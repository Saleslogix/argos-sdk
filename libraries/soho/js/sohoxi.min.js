var Soho=function(e){"use strict";function t(e,t){}var i=Object.freeze({__proto__:null,enableTimeLogging:!1,logTimeStart:function(e){},logTimeEnd:function(e){},enableConsoleLogging:!1,log:t});Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),i=t.length;--i>=0&&t.item(i)!==this;);return i>-1});var s={stripHTML:function(e){var t=e;return t?t=t.replace(/<\/?[^>]+(>|$)/g,""):""},stripTags:function(e,t){if(!e)return"";if("number"==typeof e)return e;var i=((""+(t||"")).toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),s=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(s,function(e,t){return i.indexOf("<"+t.toLowerCase()+">")>-1?e:""}).replace(s,function(e,t){return i.indexOf("<"+t.toLowerCase()+">")>-1?e:""}).replace(s,function(e,t){return i.indexOf("<"+t.toLowerCase()+">")>-1?e:""})},sanitizeConsoleMethods:function(e){var t=new RegExp("console\\.("+["assert","clear","count","debug","dirxml","dir","error","exception","groupCollapsed","groupEnd","group","info","log","markTimeline","profileEnd","profile","table","timeEnd","timeStamp","time","trace","warn"].join("|")+")((\\s+)?\\(([^)]+)\\);?)?","igm");return"string"!=typeof e?e:e.replace(t,"")},sanitizeHTML:function(e){var t=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/g,"");return t=t.replace(/<[^>]+/g,function(e){return e.replace(/(\/|\s)on\w+=(\'|")?[^"]*(\'|")?/g,"")}),t=(t=this.sanitizeConsoleMethods(t)).replace(/<\/script>/g,"")},ensureAlphaNumeric:function(e){return"number"==typeof e?e:this.stripTags(e).replace(/[^a-z0-9-]/gi,"","")},ensureAlphaNumericWithSpaces:function(e){return"number"==typeof e?e:this.stripTags(e).replace(/[^a-z0-9 ]/gi,"","")},escapeHTML:function(e){var t=e;if("string"==typeof t){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"};return t.replace(/[&<>"']/gi,function(e){return i[e]})}return t},unescapeHTML:function(e){var t=e;return"string"==typeof e&&(t=(t=(t=(t=(t=t.replace(/&amp;/g,"&")).replace(/&lt;/g,"<").replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#x27;/g,"'")).replace(/&#x2F;/g,"/")),t},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},isUrlLocal:function(e){return!(""===e)&&("/"===e[0]&&(1===e.length||"/"!==e[1]&&"\\"!==e[1])||e.length>1&&"~"===e[0]&&"/"===e[1])||e.length>=1&&"#"===e[0]}},n={isValidElement:function(e){return e instanceof HTMLElement||e instanceof SVGElement},getAttributes:function(e){return e&&(e instanceof HTMLElement||e instanceof SVGElement)?e.attributes:{}},classNameExists:function(e){var t=e.className;return t&&t.length>0},hasClass:function(e,t){if(!e.classList)return!1;if(e.className)return new RegExp("\\b"+t+"\\b").test(e.className);var i=e.getAttribute("class");return!(!i||!i.length)&&i.indexOf(t)>-1},addClass:function(e){if(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];for(var a=0;a<i.length;a++)e.classList?e.classList.add(i[a]):n.hasClass(e,[a])||(e.className+=" "+i[a])}},removeClass:function(e){if(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];for(var n=0;n<i.length;n++)if(e.classList)e.classList.remove(i[n]);else{for(var a="",r=e.className.split(" "),o=0;o<r.length;o++)r[o]!==i[o]&&(a+=r[n]+" ");this.className=a}}},isElement:function(e){return!!(e instanceof HTMLElement||e instanceof SVGElement||e instanceof $&&e.length)},getDimensions:function(e){if(!n.isElement(e))return{};if(e instanceof $){if(!e.length)return{};e=e[0]}var t=e.getBoundingClientRect(),i={};for(var s in t)isNaN(t[s])||(i[s]=t[s]);return i},append:function(e,t,i){var s=e;e instanceof $&&e.length&&(s=s[0]),(s instanceof HTMLElement||s instanceof SVGElement)&&s.insertAdjacentHTML("beforeend",this.xssClean(t,i))},remove:function(e){var t=e;e instanceof $&&e.length&&(t=t[0]),(t instanceof HTMLElement||t instanceof SVGElement)&&e.parentNode&&e.parentNode.removeChild(e)},setAttribute:function(e,t,i){var s=e;e instanceof $&&e.length&&(s=s[0]),(s instanceof HTMLElement||s instanceof SVGElement)&&s.setAttribute("attribute",i)},xssClean:function(e,t){var i=e;return t&&"*"!==t&&(i=s.stripTags(e,t)),"*"===t&&(i=s.sanitizeHTML(e)),i},html:function(e,t,i){var s=e;e instanceof $&&e.length&&(s=s[0]),(s instanceof HTMLElement||s instanceof SVGElement)&&(s.innerHTML=this.xssClean(t,i))},parents:function(e,t,i){var s,a=[];if(!n.isValidElement(e))return a;for(;e.parentNode&&(!i||!a.length);)e=e.parentNode,(s=e)!==document&&s.matches(t)&&a.push(s);return i?a[0]:a}},a={phone:320,slim:400,phablet:610,"phone-to-tablet":767,"wide-tablet":968,"tablet-to-desktop":1280,desktop:1024,"desktop-to-extralarge":1600};function r(e,t,i){var s=void 0;return function(){for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];var o=this;s?clearTimeout(s):i&&e.apply(o,a),s=setTimeout(function(){i||e.apply(o,a),s=null},t||250)}}a.current=function(){var e=!!window.getComputedStyle&&window.getComputedStyle(document.body,":after");return e?(e.getPropertyValue("content")||"").replace(/"/g,""):""},a.isAbove=function(e){var t=a[e];return!!t&&$(window).width()>t-1},a.isBelow=function(e){var t=a[e];return!!t&&$(window).width()<t},a.compare=function(){this.last||(this.last="");var e=this.current();this.last!==e&&($("body").triggerHandler("breakpoint-change",[{previous:this.last,current:e}]),this.last=e)},a.isHidden=function(e){if(!e||!n.isElement(e))return!1;var t=e.classList;if(!t.length)return!1;if(t.contains("hidden"))return!0;var i={phonedown:"xs",phone:"sm",tablet:"md",desktop:"lg",extralarge:"xl"}[this.current()],s="hidden-"+i,a="visible-"+i+"-";return!!t.contains(s)||(t.toString().indexOf(a),!1)},$.fn.isHiddenAtBreakpoint=function(){return!!this.length&&a.isHidden($(this).first()[0])};$.fn.debouncedResize=function(e){return e?this.bind("resize",r(e)):this.trigger("debouncedResize")};var o="environment",l={browser:{},features:{touch:"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},os:{},devicespecs:{},rtl:"rtl"===$("html").attr("dir"),set:function(){$("html").attr("data-sohoxi-version","4.21.2"),this.addBrowserClasses(),this.addGlobalResize(),this.addGlobalEvents(),this.addDeviceSpecs()},addBrowserClasses:function(){var e=navigator.userAgent||navigator.vendor||window.opera,t=navigator.platform,i=$("html"),s="";-1!==e.indexOf("Safari")&&-1===e.indexOf("Chrome")&&-1===e.indexOf("Android")&&(s+="is-safari ",this.browser.name="safari"),-1!==e.indexOf("Chrome")&&(s+="is-chrome ",this.browser.name="chrome");if(["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)>-1&&!/Linux/.test(t)&&(s+="is-mac ",this.os.name="Mac OS X"),e.indexOf("Firefox")>0&&(s+="is-firefox ",this.browser.name="firefox"),e.match(/Edge\//)&&(s+="ie ie-edge ",this.browser.name="edge",this.browser.version=navigator.appVersion.indexOf("Edge/18")>-1?"18":"17",s+="ie-edge"+this.browser.version),e.match(/Trident/)&&(s+="ie ",this.browser.name="ie"),(navigator.appVersion.indexOf("MSIE 8.0")>-1||e.indexOf("MSIE 8.0")>-1||8===document.documentMode)&&(s+="ie8 ",this.browser.version="8"),navigator.appVersion.indexOf("MSIE 9.0")>-1&&(s+="ie9 ",this.browser.version="9"),navigator.appVersion.indexOf("MSIE 10.0")>-1?(s+="ie10 ",this.browser.version="10"):e.match(/Trident\/7\./)&&(s+="ie11 ",this.browser.version="11"),/iPhone|iPod|iPad/.test(e)){s+="ios ",this.os.name="ios";for(var n=["iPod","iPad","iPhone"],a=0;a<n.length;a++)new RegExp(n[a]).test(e)&&(s+=n[a].toLowerCase()+" ",this.device=n[a])}/Android/.test(e)&&(s+="android ",this.os.name="android"),!this.os.name&&/Linux/.test(t)&&(this.os.name="linux"),i.addClass(s)},addDeviceSpecs:function(){var e=navigator.appVersion,t=navigator.userAgent,i=navigator.appName,s=" "+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10),a=void 0,r=void 0,o=void 0;-1!==(r=t.indexOf("Opera"))&&(i="Opera",s=t.substring(r+6),-1!==(r=t.indexOf("Version"))&&(s=t.substring(r+8))),-1!==(r=t.indexOf("OPR"))?(i="Opera",s=t.substring(r+4)):-1!==(r=t.indexOf("Edge"))?(i="Microsoft Edge",s=t.substring(r+5)):-1!==(r=t.indexOf("MSIE"))?(i="Microsoft Internet Explorer",s=t.substring(r+5)):-1!==(r=t.indexOf("Chrome"))?(i="Chrome",s=t.substring(r+7)):-1!==(r=t.indexOf("Safari"))?(i="Safari",s=t.substring(r+7),-1!==(r=t.indexOf("Version"))&&(s=t.substring(r+8))):-1!==(r=t.indexOf("Firefox"))?(i="Firefox",s=t.substring(r+8)):-1!==t.indexOf("Trident/")?(i="Microsoft Internet Explorer",s=t.substring(t.indexOf("rv:")+3)):(a=t.lastIndexOf(" ")+1)<(r=t.lastIndexOf("/"))&&(i=t.substring(a,r),s=t.substring(r+1),i.toLowerCase()===i.toUpperCase()&&(i=navigator.appName)),-1!==(o=s.indexOf(";"))&&(s=s.substring(0,o)),-1!==(o=s.indexOf(" "))&&(s=s.substring(0,o)),-1!==(o=s.indexOf(")"))&&(s=s.substring(0,o)),n=" "+parseInt(s,10),isNaN(n)&&(s=" "+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10));var l=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(e),d="-",c=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"UNIX",r:/UNIX/}];for(var h in c){var u=c[h];if(u.r.test(t)){d=u.s;break}}var p="-";switch(/Windows/.test(d)&&(p=/Windows (.*)/.exec(d)[1]),d){case"Mac OS X":p=/Mac OS X (10[\.\_\d]+)/.exec(t)[1].replace(/\_/g,".");break;case"Android":p=/Android ([\.\_\d]+)/.exec(t)[1];break;case"iOS":p=(p=/OS (\d+)_?(\d+)?/.exec(t))[1]+"."+p[2]+"."+(0|p[3])}this.devicespecs={currentBrowser:i,browserVersion:s,browserMajorVersion:n,isMobile:l,os:d,currentOSVersion:p}},addGlobalResize:function(){$(window).debouncedResize(function(){$("body").triggerHandler("resize",[window]),a.compare()}),$(window).on("orientationchange load",function(){return a.compare()})},addGlobalEvents:function(){var e=this,t=this;this.globalMouseActive=0,this.globalTouchActive=0,$("body").on("mousedown."+o,function(){++e.globalMouseActive}).on("mouseup."+o,function(){--e.globalMouseActive}).on("touchstart."+o,function(){++e.globalTouchActive}).on("touchend."+o,function(){--e.globalTouchActive}),$(window).on("scroll."+o,function(i){return"ios"!==t.os.name||-1===document.body.className.indexOf("no-scroll")||(!(!e.globalTouchActive&&!e.globalMouseActive)||(i.preventDefault(),document.body.scrollTop>0&&(document.body.scrollTop=0),!1))}),$("body").on("focusin."+o,"input, textarea",function(e){e.target.className.indexOf("dropdown-search")>-1||"ios"===t.os.name&&$("head").triggerHandler("disable-zoom")}).on("focusout."+o,"input, textarea",function(e){e.target.className.indexOf("dropdown-search")>-1||"ios"===t.os.name&&$("head").triggerHandler("enable-zoom")})},removeGlobalEvents:function(){$(window).off("scroll."+o),$("body").off(["focusin."+o,"focusout."+o].join(" "))}};function d(e){return this.init(e)}function c(e,t,i){var s=$.Deferred();if(!n.isElement(e))return s.reject();if(e instanceof $&&e.length&&(e=e[0]),null==t)return s.resolve();if(isNaN(i)&&(i=0),t=Math.round(t),(i=Math.round(i))<0)return s.fail();if(0===i)return e.scrollLeft+=t,s.resolve();var a=Date.now(),r=a+i,o=e.scrollLeft,l=t;var d=e.scrollLeft;return setTimeout(function t(){if(e.scrollLeft===d){var i=Date.now(),n=function(e,t,i){if(i<=e)return 0;if(i>=t)return 1;var s=(i-e)/(t-e);return s*s*(3-2*s)}(a,r,i),c=Math.round(o+l*n);e.scrollLeft=c,i>=r?s.resolve():e.scrollLeft!==d||e.scrollLeft===c?(d=e.scrollLeft,setTimeout(t,0)):s.resolve()}else s.reject()},0),s}function h(e,t){return(void 0!==window.requestAnimationFrame?window.requestAnimationFrame:setTimeout)(e,t)}l.browser.isIE11=function(){return"ie"===l.browser.name&&"11"===l.browser.version},l.browser.isIE10=function(){return"ie"===l.browser.name&&"10"===l.browser.version},l.set(),d.prototype={init:function(e){!this.element&&(e instanceof HTMLElement||e instanceof SVGElement)&&(this.element=e);var t=$(e),i=!1,s=!1,n=!1;if(t.is(".checkbox, .radio, .switch")){var a=t.next();a.is('[type="hidden"]')&&(a=a.next()),this.label=a[0],t.addClass("hide-focus").on("focusin.hide-focus",function(e){i||s||n||(t.removeClass("hide-focus"),t.triggerHandler("hidefocusremove",[e])),i=!1,s=!0,n=!1}).on("focusout.hide-focus",function(e){t.addClass("hide-focus"),n=a.is(n),i=!1,s=!1,t.triggerHandler("hidefocusadd",[e])}),a.on("mousedown.hide-focus",function(e){n=this,i=!0,t.addClass("hide-focus"),t.triggerHandler("hidefocusadd",[e])})}else{var r=function(e){i=!0,t.addClass("hide-focus"),t.triggerHandler("hidefocusadd",[e])};l.features.touch&&t.on("touchstart.hide-focus",function(e){r(e)}),t.addClass("hide-focus").on("mousedown.hide-focus",function(e){r(e)}).on("focusin.hide-focus",function(e){i||s||(t.removeClass("hide-focus"),t.triggerHandler("hidefocusremove",[e])),i=!1,s=!0}).on("focusout.hide-focus",function(e){t.addClass("hide-focus"),i=!1,s=!1,t.triggerHandler("hidefocusadd",[e])})}return this},updated:function(){return this.teardown().init()},teardown:function(){this.label&&$(this.label).off("mousedown.hide-focus");return $(this.element).off(["focusin.hide-focus","focusout.hide-focus","mousedown.hide-focus","touchstart.hide-focus"].join(" ")),this.element.classList.remove("hide-focus"),this}},$.fn.hideFocus=function(){return this.each(function(){var e=$.data(this,"hidefocus");e?e.updated():(e=$.data(this,"hidefocus",new d(this))).destroy=function(){this.teardown(),$.removeData(this,"hidefocus")}})},$.fn.smoothScroll=function(e,t){return c(this,e,t)};var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)};$.fn.bindFirst=function(e,t){this.on(e,t),this.each(function(){var t=$._data(this,"events")[e.split(".")[0]],i=t.pop();t.splice(0,0,i)})};var g=[];function f(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}$.fn.cssPropSupport=function(e){if(!e)return null;var t=$("<div></div>")[0],i=e.toString(),s=["Moz","Webkit","O","ms"],n=i.charAt(0).toUpperCase()+i.substr(1);if(e in t.style)return $(t).remove(),e;for(var a=0;a<s.length;a++){var r=s[a]+n;if(r in t.style)return $(t).remove(),r}return $(t).remove(),null},$.fn.transitionEndName=function(){return{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",OTransition:"oTransitionEnd",transition:"transitionend"}[$.fn.cssPropSupport("transition")]||null},$.extend($.expr[":"],{focusable:function(e){return function(e){var t=void 0,i=void 0,s=void 0,n=e.nodeName.toLowerCase(),a=!isNaN($.attr(e,"tabindex"));return"area"===n?(i=(t=e.parentNode).name,!(!e.href||!i||"map"!==t.nodeName.toLowerCase())&&!!(s=$("img[usemap=#"+i+"]")[0])&&f(s)):!!f(e)&&(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n&&void 0!==e.href||a)}(e,isNaN($.attr(e,"tabindex")))}}),$.fn.listEvents=function(){var e={};return this.each(function(){e=$._data(this,"events")}),e};var m={};function v(e){return"object"===(void 0===e?"undefined":u(e))||"function"==typeof e}function b(e){return"function"==typeof e?e():e}m.uniqueId=function(e,t,i,s){var n=e.id;if(n&&$("#"+n).length<2)return n;i=i?i+"-":"",s=s?"-"+s:"",t=t||m.getArrayFromList(e.classList).join("-"),g[t]||(g[t]=1);var a=""+i+t+"-"+g[t]+s;return g[t]+=1,a},m.parseSettings=function(e,t){var i={};if(!e||!(e instanceof HTMLElement)&&!(e instanceof $)||e instanceof $&&!e.length)return i;e instanceof $&&(e=e[0]),t=t||"data-options";var s,n,a=e.getAttribute(t);if(!a||"string"!=typeof a||-1===a.indexOf("{"))return i;function r(e){return e.replace(/'/g,'"')}try{i=JSON.parse(r(a))}catch(e){i=JSON.parse((n=/({|,)(?:\s*)(?:')?([A-Za-z_$\.][A-Za-z0-9_ \-\.$]*)(?:')?(?:\s*):/g,s=(s=a).replace(n,'$1"$2":'),n=/:(?:\s*)(?!(true|false|null|undefined))([A-Za-z_$\.#][A-Za-z0-9_ \-\.$]*)/g,s=r(s=s.replace(n,':"$2"'))))}return i},m.parseOptions=function(e,t){return m.parseSettings(e,t)},$.fn.parseOptions=function(e,t){var i=[],s=this;return e instanceof HTMLElement||e instanceof SVGElement||e instanceof $?s=$(e):(t=e,e=void 0),s.each(function(e,s){i.push({element:this,options:m.parseOptions(s,t)})}),1===i.length?i[0].options:i},m.coerceToBoolean=function(e){return!/^(false|0)$/i.test(e)&&!!e},m.coerceSettingsToBoolean=function(e,t){t&&Array.isArray(t)||Object.keys(e).forEach(function(e){t.push(e)});var i,s=void 0;for(s=0,i=t.length;s<i;s++)e[t[s]]=m.coerceToBoolean(e[t[s]]);return e},$.fn.timer=function(e,t){var i=$(this),s=10,n=void 0,a=0;function r(){n=setInterval(function(){a+=s,i.triggerHandler("update",[{counter:a}]),a>t&&(i.triggerHandler("timeout"),e.apply(arguments),clearInterval(n),a=0)},s)}return r(),{event:this,cancel:function(){i.triggerHandler("cancel"),clearInterval(n),a=0},pause:function(){i.triggerHandler("pause"),clearInterval(n)},resume:function(){i.triggerHandler("resume"),r()}}},$.copyToClipboard=function(e){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return!1}finally{document.body.removeChild(t)}}},$.fn.clearable=function(){var e=this;this.element=$(this);this.xButton=this.element.find(".icon.close").first(),this.xButton&&this.xButton.length||(this.xButton=$.createIconElement({classes:"close is-empty",icon:"close"}).icon()),this.clear=function(){e.element.val("").trigger("change").focus().trigger("cleared"),e.checkContents()},this.handleKeydown=function(t){var i=t.key;("Enter"===i||t.altKey&&("Delete"===i||"Backspace"===i))&&(t.preventDefault(),e.clear())},this.checkContents=function(){var t=e.element.val();t&&t.length?this.xButton.removeClass("is-empty"):this.xButton.addClass("is-empty"),this.element.trigger("contents-checked")},this.xButton.insertAfter(e.element),this.xButton[0].tabIndex=0,this.xButton[0].setAttribute("focusable",!0),this.xButton.off(["click.clearable","keydown.clearable"].join(" ")).on("click.clearable",this.clear).on("keydown.clearable",this.handleKeydown);var t=["blur.clearable","change.clearable","keyup.clearable"].join(" ");this.element.off(t).on(t,function(){e.checkContents()}),this.checkContents()},m.actualChar=function(e){var t=e.which,i={188:"44",190:"46",191:"47",192:"96",220:"92",222:"39",221:"93",219:"91",173:"45",187:"61",186:"59",189:"45"},s={96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",37:"%",38:"&",39:'"',44:"<",46:">",47:"?"};return Object.prototype.hasOwnProperty.call(i,t)&&(t=i[t]),t>=96&&t<=105&&(t-=48),!e.shiftKey&&t>=65&&t<=90?String.fromCharCode(t+32):!e.shiftKey&&t>=37&&t<=40?"":e.shiftKey&&Object.prototype.hasOwnProperty.call(s,t)?s[t]:String.fromCharCode(t)},$.actualChar=function(e){return m.actualChar(e)},m.equals=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},n.convertToHTMLElement=function(e){return e instanceof HTMLElement?e:e instanceof $?e=e.length?e[0]:void 0:void 0},m.extend=$.extend,m.fixSVGIcons=function e(t){if(("ie"===l.browser.name||"11"===l.browser.version)&&void 0!==t){var i="http://www.w3.org/1999/xlink";if(t instanceof $){if(!t.length)return;if(1!==t.length)return void t.each(function(t,i){e(i)});t=t[0]}t instanceof NodeList?Array.prototype.forEach.call(t,function(t){e(t)}):setTimeout(function(){for(var e=t.getElementsByTagName("use"),s=0;s<e.length;s++){var n=e[s].getAttributeNS(i,"href");e[s].setAttributeNS(i,"href","x"),e[s].setAttributeNS(i,"href",n)}},1)}},m.getViewportSize=function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},m.getContainerScrollDistance=function(e){if(!n.isElement(e))return[];var t=[];return $(e).parents([".scrollable",".scrollable-x",".scrollable-y",".modal",".card-content",".widget-content",".tab-panel",".datagrid-content"].join(", ")).each(function(){t.push({element:this,left:this.scrollLeft,top:this.scrollTop})}),document.body.classList.contains("no-scroll")||t.push({element:document.body,left:document.body.scrollLeft,top:document.body.scrollTop}),t},m.getHiddenSize=function(e,t){var i={dims:{width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},parentElement:void 0,includeMargin:!1};if(!n.isElement(e))return i.dims;e=$(e),t=$.extend({},i,t);var s=n.isElement(t.parentElement);s&&(e=e.clone().appendTo(t.parentElement));var a=t.dims,r=e.parents().add(e),o={transition:"none",webkitTransition:"none",mozTransition:"none",msTransition:"none",visibility:"hidden",display:"block"},l=[];return r.each(function(){var e=this,t={};Object.keys(o).forEach(function(i){e.style[i]&&(t[i]=e.style[i],e.style[i]=o[i])}),l.push(t)}),a.padding={bottom:e.css("padding-bottom"),left:e.css("padding-left"),right:e.css("padding-right"),top:e.css("padding-top")},a.width=e.width(),a.outerWidth=e.outerWidth(t.includeMargin),a.innerWidth=e.innerWidth(),a.scrollWidth=e[0].scrollWidth,a.height=e.height(),a.innerHeight=e.innerHeight(),a.outerHeight=e.outerHeight(t.includeMargin),a.scrollHeight=e[0].scrollHeight,r.each(function(e){var t=this,i=l[e];Object.keys(o).forEach(function(e){i[e]&&(t.style[e]=i[e])})}),s&&e.remove(),a},$.fn.getHiddenSize=function(e){return m.getHiddenSize(this,e)},m.isString=function(e){return"string"==typeof e||e instanceof String},m.isNumber=function(e){return"number"==typeof e&&void 0===e.length&&!isNaN(e)},m.safeSetSelection=function(e,t,i){t&&void 0===i&&(i=t),document.activeElement===e&&("android"===l.os.name?h(function(){e.setSelectionRange(t,i,"none")},0):e.setSelectionRange(t,i,"none"))},m.mergeSettings=function(e,t,i){return t&&v(t)||(t=v(i)?i:{}),m.extend(!0,{},b(i||{}),b(t),void 0!==e?m.parseSettings(e):{})},m.isHTML=function(e){return/(<([^>]+)>)/i.test(e)};var y={convertDelayToFPS:function(e){if(isNaN(e))throw new Error("provided delay value is not a number");return e/16.7},convertFPSToDelay:function(e){if(isNaN(e))throw new Error("provided delay value is not a number");return 16.7*e},isFinite:function(e){return"number"==typeof e&&(e==e&&e!==1/0&&e!==-1/0)}};m.forEach=function(e,t,i){for(var s=0;s<e.length;s++)t.call(i,e[s],s,e)},m.hasClass=function(e,t){var i=!1;if(e)if("classList"in e)i=e.classList.contains(t);else{var s=e.getAttribute("class");i=!!s&&-1!==s.split(/\s+/).indexOf(t)}return i},y.sign=function(e){return Math.sign?Math.sign(e):0===(e=+e)||isNaN(e)?e:e>0?1:-1},m.getArrayFromList=function(e){var t=Array.prototype.slice;return Function.prototype.call.bind(t)(e)},m.getScrollbarWidth=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",e.appendChild(i);var s=i.offsetWidth;return e.parentNode.removeChild(e),t-s};var w={EMPTY:"",splice:function(e,t,i,s){return e.slice(0,t)+s+e.slice(t+Math.abs(i))},removeDuplicates:function(e){return e.split("").filter(function(e,t,i){return i.indexOf(e)===t}).join("")},containsHTML:function(e){return/<[a-z][\s\S]*>/i.test(e)},stripWhitespace:function(e){return e.replace(/\n/g,"").replace(/[\t ]+</g,"<").replace(/>[\t ]+</g,"><").replace(/>[\t ]+$/g,">")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},toBoolean:function(e){var t=+e;return isNaN(t)?!!String(e).toLowerCase().replace(!1,""):!!t},textWidth:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;this.canvas=this.canvas||(this.canvas=document.createElement("canvas"));var i=this.canvas.getContext("2d");i.font=t+"px arial";var s=i.measureText(e);return Math.round(s.width)},padDate:function(e,t,i){return e+("0"+(t+1)).slice(-2)+("0"+i).slice(-2)}};w.textWidth=function(e,t,i){this.canvasTW=this.canvasTW||(this.canvasTW=document.createElement("canvas"));var s=this.canvasTW.getContext("2d");s.font=i||"14px arial";var n=s.measureText(e);return Math.round(n.width+(t||0))},w.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};var x={truncate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e.toString().split(".");return i[1]=i[1]?i[1].substr(0,t):"",i[0]+"."+i[1]},round:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return x.toFixed(e,t)},fixTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(+(Math.round(+(e+"e"+t))+"e"+-t)).toFixed(t)},toFixed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i="",s=e.toString().split("."),n=[s[0].substr(0,10),s[0].substr(10),s[1]],a=n[0],r=n[1];return i=this.fixTo((r||a)+(n[2]?"."+n[2]:""),t).toString(),r&&11===i.length&&"10000000000"===i&&(i="0000000000",a=(parseInt(a,10)+1).toString()),r&&(i=a+i),i},decimalPlaces:function(e){return Math.floor(e)===e?0:-1===e.toString().indexOf(".")?0:e.toString().split(".")[1].length||0}},C="";"object"===u(window.SohoConfig)&&"string"==typeof window.SohoConfig.culturesPath&&(C=window.SohoConfig.culturesPath);var k={currentLocale:{name:"",data:{}},currentLanguage:{name:""},cultures:{},languages:{},dff:[],culturesPath:C,defaultLocales:[{lang:"af",default:"af-ZA"},{lang:"ar",default:"ar-EG"},{lang:"bg",default:"bg-BG"},{lang:"cs",default:"cs-CZ"},{lang:"da",default:"da-DK"},{lang:"de",default:"de-DE"},{lang:"el",default:"el-GR"},{lang:"en",default:"en-US"},{lang:"es",default:"es-ES"},{lang:"et",default:"et-EE"},{lang:"fi",default:"fi-FI"},{lang:"fr",default:"fr-FR"},{lang:"he",default:"he-IL"},{lang:"hi",default:"hi-IN"},{lang:"hr",default:"hr-HR"},{lang:"hu",default:"hu-HU"},{lang:"id",default:"id-ID"},{lang:"it",default:"it-IT"},{lang:"iw",default:"he-IL"},{lang:"ja",default:"ja-JP"},{lang:"ko",default:"ko-KR"},{lang:"lt",default:"lt-LT"},{lang:"lv",default:"lv-LV"},{lang:"ms",default:"ms-bn"},{lang:"nb",default:"nb-NO"},{lang:"nl",default:"nl-NL"},{lang:"no",default:"no-NO"},{lang:"pl",default:"pl-PL"},{lang:"pt",default:"pt-PT"},{lang:"ro",default:"ro-RO"},{lang:"ru",default:"ru-RU"},{lang:"sk",default:"sk-SK"},{lang:"sl",default:"sl-SI"},{lang:"sv",default:"sv-SE"},{lang:"th",default:"th-TH"},{lang:"tr",default:"tr-TR"},{lang:"uk",default:"uk-UA"},{lang:"vi",default:"vi-VN"},{lang:"zh",default:"zh-CN"}],supportedLocales:["af-ZA","ar-EG","ar-SA","bg-BG","cs-CZ","da-DK","de-DE","el-GR","en-AU","en-GB","en-IN","en-NZ","en-US","en-ZA","es-AR","es-ES","es-419","es-MX","es-US","et-EE","fi-FI","fr-CA","fr-FR","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-IT","ja-JP","ko-KR","lt-LT","lv-LV","ms-bn","ms-my","nb-NO","nl-NL","no-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","sv-SE","th-TH","tr-TR","uk-UA","vi-VN","zh-CN","zh-Hans","zh-Hant","zh-TW"],defaultLocale:"en-US",updateLanguageTag:function(e){var t=$("html");2===e.length&&(e=this.defaultLocales.filter(function(t){return t.lang===e})),t.attr("lang",e),this.isRTL()?t.attr("dir","rtl"):t.removeAttr("dir"),this.isRTL()&&k.flipIconsHorizontally(),$("body").removeClass("busy-loading-locale")},getCulturesPath:function(){if(!this.culturesPath)for(var e=document.getElementsByTagName("script"),t=/sohoxi(.min){0,1}(.{0,1}[a-z0-9]*)\.js/,i=0;i<e.length;i++){var s=e[i].src,n=s.indexOf("?");if(""!==s&&n>-1&&(s=s.substr(0,n)),"sohoxi-script"===e[i].id)return s.substring(0,s.lastIndexOf("/"))+"/";s.match(t)&&(this.culturesPath=s.replace(t,"")+"cultures/")}return this.culturesPath},cultureInHead:function(){for(var e=!1,t=document.getElementsByTagName("script"),i=0;i<t.length;i++){t[i].src.indexOf("cultures")>-1&&(e=!0)}return e},correctLocale:function(e){"in-ID"===e&&(e="id-ID"),"iw"===e.substr(0,2)&&(e="he-IL");var t=e.split("-")[0];if(-1===this.supportedLocales.indexOf(e)){if((e=this.defaultLocales.filter(function(e){return e.lang===t}))&&e[0])return e[0].default;e=this.defaultLocale}return e},correctLanguage:function(e){var t=this.defaultLocales.filter(function(t){return t.lang===e});return t&&t[0]?e:(t=this.remapLanguage(e),t=this.defaultLocale.substr(0,2),t)},remapLanguage:function(e){var t=e;return"in"===e&&(t="id"),"iw"===e&&(t="he"),"nb"===e&&(t="no"),t},addCulture:function(e,t,i){var s=e.substr(0,2);this.cultures[e]=t,this.cultures[e].name=e,!this.languages[s]&&t.messages&&(this.languages[s]={name:s,direction:t.direction||(i?i.direction:""),nativeName:t.nativeName||(i?i.nativeName:""),messages:t.messages||(i?i.messages:{})})},appendLocaleScript:function(e,t,i,s){var n=this,a=document.createElement("script");a.src=s?this.getCulturesPath()+s+".js":this.getCulturesPath()+e+".js",a.onload=function(){t&&!i&&(n.setCurrentLocale(e,n.cultures[e]),n.dff[e].resolve(e)),i&&n.dff[i]&&(n.setCurrentLocale(e,n.cultures[e]),n.setCurrentLocale(i,n.cultures[i]),n.dff[i].resolve(i)),t||i||!n.dff[e]||n.dff[e].resolve(e)},a.onerror=function(){n.dff[e]&&n.dff[e].reject()},"object"===u(window.SohoConfig)&&"string"==typeof window.SohoConfig.nonce&&a.setAttribute("nonce",window.SohoConfig.nonce),document.head.appendChild(a)},set:function(e){if(e=this.correctLocale(e),this.dff[e]=$.Deferred(),""===e)return this.dff.resolve(),this.dff.promise();e&&"en-US"!==e&&!this.cultures["en-US"]&&this.appendLocaleScript("en-US",!1);var t=e.split("-")[0],i=!1,s=this.defaultLocales.filter(function(e){return e.lang===t})[0]||[{default:"en-US"}];return s.default&&s.default!==e&&!this.cultures[s.default]&&(i=!0),i||!e||this.cultures[e]||this.currentLocale.name===e||(this.setCurrentLocale(e),this.appendLocaleScript(e,!0)),i&&(this.appendLocaleScript(s.default,!1,e),this.appendLocaleScript(e,!1,s.default)),e&&this.currentLocale.data&&this.currentLocale.dataName===e&&this.dff[e].resolve(this.currentLocale.name),this.setCurrentLocale(e,this.cultures[e]),this.cultures[e]&&this.cultureInHead()&&this.dff[e].resolve(this.currentLocale.name),this.dff[e].promise()},getLocale:function(e,t){if(e=this.correctLocale(e),this.dff[e]=$.Deferred(),""===e){var i=$.Deferred();return i.resolve(),i.promise()}return e&&"en-US"!==e&&!this.cultures["en-US"]&&this.appendLocaleScript("en-US",!1),e&&!this.cultures[e]&&this.currentLocale.name!==e&&this.appendLocaleScript(e,!1,!1,t),e&&this.currentLocale.data&&this.currentLocale.dataName===e&&this.dff[e].resolve(e),this.cultures[e]&&this.cultureInHead()&&this.dff[e].resolve(e),this.dff[e].promise()},setLanguage:function(e){var t=this,i=this.currentLocale.name;e=this.correctLanguage(e),this.languages[e]||this.set(e).done(function(){t.set(i),t.setLanguage(e)});var s=this.correctLocale(e);return this.languages[e]?(this.currentLanguage=this.languages[e],this.updateLanguageTag(e),this.dff[s]=$.Deferred(),this.dff[s].resolve()):(this.currentLanguage.name=e,this.dff[s])},setCurrentLocale:function(e,t){var i=this.remapLanguage(e.substr(0,2));this.currentLocale.name=e,t&&(this.currentLocale.data=t,this.currentLocale.dataName=e,this.currentLanguage=this.languages[i],this.currentLanguage&&this.updateLanguageTag(e))},formatDate:function(e,t){t||(t={date:"short"});var i=this.useLocale(t);if(e){if("0000"===e||"000000"===e||"00000000"===e)return"";if(!(e instanceof Date)&&"string"==typeof e&&e.indexOf("Z")>-1)e=new Date(e);if(!(e instanceof Date)&&"string"==typeof e&&e.indexOf("T")>-1)e=new Date(e);if(!(e instanceof Date)&&"string"==typeof e){var s=k.parseDate(e,t);isNaN(s)&&"datetime"===t.date&&"-"===e.substr(4,1)&&"-"===e.substr(7,1)&&(s=new Date(e.substr(0,4),e.substr(5,2)-1,e.substr(8,2),e.substr(11,2),e.substr(14,2),e.substr(17,2))),e=s}if(!(e instanceof Date)&&"number"==typeof e)e=new Date(e);if(e){var n=void 0,a="",r=i.calendars?i.calendars[0]:null;t.pattern&&(n=t.pattern),t.date&&(n=r.dateFormat[t.date]),n||(n=r.dateFormat.short);var o=e instanceof Array?e[0]:e.getFullYear(),l=e instanceof Array?e[1]:e.getMonth(),d=e instanceof Array?e[2]:e.getDate(),c=e.getDay?e.getDay():"",h=e instanceof Array?e[3]:e.getHours(),u=e instanceof Array?e[4]:e.getMinutes(),p=e instanceof Array?e[5]:e.getSeconds(),g=e instanceof Array?e[6]:e.getMilliseconds();if(r&&r.conversions)if(t.fromGregorian){var f=r.conversions.fromGregorian(e);d=f[2],l=f[1],o=f[0]}else if(t.toGregorian){var m=r.conversions.toGregorian(o,l,d);d=m.getDate(),l=m.getMonth(),o=m.getFullYear()}if((a=(a=(a=(a=(a=(n=(n=(n=(n=n.replace("de","nnnnn")).replace("ngày","nnnn")).replace("tháng","t1áng")).replace("den","nnn")).replace("dd",this.pad(d,2))).replace("d",d)).replace("yyyy",o)).replace("yy",o.toString().substr(2))).replace("y",o)).indexOf(" a")>-1&&0===h&&(a=(a=a.replace("hh",12)).replace("h",12)),a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace("hh",h>12?this.pad(h-12,2):this.pad(h,2))).replace("h",h>12?h-12:h)).replace("HH",this.pad(h,2))).replace("H",h)).replace("mm",this.pad(u,2))).replace("ss",this.pad(p,2))).replace("SSS",this.pad(g,0))).replace("MMMM",r?r.months.wide[l]:null)).replace("MMM",r?r.months.abbreviated[l]:null),-1===n.indexOf("MMM")&&(a=(a=a.replace("MM",this.pad(l+1,2))).replace("M",l+1)),r&&(a=(a=a.replace(" a"," "+(h>=12?r.dayPeriods[1]:r.dayPeriods[0]))).replace("EEEE",r.days.wide[c])),r&&(a=a.replace("EEEE",r.days.wide[c])),(a=(a=(a=(a=a.replace("nnnnn","de")).replace("nnnn","ngày")).replace("t1áng","tháng")).replace("nnn","den")).indexOf("zz")>-1){var v=new Date,b=this.getTimeZone(v,"short"),y=this.getTimeZone(v,"long");a=(a=a.replace("zzzz",y)).replace("zz",b)}return a.trim()}}},getTimeZone:function(e,t){var i=k.currentLocale.name||"en-US";return"ie"===l.browser.name&&"11"===l.browser.version?e.toTimeString().match(new RegExp("[A-Z](?!.*[(])","g")).join(""):("long"===t?e.toLocaleTimeString(i,{timeZoneName:"long"}):e.toLocaleTimeString(i,{timeZoneName:"short"})).replace(/[0-9:AMP]/g,"").split(" ").join(" ").trimLeft()},dateToTimeZone:function(e,t,i){return"ie"===l.browser.name&&"11"===l.browser.version?e.toLocaleString(k.currentLocale.name)+" "+e.toTimeString().match(new RegExp("[A-Z](?!.*[(])","g")).join(""):e.toLocaleString(k.currentLocale.name,{timeZone:t,timeZoneName:i})},dateToUTC:function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()))},toLocaleString:function(e,t,i){return"number"!=typeof e?"":e.toLocaleString(t||k.currentLocale.name,i||void 0)},convertNumberToEnglish:function(e){for(var t=["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"],i=["०","१","२","३","४","५","६","७","८","९"],s=["零","壹","貳","叄","肆","伍","陸","柒","捌","玖"],n=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],a=["〇","一","二","三","四","五","六","七","八","九"],r=0;r<=9;r++)e=(e=(e=(e=(e=(e=(e=e.replace(t[r],r)).replace("٬","")).replace(",","")).replace(i[r],r)).replace(s[r],r)).replace(n[r],r)).replace(a[r],r),0===r&&(e=e.replace("零",r));return parseFloat(e)},isValidDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},parseDate:function(e,t,i){if(e){var s=t,n=this.currentLocale.name,a=this.calendar();"object"===(void 0===t?"undefined":u(t))&&(n=t.locale||n,s=t.dateFormat||this.calendar(n).dateFormat[s.date]),"object"===(void 0===t?"undefined":u(t))&&t.pattern&&(s=t.dateFormat||t.pattern),"object"===(void 0===t?"undefined":u(t))&&t.calendarName&&t.locale&&(a=this.calendar(t.locale,t.calendarName)),s||(s=this.calendar(n).dateFormat.short);var r=e;if("0000"!==e&&"000000"!==e&&"00000000"!==e){s.pattern&&(s=s.pattern);var o=void 0,l=void 0,d={},c=s.toLowerCase().indexOf("h")>-1,h=e.toLowerCase().indexOf("z")>-1,p=void 0,g=void 0;if(c){var f=k.getTimeZone(new Date,"short"),m=k.getTimeZone(new Date,"long");e=(e=e.replace(" "+f,"")).replace(" "+m,""),s=(s=s.replace(" zzzz","").replace(" zz","")).replace(/[T\s:.-]/g,"/").replace(/z/i,""),e=e.replace(/[T\s:.-]/g,"/").replace(/z/i,"")}if(s=s.replace(" de "," "),e=e.replace(" de "," "),"Mdyyyy"!==s&&"dMyyyy"!==s||(e=(e=e.substr(0,e.length-4)+"/"+e.substr(e.length-4,e.length)).substr(0,e.indexOf("/")/2)+"/"+e.substr(e.indexOf("/")/2)),"Mdyyyy"===s&&(s="M/d/yyyy"),"dMyyyy"===s&&(s="d/M/yyyy"),-1!==s.indexOf(" ")&&(s=s.replace(/[\s:.]/g,"/"),e=e.replace(/[\s:.]/g,"/")),s.indexOf("MMMM")>-1&&k.isRTL()&&s){var v=e.lastIndexOf("/");e=e.substr(0,v-1).replace("/"," ")+e.substr(v)}if(-1===s.indexOf(" ")&&-1===s.indexOf(".")&&-1===s.indexOf("/")&&-1===s.indexOf("-")){-1!==e.indexOf(" ")?e=e.split(" ").join(""):-1!==e.indexOf(".")?e=e.split(".").join(""):-1!==e.indexOf("/")?e=e.split("/").join(""):-1!==e.indexOf("-")&&(e=e.split("-").join(""));var b=s[0],y="",w="";for(p=0,g=s.length;p<g;p++)w+=s[p]!==b?"/"+e[p]:e[p],y+=s[p]!==b?"/"+s[p]:s[p],p>1&&(b=s[p]);e=w,s=y}o=s.split("/"),l=e.split("/"),1===o.length&&(o=s.split(".")),1===l.length&&(l=e.split(".")),1===o.length&&(o=s.split("-")),1===l.length&&(l=e.split("-")),1===o.length&&(o=s.split(" ")),1===l.length&&(l=e.split(" "));var x=this.getDatePart(o,l,"M","MM","MMM","MMMM"),C=this.getDatePart(o,l,"yy","yyyy"),T=!1;for(p=0,g=l.length;p<g;p++){var S=""+o[p],A=l[p],D=parseInt(A,10);T||(T=S.toLowerCase().indexOf("d")>-1);var I=void 0,E=void 0,L=void 0;switch(S){case"d":if(I=new Date(C,x,0).getDate(),D<1||D>31||D>I)return;d.day=A;break;case"dd":if(D<1||D>31||D<10&&"0"!==A.substr(0,1))return;d.day=A;break;case"M":if(D<1||D>12)return;d.month=A-1;break;case"MM":if(D<1||D>12||D<10&&"0"!==A.substr(0,1))return;d.month=A-1;break;case"MMM":E=this.calendar(n).months.abbreviated;for(var P=0;P<E.length;P++)r.indexOf(E[P])>-1&&(d.month=P);break;case"MMMM":L=this.calendar(n).months.wide;for(var M=0;M<L.length;M++)r.indexOf(L[M])>-1&&(d.month=M);break;case"yy":d.year=this.twoToFourDigitYear(A);break;case"yyyy":d.year=2===A.length?this.twoToFourDigitYear(A):A;break;case"h":if(D<0||D>12)return;d.h=A;break;case"hh":if(D<0||D>12)return;d.h=1===A.length?"0"+A:A;break;case"H":if(D<0||D>24)return;d.h=A;break;case"HH":if(D<0||D>24)return;d.h=1===A.length?"0"+A:A;break;case"ss":if(D<0||D>60){d.ss=0;break}d.ss=A;break;case"SSS":d.ms=A;break;case"mm":if(D<0||D>60){d.mm=0;break}d.mm=A;break;case"a":A.toLowerCase()!==a.dayPeriods[0]&&A.toUpperCase()!==a.dayPeriods[0]||(d.a="AM",d.h&&(12!==d.h&&"12"!==d.h||(d.h=0))),A.toLowerCase()!==a.dayPeriods[1]&&A.toUpperCase()!==a.dayPeriods[1]||(d.a="PM",d.h&&d.h<12&&(d.h=parseInt(d.h,10)+12))}}if(d.return=void 0,d.leapYear=d.year%4==0&&d.year%100!=0||d.year%400==0,!c||d.h||d.mm){if(!d.year&&0!==d.year&&!i){for(d.isUndefindedYear=!0,p=0,g=o.length;p<g;p++)if(o[p].indexOf("y")>-1&&void 0!==l[p]){d.isUndefindedYear=!1;break}d.isUndefindedYear?d.year=(new Date).getFullYear():delete d.year}if(d.year&&2===d.year.length&&(d.year="20"+d.year),d.year=$.trim(d.year),d.day=$.trim(d.day),(""===d.year||d.year&&2!==(""+d.year).length&&4!==(""+d.year).length)&&delete d.year,!d.month&&0!==d.month&&!i){for(d.isUndefindedMonth=!0,p=0,g=o.length;p<g;p++)if(o[p].indexOf("M")>-1&&void 0!==l[p]){d.isUndefindedMonth=!1;break}d.isUndefindedMonth&&(d.month=(new Date).getMonth())}if(!(d.day||0===d.day||i&&T)){for(d.isUndefindedDay=!0,p=0,g=o.length;p<g;p++)if(o[p].indexOf("d")>-1&&void 0!==l[p]){d.isUndefindedDay=!1;break}d.isUndefindedDay?d.day=1:delete d.day}return c?h?(void 0!==d.h&&(d.return=new Date(Date.UTC(d.year,d.month,d.day,d.h,d.mm))),void 0!==d.ss&&(d.return=new Date(Date.UTC(d.year,d.month,d.day,d.h,d.mm,d.ss))),void 0!==d.ms&&(d.return=new Date(Date.UTC(d.year,d.month,d.day,d.h,d.mm,d.ss,d.ms)))):(void 0!==d.h&&(d.return=new Date(d.year,d.month,d.day,d.h,d.mm)),void 0!==d.ss&&(d.return=new Date(d.year,d.month,d.day,d.h,d.mm,d.ss)),void 0!==d.ms&&(d.return=new Date(d.year,d.month,d.day,d.h,d.mm,d.ss,d.ms))):d.return=new Date(d.year,d.month,d.day),"islamic-umalqura"===a.name?[parseInt(d.year,10),parseInt(d.month,10),parseInt(d.day,10),parseInt(d.h||0,10),parseInt(d.ss||0,10),parseInt(d.ms||0,10)]:this.isValidDate(d.return)?d.return:void 0}}}},twoToFourDigitYear:function(e){return parseInt((e>39?"19":"20")+e,10)},getDatePart:function(e,t,i,s,n,a){var r=0;return $.each(t,function(o){i!==e[o]&&s!==e[o]&&n!==e[o]&&a!==e[o]||(r=t[o])}),r},useLocale:function(e){var t=this.currentLocale.data;return e&&e.locale&&this.cultures[e.locale]&&(t=this.cultures[e.locale]),t.numbers||(t.numbers=this.numbers()),t},useLanguage:function(e){var t=this.currentLanguage;if(e&&e.locale){var i=e.locale.split("-")[0];return this.languages[i]}return e&&e.language&&this.languages[e.language]&&(t=this.languages[e.language]),t},formatNumber:function(e,t){var i=this.useLocale(t),s=void 0,n=void 0,a=void 0,r=t&&t.decimal?t.decimal:i.numbers.decimal,o=t&&void 0!==t.minimumFractionDigits?t.minimumFractionDigits:t&&t.style&&"currency"===t.style?2:t&&t.style&&"percent"===t.style?0:2,l=t&&void 0!==t.maximumFractionDigits?t.maximumFractionDigits:t&&t.style&&("currency"===t.style||"percent"===t.style)?2:t&&t.minimumFractionDigits?t.minimumFractionDigits:3;if(null!=e&&""!==e){if(t&&"integer"===t.style&&(l=0,o=0),t&&"currency"===t.style){var d=t&&t.currencySign?t.currencySign:i.currencySign,c=t&&t.currencyFormat?t.currencyFormat:i.currencyFormat;c||(c="¤#,##0.00"),n=c.replace("¤",d)}if(t&&"percent"===t.style){var h=i.numbers?i.numbers.percentSign:"%";a=(a=i.numbers?i.numbers.percentFormat:"### %").replace("¤",h)}"string"==typeof e&&("."!==r&&(e=e.replace(r,".")),e=k.parseNumber(e)),e.toString().indexOf("e")>-1&&(e=e.toFixed(l+1)),t&&"percent"===t.style&&(e=(100*e).toFixed(o));var u=this.truncateDecimals(e,o,l,t&&t.round).split("."),p=[3,3];i&&i.numbers&&i.numbers.groupSizes&&(p=i.numbers.groupSizes),t&&t.groupSizes&&(p=t.groupSizes);var g=t&&void 0!==t.group?t.group:i.numbers.group,f=this.expandNumber(u[0],p,g);u[0]=f,s=u.join(r);var m=i&&i.numbers&&i.numbers.minusSign?i.numbers.minusSign:"-",v=s.indexOf(m)>-1;s=s.replace(m,"");var b=function(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},y="";return 0===o&&(y=new RegExp("("+b(r)+"[0-9]*?)0+$"),s=s.replace(y,"$1")),o>0&&(y=new RegExp("("+b(r)+".{"+o+"}[0-9]*?)0+$"),s=s.replace(y,"$1")),y=new RegExp(b(r)+"$"),s=s.replace(y,""),t&&"currency"===t.style&&(s=n.replace("###",s)),t&&"percent"===t.style&&(s=a.replace("###",s)),v&&(s=m+s),s}},expandNumber:function(e,t,i){var s=e.length,n=!1;if("-"===e.substr(0,1)&&(s=(e=e.substr(1)).length,n=!0),s<=3)return(n?"-":"")+e;if(0===t[0])return(n?"-":"")+e;var a=e.substr(e.length-t[0]),r=e.substr(0,e.length-t[0]);if(0===t[1])return(n?"-":"")+r+(""===r?"":i)+a;var o=r.split("").reverse().join(""),l=new RegExp(".{1,"+t[1]+"}","g");return(n?"-":"")+o.match(l).join(i).split("").reverse().join("")+i+a},truncateDecimals:function(e,t,i,s){var n=e;n=s?x.round(e,i):x.truncate(e,i);var a=x.decimalPlaces(n);return a<t&&(n=n.toString()+new Array(t-a+1).join("0")),n.toString()},parseNumber:function(e,t){var i=this.useLocale(t),s=i.numbers,n=void 0;if(!(n=e))return NaN;"number"==typeof e&&(n=n.toString());var a=s?s.group:",",r=s?s.decimal:".",o=s?s.percentSign:"%",l=i.currencySign||"$";return(n=(n=(n=(n=(n=(n=n.replace(new RegExp("\\"+a,"g"),"")).replace(r,".")).replace(o,"")).replace(l,"")).replace("$","")).replace(" ","")).length>=19?n:parseFloat(n)},translate:function(e,t){var i=this.useLanguage(t),s=!1,n=!0;if("boolean"==typeof t&&(s=t),"object"===(void 0===t?"undefined":u(t))&&void 0!==t.showAsUndefined&&(s=t.showAsUndefined),"object"===(void 0===t?"undefined":u(t))&&void 0!==t.showBrackets&&(n=t.showBrackets),void 0===i||void 0===i.messages)return s?void 0:(n?"[":"")+e+(n?"]":"");if(void 0===i.messages[e]){return this.languages&&this.languages.en&&this.languages.en.messages&&void 0!==this.languages.en.messages[e]?this.languages.en.messages[e].value:s?void 0:(n?"[":"")+e+(n?"]":"")}return i.messages[e].value},extendTranslations:function(e,t){if(this.languages[e]){var i=this.languages[e].messages;this.languages[e].messages=$.extend(!1,i,t)}},calendar:function(e,t){var i=[];if(this.currentLocale.data.calendars&&!e&&(i=this.currentLocale.data.calendars),e&&this.cultures[e]&&(i=this.cultures[e].calendars),t&&i)for(var s=0;s<i.length;s++){var n=i[s];if(n.name===t)return n}return i[0]?i[0]:{dateFormat:{separator:"/",timeSeparator:":",short:"M/d/yyyy",medium:"MMM d, yyyy",long:"MMMM d, yyyy",full:"EEEE, MMMM d, y",month:"MMMM d",year:"MMMM yyyy",timestamp:"h:mm:ss a",datetime:"M/d/yyyy h:mm a"},timeFormat:"HH:mm:ss",dayPeriods:["AM","PM"]}},numbers:function(){return this.currentLocale.data.numbers?this.currentLocale.data.numbers:{percentSign:"%",percentFormat:"### %",minusSign:"-",decimal:".",group:","}},pad:function(e,t,i){return i=i||"0",(e+="").length>=t?e:new Array(t-e.length+1).join(i)+e},isRTL:function(){return!!this.currentLanguage&&"right-to-left"===this.currentLanguage.direction},toUpperCase:function(e){return"function"==typeof this.currentLocale.data.toUpperCase?this.currentLocale.data.toUpperCase(e):e.toLocaleUpperCase()},toLowerCase:function(e){return"function"==typeof this.currentLocale.data.toLowerCase?this.currentLocale.data.toLowerCase(e):e.toString().toLocaleLowerCase()},capitalize:function(e){return this.toUpperCase(e.charAt(0))+e.slice(1)},capitalizeWords:function(e){for(var t=e.split(" "),i=0;i<t.length;i++)t[i]=this.capitalize(t[i]);return t.join(" ")},flipIconsHorizontally:function(){var e=["attach","bottom-aligned","bullet-list","cancel","cart","collapse-app-tray","cut","document","drilldown","duplicate","expand-app-tray","export","first-page","folder","import","last-page","launch","left-align","left-text-align","left-arrow","new-document","next-page","number-list","paste","previous-page","quote","redo","refresh","right-align","right-arrow","right-text-align","save","search-folder","search-list","search","send","tack","tree-collapse","tree-expand","undo","unlocked","add-grid-record","add-grid-row","additional-help","bubble","bullet-steps","cascade","change-font","clear-screen","script","clockwise-90","close-cancel","close-save","contacts","copy-from","copy-mail","copy-url","counter-clockwise-90","create-report","delete-grid-record","delete-grid-row","display","employee-directory","export-2","export-to-pdf","generate-key","get-more-rows","group-selection","headphones","help","helper-list-select","history","invoice-released","language","logout","key","lasso","line-bar-chart","line-chart","new-expense-report","new-payment-request","new-time-sheet","new-travel-plan","no-attachment","no-comment","no-filter","overlay-line","pdf-file","phone","payment-request","pie-chart","queries","quick-access","refresh-current","restore-user","run-quick-access","save-close","save-new","search-results-history","select","send-submit","show-last-x-days","special-item","stacked","timesheet","unsubscribe","update-preview","zoom-100","zoom-in","zoom-out","caret-left","caret-right"];$("svg").each(function(){var t=$(this).getIconName();t&&-1!==$.inArray(t,e)&&0===$(this).closest(".monthview").length&&$(this).addClass("icon-rtl-rotate")})}};function T(e){if("function"!=typeof e){if("string"==typeof e)return e;throw new Error((void 0===e?"undefined":u(e))+" was provided where a function was expected.")}if("string"==typeof e.name)return e.name+"()";var t=/^function\s+([\w$]+)\s*\(/.exec(e.toString());return t?t[1]+"()":"(anonymous function)"}function S(e,t){var i=T(e),s=T(t);"object"===("undefined"==typeof console?"undefined":u(console))&&console.warn('IDS Enterprise: "'+s+'" is deprecated. Please use "'+i+'" instead.')}function A(e){"object"===("undefined"==typeof console?"undefined":u(console))&&console.warn('IDS Enterprise: "'+e+'" is deprecated and will be later removed. Please adjust your code accordingly.')}function D(e,t){var i=function(){S(e,t);for(var i=arguments.length,s=Array(i),n=0;n<i;n++)s[n]=arguments[n];e.apply(this,s)};return i.prototype=e.prototype,i}function I(e){return this.element=$(e),this}I.prototype={get url(){return window.location.href.replace(window.location.hash,"")},get href(){return this.element[0].getAttribute("href")},getCurrentURL:function(){return S("url","getCurrentURL"),this.url},getBaseURL:function(e){return this.element.length&&this.href&&"/"!==this.href?e?0===e.indexOf("/")?e:(e=(-1===e.indexOf("#")?"#":"")+e,this.url+e):this.url:e||""}};var E=new I($("base[href]"));$.getBaseURL=function(e){return E.getBaseURL(e)};var L={noAutoStart:!1},P={};function M(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function B(e){if(this.id=e.id,this.duration=e.duration||-1,this.duration<1&&("string"!=typeof this.id||!this.id.length))throw new Error("cannot build a RenderLoopItem with no duration and no namespace");return this.updateDuration=e.updateDuration||1,this.setFuncs(e),this.paused=!1,this.elapsedTime=0,this.startTime=M(),this}function R(e){return this.items=[],this.element=$("body"),this.settings=m.mergeSettings(null,e,L),!0!==this.settings.noAutoStart&&this.start(),this}"object"===u(window.SohoConfig)&&"object"===u(window.SohoConfig.renderLoop)&&(P=m.extend({},L,window.SohoConfig.renderLoop)),B.prototype={setFuncs:function(e){if("function"!=typeof e.updateCallback&&"function"!=typeof e.timeoutCallback)throw new Error("cannot register callback to RenderLoop because callback is not a function");"function"==typeof e.updateCallback&&(this.updateCallback=e.updateCallback),"function"==typeof e.timeoutCallback&&(this.timeoutCallback=e.timeoutCallback)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},destroy:function(e){e&&(this.noTimeout=!0),this.doRemoveOnNextTick=!0}},R.prototype={start:function(){this.doLoop=!0,this.startTime=M();var e=this,t=M(),i=void 0,s=void 0;!function n(){e.doLoop&&(i=M(),s=(i-t)/1e3,e.items.forEach(function(n){if(n.doRemoveOnNextTick)e.remove(n);else if(n.paused||n.elapsedTime++,"number"==typeof n.duration&&n.duration>-1&&(n.startTime||(n.startTime=i),n.elapsedTime>=n.duration))n.destroy();else{var a=void 0;if("function"==typeof n.updateCallback){if(n.updateDuration&&n.updateDuration>1&&(isNaN(n.timeUntilNextUpdate)&&(n.timeUntilNextUpdate=n.updateDuration),n.timeUntilNextUpdate>0))return void--n.timeUntilNextUpdate;a=[n,{last:t,delta:s,now:i}],n.updateCallback.apply(null,a)}}}),t=i,requestAnimationFrame(n))}()},stop:function(){this.doLoop=!1},totalDuration:function(){return M()-this.startTime},queue:function(){return this.items},buildRenderLoopItem:function(e,t,i,s){var n="string"!=typeof s||!s.length;if("string"==typeof i)if(n)s=i,i=-1,n=!1;else{var a=Number(i);isNaN(a)||(i=a)}else"number"!=typeof i&&(i=-1);return"string"==typeof s&&s.length||(s=""),new B({id:s,updateCallback:e,timeoutCallback:t,duration:i})},register:function(e,t,i,s){return e instanceof B||(e=this.buildRenderLoopItem(e,t,i,s)),this.items.push(e),e},unregister:function(e,t){if("function"!=typeof e&&"string"!=typeof e&&"string"!=typeof t)throw new Error("must provide either a callback function or a namespace string to remove an entry from the RenderLoop queue.");return"string"==typeof e&&(t=e,e=void 0),this.remove({cb:e,id:t})},getFromQueue:function(e,t){"string"==typeof callback&&(t=e,e=void 0);var i=void 0;return"function"==typeof callback?this.items.forEach(function(t){return""+t.updateCallback!=""+e||(i=t,!1)}):"string"==typeof t&&this.items.forEach(function(e){return e.id!==t||(i=e,!1)}),i},remove:function(e){var t=void 0;return e instanceof B?(t=e,this.items=this.items.filter(function(t){return t!==e})):"function"==typeof e.updateCallback?this.items=this.items.filter(function(i){return""+i.updateCallback!=""+e.updateCallback||(t=i,!1)}):"string"==typeof e.id&&(this.items=this.items.filter(function(i){return i.id!==e.id||(t=i,!1)})),"function"!=typeof t.timeoutCallback||t.noTimeout||t.timeoutCallback.apply(null,t),this.element.triggerHandler("remove.renderLoop",[t]),t},pause:function(e,t){if("function"!=typeof e&&"string"!=typeof e&&"string"!=typeof t)throw new Error("must provide either a callback function or a namespace string to pause an entry in the RenderLoop queue.");var i=this.getFromQueue(e,t);return i.pause(),i},resume:function(e,t){if("function"!=typeof e&&"string"!=typeof e&&"string"!=typeof t)throw new Error("must provide either a callback function or a namespace string to pause an entry in the RenderLoop queue.");var i=this.getFromQueue(e,t);return i.resume(),i}};var F=new R(P);function O(){this.pressedKeys=new Map,this.init()}O.prototype={init:function(){var e=this;$(document).on("keydown.keyboard",function(t){e.press(t.key),e.announceKeys()}).on("keyup.keyboard",function(t){e.unpress(t.key),e.announceKeys()})},announceKeys:function(){var e=[];this.pressedKeys.forEach(function(t,i){e.push(i)}),$("body").triggerHandler("keys",[e])},press:function(e){return this.pressedKeys.set(""+e,!0)},unpress:function(e){return this.pressedKeys.delete(""+e)},isPressed:function(e){return this.pressedKeys.has(""+e)}};var N=new O,z={hexToRgba:function(e,t){var i=void 0;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)?(3===(i=e.substring(1).split("")).length&&(i=[i[0],i[0],i[1],i[1],i[2],i[2]]),"rgba("+[(i="0x"+i.join(""))>>16&255,i>>8&255,255&i].join(",")+","+t.toString()+")"):""},getLuminousColorShade:function(e,t){e=this.validateHex(e).substr(1),t=t||0;var i="#",s=void 0,n=void 0;for(n=0;n<3;n++)s=parseInt(e.substr(2*n,2),16),i+=("00"+(s=Math.round(Math.min(Math.max(0,s+s*t),255)).toString(16))).substr(s.length);return i},validateHex:function(e){return(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),"#"+e},getContrastColor:function(e,t,i){e=e?e.replace("#",""):"";var s=function(t){return parseInt(e.substr(t,2),16)};return(299*s(0)+587*s(2)+114*s(4))/1e3>=128?i||"black":t||"white"}},H={currentTheme:{id:"theme-soho-light",name:k.translate("SohoLightTheme"),legacyId:"light"},allColors:[{id:"theme-soho-light",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#fbe9bf"},20:{name:"theme-color-palette-amber-20",value:"#f8e09c"},30:{name:"theme-color-palette-amber-30",value:"#f7d475"},40:{name:"theme-color-palette-amber-40",value:"#f4c951"},50:{name:"theme-color-palette-amber-50",value:"#f2bc41"},60:{name:"theme-color-palette-amber-60",value:"#efa836"},70:{name:"theme-color-palette-amber-70",value:"#ee9a36"},80:{name:"theme-color-palette-amber-80",value:"#e4882b"},90:{name:"theme-color-palette-amber-90",value:"#db7726"},100:{name:"theme-color-palette-amber-100",value:"#d66221"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#ede3fc"},20:{name:"theme-color-palette-amethyst-20",value:"#daccec"},30:{name:"theme-color-palette-amethyst-30",value:"#c7b4db"},40:{name:"theme-color-palette-amethyst-40",value:"#b59eca"},50:{name:"theme-color-palette-amethyst-50",value:"#a38db7"},60:{name:"theme-color-palette-amethyst-60",value:"#9279a6"},70:{name:"theme-color-palette-amethyst-70",value:"#806594"},80:{name:"theme-color-palette-amethyst-80",value:"#6e5282"},90:{name:"theme-color-palette-amethyst-90",value:"#5d3e70"},100:{name:"theme-color-palette-amethyst-100",value:"#4b2a5e"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#c8e9f4"},20:{name:"theme-color-palette-azure-20",value:"#addbeb"},30:{name:"theme-color-palette-azure-30",value:"#8dc9e6"},40:{name:"theme-color-palette-azure-40",value:"#69b5dd"},50:{name:"theme-color-palette-azure-50",value:"#54a1d3"},60:{name:"theme-color-palette-azure-60",value:"#368ac0"},70:{name:"theme-color-palette-azure-70",value:"#2578a9"},80:{name:"theme-color-palette-azure-80",value:"#1d5f8a"},90:{name:"theme-color-palette-azure-90",value:"#134d71"},100:{name:"theme-color-palette-azure-100",value:"#133c59"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#d5f6c0"},20:{name:"theme-color-palette-emerald-20",value:"#c3e8ac"},30:{name:"theme-color-palette-emerald-30",value:"#afdc91"},40:{name:"theme-color-palette-emerald-40",value:"#9cce7c"},50:{name:"theme-color-palette-emerald-50",value:"#89bf65"},60:{name:"theme-color-palette-emerald-60",value:"#76b051"},70:{name:"theme-color-palette-emerald-70",value:"#66a140"},80:{name:"theme-color-palette-emerald-80",value:"#56932e"},90:{name:"theme-color-palette-emerald-90",value:"#488421"},100:{name:"theme-color-palette-emerald-100",value:"#397514"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#f0f0f0"},20:{name:"theme-color-palette-graphite-20",value:"#d8d8d8"},30:{name:"theme-color-palette-graphite-30",value:"#bdbdbd"},40:{name:"theme-color-palette-graphite-40",value:"#999999"},50:{name:"theme-color-palette-graphite-50",value:"#737373"},60:{name:"theme-color-palette-graphite-60",value:"#5c5c5c"},70:{name:"theme-color-palette-graphite-70",value:"#454545"},80:{name:"theme-color-palette-graphite-80",value:"#383838"},90:{name:"theme-color-palette-graphite-90",value:"#292929"},100:{name:"theme-color-palette-graphite-100",value:"#1a1a1a"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#f6caca"},20:{name:"theme-color-palette-ruby-20",value:"#eb9d9d"},30:{name:"theme-color-palette-ruby-30",value:"#de8181"},40:{name:"theme-color-palette-ruby-40",value:"#d26d6d"},50:{name:"theme-color-palette-ruby-50",value:"#c65f5f"},60:{name:"theme-color-palette-ruby-60",value:"#b94e4a"},70:{name:"theme-color-palette-ruby-70",value:"#ad4242"},80:{name:"theme-color-palette-ruby-80",value:"#a13030"},90:{name:"theme-color-palette-ruby-90",value:"#941e1e"},100:{name:"theme-color-palette-ruby-100",value:"#880e0e"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#dee1e8"},20:{name:"theme-color-palette-slate-20",value:"#c8cbd4"},30:{name:"theme-color-palette-slate-30",value:"#abaeb7"},40:{name:"theme-color-palette-slate-40",value:"#888b94"},50:{name:"theme-color-palette-slate-50",value:"#656871"},60:{name:"theme-color-palette-slate-60",value:"#50535a"},70:{name:"theme-color-palette-slate-70",value:"#414247"},80:{name:"theme-color-palette-slate-80",value:"#313236"},90:{name:"theme-color-palette-slate-90",value:"#212224"},100:{name:"theme-color-palette-slate-100",value:"#1c1819"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#c0ede3"},20:{name:"theme-color-palette-turquoise-20",value:"#a9e1d6"},30:{name:"theme-color-palette-turquoise-30",value:"#8ed1c6"},40:{name:"theme-color-palette-turquoise-40",value:"#7cc0b5"},50:{name:"theme-color-palette-turquoise-50",value:"#69ada3"},60:{name:"theme-color-palette-turquoise-60",value:"#579e95"},70:{name:"theme-color-palette-turquoise-70",value:"#448d83"},80:{name:"theme-color-palette-turquoise-80",value:"#317c73"},90:{name:"theme-color-palette-turquoise-90",value:"#206b62"},100:{name:"theme-color-palette-turquoise-100",value:"#0e5b52"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#2578a9",paletteName:"{theme.color.brand.primary.alt.value}"},caution:{name:"theme-color-status-caution",value:"#ffd726",paletteName:"#ffd726"},danger:{name:"theme-color-status-danger",value:"#e84f4f",paletteName:"#e84f4f"},success:{name:"theme-color-status-success",value:"#80ce4d",paletteName:"#80ce4d"},warning:{name:"theme-color-status-warning",value:"#ff9426",paletteName:"#ff9426"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#69b5dd"},base:{name:"theme-color-brand-primary-base",value:"#368ac0"},alt:{name:"theme-color-brand-primary-alt",value:"#2578a9"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#d8d8d8"},base:{name:"theme-color-brand-secondary-base",value:"#bdbdbd"},alt:{name:"theme-color-brand-secondary-alt",value:"#999999"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#383838"}}}},legacyId:"light"},{id:"theme-soho-dark",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#fbe9bf"},20:{name:"theme-color-palette-amber-20",value:"#f8e09c"},30:{name:"theme-color-palette-amber-30",value:"#f7d475"},40:{name:"theme-color-palette-amber-40",value:"#f4c951"},50:{name:"theme-color-palette-amber-50",value:"#f2bc41"},60:{name:"theme-color-palette-amber-60",value:"#efa836"},70:{name:"theme-color-palette-amber-70",value:"#ee9a36"},80:{name:"theme-color-palette-amber-80",value:"#e4882b"},90:{name:"theme-color-palette-amber-90",value:"#db7726"},100:{name:"theme-color-palette-amber-100",value:"#d66221"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#ede3fc"},20:{name:"theme-color-palette-amethyst-20",value:"#daccec"},30:{name:"theme-color-palette-amethyst-30",value:"#c7b4db"},40:{name:"theme-color-palette-amethyst-40",value:"#b59eca"},50:{name:"theme-color-palette-amethyst-50",value:"#a38db7"},60:{name:"theme-color-palette-amethyst-60",value:"#9279a6"},70:{name:"theme-color-palette-amethyst-70",value:"#806594"},80:{name:"theme-color-palette-amethyst-80",value:"#6e5282"},90:{name:"theme-color-palette-amethyst-90",value:"#5d3e70"},100:{name:"theme-color-palette-amethyst-100",value:"#4b2a5e"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#c8e9f4"},20:{name:"theme-color-palette-azure-20",value:"#addbeb"},30:{name:"theme-color-palette-azure-30",value:"#8dc9e6"},40:{name:"theme-color-palette-azure-40",value:"#69b5dd"},50:{name:"theme-color-palette-azure-50",value:"#54a1d3"},60:{name:"theme-color-palette-azure-60",value:"#368ac0"},70:{name:"theme-color-palette-azure-70",value:"#2578a9"},80:{name:"theme-color-palette-azure-80",value:"#1d5f8a"},90:{name:"theme-color-palette-azure-90",value:"#134d71"},100:{name:"theme-color-palette-azure-100",value:"#133c59"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#d5f6c0"},20:{name:"theme-color-palette-emerald-20",value:"#c3e8ac"},30:{name:"theme-color-palette-emerald-30",value:"#afdc91"},40:{name:"theme-color-palette-emerald-40",value:"#9cce7c"},50:{name:"theme-color-palette-emerald-50",value:"#89bf65"},60:{name:"theme-color-palette-emerald-60",value:"#76b051"},70:{name:"theme-color-palette-emerald-70",value:"#66a140"},80:{name:"theme-color-palette-emerald-80",value:"#56932e"},90:{name:"theme-color-palette-emerald-90",value:"#488421"},100:{name:"theme-color-palette-emerald-100",value:"#397514"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#f0f0f0"},20:{name:"theme-color-palette-graphite-20",value:"#d8d8d8"},30:{name:"theme-color-palette-graphite-30",value:"#bdbdbd"},40:{name:"theme-color-palette-graphite-40",value:"#999999"},50:{name:"theme-color-palette-graphite-50",value:"#737373"},60:{name:"theme-color-palette-graphite-60",value:"#5c5c5c"},70:{name:"theme-color-palette-graphite-70",value:"#454545"},80:{name:"theme-color-palette-graphite-80",value:"#383838"},90:{name:"theme-color-palette-graphite-90",value:"#292929"},100:{name:"theme-color-palette-graphite-100",value:"#1a1a1a"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#f6caca"},20:{name:"theme-color-palette-ruby-20",value:"#eb9d9d"},30:{name:"theme-color-palette-ruby-30",value:"#de8181"},40:{name:"theme-color-palette-ruby-40",value:"#d26d6d"},50:{name:"theme-color-palette-ruby-50",value:"#c65f5f"},60:{name:"theme-color-palette-ruby-60",value:"#b94e4a"},70:{name:"theme-color-palette-ruby-70",value:"#ad4242"},80:{name:"theme-color-palette-ruby-80",value:"#a13030"},90:{name:"theme-color-palette-ruby-90",value:"#941e1e"},100:{name:"theme-color-palette-ruby-100",value:"#880e0e"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#dee1e8"},20:{name:"theme-color-palette-slate-20",value:"#c8cbd4"},30:{name:"theme-color-palette-slate-30",value:"#abaeb7"},40:{name:"theme-color-palette-slate-40",value:"#888b94"},50:{name:"theme-color-palette-slate-50",value:"#656871"},60:{name:"theme-color-palette-slate-60",value:"#50535a"},70:{name:"theme-color-palette-slate-70",value:"#414247"},80:{name:"theme-color-palette-slate-80",value:"#313236"},90:{name:"theme-color-palette-slate-90",value:"#212224"},100:{name:"theme-color-palette-slate-100",value:"#1c1819"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#c0ede3"},20:{name:"theme-color-palette-turquoise-20",value:"#a9e1d6"},30:{name:"theme-color-palette-turquoise-30",value:"#8ed1c6"},40:{name:"theme-color-palette-turquoise-40",value:"#7cc0b5"},50:{name:"theme-color-palette-turquoise-50",value:"#69ada3"},60:{name:"theme-color-palette-turquoise-60",value:"#579e95"},70:{name:"theme-color-palette-turquoise-70",value:"#448d83"},80:{name:"theme-color-palette-turquoise-80",value:"#317c73"},90:{name:"theme-color-palette-turquoise-90",value:"#206b62"},100:{name:"theme-color-palette-turquoise-100",value:"#0e5b52"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#2578a9",paletteName:"{theme.color.brand.primary.alt.value}"},caution:{name:"theme-color-status-caution",value:"#ffd726",paletteName:"#ffd726"},danger:{name:"theme-color-status-danger",value:"#e84f4f",paletteName:"#e84f4f"},success:{name:"theme-color-status-success",value:"#80ce4d",paletteName:"#80ce4d"},warning:{name:"theme-color-status-warning",value:"#ff9426",paletteName:"#ff9426"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#69b5dd"},base:{name:"theme-color-brand-primary-base",value:"#368ac0"},alt:{name:"theme-color-brand-primary-alt",value:"#2578a9"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#d8d8d8"},base:{name:"theme-color-brand-secondary-base",value:"#bdbdbd"},alt:{name:"theme-color-brand-secondary-alt",value:"#999999"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#383838"}}}},legacyId:"dark"},{id:"theme-soho-contrast",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#fbe9bf"},20:{name:"theme-color-palette-amber-20",value:"#f8e09c"},30:{name:"theme-color-palette-amber-30",value:"#f7d475"},40:{name:"theme-color-palette-amber-40",value:"#f4c951"},50:{name:"theme-color-palette-amber-50",value:"#f2bc41"},60:{name:"theme-color-palette-amber-60",value:"#efa836"},70:{name:"theme-color-palette-amber-70",value:"#ee9a36"},80:{name:"theme-color-palette-amber-80",value:"#e4882b"},90:{name:"theme-color-palette-amber-90",value:"#db7726"},100:{name:"theme-color-palette-amber-100",value:"#d66221"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#ede3fc"},20:{name:"theme-color-palette-amethyst-20",value:"#daccec"},30:{name:"theme-color-palette-amethyst-30",value:"#c7b4db"},40:{name:"theme-color-palette-amethyst-40",value:"#b59eca"},50:{name:"theme-color-palette-amethyst-50",value:"#a38db7"},60:{name:"theme-color-palette-amethyst-60",value:"#9279a6"},70:{name:"theme-color-palette-amethyst-70",value:"#806594"},80:{name:"theme-color-palette-amethyst-80",value:"#6e5282"},90:{name:"theme-color-palette-amethyst-90",value:"#5d3e70"},100:{name:"theme-color-palette-amethyst-100",value:"#4b2a5e"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#c8e9f4"},20:{name:"theme-color-palette-azure-20",value:"#addbeb"},30:{name:"theme-color-palette-azure-30",value:"#8dc9e6"},40:{name:"theme-color-palette-azure-40",value:"#69b5dd"},50:{name:"theme-color-palette-azure-50",value:"#54a1d3"},60:{name:"theme-color-palette-azure-60",value:"#368ac0"},70:{name:"theme-color-palette-azure-70",value:"#2578a9"},80:{name:"theme-color-palette-azure-80",value:"#1d5f8a"},90:{name:"theme-color-palette-azure-90",value:"#134d71"},100:{name:"theme-color-palette-azure-100",value:"#133c59"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#d5f6c0"},20:{name:"theme-color-palette-emerald-20",value:"#c3e8ac"},30:{name:"theme-color-palette-emerald-30",value:"#afdc91"},40:{name:"theme-color-palette-emerald-40",value:"#9cce7c"},50:{name:"theme-color-palette-emerald-50",value:"#89bf65"},60:{name:"theme-color-palette-emerald-60",value:"#76b051"},70:{name:"theme-color-palette-emerald-70",value:"#66a140"},80:{name:"theme-color-palette-emerald-80",value:"#56932e"},90:{name:"theme-color-palette-emerald-90",value:"#488421"},100:{name:"theme-color-palette-emerald-100",value:"#397514"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#f0f0f0"},20:{name:"theme-color-palette-graphite-20",value:"#d8d8d8"},30:{name:"theme-color-palette-graphite-30",value:"#bdbdbd"},40:{name:"theme-color-palette-graphite-40",value:"#999999"},50:{name:"theme-color-palette-graphite-50",value:"#737373"},60:{name:"theme-color-palette-graphite-60",value:"#5c5c5c"},70:{name:"theme-color-palette-graphite-70",value:"#454545"},80:{name:"theme-color-palette-graphite-80",value:"#383838"},90:{name:"theme-color-palette-graphite-90",value:"#292929"},100:{name:"theme-color-palette-graphite-100",value:"#1a1a1a"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#f6caca"},20:{name:"theme-color-palette-ruby-20",value:"#eb9d9d"},30:{name:"theme-color-palette-ruby-30",value:"#de8181"},40:{name:"theme-color-palette-ruby-40",value:"#d26d6d"},50:{name:"theme-color-palette-ruby-50",value:"#c65f5f"},60:{name:"theme-color-palette-ruby-60",value:"#b94e4a"},70:{name:"theme-color-palette-ruby-70",value:"#ad4242"},80:{name:"theme-color-palette-ruby-80",value:"#a13030"},90:{name:"theme-color-palette-ruby-90",value:"#941e1e"},100:{name:"theme-color-palette-ruby-100",value:"#880e0e"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#dee1e8"},20:{name:"theme-color-palette-slate-20",value:"#c8cbd4"},30:{name:"theme-color-palette-slate-30",value:"#abaeb7"},40:{name:"theme-color-palette-slate-40",value:"#888b94"},50:{name:"theme-color-palette-slate-50",value:"#656871"},60:{name:"theme-color-palette-slate-60",value:"#50535a"},70:{name:"theme-color-palette-slate-70",value:"#414247"},80:{name:"theme-color-palette-slate-80",value:"#313236"},90:{name:"theme-color-palette-slate-90",value:"#212224"},100:{name:"theme-color-palette-slate-100",value:"#1c1819"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#c0ede3"},20:{name:"theme-color-palette-turquoise-20",value:"#a9e1d6"},30:{name:"theme-color-palette-turquoise-30",value:"#8ed1c6"},40:{name:"theme-color-palette-turquoise-40",value:"#7cc0b5"},50:{name:"theme-color-palette-turquoise-50",value:"#69ada3"},60:{name:"theme-color-palette-turquoise-60",value:"#579e95"},70:{name:"theme-color-palette-turquoise-70",value:"#448d83"},80:{name:"theme-color-palette-turquoise-80",value:"#317c73"},90:{name:"theme-color-palette-turquoise-90",value:"#206b62"},100:{name:"theme-color-palette-turquoise-100",value:"#0e5b52"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#133c59",paletteName:"{theme.color.brand.primary.alt.value}"},caution:{name:"theme-color-status-caution",value:"#504100",paletteName:"#504100"},danger:{name:"theme-color-status-danger",value:"#861111",paletteName:"#861111"},success:{name:"theme-color-status-success",value:"#134D13",paletteName:"#134D13"},warning:{name:"theme-color-status-warning",value:"#683500",paletteName:"#683500"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#69b5dd"},base:{name:"theme-color-brand-primary-base",value:"#134d71"},alt:{name:"theme-color-brand-primary-alt",value:"#133c59"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#d8d8d8"},base:{name:"theme-color-brand-secondary-base",value:"#bdbdbd"},alt:{name:"theme-color-brand-secondary-alt",value:"#999999"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#383838"}}}},legacyId:"high-contrast"},{id:"theme-uplift-light",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#FDF0DD"},20:{name:"theme-color-palette-amber-20",value:"#FCE6C5"},30:{name:"theme-color-palette-amber-30",value:"#FFD48F"},40:{name:"theme-color-palette-amber-40",value:"#FFC05E"},50:{name:"theme-color-palette-amber-50",value:"#FEA43E"},60:{name:"theme-color-palette-amber-60",value:"#F78300"},70:{name:"theme-color-palette-amber-70",value:"#E07800"},80:{name:"theme-color-palette-amber-80",value:"#C45800"},90:{name:"theme-color-palette-amber-90",value:"#9B3300"},100:{name:"theme-color-palette-amber-100",value:"#802B00"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#F0E8FC"},20:{name:"theme-color-palette-amethyst-20",value:"#E1D1FA"},30:{name:"theme-color-palette-amethyst-30",value:"#C1B3FF"},40:{name:"theme-color-palette-amethyst-40",value:"#977FFF"},50:{name:"theme-color-palette-amethyst-50",value:"#9668F3"},60:{name:"theme-color-palette-amethyst-60",value:"#7834DD"},70:{name:"theme-color-palette-amethyst-70",value:"#7025B6"},80:{name:"theme-color-palette-amethyst-80",value:"#60209D"},90:{name:"theme-color-palette-amethyst-90",value:"#41166A"},100:{name:"theme-color-palette-amethyst-100",value:"#39135D"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#E1F3FE"},20:{name:"theme-color-palette-azure-20",value:"#C9E9FD"},30:{name:"theme-color-palette-azure-30",value:"#7BD3FE"},40:{name:"theme-color-palette-azure-40",value:"#4AC1FE"},50:{name:"theme-color-palette-azure-50",value:"#3399FF"},60:{name:"theme-color-palette-azure-60",value:"#0075E9"},70:{name:"theme-color-palette-azure-70",value:"#0563C2"},80:{name:"theme-color-palette-azure-80",value:"#0053B1"},90:{name:"theme-color-palette-azure-90",value:"#003C80"},100:{name:"theme-color-palette-azure-100",value:"#003066"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#E3F7EC"},20:{name:"theme-color-palette-emerald-20",value:"#CFF2DF"},30:{name:"theme-color-palette-emerald-30",value:"#B0F8C2"},40:{name:"theme-color-palette-emerald-40",value:"#7FF39C"},50:{name:"theme-color-palette-emerald-50",value:"#67D599"},60:{name:"theme-color-palette-emerald-60",value:"#35C274"},70:{name:"theme-color-palette-emerald-70",value:"#2A985D"},80:{name:"theme-color-palette-emerald-80",value:"#0A834B"},90:{name:"theme-color-palette-emerald-90",value:"#065531"},100:{name:"theme-color-palette-emerald-100",value:"#053E23"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#F7F7F7"},20:{name:"theme-color-palette-graphite-20",value:"#EBEBEB"},30:{name:"theme-color-palette-graphite-30",value:"#D1D1D1"},40:{name:"theme-color-palette-graphite-40",value:"#BFBFBF"},50:{name:"theme-color-palette-graphite-50",value:"#999999"},60:{name:"theme-color-palette-graphite-60",value:"#808080"},70:{name:"theme-color-palette-graphite-70",value:"#666666"},80:{name:"theme-color-palette-graphite-80",value:"#545454"},90:{name:"theme-color-palette-graphite-90",value:"#333333"},100:{name:"theme-color-palette-graphite-100",value:"#262626"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#FCE8E8"},20:{name:"theme-color-palette-ruby-20",value:"#FAD1D1"},30:{name:"theme-color-palette-ruby-30",value:"#FFB3B8"},40:{name:"theme-color-palette-ruby-40",value:"#FF7F88"},50:{name:"theme-color-palette-ruby-50",value:"#ED4548"},60:{name:"theme-color-palette-ruby-60",value:"#DA1217"},70:{name:"theme-color-palette-ruby-70",value:"#CA0728"},80:{name:"theme-color-palette-ruby-80",value:"#AC1518"},90:{name:"theme-color-palette-ruby-90",value:"#7B0F11"},100:{name:"theme-color-palette-ruby-100",value:"#640C0E"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#F7F7F8"},20:{name:"theme-color-palette-slate-20",value:"#E9E9EC"},30:{name:"theme-color-palette-slate-30",value:"#E3E1E5"},40:{name:"theme-color-palette-slate-40",value:"#D8D6DB"},50:{name:"theme-color-palette-slate-50",value:"#BEBBC3"},60:{name:"theme-color-palette-slate-60",value:"#98949E"},70:{name:"theme-color-palette-slate-70",value:"#7A7481"},80:{name:"theme-color-palette-slate-80",value:"#6D6873"},90:{name:"theme-color-palette-slate-90",value:"#323036"},100:{name:"theme-color-palette-slate-100",value:"#252429"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#E6FAF7"},20:{name:"theme-color-palette-turquoise-20",value:"#D1F5F2"},30:{name:"theme-color-palette-turquoise-30",value:"#A8F0E4"},40:{name:"theme-color-palette-turquoise-40",value:"#79E7D5"},50:{name:"theme-color-palette-turquoise-50",value:"#78DDDD"},60:{name:"theme-color-palette-turquoise-60",value:"#50D3D3"},70:{name:"theme-color-palette-turquoise-70",value:"#31C4C4"},80:{name:"theme-color-palette-turquoise-80",value:"#2EB3B8"},90:{name:"theme-color-palette-turquoise-90",value:"#248B8F"},100:{name:"theme-color-palette-turquoise-100",value:"#1F777A"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#0563C2",paletteName:"{theme.color.brand.primary.alt.value}"},caution:{name:"theme-color-status-caution",value:"#FFD100",paletteName:"#FFD100"},danger:{name:"theme-color-status-danger",value:"#DA1217",paletteName:"#DA1217"},success:{name:"theme-color-status-success",value:"#35C274",paletteName:"#35C274"},warning:{name:"theme-color-status-warning",value:"#F78300",paletteName:"#F78300"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#4AC1FE"},base:{name:"theme-color-brand-primary-base",value:"#0075E9"},alt:{name:"theme-color-brand-primary-alt",value:"#0563C2"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#D8D6DB"},base:{name:"theme-color-brand-secondary-base",value:"#98949E"},alt:{name:"theme-color-brand-secondary-alt",value:"#7A7481"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#323036"}}}}},{id:"theme-uplift-dark",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#FDF0DD"},20:{name:"theme-color-palette-amber-20",value:"#FCE6C5"},30:{name:"theme-color-palette-amber-30",value:"#FFD48F"},40:{name:"theme-color-palette-amber-40",value:"#FFC05E"},50:{name:"theme-color-palette-amber-50",value:"#FEA43E"},60:{name:"theme-color-palette-amber-60",value:"#F78300"},70:{name:"theme-color-palette-amber-70",value:"#E07800"},80:{name:"theme-color-palette-amber-80",value:"#C45800"},90:{name:"theme-color-palette-amber-90",value:"#9B3300"},100:{name:"theme-color-palette-amber-100",value:"#802B00"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#F0E8FC"},20:{name:"theme-color-palette-amethyst-20",value:"#E1D1FA"},30:{name:"theme-color-palette-amethyst-30",value:"#C1B3FF"},40:{name:"theme-color-palette-amethyst-40",value:"#977FFF"},50:{name:"theme-color-palette-amethyst-50",value:"#9668F3"},60:{name:"theme-color-palette-amethyst-60",value:"#7834DD"},70:{name:"theme-color-palette-amethyst-70",value:"#7025B6"},80:{name:"theme-color-palette-amethyst-80",value:"#60209D"},90:{name:"theme-color-palette-amethyst-90",value:"#41166A"},100:{name:"theme-color-palette-amethyst-100",value:"#39135D"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#E1F3FE"},20:{name:"theme-color-palette-azure-20",value:"#C9E9FD"},30:{name:"theme-color-palette-azure-30",value:"#7BD3FE"},40:{name:"theme-color-palette-azure-40",value:"#4AC1FE"},50:{name:"theme-color-palette-azure-50",value:"#3399FF"},60:{name:"theme-color-palette-azure-60",value:"#0075E9"},70:{name:"theme-color-palette-azure-70",value:"#0563C2"},80:{name:"theme-color-palette-azure-80",value:"#0053B1"},90:{name:"theme-color-palette-azure-90",value:"#003C80"},100:{name:"theme-color-palette-azure-100",value:"#003066"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#E3F7EC"},20:{name:"theme-color-palette-emerald-20",value:"#CFF2DF"},30:{name:"theme-color-palette-emerald-30",value:"#B0F8C2"},40:{name:"theme-color-palette-emerald-40",value:"#7FF39C"},50:{name:"theme-color-palette-emerald-50",value:"#67D599"},60:{name:"theme-color-palette-emerald-60",value:"#35C274"},70:{name:"theme-color-palette-emerald-70",value:"#2A985D"},80:{name:"theme-color-palette-emerald-80",value:"#0A834B"},90:{name:"theme-color-palette-emerald-90",value:"#065531"},100:{name:"theme-color-palette-emerald-100",value:"#053E23"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#F7F7F7"},20:{name:"theme-color-palette-graphite-20",value:"#EBEBEB"},30:{name:"theme-color-palette-graphite-30",value:"#D1D1D1"},40:{name:"theme-color-palette-graphite-40",value:"#BFBFBF"},50:{name:"theme-color-palette-graphite-50",value:"#999999"},60:{name:"theme-color-palette-graphite-60",value:"#808080"},70:{name:"theme-color-palette-graphite-70",value:"#666666"},80:{name:"theme-color-palette-graphite-80",value:"#545454"},90:{name:"theme-color-palette-graphite-90",value:"#333333"},100:{name:"theme-color-palette-graphite-100",value:"#262626"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#FCE8E8"},20:{name:"theme-color-palette-ruby-20",value:"#FAD1D1"},30:{name:"theme-color-palette-ruby-30",value:"#FFB3B8"},40:{name:"theme-color-palette-ruby-40",value:"#FF7F88"},50:{name:"theme-color-palette-ruby-50",value:"#ED4548"},60:{name:"theme-color-palette-ruby-60",value:"#DA1217"},70:{name:"theme-color-palette-ruby-70",value:"#CA0728"},80:{name:"theme-color-palette-ruby-80",value:"#AC1518"},90:{name:"theme-color-palette-ruby-90",value:"#7B0F11"},100:{name:"theme-color-palette-ruby-100",value:"#640C0E"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#F7F7F8"},20:{name:"theme-color-palette-slate-20",value:"#E9E9EC"},30:{name:"theme-color-palette-slate-30",value:"#E3E1E5"},40:{name:"theme-color-palette-slate-40",value:"#D8D6DB"},50:{name:"theme-color-palette-slate-50",value:"#BEBBC3"},60:{name:"theme-color-palette-slate-60",value:"#98949E"},70:{name:"theme-color-palette-slate-70",value:"#7A7481"},80:{name:"theme-color-palette-slate-80",value:"#6D6873"},90:{name:"theme-color-palette-slate-90",value:"#323036"},100:{name:"theme-color-palette-slate-100",value:"#252429"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#E6FAF7"},20:{name:"theme-color-palette-turquoise-20",value:"#D1F5F2"},30:{name:"theme-color-palette-turquoise-30",value:"#A8F0E4"},40:{name:"theme-color-palette-turquoise-40",value:"#79E7D5"},50:{name:"theme-color-palette-turquoise-50",value:"#78DDDD"},60:{name:"theme-color-palette-turquoise-60",value:"#50D3D3"},70:{name:"theme-color-palette-turquoise-70",value:"#31C4C4"},80:{name:"theme-color-palette-turquoise-80",value:"#2EB3B8"},90:{name:"theme-color-palette-turquoise-90",value:"#248B8F"},100:{name:"theme-color-palette-turquoise-100",value:"#1F777A"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#0075E9",paletteName:"{theme.color.brand.primary.base.value}"},caution:{name:"theme-color-status-caution",value:"#FFD100",paletteName:"#FFD100"},danger:{name:"theme-color-status-danger",value:"#DA1217",paletteName:"#DA1217"},success:{name:"theme-color-status-success",value:"#35C274",paletteName:"#35C274"},warning:{name:"theme-color-status-warning",value:"#F78300",paletteName:"#F78300"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#4AC1FE"},base:{name:"theme-color-brand-primary-base",value:"#0075E9"},alt:{name:"theme-color-brand-primary-alt",value:"#0053B1"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#D8D6DB"},base:{name:"theme-color-brand-secondary-base",value:"#BEBBC3"},alt:{name:"theme-color-brand-secondary-alt",value:"#7A7481"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#323036"}}}}},{id:"theme-uplift-contrast",colors:{palette:{amber:{10:{name:"theme-color-palette-amber-10",value:"#FDF0DD"},20:{name:"theme-color-palette-amber-20",value:"#FCE6C5"},30:{name:"theme-color-palette-amber-30",value:"#FFD48F"},40:{name:"theme-color-palette-amber-40",value:"#FFC05E"},50:{name:"theme-color-palette-amber-50",value:"#FEA43E"},60:{name:"theme-color-palette-amber-60",value:"#F78300"},70:{name:"theme-color-palette-amber-70",value:"#E07800"},80:{name:"theme-color-palette-amber-80",value:"#C45800"},90:{name:"theme-color-palette-amber-90",value:"#9B3300"},100:{name:"theme-color-palette-amber-100",value:"#802B00"}},amethyst:{10:{name:"theme-color-palette-amethyst-10",value:"#F0E8FC"},20:{name:"theme-color-palette-amethyst-20",value:"#E1D1FA"},30:{name:"theme-color-palette-amethyst-30",value:"#C1B3FF"},40:{name:"theme-color-palette-amethyst-40",value:"#977FFF"},50:{name:"theme-color-palette-amethyst-50",value:"#9668F3"},60:{name:"theme-color-palette-amethyst-60",value:"#7834DD"},70:{name:"theme-color-palette-amethyst-70",value:"#7025B6"},80:{name:"theme-color-palette-amethyst-80",value:"#60209D"},90:{name:"theme-color-palette-amethyst-90",value:"#41166A"},100:{name:"theme-color-palette-amethyst-100",value:"#39135D"}},azure:{10:{name:"theme-color-palette-azure-10",value:"#E1F3FE"},20:{name:"theme-color-palette-azure-20",value:"#C9E9FD"},30:{name:"theme-color-palette-azure-30",value:"#7BD3FE"},40:{name:"theme-color-palette-azure-40",value:"#4AC1FE"},50:{name:"theme-color-palette-azure-50",value:"#3399FF"},60:{name:"theme-color-palette-azure-60",value:"#0075E9"},70:{name:"theme-color-palette-azure-70",value:"#0563C2"},80:{name:"theme-color-palette-azure-80",value:"#0053B1"},90:{name:"theme-color-palette-azure-90",value:"#003C80"},100:{name:"theme-color-palette-azure-100",value:"#003066"}},emerald:{10:{name:"theme-color-palette-emerald-10",value:"#E3F7EC"},20:{name:"theme-color-palette-emerald-20",value:"#CFF2DF"},30:{name:"theme-color-palette-emerald-30",value:"#B0F8C2"},40:{name:"theme-color-palette-emerald-40",value:"#7FF39C"},50:{name:"theme-color-palette-emerald-50",value:"#67D599"},60:{name:"theme-color-palette-emerald-60",value:"#35C274"},70:{name:"theme-color-palette-emerald-70",value:"#2A985D"},80:{name:"theme-color-palette-emerald-80",value:"#0A834B"},90:{name:"theme-color-palette-emerald-90",value:"#065531"},100:{name:"theme-color-palette-emerald-100",value:"#053E23"}},graphite:{10:{name:"theme-color-palette-graphite-10",value:"#F7F7F7"},20:{name:"theme-color-palette-graphite-20",value:"#EBEBEB"},30:{name:"theme-color-palette-graphite-30",value:"#D1D1D1"},40:{name:"theme-color-palette-graphite-40",value:"#BFBFBF"},50:{name:"theme-color-palette-graphite-50",value:"#999999"},60:{name:"theme-color-palette-graphite-60",value:"#808080"},70:{name:"theme-color-palette-graphite-70",value:"#666666"},80:{name:"theme-color-palette-graphite-80",value:"#545454"},90:{name:"theme-color-palette-graphite-90",value:"#333333"},100:{name:"theme-color-palette-graphite-100",value:"#262626"}},ruby:{10:{name:"theme-color-palette-ruby-10",value:"#FCE8E8"},20:{name:"theme-color-palette-ruby-20",value:"#FAD1D1"},30:{name:"theme-color-palette-ruby-30",value:"#FFB3B8"},40:{name:"theme-color-palette-ruby-40",value:"#FF7F88"},50:{name:"theme-color-palette-ruby-50",value:"#ED4548"},60:{name:"theme-color-palette-ruby-60",value:"#DA1217"},70:{name:"theme-color-palette-ruby-70",value:"#CA0728"},80:{name:"theme-color-palette-ruby-80",value:"#AC1518"},90:{name:"theme-color-palette-ruby-90",value:"#7B0F11"},100:{name:"theme-color-palette-ruby-100",value:"#640C0E"}},slate:{10:{name:"theme-color-palette-slate-10",value:"#F7F7F8"},20:{name:"theme-color-palette-slate-20",value:"#E9E9EC"},30:{name:"theme-color-palette-slate-30",value:"#E3E1E5"},40:{name:"theme-color-palette-slate-40",value:"#D8D6DB"},50:{name:"theme-color-palette-slate-50",value:"#BEBBC3"},60:{name:"theme-color-palette-slate-60",value:"#98949E"},70:{name:"theme-color-palette-slate-70",value:"#7A7481"},80:{name:"theme-color-palette-slate-80",value:"#6D6873"},90:{name:"theme-color-palette-slate-90",value:"#323036"},100:{name:"theme-color-palette-slate-100",value:"#252429"}},turquoise:{10:{name:"theme-color-palette-turquoise-10",value:"#E6FAF7"},20:{name:"theme-color-palette-turquoise-20",value:"#D1F5F2"},30:{name:"theme-color-palette-turquoise-30",value:"#A8F0E4"},40:{name:"theme-color-palette-turquoise-40",value:"#79E7D5"},50:{name:"theme-color-palette-turquoise-50",value:"#78DDDD"},60:{name:"theme-color-palette-turquoise-60",value:"#50D3D3"},70:{name:"theme-color-palette-turquoise-70",value:"#31C4C4"},80:{name:"theme-color-palette-turquoise-80",value:"#2EB3B8"},90:{name:"theme-color-palette-turquoise-90",value:"#248B8F"},100:{name:"theme-color-palette-turquoise-100",value:"#1F777A"}},white:{name:"theme-color-palette-white",value:"#ffffff",paletteName:"#ffffff"},black:{name:"theme-color-palette-black",value:"#000000",paletteName:"#000000"}},status:{base:{name:"theme-color-status-base",value:"#003C80",paletteName:"{theme.color.brand.primary.base.value}"},caution:{name:"theme-color-status-caution",value:"#5D4C00",paletteName:"#5D4C00"},danger:{name:"theme-color-status-danger",value:"#7B0F11",paletteName:"#7B0F11"},success:{name:"theme-color-status-success",value:"#065531",paletteName:"#065531"},warning:{name:"theme-color-status-warning",value:"#802B00",paletteName:"#802B00"}},brand:{primary:{lighter:{name:"theme-color-brand-primary-lighter",value:"#4AC1FE"},base:{name:"theme-color-brand-primary-base",value:"#003C80"},alt:{name:"theme-color-brand-primary-alt",value:"#003066"},contrast:{name:"theme-color-brand-primary-contrast",value:"#ffffff"}},secondary:{lighter:{name:"theme-color-brand-secondary-lighter",value:"#6D6873"},base:{name:"theme-color-brand-secondary-base",value:"#323036"},alt:{name:"theme-color-brand-secondary-alt",value:"#252429"},contrast:{name:"theme-color-brand-secondary-contrast",value:"#323036"}}}}}],themes:function(){return[{id:"theme-soho-light",name:k.translate("SohoLightTheme"),legacyId:"light"},{id:"theme-soho-dark",name:k.translate("SohoDarkTheme"),legacyId:"dark"},{id:"theme-soho-contrast",name:k.translate("SohoHighContrastTheme"),legacyId:"high-contrast"},{id:"theme-uplift-light",name:k.translate("UpliftLightTheme")},{id:"theme-uplift-dark",name:k.translate("UpliftDarkTheme")},{id:"theme-uplift-contrast",name:k.translate("UpliftHighContrastTheme")}]},themeColors:function(){var e=this,t=this.allColors.filter(function(t){return t.id===e.currentTheme.id});return t[0]?t[0].colors:{palette:{},colors:{},brand:{}}},personalizationColors:function(){var e=this.themeColors().palette,t=this.themeColors().brand,i={},s={showBrackets:!1};return i.default={id:"default",name:k.translate("Default",s),backgroundColorClass:"primary-bg-color",value:t.primary.base.value},i.amber={id:"amber",name:k.translate("Amber",s),backgroundColorClass:"amber09",value:e.amber[90].value},i.amethyst={id:"amethyst",name:k.translate("Amethyst",s),backgroundColorClass:"amethyst06",value:e.amethyst[60].value},i.azure={id:"azure",name:k.translate("Azure",s),backgroundColorClass:"azure07",value:e.azure[70].value},i.emerald={id:"emerald",name:k.translate("Emerald",s),backgroundColorClass:"emerald08",value:e.emerald[80].value},i.graphite={id:"graphite",name:k.translate("Graphite",s),backgroundColorClass:"graphite06",value:e.graphite[60].value},i.ruby={id:"ruby",name:k.translate("Ruby",s),backgroundColorClass:"ruby09",value:e.ruby[90].value},i.slate={id:"slate",name:k.translate("Slate",s),backgroundColorClass:"slate06",value:e.slate[60].value},i.turquoise={id:"turquoise",name:k.translate("Turquoise",s),backgroundColorClass:"turquoise09",value:e.turquoise[90].value},i},setTheme:function(e){var t=this.themes().filter(function(t){return t.id===e||t.legacyId&&t.legacyId===e});return 0===t.length?"":(this.currentTheme=t[0],t)},get uplift(){return this.currentTheme.id.indexOf("-uplift-")>-1}};var q={colors:"",theme:"",font:"",blockUI:!0,noInit:!1};function V(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,q),this.init()}V.prototype={init:function(){return this.handleEvents(),this.settings.noInit?this:(this.settings.theme?this.setTheme(this.settings.theme):this.setTheme(this.getThemeFromStylesheet()),this.settings.colors&&this.setColors(this.settings.colors),this.settings.font&&this.setFont(this.settings.font),this)},handleEvents:function(){var e=this;return this.element.off("updated.personalize").on("updated.personalize",function(){e.updated()}),this},appendStyleSheet:function(e){var t=document.getElementById("soho-personalization");t&&t.parentNode.removeChild(t),(t=document.createElement("style")).setAttribute("id","soho-personalization"),t.appendChild(document.createTextNode(e)),document.head.appendChild(t)},getColorStyleSheet:function(e){if(e||(e={}),"string"==typeof e&&(e={header:e}),!e||""===e)return this;var t={header:"2578A9"},i={amber:["#db7726","#9b3300"],amethyst:["#9279a6","#7834dd"],azure:["#2578a9","#0563c2"],emerald:["#56932e","#0a834b"],graphite:["#5c5c5c","#808080"],ruby:["#941e1e","#7b0f11"],slate:["#50535a","#98949e"],turquoise:["#206b62","#248b8f"]},s=!1,n=(""+(e.header||t.header)).toLowerCase();n=z.validateHex(n),Object.keys(i).forEach(function(e){s=s||i[e].indexOf(n)>-1}),n=s?"white":null;var a=z.validateHex(e.lightest||z.getLuminousColorShade(e.header||t.header,.3));"white"===z.getContrastColor(a,null,n)?(t.text="ffffff",t.subtext="f0f0f0"):(t.text="000000",t.subtext="292929"),e.header=z.validateHex(e.header||t.header),e.text=z.validateHex(e.text||t.text),e.subtext=z.validateHex(e.subtext||t.subtext),e.btnColorHeader=z.validateHex(e.btnColorHeader||z.getLuminousColorShade(e.header,.3)),e.subheader=z.validateHex(e.subheader||z.getLuminousColorShade(e.header,.2)),e.verticalBorder=z.validateHex(e.verticalBorder||z.getLuminousColorShade(e.header,.1)),e.btnColorSubheader=z.validateHex(e.btnColorSubheader||z.getLuminousColorShade(e.header,-.1)),e.inactive=z.validateHex(e.inactive||z.getLuminousColorShade(e.header,-.2)),e.horizontalBorder=z.validateHex(e.horizontalBorder||z.getLuminousColorShade(e.header,-.3)),e.hover=z.validateHex(e.hover||z.getLuminousColorShade(e.header,-.5)),e.button=z.validateHex(e.button||z.getLuminousColorShade(e.text,-.8)),e.lightest=e.btnColorHeader,e.lighter=e.subheader,e.light=e.verticalBorder,e.base=e.header,e.contrast=e.text,e.dark=e.btnColorSubheader,e.darker=e.inactive,e.darkest=e.horizontalBorder;var r=z.getContrastColor(e.darkest);return t.tooltipText="white"===r?"ffffff":"000000",e.tooltipText=z.validateHex(e.tooltipText||t.tooltipText),function(e){return"\n\n.tab-container.module-tabs.is-personalizable {\n  border-top: 1px solid "+e.darkest+" !important;\n  border-bottom: 1px solid "+e.darkest+" !important;\n}\n\n.module-tabs.is-personalizable .tab:not(:first-child) {\n  border-left: 1px solid "+e.darkest+" !important;\n}\n\n.module-tabs.is-personalizable {\n  background-color: "+e.darker+" !important;\n}\n\n.module-tabs.is-personalizable .tab.is-selected {\n  background-color: "+e.base+" !important;\n}\n\n.accordion.panel .accordion-header.is-selected {\n  background-color: "+e.lighter+" !important;\n  color: "+e.contrast+" !important;\n}\n\n.builder-header.is-personalizable{\n  background-color: "+e.lighter+";\n}\n\n.header.is-personalizable {\n  background-color: "+e.base+";\n}\n\n.header.is-personalizable .title {\n  color: "+e.contrast+";\n}\n\n.header.is-personalizable h1 {\n  color: "+e.contrast+";\n}\n\n.header.is-personalizable button:not(:disabled),\n.header.is-personalizable button:not(:disabled) .icon,\n.header.is-personalizable button:not(:disabled) .app-header.icon > span {\n  color: "+e.contrast+" !important;\n  opacity: .8;\n}\n\n.header.is-personalizable .header.is-personalizable button:not(:disabled) .app-header.icon > span {\n  background-color: "+e.contrast+" !important;\n  opacity: .8;\n}\n\n.header.is-personalizable button:not(:disabled):hover,\n.header.is-personalizable button:not(:disabled):hover .icon,\n.header.is-personalizable button:not(:disabled):hover .app-header.icon > span,\n.header.is-personalizable .toolbar [class^='btn']:hover:not([disabled]) {\n  color: "+e.contrast+" !important;\n  opacity: 1;\n}\n\n.header.is-personalizable button:not(:disabled) .app-header.icon > span {\n  background-color: "+e.contrast+" !important;\n  opacity: 1;\n}\n\n.header.is-personalizable .go-button.is-personalizable {\n  background-color: "+e.lightest+";\n  border-color:"+e.lightest+";\n  color: "+e.contrast+";\n}\n\n.header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab.is-selected:not(.is-disabled) {\n  color: "+e.contrast+" !important;\n}\n\n.header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab,\n.is-personalizable.tab-container.header-tabs > .tab-list-container .tab  {\n  color: "+e.contrast+" !important;\n  opacity: .8;\n}\n\n.header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab:hover:not(.is-disabled),\n.is-personalizable.tab-container.header-tabs > .tab-list-container .tab:hover:not(.is-disabled)  {\n  color: "+e.contrast+" !important;\n  opacity: 1;\n}\n\n.header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab:hover:not(.is-disabled)::before {\n  background-color: "+e.contrast+";\n}\n\n.header.is-personalizable.has-tabs .animated-bar {\n  background-color: "+e.contrast+";\n}\n\n.header.is-personalizable.has-tabs .tab-list-container .tab.is-selected:not(.is-disabled):hover::before {\n  background-color: "+e.contrast+" !important;\n}\n\n.subheader.is-personalizable .go-button.is-personalizable {\n  background-color: "+e.dark+";\n  border-color: "+e.dark+";\n  color: "+e.contrast+";\n}\n\n.module-tabs.is-personalizable .tab-more {\n  border-left-color: "+e.darkest+" !important;\n}\n\n.module-tabs.is-personalizable .tab-more:hover {\n  background-color: "+e.hover+" !important;\n}\n\n.module-tabs.is-personalizable .tab-more.is-open {\n  background-color: "+e.hover+" !important;\n}\n\n.module-tabs.is-personalizable .tab-more.is-selected {\n  background-color: "+e.base+" !important;\n}\n\n.header .toolbar > .toolbar-searchfield-wrapper.active .searchfield {\n  background-color: "+e.hover+" !important;\n  border-bottom-color: "+e.hover+" !important;\n}\n\n.header .toolbar > .toolbar-searchfield-wrapper.active .searchfield-category-button {\n  background-color: "+e.hover+" !important;\n  border-bottom-color: "+e.hover+" !important;\n}\n\n.subheader.is-personalizable {\n  background-color: "+e.lighter+" !important;\n}\n\n.builder .sidebar .header {\n  border-right: 1px solid "+e.hover+" !important;\n}\n\n.module-tabs.is-personalizable .tab:hover {\n  background-color: "+e.hover+" !important;\n}\n\n.module-tabs.has-toolbar.is-personalizable .tab-list-container + .toolbar {\n  border-left-color: "+e.darkest+' !important;\n}\n\n.module-tabs.is-personalizable [class^="btn"] {\n  background-color: transparent !important;\n  color: '+e.contrast+" !important;\n}\n\n.module-tabs.is-personalizable .tab.is-disabled {\n  background-color: "+e.darker+" !important;\n  color: "+e.contrast+" !important;\n}\n\n.module-tabs.is-personalizable .tab.is-disabled > svg {\n  fill: "+e.contrast+" !important;\n}\n\n.module-tabs.is-personalizable .add-tab-button {\n  border-left-color: "+e.darkest+" !important;\n}\n\n.module-tabs.is-personalizable .add-tab-button:hover {\n  background-color: "+e.darker+" !important;\n}\n\n.module-tabs.is-personalizable .toolbar-searchfield-wrapper > .searchfield {\n  color: "+e.contrast+" !important;\n}\n\n.module-tabs.is-personalizable .toolbar-searchfield-wrapper > svg {\n  fill: "+e.contrast+" !important;\n}\n\n.is-personalizable .tab-container.header-tabs:not(.alternate)::before,\n.is-personalizable.tab-container.header-tabs:not(.alternate)::before {\n  background-image: linear-gradient(to right, "+e.base+" , "+z.hexToRgba(e.base,0)+") !important;\n}\n\n.is-personalizable .tab-container.header-tabs:not(.alternate)::after,\n.is-personalizable.tab-container.header-tabs:not(.alternate)::after {\n  background-image: linear-gradient(to right, "+z.hexToRgba(e.base,0)+", "+e.base+") !important;\n}\n\n.hero-widget.is-personalizable {\n  background-color: "+e.lighter+";\n}\n\n.hero-widget.is-personalizable .hero-bottom {\n  background-color: "+e.base+";\n}\n\n.hero-widget.is-personalizable .hero-footer .hero-footer-nav li::before {\n  color: "+e.light+";\n}\n\n.hero-widget.is-personalizable .chart-container .arc {\n  stroke: "+e.lighter+";\n}\n\n.hero-widget.is-personalizable .chart-container .bar {\n  stroke: "+e.lighter+";\n}\n\n.hero-widget.is-personalizable .chart-container.line-chart .dot {\n  stroke: "+e.lighter+";\n}\n\n.application-menu.is-personalizable {\n  background-color: "+e.lighter+";\n  border-right: "+e.light+";\n}\n\n.application-menu.is-personalizable .application-menu-header {\n  background-color: "+e.lighter+";\n  border-bottom-color: "+e.light+";\n}\n\n.application-menu.is-personalizable .application-menu-footer {\n  background-color: "+e.lighter+";\n  border-top-color: "+e.light+";\n}\n\n.application-menu.is-personalizable button .icon,\n.application-menu.is-personalizable button span,\n.application-menu.is-personalizable .hyperlink {\n  color: "+e.contrast+" !important;\n}\n\n.application-menu.is-personalizable button:not(:disabled):hover .icon,\n.application-menu.is-personalizable button:not(:disabled):hover span,\n.application-menu.is-personalizable .hyperlink:hover {\n  color: "+e.contrast+";\n  opacity: 1;\n}\n\n.application-menu.is-personalizable .accordion.panel {\n  background-color: "+e.lighter+";\n}\n\n.application-menu.is-personalizable .name-xl,\n.application-menu.is-personalizable .name,\n.application-menu.is-personalizable .accordion-heading {\n  color: "+e.contrast+";\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header {\n  background-color: "+e.lighter+" !important;\n  border: 1px solid transparent !important;\n  color: "+e.contrast+";\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header .icon {\n  color: "+e.contrast+" !important;\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-selected {\n  background-color: "+e.base+" !important;\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-selected > a,\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-selected:hover > a,\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-selected > a,\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-selected .icon {\n  color: "+e.contrast+" !important;\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header:hover {\n  background-color: "+e.base+" !important;\n}\n\n.application-menu.is-personalizable .accordion.panel .accordion-header.is-focused:not(.hide-focus) {\n  border: 1px solid "+e.contrast+" !important;\n  box-shadow: none !important;\n}\n\n.application-menu.is-personalizable .accordion.panel.inverse .accordion-pane {\n  background-color: "+e.lighter+" !important;\n}\n\n.application-menu.is-personalizable .accordion.panel.inverse .accordion-pane .accordion-header {\n  border: 1px solid "+e.lighter+";\n}\n\n.application-menu.is-personalizable .accordion.panel.inverse .accordion-header .icon.plus-minus::before,\n.application-menu.is-personalizable .accordion.panel.inverse .accordion-header .icon.plus-minus::after {\n  background-color: "+e.contrast+";\n}\n\n.application-menu.is-personalizable button:focus:not(.hide-focus),\n.application-menu.is-personalizable .hyperlink:focus:not(.hide-focus)::after {\n  border-color: "+e.contrast+" !important;\n  box-shadow: none !important;\n}\n\n.application-menu .application-menu-header button:hover,\n.application-menu .application-menu-footer button:hover {\n  background-color: "+e.base+" !important;\n}\n\n.application-menu.is-personalizable .searchfield-wrapper .searchfield {\n  color: "+e.contrast+" !important;\n}\n\n.application-menu.is-personalizable .accordion-header.has-filtered-children > a,\n.application-menu.is-personalizable .accordion.panel .accordion-header.has-filtered-children.is-focused {\n  color: "+e.contrast+" !important;\n}\n\n.application-menu.is-personalizable .searchfield-wrapper .searchfield::placeholder {\n  color: "+e.contrast+";\n  opacity: .8;\n}\n\n.application-menu.is-personalizable .searchfield-wrapper .icon {\n  color: "+e.contrast+";\n  opacity: .8;\n}\n\n.application-menu.is-personalizable .searchfield-wrapper.active .icon {\n  color: "+e.contrast+";\n  opacity: 1;\n}\n\n.application-menu.is-personalizable .application-menu-switcher-panel,\n.application-menu.is-personalizable .application-menu-switcher-panel .accordion.panel,\n.application-menu.is-personalizable .application-menu-switcher-panel .accordion.panel .accordion-header {\n  background-color: "+e.base+" !important;\n  border-top-color: transparent;\n}\n\n.application-menu.is-personalizable .application-menu-switcher-panel .accordion.panel .accordion-header:hover {\n  background-color: "+e.darkest+" !important;\n}\n\n.application-menu.is-personalizable .application-menu-switcher-panel .accordion-heading {\n  border-top-color: "+e.darkest+";\n}\n\n.application-menu.is-personalizable .searchfield-wrapper {\n  background-color: "+e.base+";\n  border-bottom: none !important;\n}\n\n.is-personalizable .personalize-header,\n.is-personalizable.tab-container {\n  background-color: "+e.base+" !important;;\n}\n\n.is-personalizable .personalize-subheader {\n  background-color: "+e.lighter+" !important;;\n}\n\n.is-personalizable .personalize-text {\n  color: "+e.contrast+" !important;\n}\n\n.is-personalizable .personalize-actionable,\n.is-personalizable .personalize-actionable svg {\n  color: "+e.contrast+";\n  opacity: .8;\n}\n\n.is-personalizable .personalize-actionable:hover:not([disabled]),\n.is-personalizable .personalize-actionable:hover:not([disabled]) svg {\n  color: "+e.contrast+";\n  opacity: 1;\n}\n\n.is-personalizable .personalize-actionable.is-focused:not(.hide-focus),\n.is-personalizable .personalize-actionable:focus:not(.hide-focus) {\n  border-color: "+e.contrast+";\n  box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2);\n}\n\n.is-personalizable .personalize-actionable.hyperlink:focus:not(.hide-focus)::after {\n  border-color: "+e.contrast+";\n  opacity: 1;\n  box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2);\n}\n\n.is-personalizable .personalize-vertical-border {\n  border-color: "+e.light+";\n}\n\n.is-personalizable .personalize-horizontal-bottom-border {\n  border-bottom: 1px solid "+e.darkest+";\n}\n\n.is-personalizable .personalize-horizontal-top-border {\n  border-top: 1px solid: "+e.darkest+";\n}\n\n.is-personalizable .personalize-chart-targeted .total.bar {\n  background-color: rgba(255, 255, 255, .8);\n}\n\n.is-personalizable .personalize-chart-targeted .chart-percent-text,\n.is-personalizable .personalize-chart-targeted .label {\n  color: "+e.text+";\n}\n\n.is-personalizable .info-message,\n.is-personalizable .info-message .icon,\n.is-personalizable .info-message p {\n  color: "+e.text+" !important;\n}\n\n.is-personalizable .personalize-actionable-disabled,\n.is-personalizable .personalize-actionable-disabled:hover {\n  opacity: .4 !important;\n  cursor: default;\n}\n\n.hero-widget.is-personalizable .hero-header .chart-container .arc,\n.hero-widget.is-personalizable .hero-header .chart-container .bar,\n.hero-widget.is-personalizable .hero-header .chart-container.line-chart .dot,\n.hero-widget.is-personalizable .hero-content .chart-container .arc,\n.hero-widget.is-personalizable .hero-content .chart-container .bar,\n.hero-widget.is-personalizable .hero-content .chart-container.line-chart .dot,\n.hero-widget.is-personalizable .hero-footer .chart-container .arc,\n.hero-widget.is-personalizable .hero-footer .chart-container .bar,\n.hero-widget.is-personalizable .hero-footer .chart-container.line-chart .dot {\n    stroke: "+e.lighter+" !important;\n}\n\n.hero-widget.is-personalizable .hero-header .chart-container text,\n.hero-widget.is-personalizable .hero-content .chart-container text,\n.hero-widget.is-personalizable .hero-footer .chart-container text {\n    fill: "+e.text+" !important;\n}\n\n.hero-widget.is-personalizable .hero-header .chart-container .chart-legend-item-text,\n.hero-widget.is-personalizable .hero-content .chart-container .chart-legend-item-text,\n.hero-widget.is-personalizable .hero-footer .chart-container .chart-legend-item-text {\n  color: "+e.text+";\n  fill: "+e.text+";\n}\n\n.hero-widget.is-personalizable .hero-header .chart-container .axis path, .chart-container .axis line,\n.hero-widget.is-personalizable .hero-header .chart-container .axis .tick0 line {\n  stroke: "+e.subtext+" !important;\n}\n\n.hero-widget.is-personalizable .hero-header .title,\n.hero-widget.is-personalizable .hero-content .title,\n.hero-widget.is-personalizable .hero-footer .title {\n  color: "+e.subtext+";\n}\n\n.hero-widget.is-personalizable .hero-header .btn-tertiary,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary),\n.hero-widget.is-personalizable .hero-content .btn-tertiary,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary),\n.hero-widget.is-personalizable .hero-footer .btn-tertiary,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary),\n.hero-widget.is-personalizable .hero-header .btn-tertiary .icon,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span .icon,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary) .icon,\n.hero-widget.is-personalizable .hero-content .btn-tertiary .icon,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span .icon,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary) .icon,\n.hero-widget.is-personalizable .hero-footer .btn-tertiary .icon,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span .icon,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary) .icon\n {\n  color: "+e.subtext+";\n}\n\n.hero-widget.is-personalizable .hero-header .btn-tertiary:hover,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover,\n.hero-widget.is-personalizable .hero-content .btn-tertiary:hover,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover,\n.hero-widget.is-personalizable .hero-footer .btn-tertiary:hover,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover,\n.hero-widget.is-personalizable .hero-header .btn-tertiary:hover .icon,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover .icon,\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover .icon,\n.hero-widget.is-personalizable .hero-content .btn-tertiary:hover .icon,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover .icon,\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover .icon,\n.hero-widget.is-personalizable .hero-footer .btn-tertiary:hover .icon,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:hover .icon,\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover .icon\n {\n  color: "+e.text+";\n}\n\n.hero-widget.is-personalizable .hero-header .btn-tertiary:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-header .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-content .btn-tertiary:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-content .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-footer .btn-tertiary:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary).is-open span:focus:not(.hide-focus),\n.hero-widget.is-personalizable .hero-footer .btn-menu:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):focus:not(.hide-focus) {\n  box-shadow: 0 0 0 2px transparent,\n    0 0 0 1px "+e.subtext+",\n    0 0 2px 1px "+e.subtext+";\n}\n\n.header.is-personalizable .toolbar [class^='btn']:focus:not(.hide-focus),\n.header.is-personalizable .flex-toolbar [class^='btn']:focus:not(.hide-focus),\n.subheader.is-personalizable .toolbar [class^='btn']:focus:not(.hide-focus),\n.subheader.is-personalizable .flex-toolbar [class^='btn']:focus:not(.hide-focus) {\n  box-shadow: 0 0 0 2px transparent,\n    0 0 0 1px "+e.subtext+",\n    0 0 2px 1px "+e.subtext+";\n}\n\n.tooltip.is-personalizable {\n  background-color: "+e.darkest+";\n  border-color: "+e.darkest+";\n}\n.tooltip.is-personalizable .chart-swatch .swatch-row div {\n  border-bottom-color: "+e.darkest+";\n}\n.tooltip.is-personalizable,\n.tooltip.is-personalizable p,\n.tooltip.is-personalizable .chart-swatch .swatch-row span,\n.tooltip.is-personalizable .chart-swatch .swatch-row b {\n  color: "+e.tooltipText+";\n}\n.tooltip.is-personalizable.top .arrow::after {\n  border-top-color: "+e.darkest+";\n}\n.tooltip.is-personalizable.right .arrow::after {\n  border-right-color: "+e.darkest+";\n}\n.tooltip.is-personalizable.bottom .arrow::after {\n  border-bottom-color: "+e.darkest+";\n}\n.tooltip.is-personalizable.left .arrow::after {\n  border-left-color: "+e.darkest+";\n}\n\n    "}(e)},setFont:function(e){$("html").addClass("font-"+e)},setColors:function(e){return""===e?(this.setColorsToDefault(),this):e?(this.appendStyleSheet(this.getColorStyleSheet(e)),this.settings.colors=e,this.element.triggerHandler("colorschanged",{colors:this.settings.colors.header||this.settings.colors||H.themeColors().brand.primary.alt.value,theme:this.currentTheme||"theme-soho-light"}),this):this},setColorsToDefault:function(){this.settings.colors="";var e=document.getElementById("soho-personalization");e&&e.parentNode.removeChild(e)},getThemeFromStylesheet:function(){var e=$("#stylesheet, #sohoxi-stylesheet"),t="";if(e.length>0){var i=e.attr("href"),s=(t=i.substring(i.lastIndexOf("/")+1)).lastIndexOf("?");s>-1&&(t=t.slice(0,s)),t=t.replace(".min","").replace(".css","")}return t},setTheme:function(e){var t=$("html");if(e)if(this.currentTheme=e,H.currentTheme.id!==e){["light","dark","high-contrast"].indexOf(e)>-1&&(e+="-theme"),t.removeClass(function(e,t){return t.split(" ").filter(function(e){return e.indexOf("theme")>-1}).join()}).addClass(e),this.blockUi();var i=this,n=$("#stylesheet, #sohoxi-stylesheet"),a=$('<link rel="stylesheet">'),r=n.attr("href");a.on("load",function(){n.remove(),i.unBlockUi()}).on("error",function(){i.unBlockUi()});var o=r?r.substring(0,r.lastIndexOf("/")):"",l=!!r&&r.indexOf(".min")>-1;a.attr({id:n.attr("id"),href:s.stripTags(o+"/"+e+(l?".min":"")+".css")}),n.removeAttr("id"),n.before(a),this.settings.theme=e,H.setTheme(e),this.element.triggerHandler("themechanged",{colors:this.settings.colors.header||this.settings.colors||H.themeColors().brand.primary.alt.value,theme:e||"theme-soho-light"})}else t.hasClass(e)||t.addClass(e)},blockUi:function(){if(this.settings.blockUI){var e="#bdbdbd";switch(H){case"light":e="#f0f0f0";break;case"dark":e="#313236";break;case"high-contrast":e="#d8d8d8";break;default:e="#f0f0f0"}this.pageOverlay=this.pageOverlay||$('<div class="personalize-overlay"></div>'),this.pageOverlay.css("background",e),$("body").append(this.pageOverlay)}},unBlockUi:function(){var e=this;e.settings.blockUI&&e.pageOverlay&&e.pageOverlay.fadeOut(300,function(){e.pageOverlay.remove(),e.pageOverlay=void 0})},updated:function(e){if(!e)return this;var t=m.extend({},this.settings);return this.settings=m.mergeSettings(this.element[0],e,this.settings),this.settingsDidChange(t,"theme")&&this.setTheme(this.settings.theme),this.settingsDidChange(t,"colors")&&this.setColors(this.settings.colors),this.settingsDidChange(t,"font")&&this.setFont(this.settings.font),this},settingsDidChange:function(e,t){return this.settings[t]&&this.settings[t]!==e[t]},teardown:function(){return this.element.off("updated.personalize"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"personalize")}};var W={theme:"theme-soho-light"};"object"===u(window.SohoConfig)&&"object"===u(window.SohoConfig.personalize)&&(W=window.SohoConfig.personalize);var j=new V(document.documentElement,W);$.fn.personalize=function(e){return this.each(function(){var t=$.data(this,"personalize");t||(t=$.data(this,"personalize",j)),t.updated(e)})},$.fn.disable=function(){return $.each(this.data(),function(e,t){t instanceof jQuery||t&&t.disable&&t.disable()}),this.prop("disabled",!0),this},$.fn.enable=function(){return $.each(this.data(),function(e,t){t instanceof jQuery||t&&t.enable&&t.enable()}),this.prop({disabled:!1,readonly:!1}),this},$.fn.readonly=function(){return $.each(this.data(),function(e,t){t instanceof jQuery||t&&t.readonly&&t.readonly()}),this.prop("readonly",!0),this},$(function(){var e=void 0,t=void 0;$(".label-text").closest("label, .label").each(function(){t=$("input, textarea, select",this),e=t.attr("class"),$(this).addClass(function(){return"inline"+(e?" inline-"+(-1===e.indexOf(" ")?e:e.substr(0,e.indexOf(" "))):"")})})}),$(function(){$("input:radio").on("click.radios",function(){this.focus()})}),$(function(){var e=function(e,t){for(var i=0,s=e.length;i<s;i++)$(e[i]).parent().addClass(t)};e($(".field > input:checkbox, .field > .inline-checkbox"),"field-checkbox"),e($(".field > input:radio, .field > .inline-radio"),"field-radio")}),$(function(){[].slice.call(document.body.querySelectorAll("label.required .label-text, .label.required .label-text, label:not(.inline).required, .label:not(.inline).required")).forEach(function(e){-1!==e.className.indexOf("accessible")&&(e.querySelector(".required-asterisk")||e.insertAdjacentHTML("beforeend",'<span class="required-asterisk" aria-hidden="true">*</span>'))});var e=[].slice.call(document.body.querySelectorAll("[data-validate]"));e.forEach(function(e){var t=e.getAttribute("data-validate");t&&t.indexOf("required")>-1&&e.setAttribute("aria-required",!0)}),(e=[].slice.call(document.body.querySelectorAll('input[type="hidden"]'))).forEach(function(e){var t=e.getAttribute("id");if(t){var i=document.body.querySelector('label[for="'+t+'"]');i&&i.setAttribute("aria-hidden",!0)}})}),$.fn.highlight=function(e){return this.length&&e&&e.length?this.each(function(){!function e(t,i){var s=0,n=void 0,a=void 0,r=void 0,o=void 0;if(3===t.nodeType)n=t.data.toUpperCase().indexOf(i),(n-=t.data.substr(0,n).toUpperCase().length-t.data.substr(0,n).length)>=0&&((a=document.createElement("mark")).className="highlight",(r=t.splitText(n)).splitText(i.length),o=r.cloneNode(!0),a.appendChild(o),r.parentNode.replaceChild(a,r),s=1);else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var l=0;l<t.childNodes.length;++l)l+=e(t.childNodes[l],i);return s}(this,e.toUpperCase())}):this},$.fn.unhighlight=function(){return this.find("mark.highlight").each(function(){var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()};var G={handle:null,itemsSelector:null,connectWith:!1,isVisualItems:!1,placeholder:null,placeholderCssClass:"arrange-placeholder"};function U(e,t){this.settings=m.mergeSettings(e,t,G),this.element=$(e),this.init()}U.prototype={init:function(){this.isTouch=l.features.touch,this.isIe="ie"===l.browser.name,this.handleEvents()},getElementByTouchInList:function(e,t,i){for(var s=!1,n=$(e),a=0,r=n.length;a<r;a++){var o=$(n[a]),l=o.offset();t<=l.left||t>=l.left+o.outerWidth()||i<=l.top||i>=l.top+o.outerHeight()||(s=o)}return s},dragTouchElement:function(e,t){var i=e.originalEvent.changedTouches[0];t[0].style.top=i.pageY-this.offset.y+"px",t[0].style.left=i.pageX-this.offset.x+"px"},unbind:function(){return this.items.removeClass("draggable").removeAttr("draggable").off("selectstart.arrange "+this.dragStart+" "+this.dragEnd+" "+this.dragWhileDragging),$(this.handle,this.items).removeClass("draggable").off("mousedown.arrange mouseup.arrange touchstart.arrange touchend.arrange"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,G)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"arrange")},getVisualIndex:function(e){var t=this.settings,i=null;if(t.isVisualItems){var s=this.element.children().not('[data-arrange-exclude="true"]');t.itemsSelector&&(s=$(t.itemsSelector,this.element).not('[data-arrange-exclude="true"]')),i=s.index(e)}return i},handleEvents:function(){var e=this,t=this.settings,i=void 0,s=void 0,n={},a=this.element.children().not('[data-arrange-exclude="true"]'),r=$("<"+(/^(ul|ol)$/i.test(this.element[0].tagName)?"li":"div")+">");t.itemsSelector&&(a=$(t.itemsSelector,this.element).not('[data-arrange-exclude="true"]'),r=$("<"+a.first()[0].tagName+" />")),t.placeholder&&(r=$(t.placeholder)),this.dragStart="dragstart.arrange touchstart.arrange gesturestart.arrange",this.dragEnd="dragend.arrange touchend.arrange touchcancel.arrange gestureend.arrange",this.dragWhileDragging="dragover.arrange dragenter.arrange drop.arrange touchmove.arrange gesturechange.arrange",this.handle=t.handle||this.element.attr("data-arrange-handle"),this.connectWith=this.element.attr("data-arrange-connectWith"),this.placeholders=r,this.isTouch||this.placeholders.addClass(t.placeholderCssClass+" draggable"),$(this.handle,a).addClass("draggable").on("mousedown.arrange touchstart.arrange",function(){s=!0}).on("mouseup.arrange touchend.arrange",function(){s=!1}),this.connectWith&&(a=a.add($(this.connectWith).children().not('[data-arrange-exclude="true"]')).data("connectWith",this.connectWith)),this.items=a,this.items.attr("draggable",!0).addClass(this.handle?"":"draggable").add([this,r]).not("a[href], img").on("selectstart.arrange",function(){return this.dragDrop&&this.dragDrop(),this.isIe}).end().each(function(){$(this).on(e.dragStart,function(a){if(e.handle&&!s){if(e.isTouch)return;return!1}s=!1,e.dragging=$(this),i=e.dragging.addClass("arrange-dragging").index();var r=t.isVisualItems?e.getVisualIndex(e.dragging):i;$.extend(n,{start:e.dragging,startIndex:r});var o=e.element.triggerHandler("beforearrange",n);if("boolean"==typeof o&&!o||"string"==typeof o&&"false"===o.toLowerCase())e.dragging=null;else if(e.isTouch){var l=e.dragging[0].getBoundingClientRect(),d=a.originalEvent.changedTouches[0];e.offset={x:d.pageX-l.left,y:d.pageY-l.top},e.placeholderTouch=e.dragging.clone().addClass("is-touch").attr("id","arrange-placeholder-touch").insertBefore(e.dragging),e.dragTouchElement(a,e.placeholderTouch)}else{var c=a.originalEvent.dataTransfer;c.effectAllowed="move",c.setData("Text","dummy")}}).on(e.dragEnd,function(){if(e.dragging){if(e.isTouch&&(e.dragging.css("opacity",1),e.placeholderTouch.remove()),e.placeholders.filter(":visible").after(e.dragging),e.dragging.removeClass("arrange-dragging").show(),e.placeholders.detach(),i!==e.dragging.index()){var s=t.isVisualItems?e.getVisualIndex(e.dragging):e.dragging.index();$.extend(n,{end:e.dragging,endIndex:s}),e.element.triggerHandler("arrangeupdate",n)}e.dragging=null,e.placeholderTouch=null}}).on(e.dragWhileDragging,function(i){if(e.dragging){var s=this,o=void 0;if(i.preventDefault(),"drop"===i.type)return i.stopPropagation(),e.dragging.trigger("dragend.arrange"),!1;if(e.isTouch){var l=i.originalEvent.touches[0];s=e.getElementByTouchInList(a,l.pageX,l.pageY)||s}if(s=$(s),e.isTouch||(i.originalEvent.dataTransfer.dropEffect="move"),a.is(s)&&r.index()!==s.index()){e.isTouch?e.dragging.css("opacity",0):e.dragging.hide();var d=void 0;r.index()<s.index()?(r.insertAfter(s),o=s.index(),d=t.isVisualItems?e.getVisualIndex(s):o):(r.insertBefore(s),o=r.index(),d=t.isVisualItems?e.getVisualIndex(r):o),$.extend(n,{over:s,overIndex:d}),e.element.triggerHandler("draggingarrange",n),m.fixSVGIcons(s),e.placeholders.not(r).detach()}else e.placeholders.is(this)||(e.placeholders.detach(),e.element.append(r));if(!e.isTouch)return!1;e.dragTouchElement(i,e.placeholderTouch)}})})}},$.fn.arrange=function(e){return this.each(function(){var t=$.data(this,"arrange");t?t.updated(e):t=$.data(this,"arrange",new U(this,e))})};var _={axis:null,clone:!1,cloneCssClass:"is-clone",clonePosIsFixed:!1,cloneAppendTo:null,containment:!1,obstacle:!1,underElements:!1,containmentOffset:{left:0,top:0}};function K(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,_),this.init()}K.prototype={init:function(){this.handleEvents()},finish:function(e,t){var i={top:t,left:e};this.element.off("mouseup.draggable"),$(document).off("mousemove.draggable mouseup.draggable"),this.settings.underElements&&(i.underElements=this.getElementsFromPoint(i.left,i.top)),this.element.trigger("dragend",i),this.element.removeClass("is-dragging"),this.clone&&("x"===this.settings.axis&&delete i.top,"y"===this.settings.axis&&delete i.left,this.clone.remove(),this.clone=null),this.obstacle&&(this.obstacle=null),this.upperYLimit&&(this.upperYLimit=null),this.upperXLimit&&(this.upperXLimit=null),$("body").removeClass("disable-select")},move:function(e,t){var i={left:e,top:t};if("x"===this.settings.axis&&delete i.top,"y"===this.settings.axis&&delete i.left,this.settings.containment&&(this.settings.containment instanceof jQuery?this.container=this.settings.containment:"parent"===this.settings.containment?this.container=this.element.parent():"window"===this.settings.containment?this.container=$(window):"container"===this.settings.containment?this.container=this.element.closest(".page-container"):this.container=$(document),this.upperXLimit||(this.upperXLimit=this.container.width()-this.element.outerWidth()+this.settings.containmentOffset.left),this.upperYLimit||(this.upperYLimit=this.container.height()-this.element.outerHeight()+this.settings.containmentOffset.top),i.top>this.upperYLimit&&(i.top=this.upperYLimit),i.left>this.upperXLimit&&(i.left=this.upperXLimit),i.top<0&&(i.top=0),i.left<0&&(i.left=0),"container"===this.settings.containment&&i.left<=1&&(i.left=1)),this.settings.obstacle){var s=this.clone?this.clone.offset():this.element.offset(),n=this.clone?this.clone.outerWidth():this.element.outerWidth(),a=i.left>s.left;if(!this.obstacle){this.obstacle=$(this.settings.obstacle).not(this.element);var r=$(this.obstacle).offset();this.constraints={top:r.top,left:r.left,bottom:r.top+this.obstacle.outerHeight(),right:r.left+this.obstacle.outerWidth()}}!a&&this.originalPos.left>this.constraints.left&&i.left<=this.constraints.right&&(i.left=this.constraints.right),a&&this.originalPos.left+n<=this.constraints.left&&i.left+n>=this.constraints.left&&(i.left=this.constraints.left-this.obstacle.outerWidth())}var o=function(e,t,i){void 0!==t[i]&&(e[0].style[i]=t[i]+"px")};o(this.clone||this.element,i,"top"),o(this.clone||this.element,i,"left"),this.settings.underElements&&(i.underElements=this.getElementsFromPoint(i.left,i.top)),this.element.trigger("drag",i)},getElementsFromPoint:function(e,t){var i=[];if(document.elementsFromPoint)i=document.elementsFromPoint(e,t);else if(document.msElementsFromPoint)i=document.msElementsFromPoint(e,t);else{for(var s,n=void 0,a=void 0,r=void 0,o=999,l=[];(r=document.elementFromPoint(e,t))&&-1===i.indexOf(r)&&null!==r&&o>-1;)o--,i.push(r),l.push({value:r.style.getPropertyValue("pointer-events")||"",priority:r.style.getPropertyPriority("pointer-events")}),r.style.setProperty("pointer-events","none","important");for(n=0,s=i.length;n<s;n++)a=l[n],i[n].style.setProperty("pointer-events",a.value,a.priority)}return i},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings))},destroy:function(){$.removeData(this.element[0],"drag"),this.element.off("touchstart.draggable MSPointerDown.draggable pointerdown.draggable touchmove.draggable touchend.draggable touchcancel.draggable mousedown.draggable")},handleEvents:function(){var e=this;e.offset=null,e.element.attr("draggable",!1),"onpointerdown"in window||"onmspointerdown"in window||e.element.on("touchstart.draggable gesturestart.draggable",function(t){var i=$(this).position(),s=t.originalEvent;e.offset={x:s.changedTouches[0].pageX-i.left,y:s.changedTouches[0].pageY-i.top},e.originalPos=i,e.element.addClass("is-dragging"),e.element.trigger("dragstart",i)}).on("touchmove.draggable gesturechange.draggable",function(t){t.preventDefault();var i=t.originalEvent;if(!(i.targetTouches.length>1)){var s=i.changedTouches[0].pageX-e.offset.x,n=i.changedTouches[0].pageY-e.offset.y;e.move(s,n)}}).on("touchend.draggable gestureend.draggable touchcancel.draggable",function(t){t.preventDefault();var i=t.originalEvent.changedTouches[0];e.finish(i.pageX-e.offset.x,i.pageY-e.offset.y)}),e.element.on("mousedown.draggable",function(t){t.preventDefault();var i=e.settings.clonePosIsFixed?e.element[0].getBoundingClientRect():e.element.position();e.offset={x:t.pageX-i.left,y:t.pageY-i.top},e.originalPos=i,$("body").addClass("disable-select"),$(document).on("mousemove.draggable",function(t){t.preventDefault(),e.move(t.pageX-e.offset.x,t.pageY-e.offset.y)}),$(document).on("mouseup.draggable",function(i){i.preventDefault(),e.finish(t.pageX-e.offset.x,i.pageY-e.offset.y)}),e.element.on("mouseup.draggable",function(t){t.preventDefault(),e.finish(t.pageX-e.offset.x,t.pageY-e.offset.y)}),!e.clone&&e.settings.clone&&(e.clone=e.element.clone(!0),"parent"===e.settings.cloneAppendTo&&(e.settings.cloneAppendTo=e.element.parent()),e.clone.addClass(e.settings.cloneCssClass).appendTo(e.settings.cloneAppendTo||"body")),e.element.addClass("is-dragging"),e.element.trigger("dragstart",[i,e.clone])})}},$.fn.drag=function(e){return this.each(function(){var t=$.data(this,"drag");t?t.updated(e):t=$.data(this,"drag",new K(this,e))})};var Y={bleedFromContainer:!1,callback:null,container:null,parent:null,parentXAlignment:"center",parentYAlignment:"center",placement:"bottom",strategies:["nudge"]},X=["nudge","clockwise","flip","shrink","shrink-x","shrink-y"],J=["top","left","right","bottom","center"],Q=["left","center","right"],Z=["top","center","bottom"],ee=["x","y","container","containerOffsetX","containerOffsetY","callback","parent","parentXAlignment","parentYAlignment","useParentWidth","useParentHeight","placement","strategies"];function te(e){var t=this;return ee.forEach(function(i){if(null!==e[i])return"x"===i||"y"===i?(t.setCoordinate(i,e[i]),void(t["original"+i]=e[i])):void(t[i]=e[i])}),this.modified=!1,this.sanitize()}function ie(e,t){this.settings=m.mergeSettings(e,t,Y),this.element=$(e),this.init()}te.prototype={isReasonableDefault:function(e,t){return $.inArray(e,t)>-1},sanitize:function(){var e=this;this.bleedFromContainer=!0===this.bleedFromContainer,this.callback="function"==typeof this.callback?this.callback:Y.callback,this.container=this.container instanceof $&&this.container.length?this.container:Y.container,this.containerOffsetX=isNaN(parseInt(this.containerOffsetX,10))?0:this.containerOffsetX,this.containerOffsetY=isNaN(parseInt(this.containerOffsetY,10))?0:this.containerOffsetY,this.parent=this.parent instanceof $&&this.parent.length?this.parent:Y.parent,this.parentXAlignment=this.isReasonableDefault(this.parentXAlignment,Q)?this.parentXAlignment:Y.parentXAlignment,this.parentYAlignment=this.isReasonableDefault(this.parentYAlignment,Z)?this.parentYAlignment:Y.parentYAlignment,this.placement=this.isReasonableDefault(this.placement,J)?this.placement:Y.placement,this.useParentHeight=!0===this.useParentHeight,this.useParentWidth=!0===this.useParentWidth,$.isArray(this.strategies)&&this.strategies.length||(this.strategies=["nudge"]),this.strategies.forEach(function(t,i){e.strategies[i]=e.isReasonableDefault(t,X)?t:e.strategies[i]})},setCoordinate:function(e,t){this.isReasonableDefault(e,["x","y"])&&(isNaN(t)&&(t=0),this[e]=Math.round(t))}},ie.prototype={init:function(){return this.build().handleEvents()},build:function(){this.element.hasClass("placeable")||this.element.addClass("placeable"),this.originalStyles={};var e=this.element[0].style.height,t=this.element[0].style.width;return e&&(this.originalStyles.height=e),t&&(this.originalStyles.width=t),this},handleEvents:function(){var e=this;return this.element.on("place.place",function(t,i,s){e.place(new te({x:i,y:s}))}).on("updated.place",function(){e.updated()}),this},render:function(e){var t=/(px|%)/i;this.element.offset({left:e.x,top:e.y}),e.height&&(this.element[0].style.height=e.height+(t.test(""+e.height)?"":"px")),e.width&&(this.element[0].style.width=e.width+(t.test(""+e.width)?"":"px"))},place:function(e){var t=[this.element[0].style.left,this.element[0].style.top];return this.element.trigger("beforeplace",[t])?(e instanceof te||(e=new te(e)),null==e.x&&null==e.y?t:(this.clearOldStyles(),e.parent?this.placeWithParent(e):this.placeWithCoords(e))):t},placeWithParent:function(e){if(!e.parent||!e.parent.length)return[void 0,void 0];var t=this,i=n.getDimensions(e.parent[0]),s=n.getDimensions(this.element[0]),a=this.getContainer(e),r=a.length&&a[0]===document.body,o=r?$(window).scrollLeft():a.scrollLeft(),l=r?$(window).scrollTop():a.scrollTop();function d(e){var n=function(e){var t=e.placement,n=e.parentXAlignment,a=e.parentYAlignment,d=void 0,c=void 0;switch(t){case"top":c=i.top-s.height-e.y+(r?l:0);break;case"left":d=i.left-s.width-e.x+(r?o:0);break;case"right":d=i.right+e.x+(r?o:0);break;default:c=i.bottom+e.y+(r?l:0)}if("top"===t||"bottom"===t){var h=Math.round(r?document.body.offsetWidth:null);switch(n){case"left":d=r&&h<Math.round(s.left)+Math.round(s.width)?i.left+e.x+o:i.left-e.x+(r?o:0);break;case"right":d=r&&Math.round(s.right)-Math.round(s.width)<0?i.left-e.x+o:i.right-s.width+e.x+(r?o:0);break;default:d=i.left+(i.width-s.width)/2+e.x+(r?o:0)}}if("right"===t||"left"===t)switch(a){case"top":c=i.top-e.y+(r?l:0);break;case"bottom":c=i.bottom-s.height+e.y+(r?l:0);break;default:c=i.top+(i.height-s.height)/2+e.y+(r?l:0)}return[d,c]}(e);return e.setCoordinate("x",n[0]),e.setCoordinate("y",n[1]),t.render(e),e=t.handlePlacementCallback(e)}return e.useParentWidth&&(e.width=i.width),e.useParentHeight&&(e.height=i.height),(e=d(e)).strategies.forEach(function(i){(e=t.checkBleeds(e)).bleeds&&(e=function(){switch(i){case"nudge":return t.nudge(e);case"clockwise":return t.clockwise(e);case"flip":return(e=t.flip(e)).setCoordinate("x",e.originalx),e.setCoordinate("y",e.originaly),e=d(e);case"shrink":return t.shrink(e);case"shrink-x":return t.shrink(e,"x");case"shrink-y":return t.shrink(e,"y");default:return e}}(),t.render(e))}),this.element.trigger("afterplace",[e]),e},placeWithCoords:function(e){return this.render(e),e=this.handlePlacementCallback(e),this.render(e),(e=this.checkBleeds(e)).bleeds&&(e=this.nudge(e)),this.render(e),(e=this.checkBleeds(e)).bleeds&&(e=this.shrink(e)),this.render(e),this.element.trigger("afterplace",[e]),e},handlePlacementCallback:function(e){var t=e.callback||this.settings.callback;return t&&"function"==typeof t&&(e=t(e)),this.render(e),e},accountForScrolling:function(e){var t=e.container,i=window.getComputedStyle(this.element[0]).position;if("fixed"===i)return!1;if(t&&t.length||(t=this.element.parents().filter(function(){return"absolute"===window.getComputedStyle(this).position||"fixed"===i})),!t||!t.length)return!0;if(t[0]===document.body)return!1;var s=window.getComputedStyle(t[0]);return"fixed"!==(i=s.position)&&("absolute"!==i||"hidden"!==s.overflow)},getContainer:function(e){if(e.container instanceof $&&e.container.length)return e.container;var t=this.element.parents(".modal");return t.length?t:$(document.body)},checkBleeds:function(e){var t=this.settings.bleedFromContainer,i=this.getContainer(e),s=i.length&&i[0]===document.body,n=this.element[0].getBoundingClientRect(),a={},r=i?i[0].getBoundingClientRect():{},o=s?$(window).scrollLeft():i.scrollLeft(),l=s?$(window).scrollTop():i.scrollTop(),d=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c=Math.max(document.documentElement.clientWidth,window.innerWidth||0),h=void 0;function u(e){switch(e){case"top":return(t?0:r.top)-(s?-1*l:0);case"left":return(t?0:r.left)-(s?-1*o:0);case"right":return(t?c:r.right)-(s?-1*o:0);default:return(t?d:r.bottom)-(s?-1*l:0)}}a.width=n.width,a.height=n.height,a.top=n.top,a.right=n.right,a.bottom=n.bottom,a.left=n.left;var p=u("right");if(a.width>=p){h=a.width-p+20;var g=a.width-h;e.width=g,this.element[0].style.width=g+"px",a.width=g}var f=u("bottom");if(a.height>=f){h=a.height-f+20;var m=a.height-h;e.height=m,this.element[0].style.height=m+"px",a.height=m}var v=a.right>u("right"),b=a.left<u("left"),y=a.top<u("top"),w=a.bottom>u("bottom");return v||b||y||w?(e.bleeds={},e.bleeds.right=v?a.right-u("right"):null,e.bleeds.left=b?-(a.left-u("left")):null,e.bleeds.top=y?-(a.top-u("top")):null,e.bleeds.bottom=w?a.bottom-u("bottom"):null,e):(e.bleeds=void 0,e)},nudge:function(e){e.nudges||(e.nudges={x:0,y:0});var t=0;return e.bleeds.right&&(t=Math.abs(e.bleeds.right)+Math.abs(e.containerOffsetX),e.setCoordinate("x",e.x-t),e.nudges.x-=t),e.bleeds.left&&(t=Math.abs(e.bleeds.left)+Math.abs(e.containerOffsetX),e.setCoordinate("x",e.x+t),e.nudges.x+=t),e.bleeds.top&&(t=Math.abs(e.bleeds.top)+Math.abs(e.containerOffsetY),e.setCoordinate("y",e.y+t),e.nudges.y+=t),e.bleeds.bottom&&(t=Math.abs(e.bleeds.bottom)+Math.abs(e.containerOffsetY),e.setCoordinate("y",e.y-t),e.nudges.y-=t),e.wasNudged=!0,e.bleeds=void 0,e},flip:function(e){if(!e.bleeds[e.placement])return e;if(e.attemptedFlips||(e.attemptedFlips=[]),e.attemptedFlips.push(e.placement),e.attemptedFlips.length>3)return e=this.giveup(e);var t=this.accountForScrolling(e),i=["left","right"].indexOf(e.placement)>-1,s=this.settings.bleedFromContainer,n=this.getContainer(e),a=n.length&&n[0]===document.body,r=n?n[0].getBoundingClientRect():{},o=e.parent[0].getBoundingClientRect(),l=a?$(window).scrollLeft():n.scrollLeft(),d=a?$(window).scrollTop():n.scrollTop(),c=Math.max(document.documentElement.clientHeight,window.innerHeight||0),h=Math.max(document.documentElement.clientWidth,window.innerWidth||0);function u(e){switch(e){case"left":return"right";case"right":return"left";case"top":return"bottom";default:return"top"}}function p(i){var n=0;switch(i){case"left":n=(s?0:r.left)-(t?l:0)-o.left+e.containerOffsetX;break;case"right":n=(s?h:r.right)-(t?l:0)-o.right-e.containerOffsetX;break;case"top":n=(s?0:r.top)-(t?d:0)-o.top+e.containerOffsetY;break;default:n=(s?c:r.bottom)-(t?d:0)-o.bottom-e.containerOffsetY}return Math.abs(n)}function g(t){return $.inArray(t,e.attemptedFlips)>-1}return e.placement=function(t){var s=u(t),n=i?"top":"left",a=u(n),r=p(t),o=p(s);if(!g(s))return r>=o?t:(e.wasFlipped=!0,s);var l=e.originalx;e.originalx=e.originaly,e.originaly=l;var d=p(n),c=p(a);if(!g(n)){if(d>=c)return n;if(!g(a))return a}return t}(e.placement),e},clockwise:function(e){return e},shrink:function(e,t){var i=this.accountForScrolling(e),s=this.settings.bleedFromContainer,n=this.getContainer(e),a=n?n[0].getBoundingClientRect():{},r=n.length&&n[0]===document.body,o=this.element[0].getBoundingClientRect(),l=null==t||"x"===t,d=null==t||"y"===t,c=r?$(window).scrollLeft():n.scrollLeft(),h=r?$(window).scrollTop():n.scrollTop(),u=Math.max(document.documentElement.clientHeight,window.innerHeight||0),p=Math.max(document.documentElement.clientWidth,window.innerWidth||0),g=(i?c:0)+(s?0:a.left)+e.containerOffsetX,f=(i?h:0)+(s?0:a.top)+e.containerOffsetY,m=(i?c:0)+(s?p:a.right)-e.containerOffsetX,v=(i?h:0)+(s?u:a.bottom)-e.containerOffsetY,b=void 0;return e.nudges=e.nudges||{},l&&(o.left<g&&(b=Math.abs(g-o.left),o.right>=m&&(b-=e.containerOffsetX),e.width=o.width-b,e.setCoordinate("x",e.x+b),e.nudges.x+=b),o.right>m&&(b=Math.abs(o.right-m),o.left<=g&&(b-=e.containerOffsetX),e.width=o.width-b)),d&&(o.top<f&&(b=Math.abs(f-o.top),o.bottom>=v&&(b-=e.containerOffsetY),e.height=o.height-b,e.setCoordinate("y",e.y+b),e.nudges.y+=b),o.bottom>v&&(b=Math.abs(o.bottom-v),o.top<=f&&(b-=e.containerOffsetY),e.height=o.height-b)),e},giveup:function(e){return e.giveup=!0,e.strategy=this.settings.strategy,e.placement=this.settings.placement,e},clearOldStyles:function(){this.element[0].style.left="",this.element[0].style.top="",this.element[0].style.width="",this.element[0].style.height="";var e=this.originalStyles;return e&&(e.width&&(this.element[0].style.width=e.width),e.height&&(this.element[0].style.height=e.height)),this},setArrowPosition:function(e,t,i){var s=t.parent,n=i.find("div.arrow"),a=t.placement,r=["left","right"].indexOf(a)>-1,o={},l=i[0].getBoundingClientRect(),d={},c={},h=!1;if(s&&s.length&&n.length){if(n[0].removeAttribute("style"),i.removeClass("top right bottom left").addClass(a),this.isRTL&&r){var u="right"===a?"left":"right";i.removeClass("right left").addClass(u)}s.is(".colorpicker")&&(s=s.next(".trigger")),s.is(".datepicker, .timepicker")&&(s=s.next(".icon")),s.is(".btn-split-menu, .btn-menu, .btn-actions, .btn-filter, .tab, .tab-more")&&(s=s.find(".icon").last()),s.is(".searchfield-category-button")&&(s=s.find(".icon.icon-dropdown")),s.is(".colorpicker-editor-button")&&(s=s.find(".trigger .icon")),s.length||(s=t.parent),o=s.length?s[0].getBoundingClientRect():o,d=n.length?n[0].getBoundingClientRect():d,c={};var p,g,f={};f[(g=a,"right"===g||"left"===g?"margin-top":"margin-left")]=(p=0,"left"!==a&&"right"!==a||(p=o.top+o.height/2-(d.top+d.height/2),c.top=d.top+p,c.bottom=d.bottom+p,(c.top<=l.top||c.bottom>=l.bottom)&&(h=!0)),"top"!==a&&"bottom"!==a||(p=o.left+o.width/2-(d.left+d.width/2),c.left=d.left+p,c.right=d.right+p,(c.left<=l.left||c.right>=l.right)&&(h=!0)),p),h&&(f.display="none"),n.css(f)}},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},teardown:function(){return this.clearOldStyles(),this.element.removeClass("placeable"),this.element.off("updated.place place.place"),this.element.trigger("afterteardown"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"place")}},$.fn.place=function(e){return this.each(function(){var t=$.data(this,"place");t?t.updated(e):t=$.data(this,"place",new ie(this,e))})};var se={use:"user-profile",focusable:!1};function ne(e,t){this.settings=m.mergeSettings(e,t,se),this.element=$(e),this.init()}ne.prototype={init:function(){return this.getExistingUseTag(),this.render().handleEvents()},render:function(){if(this.element.addClass("icon"),!this.element.is("svg"))return this;var e=this.element[0].getElementsByTagName("use")[0];return e?(e.getAttribute("xlink:href")!==this.getBasedUseTag()&&e.setAttribute("xlink:href",this.getBasedUseTag()),this):this},getBasedUseTag:function(){return E.getBaseURL("#icon-"+this.settings.use)},getExistingUseTag:function(){if(!this.element.is("svg"))return this;var e=this.element.children("use");if(!e.length)return this;var t=e.attr("xlink:href");return this.settings.use=t.replace("#icon-",""),this},handleEvents:function(){var e=this;return this.element.on("updated.icon",function(){e.updated()}),this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown().init()},teardown:function(){return this.element.off("updated.icon"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"icon")}},$.fn.icon=function(e){return this.each(function(){var t=$.data(this,"icon");t?t.updated(e):t=$.data(this,"icon",new ne(this,e))})},function(){function e(e){var t={icon:"user-profile",classes:["icon"]};return"string"==typeof(e=e||$.extend({},t))&&(e=$.extend({},t,{icon:e.replace("icon-","")})),!e.classes&&e.class&&(e.classes=e.class,delete e.class),e.classes||(e.classes=[].concat(t.classes)),"string"==typeof e.classes&&(e.classes=e.classes.split(" ")),-1===e.classes.indexOf("icon")&&e.classes.push("icon"),e.icon||(e.icon=""),e}$.createIcon=function(t){return['<svg class="'+(t=e(t)).classes.join(" ")+'" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-'+t.icon+'"></use></svg>'].join("")},$.createIconElement=function(e){return $($.createIcon(e))},$.createIconPath=function(t){return t=e(t),$.getBaseURL("#icon-"+t.icon.replace("icon-",""))},$.fn.changeIcon=function(e){e&&$(this).find("use").attr("xlink:href",$.createIconPath({icon:e}))},$.fn.getIconName=function(){var e=$(this),t=e.find("use");return 1===t.length?t.attr("xlink:href").substr(t.attr("xlink:href").indexOf("#icon-")+6):e.attr("data-icon")}}();var ae={toggleOnIcon:null,toggleOffIcon:null,hideMenuArrow:null,replaceText:!1};function re(e,t){this.element=$(e),this.settings=m.mergeSettings(e,t,ae),this.init()}re.prototype={init:function(){var e=this;if(this.isTouch=l.features.touch,this.isSafari=$("html").is(".is-safari"),this.isFirefox=$("html").is(".is-firefox"),!this.element.hasClass("no-ripple")){if(this.element.hasClass("btn-menu")&&!this.element.hasClass("btn-icon")&&!this.element.hasClass("btn-actions")){var t=this.element.children("svg.icon"),i=t.find("use"),s=!1;t.length>0&&i.length>=1&&(s=i.last().attr("xlink:href").indexOf("#icon-dropdown")>-1),s||(t=$.createIconElement({icon:"dropdown",classes:["icon-dropdown"]}),this.element.append(t)),t.hasClass("icon-dropdown")||t.addClass("icon-dropdown"),this.settings.replaceText&&this.element.on("selected.content",function(e,t){$(this).find("span").text(t.text())}),this.settings.hideMenuArrow&&t.remove()}(this.element.hasClass("btn-toggle")||this.element.hasClass("icon-favorite"))&&(this.element.on("click.favorite",function(){var t=$(this),i=t.find("svg:not(.ripple-effect)"),s="true"===t.attr("aria-pressed");t.attr("aria-pressed",s?"false":"true"),e.settings.toggleOffIcon&&e.settings.toggleOnIcon?i.changeIcon(s?e.settings.toggleOffIcon:e.settings.toggleOnIcon):t.toggleClass("is-pressed"),t.hasClass("icon-favorite")&&!t.hasClass("btn-toggle")&&"#icon-star-filled"===i.find("use").attr("xlink:href")?i.changeIcon("star-outlined"):t.hasClass("icon-favorite")&&!t.hasClass("btn-toggle")&&i.changeIcon("star-filled")}),this.element.attr("aria-pressed")||this.element.attr("aria-pressed","false")),!this.element.hasClass("btn-actions")||this.element.parents(".field").length||this.element.parents(".toolbar").length||this.element.data("tooltip")||this.element.attr("title",k.translate("More")).tooltip({content:k.translate("More")}),this.element.hideFocus(),this.element.on("touchstart.button click.button",function(t){if(!(e.element.attr("disabled")||e.element.is(".is-disabled")||!e.isTouch&&1!==t.which||$(".ripple-effect",this).length||e.isTouch&&"touchstart"!==t.type)){var i=$(this),s=i.offset(),n=t.pageX-s.left,a=t.pageY-s.top,r=$('<svg class="ripple-effect" focusable="false" aria-hidden="true" role="presentation"><circle r="0" class="ripple-circle"></circle></svg>');if(e.isTouch&&(t=t.originalEvent)&&t.touches&&1===t.touches.length&&(n=t.touches[0].pageX-s.left,a=t.touches[0].pageY-s.top),n=n<0?e.element.outerWidth()/2:n,a=a<0?e.element.outerHeight()/2:a,$("svg.ripple-effect",i).remove(),r[0].style.left=n+"px",r[0].style.top=a+"px",i.prepend(r),!$.fn.cssPropSupport("animation")||e.isSafari&&!l.features.touch||e.isFirefox)r.removeClass("is-animation"),e.animateWithJS(r);else $("svg.ripple-effect",i).addClass("is-animation");setTimeout(function(){r.remove()},1e3)}})}},animateWithJS:function(e){var t=e[0].style,i=parseFloat(t.left)-100+"px",s=parseFloat(t.top)-100+"px";e[0].style.opacity="0.4",e.animate({opacity:0,left:i,top:s,width:200,height:200},1e3)},teardown:function(){this.element.off("click.button touchstart.button focusin.hide-focus focusout.hide-focus mousedown.hide-focus touchstart.hide-focus");var e=this.element.data("tooltip");this.element.hasClass("btn-actions")&&e&&e.destroy();var t=this.element.data("hidefocus");return t&&t.destroy(),this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings),this.teardown().init()),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"button")}},$.fn.button=function(e){return this.each(function(){var t=$.data(this,"button");t?t.updated(e):t=$.data(this,"button",new re(this,e))})};var oe={};function le(e,t){return this.init(e,t)}le.prototype={init:function(e,t){if(!this.element&&e instanceof HTMLElement&&(this.element=e),"object"===(void 0===t?"undefined":u(t))){var i=this.settings||oe;this.settings=m.mergeSettings(this.element,t,i)}return this.focusBehavior||(this.focusBehavior=new d(this.element)),this},handleEvents:function(){return this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown().init()},teardown:function(){return this}},$.fn.hyperlink=function(e){return this.each(function(){var t=$.data(this,"hyperlink");t?t.updated(e):(t=$.data(this,"hyperlink",new le(this,e))).destroy=function(){this.teardown(),$.removeData(this,"hyperlink")}})};var de={EMPTY_STRING:"",PLACEHOLDER_CHAR:"_",CARET_TRAP:"[]",NON_DIGITS_REGEX:/[^\u0660-\u06690-9\u0966-\u096F\u2E80-\u2FD5\u3190-\u319f\u3400-\u4DBF\u4E00-\u9FCC\uF900-\uFAAD]/g,DIGITS_REGEX:/[\u0660-\u06690-9\u0966-\u096F\u2E80-\u2FD5\u3190-\u319f\u3400-\u4DBF\u4E00-\u9FCC\uF900-\uFAAD]/,ALPHAS_REGEX:/[\u00C0-\u017Fa-zA-Z]/,ANY_REGEX:/[\u00C0-\u017Fa-zA-Z0-9]/,DEFAULT_API_OPTIONS:{locale:"en-US",pattern:void 0,pipe:void 0}};de.LEGACY_DEFS={"#":de.DIGITS_REGEX,0:de.DIGITS_REGEX,x:de.ALPHAS_REGEX,"*":de.ANY_REGEX,"?":/./,"~":/[-0-9]/,a:/[APap]/,m:/[Mm]/},de.DEFAULT_CONFORM_OPTIONS={caretTrapIndexes:[],guide:!0,previousMaskResult:de.EMPTY_STRING,placeholderChar:de.PLACEHOLDER_CHAR,placeholder:de.EMPTY_STRING,selection:{start:0},keepCharacterPositions:!0};var ce={prefix:de.EMPTY_STRING,suffix:de.EMPTY_STRING,allowThousandsSeparator:!0,symbols:{currency:"$",decimal:".",negative:"-",thousands:","},allowDecimal:!0,decimalLimit:2,locale:"",requireDecimal:!1,allowNegative:!1,allowLeadingZeroes:!1,integerLimit:null};function he(e){return e.split(de.EMPTY_STRING).map(function(e){return de.DIGITS_REGEX.test(e)?de.DIGITS_REGEX:e})}function ue(e,t){var i={any:de.ANY_REGEX,digits:de.DIGITS_REGEX,alphas:de.ALPHAS_REGEX};i[t]||(t="any");for(var s=e.toString().length,n=[];s>0;)n.push(i[t]),s-=1;return n}de.numberMask=function(e,t){(t=m.mergeSettings(void 0,t,ce)).locale&&t.locale.length||(t.locale=k.currentLocale.name);var i=t.prefix,s=t.suffix,n=t.symbols.decimal,a=t.symbols.thousands,r=i&&i.length||0,o=s&&s.length||0,l=a&&a.length||0;function d(e){"string"!=typeof e&&(e=de.EMPTY_STRING);var d=e.length;if(e===de.EMPTY_STRING||e[0]===i[0]&&1===d)return i.split(de.EMPTY_STRING).concat([de.DIGITS_REGEX]).concat(s.split(de.EMPTY_STRING));if(e===n&&t.allowDecimal)return i.split(de.EMPTY_STRING).concat(["0",n,de.DIGITS_REGEX]).concat(s.split(de.EMPTY_STRING));var c=e.lastIndexOf(n),h=-1!==c,u=e[0]===t.symbols.negative&&t.allowNegative,p=void 0,g=void 0,f=void 0;if(e.slice(-1*o)===s&&(e=e.slice(0,-1*o)),h?(p=e.slice(e.slice(0,r)===i?r:0,c),g=he((g=e.slice(c+1,d)).replace(de.NON_DIGITS_REGEX,de.EMPTY_STRING))):p=e.slice(0,r)===i?e.slice(r):e,t.integerLimit&&"number"==typeof t.integerLimit){var m="."===a?"[.]":""+a,v=(p.match(new RegExp(m,"g"))||[]).length;p=p.slice(0,t.integerLimit+(u?1:0)+v*l)}p=p.replace(de.NON_DIGITS_REGEX,de.EMPTY_STRING),t.allowLeadingZeroes||(p=p.replace(/^0+(0$|[^0])/,"$1"));var b={maximumFractionDigits:t.decimalLimit,style:"decimal",useGrouping:!0};return f=he(p=t.allowThousandsSeparator?function(e,t,i,s){return""===e||isNaN(e)?e:k.toLocaleString(Number(e),i,s)}(p,0,t.locale,b):p),(h&&t.allowDecimal||!0===t.requireDecimal)&&(e[c-1]!==n&&f.push(de.CARET_TRAP),f.push(n,de.CARET_TRAP),g&&("number"==typeof t.decimalLimit&&(g=g.slice(0,t.decimalLimit)),f=f.concat(g)),!0===t.requireDecimal&&e[c-1]===n&&f.push(de.DIGITS_REGEX)),r>0&&(f=i.split(de.EMPTY_STRING).concat(f)),u&&(f.length===r&&f.push(de.DIGITS_REGEX),f=[/-/].concat(f)),s.length>0&&(f=f.concat(s.split(de.EMPTY_STRING))),f}return d.instanceOf="createNumberMask",d(e)};var pe={format:"M/d/yyyy",symbols:{timeSeparator:":",dayPeriodSeparator:" ",dateSeparator:"/"}},ge={dd:31,d:31,MMM:void 0,MM:12,M:12,yy:99,yyyy:9999,h:12,hh:12,H:24,HH:24,mm:60,ss:60,a:void 0};function fe(e){return this.configure(e),this}de.dateMask=function(e,t){t=m.mergeSettings(void 0,t,pe);var i=[],s=de.DIGITS_REGEX,n=t.format,a=w.removeDuplicates(n.replace(/[dMyHhmsa]+/g,"")),r=new RegExp("["+a+"]+"),o=n.split(/[^dMyHhmsa]+/),l=e.split(r),d=ge;return o.forEach(function(e,t){var a=d[e],r=void 0;if("a"===e)i.push(/[aApP]/,/[Mm]/);else if(a)if(l[t]){var c=l[t].toString(),h=parseInt(c.substr(0,1),10),u=parseInt(d[e].toString().substr(0,1),10);1===e.length&&h>u?i.push(s):"0"!==c&&1===c.length&&h<=u&&void 0!==l[t+1]&&"HH"!==e.toUpperCase()?i.push(s):i=i.concat(ue(a,"digits"))}else for(r=a.toString().length;r>0;)i.push(s),r-=1;else i=i.concat(ue(e,"alphas"));var p=o[t+1];if(void 0!==p){var g=e.toString().length,f=n.indexOf(e)+g,m=n.indexOf(p),v=n.substring(f,m).split(de.EMPTY_STRING);i=i.concat(v)}}),i},de.rangeDateMask=function(e,t){var i=e.split(t.delimeter),s=t.delimeter.split(""),n=de.dateMask(i[0],t),a=[];return i[1]&&(a=de.dateMask(i[1],t)),n.concat(s.concat(a))},de.autocorrectedDatePipe=function(e,t){t.dateFormat||(t.dateFormat=k.calendar().dateFormat.short);var i=[],s=t.dateFormat.split(/[^dMy]+/),n={d:31,M:12,yy:99,yyyy:9999},a={d:1,M:1,yy:0,yyyy:1},r=e.conformedValue.split("");s.forEach(function(e){var s=t.dateFormat.indexOf(e),a=parseInt(n[e].toString().substr(0,1),10);parseInt(r[s],10)>a&&(r[s+1]=r[s],r[s]=0,i.push(s))});var o=new RegExp("[^"+e.placeholderChar+"]"),l=e.placeholder.split(o),d=e.conformedValue.split(/\D/g);return!s.some(function(e,t){var i=l[t].length>e.length?l[t].length:e.length,s=d[t]||"",r=parseInt(s,10);return r>n[e]||s.length===i&&r<a[e]})&&{value:r.join(""),characterIndexes:i}},fe.prototype={configure:function(e){if(this.settings||(this.settings={}),!e)return this;if(e.locale&&(this.locale=e.locale),e.pattern)if(Array.isArray(e.pattern)||"function"==typeof e.pattern)this.pattern=e.pattern;else if("string"==typeof e.pattern){var t=m.mergeSettings(void 0,e.definitions||{},de.LEGACY_DEFS);this.pattern=this._convertPatternFromString(e.pattern,t)}return e.patternOptions&&(this.patternOptions=e.patternOptions),this},process:function(e,t){if("string"!=typeof e)throw new Error("No string provided");var i=void 0,s={originalValue:e,caretPos:t.selection.start,maskResult:!1};if("function"==typeof this.pattern){t.patternOptions||(t.patternOptions={});var n=m.extend({},this.patternOptions,t.patternOptions,{caretPos:t.selection.start,previousMaskResult:t.previousMaskResult});i=this.pattern(e,n);var a=this._processCaretTraps(i);i=a.maskWithoutCaretTraps,t.caretTrapIndexes=a.indexes}else i=this.pattern;if(!1===i)return s;try{s=this._conformToMask(e,i,t)}catch(e){return s}if("function"==typeof t.pipe){var r={};try{r=t.pipe(s,t)}catch(e){r=!1}!1===r?(s.pipeResult=!1,s.pipedValue=t.previousMaskResult):m.isString(r)?(s.pipeResult=!0,s.pipedValue=r,s.pipedCharIndexes=[]):s=m.extend({},s,{pipeResult:r.result,pipedValue:r.value,pipedCharIndexes:r.characterIndexes})}return s},_conformToMask:function(e,t,i){(i=m.mergeSettings(void 0,i,de.DEFAULT_CONFORM_OPTIONS)).placeholder=this._convertMaskToPlaceholder(t,i.placeholderChar);var s=!1,n=!1===i.guide&&void 0!==i.previousMaskResult,a=e.length,r=i.previousMaskResult.length,o=this.pattern.length,l=i.placeholder.length||0,d=i.placeholderChar,c=i.selection.start,h=de.EMPTY_STRING,u=a-r,p=u>0,g=c+(p?-u:0),f=g+Math.abs(u);if(!0===i.keepCharacterPositions&&!p){for(var v=de.EMPTY_STRING,b=g;b<f;b++)i.placeholder[b]===d&&(v+=d);e=e.slice(0,g)+v+e.slice(g,a)}for(var y=e.split(de.EMPTY_STRING).map(function(e,t){return{char:e,isNew:t>=g&&t<f}}),w=a-1;w>=0;w--){var x=y[w];if(x!==i.placeholderChar){var C=w>=g&&r===o;x===i.placeholder[C?w-u:w]&&y.splice(w,1)}}e:for(var k=0;k<l;k++){var $=i.placeholder[k];if($===d){if(y.length>0)for(;y.length>0;){var T=y.shift();if(T.char===d&&!0!==n){h+=d;continue e}if(t[k].test(T.char)){if(!0===i.keepCharacterPositions&&!1!==T.isNew&&i.previousMaskResult!==de.EMPTY_STRING&&!1!==i.guide&&p){for(var S=y.length,A=null,D=0;D<S;D++){var I=y[D];if(I.char!==d&&!1===I.isNew)break;if(I.char===d){A=D;break}}null!==A?(h+=T.char,y.splice(A,1)):k--}else h+=T.char;continue e}s=!0}!1===n&&(h+=i.placeholder.substr(k,l));break}h+=$}if(n&&!1===p){for(var E=null,L=0;L<h.length;L++)i.placeholder[L]===d&&(E=L);h=null!==E?h.substr(0,E+1):de.EMPTY_STRING}return{caretPos:c,caretTrapIndexes:i.caretTrapIndexes,conformedValue:h,charactersRejected:s,placeholder:i.placeholder,placeholderChar:d,maskResult:!0}},_processCaretTraps:function(e){for(var t=[],i=e.indexOf(de.CARET_TRAP);-1!==i;)t.push(i),e.splice(i,1),i=e.indexOf(de.CARET_TRAP);return{maskWithoutCaretTraps:e,indexes:t}},_convertMaskToPlaceholder:function(e,t){if(Array.isArray(e)||(e=[]),t||(t=de.PLACEHOLDER_CHAR),-1!==e.indexOf(t))throw new Error("Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\nThe placeholder character that was received is:"+JSON.stringify(t)+"\n\nThe mask that was received is: "+JSON.stringify(e));return e.map(function(e){return e instanceof RegExp?t:e}).join(de.EMPTY_STRING)},adjustCaretPosition:function(e){if(0===e.caretPos)return 0;function t(e){return e!==t}var i=e.rawValue.length,s=e.previousMaskResult.length,n=e.placeholder?e.placeholder.length:0,a=e.conformedValue?e.conformedValue.length:0,r=i-s,o=r>0;if(r>1&&!o&&!(0===s))return e.caretPos;var l=o&&(e.previousMaskResult===e.conformedValue||e.conformedValue===e.placeholder),d=0,c=void 0,h=void 0;if(l)d=e.caretPos-r;else{var u=e.conformedValue.toLowerCase(),p=e.rawValue.toLowerCase().substr(0,e.caretPos).split(de.EMPTY_STRING).filter(function(e){return-1!==u.indexOf(e)});h=p[p.length-1];var g=e.previousPlaceholder.substr(0,p.length).split(de.EMPTY_STRING).filter(t).length,f=e.placeholder.substr(0,p.length).split(de.EMPTY_STRING).filter(t).length!==g,m=void 0!==e.previousPlaceholder[p.length-1]&&void 0!==e.placeholder[p.length-2]&&e.previousPlaceholder[p.length-1]!==e.placeholderChar&&e.previousPlaceholder[p.length-1]!==e.placeholder[p.length-1]&&e.previousPlaceholder[p.length-1]===e.placeholder[p.length-2];!o&&(f||m)&&g>0&&e.placeholder.indexOf(h)>-1&&void 0!==e.rawValue[e.caretPos]&&(c=!0,h=e.rawValue[e.caretPos]);var v=[];e.indexesOfPipedChars&&(v=e.indexesOfPipedChars.map(function(e){return u[e]}));for(var b=v.filter(function(e){return e===h}).length,y=p.filter(function(e){return e===h}).length,w=e.placeholder.substr(0,e.placeholder.indexOf(e.placeholderChar)).split(de.EMPTY_STRING).filter(function(t,i){return t===h&&e.rawValue[i]!==t}).length+y+b+(c?1:0),x=0,C=0;C<a;C++){if(d=C+1,u[C]===h&&x++,x>=w)break}}if(o)for(var k=d,$=d;$<=n;$++){if(!e.placeholder)return k;if(e.placeholder[$]===e.placeholderChar&&(k=$),e.placeholder[$]===e.placeholderChar||-1!==e.caretTrapIndexes.indexOf($)||$===n)return k}else if(c){for(var T=d-1;T>=0;T--)if(e.conformedValue[T]===h||-1!==e.caretTrapIndexes.indexOf(T)||0===T)return T}else for(var S=d;S>=0;S--)if(e.placeholder[S-1]===e.placeholderChar||-1!==e.caretTrapIndexes.indexOf(S)||0===S)return S},_convertPatternFromString:function(e,t){var i,s,n=[],a=Object.keys(t);for(var r=0;r<e.length;r++)n.push((i=e[r],void 0,(s=a.indexOf(i))>-1&&(i=t[a[s]]),i));return n}};var me={definitions:void 0,guide:!1,keepCharacterPositions:!1,maskAPI:fe,locale:"",pattern:void 0,patternOptions:{},placeholderChar:"_",pipe:void 0,process:void 0,processOnBlur:!0,processOnInitialize:!0};function ve(e,t){return this.element=e,this.settings=m.mergeSettings(this.element,t,me),this.init()}ve.prototype={init:function(){this.setLocale()},build:function(){this._replaceLegacySettings();if("string"==typeof this.settings.process)switch(this.settings.patternOptions.locale||(this.settings.patternOptions.locale=this.settings.locale),this.settings.process){case"number":this.settings.pattern=de.numberMask,this.element.classList.add("is-number-mask");break;case"date":var e=$(this.element).data("datepicker");$.fn.datepicker&&$(this.element).data("datepicker")&&(this.settings.patternOptions||this.settings.patternOptions.format||(this.settings.patternOptions.format=e.settings.dateFormat)),this.settings.pattern=de.dateMask;break;case"rangeDate":var t=$(this.element).data("datepicker");$.fn.datepicker&&$(this.element).data("datepicker")&&(this.settings.patternOptions.format=t.settings.dateFormat),this.settings.pattern=de.rangeDateMask;break;default:this.element.classList.remove(["is-number-mask"].join(" "))}return this.mask=new this.settings.maskAPI(this.settings),this.state={previousMaskResult:""},this.handleEvents(),this.settings.processOnInitialize&&this.process(),this},setLocale:function(){var e=this;this.locale=k.currentLocale,this.settings.locale?k.getLocale(this.settings.locale).done(function(t){e.locale=k.cultures[t],e.build()}):this.build()},handleEvents:function(){var e=this;return this.focusEventHandler=function(){e.state.initialValue=e.element.value},this.element.addEventListener("focus",this.focusEventHandler),this.inputEventHandler=function(){return e.process()},this.element.addEventListener("input",this.inputEventHandler),this.blurEventHandler=function(t){if(e.settings.processOnBlur){if(e.element.readOnly)return t.preventDefault(),!1;e._hasChangedValue()&&e._isEdgeIE()&&$(e.element).trigger("change")}return delete e.state.initialValue,e.process()},this.element.addEventListener("blur",this.blurEventHandler),this},process:function(){if(!this.settings.pattern)return!0;var e=this.mask;e.pattern||e.configure({pattern:this.settings.pattern,patternOptions:this.settings.patternOptions});var t=this.element.value;if(t===this.state.previousMaskResult)return!1;var i=this.element.selectionStart,s=this.element.selectionEnd;this._isAndroid()&&""===this.state.previousMaskResult&&i!==s&&(m.safeSetSelection(t.length,t.length),i=t.length,s=t.length),t=this._getSafeRawValue(t);var n={guide:this.settings.guide,keepCharacterPositions:this.settings.keepCharacterPositions,patternOptions:this.settings.patternOptions,placeholderChar:this.settings.placeholderChar,previousMaskResult:this.state.previousMaskResult,selection:{start:i,end:s}};i!==s&&(n.selection.contents=t.substring(i,s)),"function"==typeof this.settings.pipe&&(n.pipe=this.settings.pipe);var a=e.process(t,n);if(!a.maskResult)return a.maskResult;var r=a.pipedValue?a.pipedValue:a.conformedValue,o=this.settings.patternOptions;""!==r&&o&&o.suffix&&r.indexOf(o.suffix)<0&&(r+=this.settings.patternOptions.suffix);var l={previousMaskResult:this.state.previousMaskResult||"",previousPlaceholder:this.state.previousPlaceholder||"",conformedValue:r,placeholder:a.placeholder,rawValue:t,caretPos:a.caretPos,placeholderChar:this.settings.placeholderChar};a.pipedCharIndexes&&(l.indexesOfPipedChars=a.pipedCharIndexes),a.caretTrapIndexes&&(l.caretTrapIndexes=a.caretTrapIndexes),a.caretPos=e.adjustCaretPosition(l);var d=this.state.previousMaskResult;return this.state.previousMaskResult=r,this.state.previousPlaceholder=a.placeholder,this.element.value=r,m.safeSetSelection(this.element,a.caretPos),d===r&&($(this.element).trigger("write.mask",[r]),a.maskResult)},_isAndroid:function(){return"android"===(l&&l.os&&l.os.name?l.os.name:"")},_isEdgeIE:function(){var e=l&&l.browser&&l.browser.name?l.browser.name:"";return"ie"===e||"edge"===e},_hasChangedValue:function(){return!this.state||!this.state.previousMaskResult||this.state.previousMaskResult!==this.state.initialValue},_getSafeRawValue:function(e){if(m.isString(e))return e;if(m.isNumber(e))return String(e);if(null==e)return"";throw new Error('The "value" provided to the Masked Input needs to be a string or a number. The value received was:\n\n'+JSON.stringify(e))},_replaceLegacySettings:function(){var e=["group","number","date","time"];this.settings.patternOptions=this.settings.patternOptions||{},this.settings.patternOptions.symbols=this.settings.patternOptions.symbols||{};var t=this.element.getAttribute("data-mask")||!1;"string"==typeof t&&t.length&&(this.settings.pattern=t);var i=this.element.getAttribute("data-mask-mode")||!1;if(i&&e.indexOf(i)>-1&&(this.settings.mode=i),this.settings.mode&&(-1===e.indexOf(this.settings.mode)&&delete this.settings.mode,"group"===this.settings.mode?this.settings.process=void 0:"date"===this.settings.mode?this.settings.process="date":this.settings.process=this.settings.mode,delete this.settings.mode),"number"===this.settings.process){this.settings.thousandsSeparator&&(this.settings.patternOptions.allowThousandsSeparator=this.settings.thousandsSeparator,delete this.settings.thousandsSeparator);var s=this.element.getAttribute("data-thousands")||!1;if(s&&(this.settings.patternOptions.allowThousandsSeparator="true"===s),"string"==typeof this.settings.pattern){var n=-1!==this.settings.pattern.indexOf("-");n&&(this.settings.patternOptions.allowNegative=n,this.settings.patternOptions.symbols.negative="-");var a=k.currentLocale.data.numbers?k.currentLocale.data.numbers.group:",",r=this.settings.patternOptions&&this.settings.patternOptions.symbols&&this.settings.patternOptions.symbols.thousands?this.settings.patternOptions.symbols.thousands:a,o=-1!==this.settings.pattern.indexOf(r);this.settings.patternOptions.allowThousandsSeparator=o,o&&(this.settings.patternOptions.symbols.thousands=r);var l="string"==typeof this.settings.patternOptions.symbols.decimal?this.settings.patternOptions.symbols.decimal:".",d=this.settings.pattern.split(l);this.settings.patternOptions.integerLimit=d[0].replace(/[^#0]/g,"").length,d[1]&&(this.settings.patternOptions.allowDecimal=!0,this.settings.patternOptions.decimalLimit=d[1].toString().replace(/[^#0]/g,"").length,this.settings.patternOptions.symbols.decimal||(this.settings.patternOptions.symbols.decimal=l))}}var c=this.element.getAttribute("data-must-complete")||!1;c&&(this.settings.mustComplete=c),this.element.getAttribute("data-show-currency")&&(this.settings.showSymbol="currency");var h,u=this.settings.showSymbol,p=void 0;if(["currency","percent"].indexOf(u)>-1){p="currency"===(h=this.settings.showSymbol)?{char:k.currentLocale.data.currencySign,format:k.currentLocale.data.currencyFormat}:"percent"===h?{char:k.currentLocale.data.numbers.percentSign,format:k.currentLocale.data.numbers.percentFormat}:{};var g="currency"===u?"¤":p.char,f=new RegExp(g,"g").exec(p.format),m=void 0,v=void 0,b=-1,y=void 0;if(f&&f.length){if(0===(b=p.format.indexOf(f[0])))y="prefix",m=new RegExp("[^"+g+"]\\S","g"),v=p.format.replace(m,"");else if(b>0){for(y="suffix",m=new RegExp("\\S[^"+g+"]","g");/\s/.test(p.format.charAt(b-1));)--b;v=p.format.substr(b).replace(m,"")}"currency"===u&&(v=v.replace("¤",p.char)),this.settings.patternOptions[y]=v}}},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown().init()},teardown:function(){return this.element.removeEventListener("focus",this.focusEventHandler),delete this.focusEventHandler,this.element.removeEventListener("input",this.inputEventHandler),delete this.inputEventHandler,this.blurEventHandler&&(this.element.removeEventListener("blur",this.blurEventHandler),delete this.blurEventHandler),this}},$.fn.maskinput=function(e){return this.each(function(){var t=$.data(this,"mask");t?t.updated(e):(t=$.data(this,"mask",new ve(this,e))).destroy=function(){this.teardown(),$.removeData(this.element,"mask")}})},$.fn.maskedinput=$.fn.maskinput,$.fn.mask=$.fn.maskinput;var be={menu:null,trigger:"click",autoFocus:!0,mouseFocus:!0,attachToBody:!1,removeOnDestroy:!1,beforeOpen:null,ariaListbox:!1,eventObj:void 0,returnFocus:!0,showArrow:null,triggerSelect:!0,placementOpts:new te({containerOffsetX:10,containerOffsetY:"ios"===l.os.name?25:15,strategies:["flip","shrink"]}),offset:{x:0,y:0},predefined:$(),duplicateMenu:null};function ye(e,t){this.settings=m.mergeSettings(e,t,be),this.element=$(e),this.init()}ye.prototype={init:function(){this.isFirefox="firefox"===l.browser.name,this.setup(),this.addMarkup(),this.handleEvents(),this.iconFilteringSetup(),"immediate"===this.settings.trigger&&this.open(this.settings.eventObj),this.menu.find(".submenu").length&&this.menu.addClass("has-submenu")},isRTL:function(){return l.rtl},get isOpen(){return n.hasClass(this.element[0],"is-open")},setup:function(){this.element.attr("data-popupmenu")&&!this.settings.menu&&(this.settings.menu=this.element.attr("data-popupmenu").replace(/#/g,"")),this.settings.menuId&&(this.settings.menu=this.settings.menuId,this.settings.menuId=void 0),this.id||(this.id=(parseInt($(".popupmenu-wrapper").length,10)+1).toString()),this.predefinedItems=$().add(this.settings.predefined)},setMenuOrgContainment:function(e){if(e&&e.length){var t=e.parent();t.is("body")||(this.menuOrgContainment={parent:t,index:t.children().index(e)})}},insertAtContainment:function(e,t){var i=function(e){return e&&e.length};if(t=t||this.menuOrgContainment||{},i(e)&&i(t.parent)){var s=t.index,n=t.parent,a=n.children().length;s<0&&(s=Math.max(0,a+1+s)),s<a?n.children().eq(s).before(e):n.append(e)}},addMarkup:function(){var e=void 0,t=void 0,i=void 0;if(!this.menu||!this.menu.length)switch(u(this.settings.menu)){case"string":e=this.settings.menu,this.menu=$("#"+this.settings.menu),this.settings.duplicateMenu&&this.settings.attachToBody&&this.menu.parent().not("body").length>0&&(this.menu.data("trigger",this.element),i=this.menu.data("trigger")[0].id,t=this.menu.clone(),this.setMenuOrgContainment(t),t.detach().appendTo("body"),t.attr("data-trigger",i),this.menu.attr("data-trigger",i));break;case"object":null===this.settings.menu?this.menu=this.element.next(".popupmenu, .popupmenu-wrapper"):this.menu=$(this.settings.menu),(e=this.menu.attr("id"))&&""!==e||(this.menu.attr("id","popupmenu-"+this.id),e=this.menu.attr("id"))}if(this.menu.is(".popupmenu-wrapper")&&(this.preExistingWrapper=!0,this.wrapper=this.menu,this.menu=this.wrapper.children(".popupmenu").first()),this.menu.parent().is(".popupmenu-wrapper")&&(this.preExistingWrapper=!0,this.wrapper=this.menu.parent()),0!==this.menu.length){this.settings.attachToBody&&this.menu.parent().not("body").length>0&&(this.originalParent=this.menu.prev(),this.setMenuOrgContainment(this.menu),this.menu.detach().appendTo("body"),this.settings.duplicateMenu&&this.menu.attr("id",this.settings.menu+"-original")),this.menu.is(".popupmenu")||this.menu.addClass("popupmenu").attr("role",this.settings.ariaListbox?"listbox":"menu"),this.menu.data("trigger",this.element),this.wrapper=this.menu.parent(".popupmenu-wrapper"),this.wrapper.length||(this.wrapper=this.menu.wrap('<div class="popupmenu-wrapper"></div>')),this.wrapper.find("svg").each(function(){$(this).data("icon")||$(this).icon()}),0===this.wrapper.parents().filter(function(){var e=this?this.style.overflow:null;return"auto"!==e&&"visible"!==e&&"scroll"!==e}).length&&(this.wrapper[0].style.position="absolute"),this.menu.find(".popupmenu").each(function(e,t){var i=$(t);i.parent().hasClass("wrapper")||i.wrap('<div class="wrapper"></div>')});var s=this.element.parent().attr("class");if(this.element.hasClass("btn-menu")||this.element.hasClass("btn-actions")||this.element.hasClass("btn-icon")&&"#icon-more"===this.element.find("use").attr("xlink:href")||"colorpicker-menu"===this.settings.menu||this.element.closest(".toolbar").length>0||this.element.closest(".masthead").length>0||this.element.is(".searchfield-category-button")||s&&s.indexOf("more")>=0||s&&s.indexOf("btn-group")>=0||this.settings.showArrow){var n=$('<div class="arrow"></div>'),a=this.menu.parent(".popupmenu-wrapper");0===a.find(".arrow").length&&a.addClass("bottom").append(n)}var r=this.element.closest(".field-short").length;this.menu[r?"addClass":"removeClass"]("popupmenu-short"),void 0!==s&&this.element.closest(".masthead").not(".search-results .masthead").length>0&&this.menu.parent(".popupmenu-wrapper").addClass("inverse"),this.element.attr("aria-haspopup",!0),this.element.attr("aria-controls",e),this.markupItems(),this.menu.is(".hidden")&&this.menu.removeClass("hidden")}},renderItem:function(e){if(void 0===e)return"";var t=this;function i(e){var i="";return e.forEach(function(e){i+=t.renderItem(e)}),i}if(Array.isArray(e)){var s='<ul class="popupmenu">'+i(e)+"</ul>";return w.stripWhitespace(s)}var n="",a="";if(void 0!==e.separator)return e.heading&&(n+='<li class="heading">'+e.heading+"</li>"),"single"!==e.nextSectionSelect&&"multiple"!==e.nextSectionSelect||(a=" "+e.nextSectionSelect),w.stripWhitespace('\n        <li class="separator'+a+'"></li>\n        '+n+"\n      ");if(e.menu){var r="";e.menuId&&(r=' id="'+e.menuId+'"');var o="";e.hasIcons&&(o+=" has-icons");var l="";return Array.isArray(e.menu)&&(l=i(e.menu)),e.noMenuWrap?l:w.stripWhitespace("\n        <ul"+r+' class="popupmenu'+o+'">\n          '+l+"\n        </ul>\n      ")}var d="",c="",h="",u="",p="",g="",f="",m="";return e.disabled&&(d+=" is-disabled"),!1===e.visible&&(c+=" hidden"),e.id&&(u=' id="'+e.id+'"'),"single"===e.selectable&&(p+=" is-selectable"),"multiple"===e.selectable&&(p+=" is-multiselectable"),e.icon&&(h='<svg class="icon" focusable="false" aria-hidden="true" role="presentation">\n        <use xlink:href="#icon-'+e.icon+'"></use>\n      </svg>'),Array.isArray(e.submenu)&&(g+=" submenu",f+=this.renderItem(e.submenu),m+='<svg class="arrow icon-dropdown icon" focusable="false" aria-hidden="true" role="presentation">\n        <use xlink:href="#icon-dropdown"></use>\n      </svg>'),w.stripWhitespace('<li class="popupmenu-item'+d+c+p+g+'">\n      <a'+u+' href="#">'+h+"<span>"+e.text+"</span>\n        "+m+"\n      </a>\n      "+f+"\n    </li>")},toData:function(e){var t={},i=[];(e=e||{}).contextElement||(e.contextElement=this.menu),e.contextElement instanceof HTMLElement&&(e.contextElement=$(e.contextElement)),e.contextElement.is(".popupmenu-wrapper")&&(e.contextElement=e.contextElement.children("ul"));var s=e.contextElement.attr("id");s&&s.length&&(t.menuId=""+s);var n=e.contextElement.hasClass("has-icons");return t.hasIcons=n,e.noMenuWrap?t=i:t.menu=i,e.contextElement.children("li").each(function(e,t){var s=function e(t){var i=$(t),s={};if(!i.hasClass("heading")){if(i.hasClass("separator")){s.separator=!0,i.hasClass("single-selectable-section")&&(s.nextSectionSelect="single"),i.hasClass("multi-selectable-section")&&(s.nextSectionSelect="multiple");var n=i.next();return n.hasClass("heading")&&(s.heading=n.text().trim()),s}var a=i.children("a"),r=a.children(".icon:not(.close):not(.icon-dropdown)"),o=a.attr("id");s.text=a.text().trim(),s.disabled=i.hasClass("is-disabled"),s.visible=!i.hasClass("hidden"),"string"==typeof o&&o.length&&(s.id=o),r.length&&r[0]instanceof SVGElement&&(s.icon=r[0].querySelector("use").getAttribute("xlink:href").replace("#icon-","")),i.hasClass("is-selectable")?s.selectable="single":i.hasClass("is-multiselectable")&&(s.selectable="multiple");var l=i.find(".popupmenu");return l.length&&(s.submenu=[],l.first().children().each(function(t,i){var n=e(i);n&&s.submenu.push(n)})),s}}(t);s&&i.push(s)}),t},markupItems:function(e){var t=this;e?e instanceof HTMLElement&&(e=$(e)):e=this.menu;var i=e.find("li:not(.heading):not(.separator)"),s=!1;e[0].setAttribute("role","menu"),i.each(function(e,i){var a=$(i).children("a")[0],r=$(a).children("span")[0],o=$(i).children("ul")[0],l=$(i).find(".icon:not(.close):not(.icon-dropdown)"),d=$(i).children(".wrapper")[0];if(i.setAttribute("role",t.settings.ariaListbox?"option":"menuitem"),a){a.setAttribute("tabindex","-1");var c=$(a),h=$(i);h.hasClass("is-disabled")||"true"===a.getAttribute("disabled")||"disabled"===a.getAttribute("disabled")?(h.addClass("is-disabled"),a.setAttribute("aria-disabled","true"),a.setAttribute("disabled",!0)):(h.removeClass("is-disabled"),c.removeAttr("aria-disabled"),a.removeAttribute("disabled")),o instanceof HTMLElement&&o.classList.add("popupmenu"),d instanceof HTMLElement&&(i.className+=(n.classNameExists(i)?" ":"")+"submenu",(o=$(d).children("ul")[0])instanceof HTMLElement&&o.classList.add("popupmenu")),n.hasClass(i,"submenu")&&(r||(a.innerHTML="<span>"+a.innerHTML+"</span>",r=c.children("span")[0]),0===c.find("svg.arrow").length&&c.append($.createIconElement({classes:["arrow","icon-dropdown"],icon:"dropdown"})),a.setAttribute("aria-haspopup","true")),n.hasClass(i,"is-checked")&&(a.setAttribute("role","menuitemcheckbox"),a.setAttribute("aria-checked",!0)),n.hasClass(i,"is-not-checked")&&(i.className=i.className.replace("is-not-checked",""),a.setAttribute("role","menuitemcheckbox"),a.removeAttribute("aria-checked"))}l&&l.length>0&&(s=!0)}),s?e.addClass("has-icons"):e.removeClass("has-icons")},refreshMenuItem:function(e,t,i){if(e&&e instanceof HTMLElement&&t&&$(this.menu)[0].contains(e)){var s=e.querySelector("a"),n=e.querySelector(".icon:not(.close):not(.icon-dropdown)"),a=void 0;if(t.text&&s.innerText.trim()!==t.text&&(s.innerText=""+t.text),!0===t.disabled?-1===e.className.indexOf("hidden")&&e.classList.add("is-disabled"):e.className.indexOf("is-disabled")>-1&&e.classList.remove("is-disabled"),!0===t.visible?e.className.indexOf("hidden")>-1&&e.classList.remove("hidden"):-1===e.className.indexOf("hidden")&&e.classList.add("visible"),t.icon?n&&((a=n.querySelector("use"))&&a.getAttribute("xlink:href").replace("#icon-","")!==t.icon&&n.remove(),a.setAttribute("xlink:href","#icon-"+t.icon)):n&&n.remove(),t.submenu){e.classList.add("submenu");var r=e.querySelector(".popupmenu");if(r)for(var o=r.children,l=0;l<t.submenu.length;l++)t.submenu[l].isSubmenuItem=!0,this.refreshMenuItem(o.item(l),t.submenu[l],i)}"function"==typeof i&&i.apply(this,[e,t])}},handleEvents:function(){var e=this,t="rightClick"!==this.settings.trigger;function i(e){return e.stopPropagation(),e.preventDefault(),!1}function s(t,i){if(t.preventDefault(),e.keydownThenClick)delete e.keydownThenClick;else{var s=!0===i?0:2;if(!(t.button>s||e.element.is(":disabled"))){["android","ios"].indexOf(l.os.name)>-1&&(e.holdingDownClick=!0),function(t){if(e.element.hasClass("is-disabled"))return t.stopPropagation(),void t.preventDefault();var i="rightClick"===e.settings.trigger;if(t.stopPropagation(),t.preventDefault(),i&&e.menu.hasClass("is-open"))return e.close(),void e.open(t);e.menu.add(e.element).hasClass("is-open")?e.close():e.open(t)}(t)}}}if(!("immediate"===this.settings.trigger)&&(t&&this.element.on("click.popupmenu",function(e){s(e,!0)}),!t)){this.menu.parent().on("contextmenu.popupmenu",i);-1===["android","ios"].indexOf(l.os.name)?this.element.on("contextmenu.popupmenu",function(e){i(e),s(e)}):this.element.on("touchstart.popupmenu",function(e){"ios"===l.os.name&&e.preventDefault(),$(e.target).addClass("longpress-target")}).on("touchend.popupmenu",function(e){$(e.target).removeClass("longpress-target")}).on("longpress.popupmenu",function(t,i){e.openedWithTouch=!0,s(i)})}this.menu.off("dragstart.popupmenu").on("dragstart.popupmenu","a",function(){return!1}),this.element.not(".autocomplete, ul").on("keydown.popupmenu",function(t){switch(t.which){case 13:case 32:"click"===e.settings.trigger&&(e.keydownThenClick=!0,e.open(t));break;case 121:t.shiftKey&&e.open(t)}}).on("updated.popupmenu",function(t,i){t.stopPropagation(),e.updated(i)})},handleKeys:function(){var e=this;this.menu.on("click.popupmenu","li",function(t){var i=$(this).find("a");e.handleItemClick(t,i)});var t="li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled):not(.is-placeholder)";this.settings.mouseFocus&&this.menu.on("mouseenter.popupmenu","li",function(){e.highlight($(this).children("a"))}),setTimeout(function(){$(document).off("keydown.popupmenu."+this.id).on("keydown.popupmenu."+this.id,function(i){var s=i.which;if(27===s)return i.stopPropagation(),i.stopImmediatePropagation(),e.close(!0),!1;if(9===s&&(i.stopPropagation(),e.close(!0)),32===s){i.stopPropagation();var n=$(i.target),a=n.find("input:checkbox");if(a.length)return a.trigger("click"),!0;var r=$();if(n.is(".tab")||n.parent().is(".tab")||n.is(".tab-more"))return i.preventDefault(),!0;if(n.is("li")&&(r=n.children("a")),n.is("a")&&(r=n),r.length)return r.trigger("click"),!0}var o=e.menu.find(":focus");o[0]||(o=$(e.menu[0].querySelector(".is-focused a")));var l="colorpicker-menu"===e.settings.menu,d=e.element.is(".autocomplete");37!==s||d||(i.stopPropagation(),i.preventDefault(),o.closest(".popupmenu")[0]!==e.menu[0]&&o.closest(".popupmenu").length>0&&(o.closest(".popupmenu").removeClass("is-open").parent().parent().removeClass("is-submenu-open"),e.highlight(o.closest(".popupmenu").parent().prev("a"))));var c,h,u=void 0,p=void 0;c=function(e){var i=e.parent().prevAll(t),s=void 0;return i.each(function(){if(!s){var e=$(this),t=e.children("a");e.is(".is-disabled")||!0===t.prop("disabled")||(s=t)}}),s||p(e)},p=function(e){var i=e.parent().prevAll(t).last(),s=i.children("a");return i.is(".is-disabled")||!0===s.prop("disabled")?u(s):s},u=function(e){var i=e.parent().nextAll(t),s=void 0;return i.each(function(){if(!s){var e=$(this),t=e.children("a");e.is(".is-disabled")||!0===t.prop("disabled")||(s=t)}}),s||p(e)},h=function(e){var i=e.parent().nextAll(t).last(),s=i.children("a");return i.is(".is-disabled")||!0===s.prop("disabled")?c(s):s};for(var g=0,f=e.menu.children(t),m=f.length,v=0,b=0;b<m;b++){var y=f[b];if(0===v&&(v=y.offsetTop),y.offsetTop!==v)break;g++}if(!l&&38===s||l&&s===(k.isRTL()?39:37)){if(i.stopPropagation(),i.preventDefault(),0===o.parent().prevAll(t).length)return void(0===o.length?e.highlight(e.menu.children(t).last().find("a")):e.highlight(h(o)));e.highlight(c(o))}if(l&&38===s&&(i.stopPropagation(),i.preventDefault(),o.parent().prevAll(t).length>0&&e.highlight($(o.parent().prevAll(t)[g-1]).find("a"))),39!==s||d||(i.stopPropagation(),i.preventDefault(),o.parent().hasClass("submenu")&&(e.openSubmenu(o.parent()),e.highlight(o.parent().find(".popupmenu a:first")))),!l&&40===s||l&&s===(k.isRTL()?37:39)&&!d){if(i.stopPropagation(),i.preventDefault(),0===o.parent().nextAll(t).length)return void(0===o.length?e.highlight(e.menu.children(t).first().find("a")):e.highlight(p(o)));e.highlight(u(o))}if(l&&40===s&&(i.stopPropagation(),i.preventDefault(),o.parent().nextAll(t).length>0&&e.highlight($(o.parent().nextAll(t)[g-1]).find("a"))),e.isFirefox&&d&&!/37|39|38|40/.test(s)){e.element.triggerHandler(i),e.element[0].focus();var w=e.element[0].value;e.element[0].value="",e.element[0].value=w}})},1)},handleItemClick:function(e,t){var i=t.attr("href"),s=[t];return!(!e&&!t)&&(t.parent().is(".submenu, .hidden, .is-disabled")||t[0].disabled?(e.preventDefault(),!1):!(t.find("input[checkbox]").length>0)&&(this.element.hasClass("btn-filter")&&(this.iconFilteringUpdate(t),e.preventDefault()),(this.isInSelectableSection(t)||this.menu.hasClass("is-selectable")||this.menu.hasClass("is-multiselectable"))&&(s=this.select(t)),t.parent().hasClass("is-toggleable")&&t.parent().toggleClass("is-checked"),e&&this.settings.triggerSelect&&(1===s.length&&s.push(void 0),s.push(!0),this.element.triggerHandler("selected",s)),!(!this.menu.hasClass("is-multiselectable")&&!this.isInMultiselectSection(t))||(this.close(),!!this.element.is(".autocomplete")||(i&&"#"!==i.charAt(0)?("_blank"===t.attr("target")?window.open(i,"_blank"):window.location.href=i,!0):(e&&(e.preventDefault(),e.stopPropagation()),!0)))))},iconFilteringSetup:function(e){if(this.element.hasClass("btn-filter")){var t=this.element.find("svg.icon-dropdown"),i=e||$("li.is-checked a",this.menu)||$("li:first a",this.menu),s=i.find("span").text();1===t.length&&this.element.append($.createIconElement({classes:"icon-dropdown",icon:"dropdown"})),t.first().changeIcon(i.find("svg").getIconName()),this.element.find(".audible").text(s)}},iconFilteringUpdate:function(e){if(this.element.hasClass("btn-filter")){var t=e||$("li.is-checked a",this.menu)||$("li:first a",this.menu),i=t.find("span").text();this.element.find(".audible").text(i),this.element.find("svg:not(.ripple-effect):first").changeIcon(t.find("svg").getIconName())}},getPositionFromEvent:function(e){var t=0,i=0;if(e||(e=window.event),!e)return{};if(e.changedTouches){var s=e.changedTouches[0];t=s.pageX,i=s.pageY}else e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:t,y:i}},position:function(e){var t=this,i=this.element,s=this.isRTL(),n=this.menu.parent(".popupmenu-wrapper"),a=this.getPositionFromEvent(e),r=this.menu[0].offsetWidth;this.menu[0].offsetHeight;if(n.length){var o=this.element[0].offsetWidth;"click"===this.settings.trigger&&o>r&&this.menu.width(o),i.is("svg, .icon")&&i.closest(".tab").length&&(i=i.closest(".tab")),n.find(".arrow").removeAttr("style");var l=$.extend({},this.settings.placementOpts),d=["flip"];d.push("shrink-y"),l.strategies=d,"immediate"===this.settings.trigger&&this.settings.eventObj||"rightClick"===this.settings.trigger?(l.x=m(0,"x")-(s?r:0)+(s?-1:1)*this.settings.offset.x,l.y=m(0,"y")+this.settings.offset.y,0===l.x&&0===l.y&&(l.x=this.settings.offset.x||0,l.y=this.settings.offset.y||0,l.parent=this.element,l.placement="bottom",l.parentXAlignment=s?"right":"left")):(l.x=this.settings.offset.x||0,l.y=this.settings.offset.y||0,l.parent=this.element,l.placement="bottom",l.strategies.push("nudge"));var c=i.parents(".toolbar"),h=c.length>0,u=i.parents(".title").length>0,p=h&&c.children(".buttonset, .title").length>1,g=i.parents(".pager-pagesize").length>0;i.is(".btn-menu")?g?b():h&&p?u?v():b():v():i.is(".btn-actions")?b():i.is(".tab-more")?b():i.is(".btn-split-menu, .tab, .searchfield-category-button")&&!i.parent(".pager-pagesize").length&&v(),i.parents(".masthead").length>0&&(l.y+=15);var f=this.element.parents(".page-container:not(.tab-container)");f.length&&(l.container=f.first()),n.one("afterplace.popupmenu",function(e,i){t.handleAfterPlace(e,i)}),this.wrapperPlace=new ie(n,l),this.wrapperPlace.place(l)}function m(e,t){return a[t="x"===t||"y"===t?t:"x"]}function v(){l.parentXAlignment=s?"right":"left"}function b(){l.parentXAlignment=s?"left":"right"}},handleAfterPlace:function(e,t){var i=this.menu.parent(".popupmenu-wrapper");return this.wrapperPlace.setArrowPosition(e,t,i),t.height&&(i[0].style.height="",this.menu[0].style.height=t.height+(/(px|%)/i.test(""+t.height)?"":"px")),t.width&&(i[0].style.width="",this.menu[0].style.width=t.width+(/(px|%)/i.test(""+t.width)?"":"px")),i.triggerHandler("popupmenuafterplace",[t]),t},callSource:function(e,t,i,s){if("function"==typeof this.settings.beforeOpen){var a=this,r=this.menu;if(!(n.isElement(i)&&$(i).is(".popupmenu, .submenu")&&(r=$(i),i.hasClass("is-open")))){var o=function(i){if(r.children().filter(function(e,t){return-1===a.predefinedItems.index(t)}).off().remove(),!1===i)return!1;var s=$(i);r.append(s);var n=r.parent(".wrapper, .popupmenu-wrapper");return n.length||(n=r.wrap('<div class="wrapper">').parent()),n.removeAttr("style"),a.markupItems(r),t&&(r.is(a.menu)?a.open(e,!0):a.openSubmenu(n.parent("li"),!0)),!0},l={};r.is(this.menu)||(l.contextElement=r),l.element=this.element,l.isSubmenu=s,"string"!=typeof this.settings.beforeOpen?this.settings.beforeOpen(o,l):window[this.settings.beforeOpen](o,l)}}},open:function(e,t,i){var s=this;if(this.menu&&this.menu.length){if((this.element.hasClass("autocomplete")||!1!==this.element.triggerHandler("beforeopen",[this.menu]))&&(t||(this.callSource(e,!0),!this.settings.beforeOpen)))if(i||"ios"!==l.os.name){$(".popupmenu.is-open").filter(function(){return 0===$(this).parents(".popupmenu").length}).not(this.menu).each(function(){var e=$(this).data("trigger");if(e&&e.length){var t=$(this).data("trigger").data("popupmenu");t&&"function"==typeof t.close&&t.close()}});var n=this.element.data("tooltip");n&&n.visible&&n.hide();var a=$(".dropdown.is-open");if(a.length>0){var r=a.parent().prev().data("dropdown");r&&r.closeList("cancel")}this.element.addClass("is-open"),this.menu.addClass("is-open").attr("aria-hidden","false"),this.element.hasClass("inverse")&&this.menu.parent(".popupmenu-wrapper").addClass("inverse"),this.position(e),m.fixSVGIcons(this.menu),this.element.closest(".header").length>0&&(this.menu.parent()[0].style.zIndex="9001"),this.menu.find("a").each(function(){var e=$(this),t=e.parent();t.hasClass("is-disabled")?(t.addClass("is-disabled"),e.attr("aria-disabled","true"),e.attr("disabled","disabled")):(t.removeClass("is-disabled"),e.removeAttr("aria-disabled"),e.removeAttr("disabled"))}),setTimeout(function(){$(document).on("touchend.popupmenu."+s.id+" click.popupmenu."+s.id,function(e){var t="colorpicker-menu"===s.settings.menu;2!==e.button&&(s.holdingDownClick?delete s.holdingDownClick:$(e.target).is(s.element)&&!t&&"rightClick"!==s.settings.trigger||(0===$(e.target).closest(".popupmenu").length&&s.close(!0,"rightClick"===s.settings.trigger),$(e.target).hasClass("colorpicker")&&s.close()))}),void 0===window.orientation&&$("body").on("resize.popupmenu",function(){s.handleCloseEvent()}),$(window).on("scroll.popupmenu",function(){s.close()}),$(".scrollable, .modal.is-visible .modal-body-wrapper").on("scroll.popupmenu",function(){s.close()}),s.element.triggerHandler("open",[s.menu])},300),$("iframe").each(function(){var e=$(this);e.ready(function(){try{e.contents().find("body").on("click.popupmenu",function(){s.close()})}catch(e){}})}),this.handleKeys();var o=0,d=void 0,c=void 0,h=void 0;s.menu.find(".popupmenu").removeClass("is-open"),s.menu.on("mouseenter.popupmenu touchend.popupmenu",".submenu:not(.is-disabled)",function(e){var t=$(this);d=e.pageX,clearTimeout(h),h=setTimeout(function(){s.openSubmenu(t)},300),$(document).on("mousemove.popupmenu."+this.id,function(e){o=e.pageX})}).on("mouseleave.popupmenu",".submenu",function(){$(document).off("mousemove.popupmenu."+this.id);var e=((c=$(this).find("ul")).parent(".wrapper").length>0?parseInt(c.parent(".wrapper")[0].style.left,10):0)<0,t=o-d<3.5;e&&(t=o-d>=0),t&&(c.removeClass("is-open").removeAttr("style"),c.parent(".wrapper").removeAttr("style"),c.parent().parent().removeClass("is-submenu-open"),c=null),clearTimeout(h)}),s.settings.autoFocus&&setTimeout(function(){var e=":not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)",t=s.menu.children(e).find(".is-selected").children("a");t.length||(t=s.menu.children(e).first().children("a")),s.highlight(t),s.element.triggerHandler("afteropen",[s.menu])},1)}else setTimeout(function(){s.open(e,t,!0)},400)}},handleCloseEvent:function(){this.holdingDownClick||this.close()},openSubmenu:function(e,t){if(!n.hasClass(e,"is-disabled")&&!e[0].disabled){var i=e.children(".wrapper, .popupmenu");i.length&&i.is(".wrapper")&&(i=i.children(".popupmenu"));var s=this.element.triggerHandler("beforeopen",[i]);!1!==s&&(!t&&(s=this.callSource(null,!0,i,!0),this.settings.beforeOpen)||this.showSubmenu(e))}},showSubmenu:function(e){this.element.triggerHandler("show-submenu",[e]);var t=e.children(".wrapper").filter(":first"),i=this.isRTL();if(0===t.length){var s=e.children("ul").filter(":first");s.wrap('<div class="wrapper"></div>'),t=s.parent()}var n,a=t.children(".popupmenu"),r=e.position().left+e.outerWidth();e.parent().find(".popupmenu").removeClass("is-open").removeAttr("style"),t.children(".popupmenu").addClass("is-open"),n=t.outerWidth(),i&&(r=e.position().left-n),t[0].style.left=r+"px",t[0].style.top=parseInt(e.position().top,10)-5+"px";var o=a.outerWidth();if(t.offset().left+o>$(window).width()+$(document).scrollLeft()||i&&t.offset().left<0){if(t[0].style.left="-9999px",o=a.outerWidth(),r=e.position().left-o,i)r=t.closest(".popupmenu").outerWidth()-4;if(t[0].style.left=r+"px",(t.offset().left<0||i&&t.offset().left+o>$(window).width()+$(document).scrollLeft())&&(r=e.position().left-o+Math.abs(t.offset().left)+40,i&&(r=e.position().left-o-30),t[0].style.left=r+"px",o=a.outerWidth()),t.offset().left+o>$(window).width()+$(document).scrollLeft()||i&&t.offset().left<0)o-=t.offset().left+o-($(window).width()+$(document).scrollLeft()),a[0].style.width=o+"px"}var l=a.outerHeight(),d=this.settings.placementOpts.containerOffsetY;if(t.offset().top+l>window.innerHeight-d+$(document).scrollTop()){var c=t.offset().top+l-(window.innerHeight+$(document).scrollTop());if(t[0].style.top=t.position().top-c-d+"px",t.offset().top+l>window.innerHeight+$(document).scrollTop()){var h=e.parents(".popupmenu-wrapper:first").offset().top;t[0].style.top=window.innerHeight+$(document).scrollTop()-l-h+"px"}if(t.offset().top-$(document).scrollTop()<0&&(t[0].style.top=0,t[0].style.top=-1*t.offset().top+"px",l=a.outerHeight()),t.offset().top+l>window.innerHeight+$(document).scrollTop())l=l-(t.offset().top+l-(window.innerHeight+$(document).scrollTop()))-32,a[0].style.height=l+"px"}e.parent().find(".is-submenu-open").removeClass("is-submenu-open"),e.addClass("is-submenu-open")},highlight:function(e){if(e&&e.length){var t=e.parent();t.parent().children("li").removeClass("is-focused"),t.addClass("is-focused"),e&&e.focus(),t.closest(".header").scrollTop(0)}},select:function(e){var t=this.menu.is(".is-selectable"),i=this.menu.is(".is-multiselectable"),s=this.isInSingleSelectSection(e),n=this.isInMultiselectSection(e),a=e.parent(),r=[e];return t||s?(a.prevUntil(".heading, .separator").add(a.nextUntil(".heading, .separator")).removeClass("is-checked"),a.addClass("is-checked"),r.push("selected"),r):i||n?a.hasClass("is-checked")?(a.removeClass("is-checked"),r.push("deselected"),r):(a.addClass("is-checked"),r.push("selected"),r):r},getSelected:function(){return this.menu.is(".is-selectable, .is-multiselectable")?this.menu.children(".is-checked").children("a"):$()},isInSelectableSection:function(e){var t=e.parent().prevAll().filter(".separator").first();return t.hasClass("multi-selectable-section")||t.hasClass("single-selectable-section")},isInSingleSelectSection:function(e){return e.parent().prevAll().filter(".separator").first().hasClass("single-selectable-section")},isInMultiselectSection:function(e){return e.parent().prevAll().filter(".separator").first().hasClass("multi-selectable-section")},detach:function(){$(document).off("touchend.popupmenu."+this.id+" click.popupmenu."+this.id+" keydown.popupmenu"),$(window).off("scroll.popupmenu orientationchange.popupmenu"),$("body").off("resize.popupmenu"),$(".scrollable").off("scroll.popupmenu"),this.menu&&this.menu.length&&this.menu.off("click.popupmenu touchend.popupmenu touchcancel.popupmenu"),$("iframe").each(function(){var e=$(this);try{e.contents().find("body").off("click.popupmenu touchend.popupmenu touchcancel.popupmenu")}catch(e){}})},close:function(e,t){if(e&&void 0!==e||(e=!1),this.menu&&this.menu.add(this.element).hasClass("is-open")){var i=this.menu.parent(".popupmenu-wrapper"),s=this.menu.find(".popupmenu");if(this.menu.removeClass("is-open").attr("aria-hidden","true"),this.menu[0]&&(this.menu[0].style.height="",this.menu[0].style.width=""),i[0]&&(i[0].style.left="-999px",i[0].style.height="",i[0].style.width=""),this.menu.find(".submenu").off(["mouseenter.popupmenu","mouseleave.popupmenu"].join(" ")).removeClass("is-submenu-open"),s[0]&&(s[0].style.left="",s[0].style.top="",s[0].style.height="",s[0].style.width=""),this.menu.find(".is-focused").removeClass("is-focused"),$(document).off(["keydown.popupmenu."+this.id,"click.popupmenu."+this.id,"mousemove.popupmenu."+this.id,"touchend.popupmenu."+self.id].join(" ")),this.menu.off(["click.popupmenu","touchend.popupmenu","touchcancel.popupmenu","mouseenter.popupmenu","mouseleave.popupmenu"].join(" ")),delete this.keydownThenClick,delete this.holdingDownClick,this.element.is("ul.popupmenu")&&this.element.closest(".popupmenu-wrapper").prev("button").removeClass("is-open"),this.menu.find(".popupmenu.is-open").removeClass("is-open"),this.element.removeClass("is-open").triggerHandler("close",[e]),this.detach(),"immediate"===this.settings.trigger&&this.destroy(),"INPUT"===this.element[0].tagName&&this.openedWithTouch)return this.element.removeClass("longpress-target"),void delete this.openedWithTouch;delete this.openedWithTouch,t||!this.settings.returnFocus||l.features.touch||("function"!=typeof this.settings.returnFocus?document.activeElement&&"INPUT"===document.activeElement.tagName||this.element&&this.element.focus():this.settings.returnFocus(this,{triggerElement:this.element[0],menuElement:this.menu[0]}))}},teardown:function(){var e=this.menu.parent(".popupmenu-wrapper");this.ajaxContent&&this.ajaxContent.off().remove(),this.predefinedItems=$();var t=this.menu.parent();t.find(".arrow").remove(),t.off("contextmenu.popupmenu"),this.element.hasClass("btn-actions")&&t.removeClass("bottom"),this.menu.off("dragstart.popupmenu"),!this.preExistingWrapper&&this.menu.parent().is(".popupmenu-wrapper")&&this.menu.unwrap();var i=this.element.parent().children(".searchfield");return i.length?this.menu.insertAfter(i.first()):this.menuOrgContainment?this.insertAtContainment(this.menu):this.menu.insertAfter(this.element),this.menu.find(".submenu").children("a").each(function(e,t){var i=$(t).find("span").text()||$(t).text();$(t).find("span, svg").remove(),$(t).text(i)}),this.menu.find(".submenu").removeClass("submenu"),this.menu.find(".popupmenu").each(function(){var e;(e=$(this)).parent().is(".popupmenu-wrapper, .wrapper")&&e.unwrap()}),this.wrapperPlace&&(this.wrapperPlace.destroy(),delete this.wrapperPlace),e.off().remove(),this.menu&&this.menu.length&&this.menu.data("trigger")&&$.removeData(this.menu[0],"trigger"),this.detach(),this.element.removeAttr("aria-controls").removeAttr("aria-haspopup").off("touchend.popupmenu touchcancel.popupmenu click.popupmenu keydown.popupmenu keypress.popupmenu contextmenu.popupmenu updated.popupmenu"),this},updated:function(e){return this.settings=m.mergeSettings(this.element[0],e,this.settings),this.teardown().init()},destroy:function(){this.menu&&(this.close(),this.teardown(),this.menu.trigger("destroy"),this.settings.removeOnDestroy&&this.menu&&this.menu.length&&(this.menu.off().remove(),delete this.menu),$.removeData(this.element[0],"popupmenu"))}},$.fn.popupmenu=function(e){return this.each(function(){var t=$.data(this,"popupmenu");t?t.updated(e):t=$.data(this,"popupmenu",new ye(this,e))})};var we={appName:"Infor Application Name",content:void 0,copyrightYear:(new Date).getFullYear(),deviceSpecs:!0,productName:void 0,useDefaultCopyright:!0,version:void 0};function xe(e,t){this.settings=m.mergeSettings(e,t,we),this.element=$(e),this.init()}xe.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){var e=this.element.attr("data-appname");this.isBody=$(this.element).is("body"),this.settings.appName=void 0!==e?e.toString():this.settings.appName;var t=this.element.attr("data-about-content");this.settings.content=void 0!==t?t.toString():this.settings.content;var i=this.element.attr("data-copyright-year");this.settings.copyrightYear=void 0!==i?i.toString():this.settings.copyrightYear;var s=this.element.attr("data-device-specs");s&&(this.settings.deviceSpecs="true"===s);var n=this.element.attr("data-product-name");this.settings.productName=void 0!==n?n.toString():this.settings.productName;var a=this.element.attr("data-use-default");void 0!==a&&(this.settings.useDefaultCopyright="true"===a);var r=this.element.attr("data-version");return this.settings.version=void 0!==r?r.toString():this.settings.version,this.defaultCopyright=k.translate("AboutText")+' <a class="hyperlink" href="http://www.infor.com" target="_blank">www.infor.com</a>.',this.defaultCopyright=this.defaultCopyright.replace("{0}",this.settings.copyrightYear),this},build:function(){this.modal=$('<div class="modal about" id="about-modal"></div>'),$('<div class="modal-content"></div>').appendTo(this.modal);var e=$('<div class="modal-header"></div>').appendTo(this.modal.find(".modal-content"));$('<div class="close-container"></div>').append($('<button name="close" type="button" class="btn-icon hide-focus"></button>').append($.createIconElement({icon:"close",classes:"icon-close"})).append("<span>"+k.translate("Close")+"'</span>")).appendTo(e),$.createIconElement({icon:"logo-trademark",classes:["icon","about-logo"]}).attr({viewBox:"0 0 44 44"}).appendTo(e),this.title=$('<h1 class="title"></h1>').text(this.settings.appName).appendTo(this.modal.find(".modal-header"));var t=$('<div class="modal-body"></div>').appendTo(this.modal.find(".modal-content"));if(this.settings.version||this.settings.productName){var i=this.settings.productName?this.settings.productName+" "+this.settings.version:""+this.settings.version;$("<p></p>").text(i).appendTo(t)}if(this.settings.content&&$('<div class="additional-content"></div>').html(this.settings.content).appendTo(t),!this.settings.useDefaultCopyright&&this.settings.content||$("<p></p>").html(this.defaultCopyright).appendTo(t),this.settings.deviceSpecs){var s=this.getDeviceSpecs(),n='<span class="ds">'+k.translate("OperatingSystem")+" : "+l.devicespecs.os+" "+l.devicespecs.currentOSVersion+'</span><br>\n        <span class="platform">'+k.translate("Platform")+" : "+s.os+'</span><br>\n        <span class="ds">'+k.translate("Mobile")+" : "+l.devicespecs.isMobile+'</span><br>\n        <span class="locale">'+k.translate("Locale")+" : "+s.locale+'</span><br>\n        <span class="browser">'+k.translate("Browser")+" : "+l.devicespecs.currentBrowser+" "+l.devicespecs.browserMajorVersion+" ("+l.devicespecs.browserVersion+')</span><br>\n        <span class="cookiesEnabled">'+k.translate("CookiesEnabled")+" : "+s.cookiesEnabled+'</span><br>\n        <span class="version">'+k.translate("Version")+" : "+$("html").attr("data-sohoxi-version")+"</span><br>";$("<p></p>").html(n).appendTo(t)}return this.buttons=this.modal.find("button"),this.modal.find(".hide-focus").one("blur",function(){$(this).removeClass("hide-focus")}),this.element.attr("data-modal","about-modal"),$(".modal-body",this.modal)[0].tabIndex=0,this.modal.appendTo("body"),this.modal.modal({trigger:this.isBody?"immediate":"click"}),this},getDeviceSpecs:function(){var e,t,i,s="Microsoft Internet Explorer"===navigator.appName?navigator.userLanguage:navigator.language;return{browser:(e=navigator.userAgent,t=[],i=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(i[1])?"IE '"+(t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]:"Chrome"===i[1]&&null!=(t=e.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(t=e.match(/version\/(\d+)/i))&&i.splice(1,1,t[1]),i.join(" "))),os:navigator.platform,cookiesEnabled:navigator.cookieEnabled,locale:s}},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this},close:function(){var e=this.modal.data("modal");e&&e.close(),this.isBody&&this.destroy()},destroy:function(){var e=this.modal.data("modal");e&&(e.element.off("beforeopen.about"),e.destroy()),this.buttons.off(),this.element.off("open.about"),this.element.length>0&&$.removeData(this.element[0],"about")},handleEvents:function(){var e=this;return this.element.on("open.about",function(t){t.stopPropagation(),e.element.trigger("click")}),this.buttons.filter('[name="done"], [name="close"]').on("click.about",function(){e.close()}),this.modal.data("modal").element.on("beforeopen.about",function(){e.modal.find(".modal-body").scrollTop(0)}),$(document).on("keydown.about",function(t){0!==t.which&&27!==t.which||e.close()}),this}},$.fn.about=function(e){return this.each(function(){var t=$.data(this,"about");t?t.updated(e):t=$.data(this,"about",new xe(this,e))})};var Ce={direction:"vertical",distance:"auto",timing:300,transition:"cubic-bezier(.17, .04, .03, .94)"};$.fn.animateOpen=function(e){var t=$.fn.transitionEndName();return e=m.mergeSettings(void 0,e,Ce),this.each(function(){var i=this,s=$(this),n="horizontal"===e.direction?"width":"height",a=n.charAt(0).toUpperCase()+n.slice(1),r=isNaN(e.distance)?"auto":parseInt(e.distance,10)+"px",o=void 0;function l(){o&&clearTimeout(o),s.data("ignore-animation-once")&&$.removeData(s[0],"ignore-animation-once"),s.data("is-animating")&&$.removeData(s[0],"is-animating"),s.off(t+".animateopen"),i.style.transition="",i.style[n]=r,s.trigger("animateopencomplete")}s.one("animateopenstart.animation",function(e){e.stopPropagation(),s.off(t+".animateopen")}),s.trigger("animateopenstart"),t&&s.one(t+".animateopen",l),s.data("is-animating",!0);var d=this.style[n];this.style[n]=r;var c=getComputedStyle(this)[n];this.style[n]=d,this["offset"+a],this.style.transition=n+" "+e.timing+"ms "+e.transition,o=setTimeout(l,e.timing),this.style[n]=c,(s.is(":hidden")||s.is(".no-transition")||s.data("ignore-animation-once"))&&l()})};var ke={direction:"vertical",timing:300,transition:"cubic-bezier(.17, .04, .03, .94)"};$.fn.animateClosed=function(e){var t=$.fn.transitionEndName();return e=m.mergeSettings(void 0,e,ke),this.each(function(){var i=this,s=$(this),n="horizontal"===e.direction?"width":"height",a=n.charAt(0).toUpperCase()+n.slice(1),r=void 0;function o(){r&&clearTimeout(r),s.data("ignore-animation-once")&&$.removeData(s[0],"ignore-animation-once"),s.data("is-animating")&&$.removeData(s[0],"is-animating"),s.off(t+".animatedclosed"),i.style.transition="",i.style[n]="0px",s.trigger("animateclosedcomplete")}s.one("animateclosedstart",function(e){e.stopPropagation(),s.off(t+".animatedclosed")}),s.trigger("animateclosedstart"),t&&s.one(t+".animatedclosed",o),s.data("is-animating",!0),this.style[n]=getComputedStyle(this)[n],this["offset"+a],this.style.transition=n+" "+e.timing+"ms "+e.transition,r=setTimeout(o,e.timing),this.style[n]="0px",(s.is(":hidden")||s.is(".no-transition")||s.data("ignore-animation-once"))&&o()})},$.fn.isAnimating=function(){return this.each(function(){return!0===$(this).data("is-animating")})};var $e={allowOnePane:!0,displayChevron:!0,enableTooltips:!0,rerouteOnLinkClick:!0,source:null};function Te(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,$e),this.init()}Te.prototype={init:function(e){this.build(e).handleEvents(e).setupTooltips()},build:function(e,t){var i=this,s=void 0,n=void 0,a=this,r=!0;e&&e instanceof jQuery?(s=e.children("a"),n=e.next(".accordion-pane"),r=!1,this.headers=this.headers.add(e),this.anchors=this.anchors.add(s),this.panes=this.panes.add(n)):(this.headers=this.element.find(".accordion-header"),e=this.element.find(".accordion-header"),this.anchors=e.children("a"),s=e.children("a"),this.panes=e.next(".accordion-pane"),n=e.next(".accordion-pane"));var o=!1;if(e.each(function(){var e=$(this),t=!1,i=e.parent(),s=i.is(".accordion");function n(){s||(t?i.addClass("has-icons"):e.addClass("no-icon"))}e.hideFocus(),e.children("a").find("svg").detach().insertBefore(e.children("a"));var r=e.children(".icon, svg");if(r.addClass("icon").attr({role:"presentation","aria-hidden":"true",focusable:"false"}),s&&r.length&&(o=!0),(e.is(".list-item")||!s&&e.find("button").length||!s&&e.find("svg").length)&&(t=!0),e.hasClass("is-disabled")&&e.children("a, button").attr("tabindex","-1"),e.next(".accordion-pane").length){t=!0;var l=e.children(".btn");if(!l.length){l=$('<button class="btn" type="button"></button>');var d="insertBefore";a.settings.displayChevron&&s&&(e.addClass("has-chevron"),d="insertAfter"),l[d](e.children("a")),e.data("addedExpander",l)}l.hideFocus(),r.length&&!a.settings.displayChevron&&r.appendTo(l);var c=l.children(".icon, .svg, .plus-minus");if(!c.length){if(a.settings.displayChevron&&s)c=$.createIconElement({icon:"caret-down",classes:["chevron"]});else{var h=a.isExpanded(e)?" active":"";c=$('<span class="icon plus-minus'+h+'" aria-hidden="true" role="presentation"></span>')}c.appendTo(l)}var u={role:"presentation","aria-hidden":"true"};c.is("span")||(u.focusable="false"),c.attr(u),c.is(".chevron")?(e.addClass("has-chevron"),l.insertAfter(e.children("a"))):(e.removeClass("has-chevron"),l.insertBefore(e.children("a"))),!a.settings.displayChevron&&s&&(o=!0),n();var p=l.children(".audible");p.length||(p=$('<span class="audible"></span>').appendTo(l)),p.text(k.translate("Expand"))}else n()}),o&&this.element.addClass("has-icons"),n.each(function(){var e=$(this),t=e.prev(".accordion-header");t.children("a").attr({"aria-haspopup":"true",role:"button"}),a.isExpanded(t)||(e.data("ignore-animation-once",!0),a.collapse(t,!1))}),r&&!this.element.data("updating")){var l=e.filter(".is-selected, .is-expanded");l.next(".accordion-pane").addClass("no-transition"),this.settings.allowOnePane?(l=l.first(),this.expand(l)):l.each(function(e){i.expand($(l[e]))}),this.select(l.last()),l.next(".accordion-pane").removeClass("no-transition")}return t||(this.currentlyFiltered=$()),this},handleHeaderClick:function(e,t){if(!t||!t.length||this.isDisabled(t)||this.isFiltered(t)||t.data("is-animating"))e.preventDefault();else{if(!$(e.target).is('[class^="btn"]')){var i=t.children("a");return this.handleAnchorClick(e,i)}e.preventDefault()}},handleAnchorClick:function(e,t){var i,s=this,n=t.parent(".accordion-header"),a=n.next(".accordion-pane"),r=t.attr("ng-reflect-href");if(e&&!r&&e.preventDefault(),!n.length||this.isDisabled(n)||this.isFiltered(n))return!1;if(!1!==this.element.triggerHandler("beforeselect",[t]))return this.originalSelection=t,this.select(t),e&&e.stopPropagation(),this.closePopups(e),!(i=t.attr("href"))||""===i||"#"===i||s.settings.rerouteOnLinkClick&&(window.location.href=i,0)?a.length?(s.toggle(n),!0):(this.isControllingDetails?a.length||s.element.trigger("drilldown",[n[0]]):t.focus(),this.element.trigger("selected",n),!0):(this.element.trigger("followlink",[t]),!0)},closePopups:function(e){$(".popupmenu.is-open").length&&this.element.find('.accordion-header[aria-haspopup="true"]').each(function(){return $(this).data("popupmenu").close(),void 0!==e&&(e.stopPropagation(),e.stopImmediatePropagation()),!1})},handleExpanderClick:function(e,t){var i=t.parent(".accordion-header");if(i.length&&!this.isDisabled(i)&&!this.isFiltered(i)&&!i.data("is-animating"))return this.originalSelection=t,e&&e.stopPropagation(),this.closePopups(),i.next(".accordion-pane").length?(this.toggle(i),this.select(i),void t.focus()):this.handleAnchorClick(e,i.children("a"))},handleKeys:function(e){var t=this,i=e.which,s=$(e.target),n=s.parent(),a=n.children('[class^="btn"]').first(),r=n.children("a");function o(e){e||(e=s),t.originalSelection||(t.originalSelection=e)}if(9===i&&(this.headers.removeClass("is-selected"),s.is("a")&&a.length?o(a):o(r)),32===i){if(e.preventDefault(),s.is('[class^="btn"]')&&(e.stopPropagation(),e.stopImmediatePropagation(),$("html").hasClass("is-firefox")))return;return a.length?(o(a),this.handleExpanderClick(null,s)):(o(r),this.handleAnchorClick(null,s))}return 37===i||38===i?(e.preventDefault(),o(),e.shiftKey?this.ascend(n):this.prevHeader(n)):39===i||40===i?(e.preventDefault(),o(),e.shiftKey?this.descend(n):this.nextHeader(n)):void 0},toData:function(e,t){var i=[];return this.element.children(".accordion-header").each(function(s,n){!function i(s,n,a,r){var o=$(s),l=$(s).next(".accordion-pane"),d={text:$(s).children("a, span").text().trim(),index:(void 0!==a?a+".":"")+n};s.getAttribute("id")&&(d.id=s.getAttribute("id"));var c=o.children(".icon");if(c.length&&(d.icon="svg"===c[0].tagName.toLowerCase()?c[0].getElementsByTagName("use")[0].getAttribute("xlink:href"):""),t&&(d.element=s),o.hasClass("is-disabled")&&(d.disabled=!0),l.length){var h=l.children(".accordion-content"),u=l.children(".accordion-header"),p=[];if(h.length&&(d.content=""+h.html()),u.length){var g=p;e&&(g=r),u.each(function(e,t){i(t,e,d.index,g)}),d.children=p}}r.push(d)}(n,s,void 0,i)}),i},select:function(e){if(e&&e.length){var t=e,i=t.parent();if(e.is(".accordion-header")&&(t=(i=e).children("a")),t.is('[class^="btn"]')&&(t=e.next("a")),!this.isDisabled(i)&&!this.isFiltered(i))this.headers.removeClass("child-selected").removeClass("is-selected"),i.addClass("is-selected"),i.parentsUntil(this.element,".accordion-pane").prev(".accordion-header").addClass("child-selected")}},getSelected:function(){return this.element.find(".is-selected")},isDisabled:function(e){return!!this.element.hasClass("is-disabled")||!!e&&e.hasClass("is-disabled")},isFiltered:function(e){if(!e||!e.length)return!1;var t=e[0].classList;return t.contains("filtered")&&!t.contains("has-filtered-children")},isExpanded:function(e){if(e&&e instanceof Element&&(e=$(e)),e&&e.length)return"true"===e.children("a").attr("aria-expanded")},toggle:function(e){var t=this;!e||!e.length||this.isDisabled(e)||this.isFiltered(e)||this.isAnimating||(this.isAnimating=!0,setTimeout(function(){t.isAnimating=!1},500),this.isExpanded(e)?this.collapse(e):this.expand(e))},expand:function(e,t){if(e&&e.length){var i=this,s=e.next(".accordion-pane"),n=e.children("a"),a=$.Deferred();return!1===this.element.triggerHandler("beforeexpand",[n])?a.reject():(this.callSource(n,r)||r.apply(this),a)}function r(){var r=e.children(".btn");r.length&&(r.children(".plus-minus, .chevron").addClass("active"),r.children(".audible").text(k.translate("Collapse")));var o=e.parentsUntil(i.element).filter(".accordion-pane").prev(".accordion-header").add(e),l=[];i.settings.allowOnePane&&!t&&i.headers.not(o).each(function(){var e=$(this);i.isExpanded(e)&&l.push(i.collapse(e))});var d=[];function c(t){var r;t&&t.stopPropagation(),e.children("a").attr("aria-expanded","true"),s.triggerHandler("afterexpand",[n]),i.element.trigger("afterexpand",[n]),(r=$).when.apply(r,d.concat(l)).done(function(){a.resolve()})}if(o.not(e).each(function(){var e=$(this);i.isExpanded(e)||d.push(i.expand(e))}),s.addClass("is-expanded"),i.element.trigger("expand",[n]),s.hasClass("no-transition")){for(var h=0;h<s.length;h++)s[h].style.display="block",s[h].style.height="auto";c()}else s.one("animateopencomplete",c).css("display","block").animateOpen()}},expandAll:function(){var e;if(!0!==this.settings.allowOnePane){var t=this,i=$.Deferred(),s=[];return this.headers.each(function(){var e=$(this);t.isExpanded(e)||s.push(t.expand(e))}),(e=$).when.apply(e,s).always(function(){i.resolve()}),i}},collapse:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&e.length){var i=this,s=e.next(".accordion-pane"),n=e.children("a"),a=$.Deferred();if(!1===this.element.triggerHandler("beforecollapse",[n]))return a.reject();var r=e.children(".btn");return r.length&&(r.children(".plus-minus, .chevron").removeClass("active"),r.children(".audible").text(k.translate("Expand"))),s.removeClass("is-expanded"),n.attr("aria-expanded","false"),t&&s.closeChildren(),i.element.trigger("collapse",[n]),s.hasClass("no-transition")?o():s.one("animateclosedcomplete",o).animateClosed(),a}function o(e){e&&e.stopPropagation(),s[0].style.display="none",s[0].style.height="0px",s.triggerHandler("aftercollapse",[n]),i.element.trigger("aftercollapse",[n]),a.resolve()}},collapseAll:function(){var e,t=this,i=$.Deferred(),s=[];return this.headers.each(function(){var e=$(this);t.isExpanded(e)&&s.push(t.collapse(e))}),(e=$).when.apply(e,s).always(function(){i.resolve()}),i},callSource:function(e,t){if(!this.settings.source||"function"!=typeof this.settings.source)return!1;var i=this,s=e.parent(),n={anchor:e,header:s,pane:s.next(".accordion-pane")};return this.settings.source(n,function(){i.updated(),setTimeout(function(){t.apply(i)},1)})},getElements:function(e){var t=$(e),i=void 0,s=void 0,n=void 0;return t.is(".accordion-header")&&(i=t,n=t.children('[class^="btn"]'),s=t.children("a")),t.is(".btn")&&(s=(i=(n=t).parent()).children("a")),t.is("a")&&(n=(i=(s=t).parent()).children(".btn")),{header:i,expander:n,anchor:s,pane:i.next(".accordion-pane")}},prevHeader:function(e,t){var i=this.getElements(e),n=i.header.parent().children(),a=n.index(i.header),r=$(n.get(s.ensureAlphaNumeric(a)-1));if(!n.length||0===a){if(i.header.parent(".accordion-pane").length)return this.ascend(i.header);r=n.last()}for(;r.is(".accordion-content")||this.isDisabled(r)||this.isFiltered(r);){if(r.is(":only-child")||r.is(":first-child"))return this.ascend(i.header);r=r.prev()}if(r.is(".accordion-pane")){var o=r.prev(".accordion-header");if(this.isExpanded(o))if(o.next(".accordion-pane").children(":not(.accordion-content)").length&&!t)return this.descend(o,-1);if(!(r=o).length){if(i.header.parent(".accordion-pane").length)return this.ascend(i.header);for(r=n.last();r.is(".accordion-content")||this.isDisabled(r)||this.isFiltered(r);)r=r.prev()}}this.focusOriginalType(r)},nextHeader:function(e,t){var i=this.getElements(e),n=i.header.parent().children(),a=n.index(i.header),r=$(n.get(s.ensureAlphaNumeric(a)+1));if(!n.length||a===n.length-1){if(i.header.parent(".accordion-pane").length)return this.ascend(i.header,-1);r=n.first()}for(;r.is(".accordion-content")||this.isDisabled(r)||this.isFiltered(r);){if(r.is(":only-child")||r.is(":last-child"))return this.ascend(i.header);r=r.next()}if(r.is(".accordion-pane")){var o=r.prev(".accordion-header");if(this.isExpanded(o))if(o.next(".accordion-pane").children(":not(.accordion-content)").length&&!t)return this.descend(o);if(!(r=$(n.get(s.ensureAlphaNumeric(a)+2))).length){if(i.header.parent(".accordion-pane").length)return this.ascend(i.header,-1);for(r=n.first();r.is(".accordion-content")||this.isDisabled(r)||this.isFiltered(r);)r=r.next()}}this.focusOriginalType(r)},ascend:function(e,t){t||(t=0);var i=e.parent(".accordion-pane"),s=i.prev();if(-1===t&&!(s=i.next(".accordion-header")).length)return i.parent(".accordion").length?this.nextHeader(i.prev().children("a"),!0):this.ascend(i.prev(),-1);this.focusOriginalType(s)},descend:function(e,t){t||(t=0);var i=e.next(".accordion-pane"),s=i.children(".accordion-header").first();return-1===t&&(s=i.children(".accordion-header").last()),s.length?this.isExpanded(s)?this.descend(s,-1):void this.focusOriginalType(s):this.focusOriginalType(e)},focusOriginalType:function(e){this.originalSelection.is(".btn")&&e.children(".btn").length?e.children(".btn").focus():e.children("a").focus()},filter:function(e,t){var i=this;if(e&&e.length){var s=this;if(t){var n=this.collapseAll();return this.headers.removeClass("filtered has-filtered-children hide-focus"),void $.when(n).then(function(){i.currentlyFiltered=$(),i.build(void 0,!0),i.filter(e)})}var a=e.not(this.currentlyFiltered),r=a.next(".accordion-pane"),o=$();this.headers.not(a).addClass("filtered"),a.each(function(e,t){var i=$(t).parents(".accordion-pane");if(i.length){r=r.add(i.filter(function(e,t){return-1===r.index(t)}));var s=i.prev(".accordion-header").filter(function(e,t){return-1===o.index(t)});o=o.add(s)}}),o.addClass("has-filtered-children");var l=this.expand(o.add(r.prev(".accordion-header")),!0);$.when(l).done(function(){i.currentlyFiltered=i.currentlyFiltered.add(a),s.build(void 0,!0)})}},unfilter:function(e){var t=this;if(this.currentlyFiltered.length){e&&e.length||(e=this.currentlyFiltered);var i=$();this.headers.removeClass("filtered"),e.each(function(e,t){var s=$(t).parents(".accordion-pane");if(s.length){var n=s.prev(".accordion-header").filter(function(e,t){return-1===i.index(t)});i=i.add(n)}}),i.removeClass("has-filtered-children");var s=[this.collapse(e),this.collapse(i)];$.when(s).done(function(){t.currentlyFiltered=t.currentlyFiltered.not(e),t.build(void 0,!0)})}},disable:function(){this.element.addClass("is-disabled"),this.anchors.add(this.headers.children('[class^="btn"]')).attr("tabindex","-1")},enable:function(){this.element.removeClass("is-disabled"),this.anchors.add(this.headers.children('[class^="btn"]')).removeAttr("tabindex")},updated:function(e,t){this.element.data("updating",!0),t&&(this.settings=m.mergeSettings(this.element[0],t,this.settings));var i=$(document.activeElement);return $.contains(this.element[0],i[0])||(i=void 0),e&&e instanceof jQuery?this.teardown(e).init(e):this.teardown().init(),i&&i.length&&i.focus(),$.removeData(this.element[0],"updating"),this},teardown:function(e){var t=!1,i=e;this.currentlyFiltered&&this.unfilter(this.currentlyFiltered),e&&e instanceof jQuery||(i=this.headers,t=!0);var s=i.find("a");return i.off("touchend.accordion click.accordion focusin.accordion focusout.accordion keydown.accordion mousedown.accordion mouseup.accordion").each(function(){var e=$(this),t=e.children(".icon"),i=e.data("hidefocus");if(i&&i.destroy(),t.length){var s=t.data("icon");s&&s.destroy()}var n=e.data("addedExpander");n&&(n.remove(),$.removeData(this,"addedExpander"))}),s.off("touchend.accordion keydown.accordion click.accordion"),i.children('[class^="btn"]').off("touchend.accordion click.accordion keydown.accordion"),t&&this.element.off("updated.accordion selected.accordion"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"accordion")},handleEvents:function(e){var t=this,i=null,s=e,n=!1;e&&e instanceof jQuery||(s=this.headers,n=!0);var a=s.find("a");function r(e,i){var s=function(e){var t="Header";return e.is("a")&&(t="Anchor"),e.is("button")&&(t="Expander"),t}(i);return $("body").children().not(".application-menu, .modal-page-container, .page-container").closeChildren(),t["handle"+s+"Click"](e,i)}return s.on("click.accordion",function(e){return r(e,$(this))}).on("focusin.accordion",function(e){var i=$(e.target);t.originalSelection||(t.originalSelection=i),i.is(":not(.btn)")&&$(this).addClass("is-focused").removeClass("hide-focus")}).on("focusout.accordion",function(){$.contains(this,i)&&!$(this).is($(i))||$(this).removeClass("is-focused")}).on("keydown.accordion",function(e){t.handleKeys(e)}).on("mousedown.accordion",function(e){$(this).addClass("is-focused").removeClass("hide-focus"),i=e.target}).on("mouseup.accordion",function(){i=null}),a.on("click.accordion",function(e){return r(e,$(this))}),s.children('[class^="btn"]').on("click.accordion",function(e){return r(e,$(this))}).on("keydown.accordion",function(e){t.handleKeys(e)}),n&&this.element.on("selected.accordion",function(e){e.stopPropagation()}).on("updated.accordion",function(e,i){e.stopPropagation(),t.updated(i)}),this},hideTooltip:function(){var e=this,t=window;t.tooltip&&(this.removeTooltipData(t.tooltip),t.tooltip.classList.add("is-hidden"),t.tooltip.classList.remove("content-tooltip")),$("body, .scrollable").off("scroll.spantooltip",function(){e.hideTooltip()})},removeTooltipData:function(e){(e=e instanceof jQuery?e:$(e)).data("spantooltip")&&$.removeData(e[0],"spantooltip")},setupTooltips:function(){if(this.settings.enableTooltips){var e=this,t=".accordion-header a span",i=void 0;this.element.off("mouseenter.spantooltip",t).on("mouseenter.spantooltip",t,function(){var e;(e=this).offsetWidth>e.parentElement.offsetWidth-parseInt($(e).parent().css("padding-left"),10)&&(i=setTimeout(function(){$(e).tooltip({trigger:"immediate",content:""+e.innerText,extraClass:"tooltip-accordion-style"})},400))}).off("mouseleave.spantooltip click.spantooltip",t).on("mouseleave.spantooltip click.spantooltip",t,function(){var t;(t=this).offsetWidth>t.parentElement.offsetWidth-parseInt($(t).parent().css("padding-left"),10)&&(e.hideTooltip(),clearTimeout(i))})}}},$.fn.accordion=function(e){return this.each(function(){var t=$.data(this,"accordion");t?t.updated(e):t=$.data(this,"accordion",new Te(this,e))})};var Se=[".expandable-area",".accordion","[soho-busyindicator]",".busy-indicator-container"],Ae=[];function De(e,t){return!!function(e){return e&&!(e instanceof jQuery)}(e)&&(e[t]&&"function"==typeof e[t])}function Ie(e,t){var i=[];return $.each(e,function(e,s){$.each($(s).data(),function(e,n){(function(e,t){return!!De(e,t)&&(e[t](),!0)})(n,t)&&i.push({elem:$(s),control:n})})}),i}function Ee(e,t,i){if(e&&t){var s=(e=$(e)).find("*").add(e);i&&(s=s.not(i.join(", ")));var n=Ie(s,t);return e.trigger("sift-"+t+"-complete",[n]),e}}$.fn.destroy=function(){return Ee($(this),"destroy")},$.fn.closeChildren=function(){return Ee($(this),"close",Se)},$.fn.handleResize=function(){return Ee($(this),"handleResize",Ae)};var Le=setTimeout;function Pe(e){return Boolean(e&&void 0!==e.length)}function Me(){}function Be(e){if(!(this instanceof Be))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ze(e,this)}function Re(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,Be._immediateFn(function(){var i=1===e._state?t.onFulfilled:t.onRejected;if(null!==i){var s;try{s=i(e._value)}catch(e){return void Oe(t.promise,e)}Fe(t.promise,s)}else(1===e._state?Fe:Oe)(t.promise,e._value)})):e._deferreds.push(t)}function Fe(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if(t instanceof Be)return e._state=3,e._value=t,void Ne(e);if("function"==typeof i)return void ze((s=i,n=t,function(){s.apply(n,arguments)}),e)}e._state=1,e._value=t,Ne(e)}catch(t){Oe(e,t)}var s,n}function Oe(e,t){e._state=2,e._value=t,Ne(e)}function Ne(e){2===e._state&&0===e._deferreds.length&&Be._immediateFn(function(){e._handled||Be._unhandledRejectionFn(e._value)});for(var t=0,i=e._deferreds.length;t<i;t++)Re(e,e._deferreds[t]);e._deferreds=null}function ze(e,t){var i=!1;try{e(function(e){i||(i=!0,Fe(t,e))},function(e){i||(i=!0,Oe(t,e))})}catch(e){if(i)return;i=!0,Oe(t,e)}}Be.prototype.catch=function(e){return this.then(null,e)},Be.prototype.then=function(e,t){var i=new this.constructor(Me);return Re(this,new function(e,t,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=i}(e,t,i)),i},Be.prototype.finally=function(e){var t=this.constructor;return this.then(function(i){return t.resolve(e()).then(function(){return i})},function(i){return t.resolve(e()).then(function(){return t.reject(i)})})},Be.all=function(e){return new Be(function(t,i){if(!Pe(e))return i(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(e);if(0===s.length)return t([]);var n=s.length;function a(e,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var o=r.then;if("function"==typeof o)return void o.call(r,function(t){a(e,t)},i)}s[e]=r,0==--n&&t(s)}catch(e){i(e)}}for(var r=0;r<s.length;r++)a(r,s[r])})},Be.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Be?e:new Be(function(t){t(e)})},Be.reject=function(e){return new Be(function(t,i){i(e)})},Be.race=function(e){return new Be(function(t,i){if(!Pe(e))return i(new TypeError("Promise.race accepts an array"));for(var s=0,n=e.length;s<n;s++)Be.resolve(e[s]).then(t,i)})},Be._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){Le(e,0)},Be._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var He=["startsWith","contains","keyword","wordStartsWith","phraseStartsWith"];var qe={caseSensitive:!1,filterMode:He[3],searchableTextCallback:void 0};function Ve(e){this.settings=m.mergeSettings(void 0,e,qe),this.init()}Ve.prototype={init:function(){for(var e,t,i,s=[{setting:this.settings.filterMode,limits:He,preset:qe.filterMode}],n=0;n<s.length;n++)e=s[n].setting,t=s[n].limits,i=s[n].preset,-1===$.inArray(e,t)&&(e=i);return this.settings.filterMode===He[0]&&S("wordStartsWith (filter)","startsWith (filter)"),this},filter:function(e,t){if(!e)return!1;if(!($.isArray(e)||e instanceof jQuery))return!1;if(!t||"string"!=typeof t||!t.length)return!1;var i=this,n=[],a=!1;function r(e){if("function"==typeof i.settings.searchableTextCallback)return i.settings.searchableTextCallback(e);var t,n,a=void 0;return"string"==typeof e?a=e:e instanceof $?a=$(e).text():e instanceof HTMLElement?a=e.innerText:(t=e,n="",Object.keys(t).forEach(function(e){var i=n.length?" ":"";n+=""+i+t[e]}),a=n),s.sanitizeHTML(a)}return this.settings.caseSensitive||(t=t.toLowerCase()),$.isArray(e)||(e instanceof jQuery||"object"===(void 0===e?"undefined":u(e)))&&(e=$.makeArray(e),a=!0),e.forEach(function(e){var s=r(e);i.settings.caseSensitive||(s=s.toLowerCase());var a=!1;if(["startsWith","wordStartsWith"].indexOf(i.settings.filterMode)>-1&&(a=function(e,t){for(var i=e.split(" "),s=0;s<i.length;s++)if(0===i[s].indexOf(t))return!0;return 0===e.indexOf(t)||t.indexOf(" ")>0&&e.indexOf(t)>0}(s,t)),"phraseStartsWith"===i.settings.filterMode&&0===s.indexOf(t)&&(a=!0),"contains"===i.settings.filterMode&&s.indexOf(t)>=0&&(a=!0),"keyword"===i.settings.filterMode)for(var o=t.split(" "),l=0;l<o.length;l++){var d=o[l];if(s.indexOf(d)>=0){a=!0;break}}null===i.settings.filterMode&&(a=!0),a&&n.push(e)}),a&&(n=$(n)),!(!a&&!n.length)&&n},updated:function(e){return this.settings=m.mergeSettings(void 0,e,this.settings),this.teardown().init()},teardown:function(){return this},destroy:function(){return this.teardown()}};var We={compile:function e(t,i,s,n){var a=e,r="",o=void 0;function l(e,t){return e=e[(t=t.pop?t:t.split(".")).shift()]||"",0 in t?l(e,t):e}i=Array.isArray(i)?i:i?[i]:[],i=n?0 in i?[]:[1]:i;var d=function(){var e="",n=0,d=void 0,c="object"===u(i[o])?i[o]:{};(c=m.extend({},s,c))[""]={"":i[o]},t.replace(/([\s\S]*?)({{((\/)|(\^)|#)(.*?)}}|$)/g,function(t,i,s,o,h,p,g){n?e+=n&&!h||n>1?t:i:(r+=i.replace(/{{{(.*?)}}}|{{(!?)(&?)(>?)(.*?)}}/g,function(e,t,i,s,n,r){return t?l(c,t):s?l(c,r):n?a(l(c,r),c):i?"":new Option(l(c,r)).innerHTML}),d=p),h?--n||(g=l(c,g),/^f/.test(void 0===g?"undefined":u(g))?r+=g.call(c,e,function(e){return a(e,c)}):r+=a(e,g,c,d),e=""):++n})};for(o=0;o<i.length;o++)d();return r}},je={source:[],sourceArguments:{},template:void 0,filterMode:"wordStartsWith",caseSensitive:!1,delay:300,width:null,offset:null,autoSelectFirstItem:!1,highlightMatchedText:!0,highlightCallback:function(e,t){var i=e,s=!1;if("string"==typeof t.alias&&void 0!==e[t.alias]&&(s=!0,i=e[t.alias]),"contains"===t.filterMode)i=i.replace(new RegExp("("+t.term+")","ig"),"<i>$1</i>");else if("keyword"===t.filterMode)for(var n=t.term.split(" "),a=0;a<n.length;a++){var r=n[a];r&&(i=i.replace(new RegExp("("+r+")","ig"),"<i>$1</i>"))}else{var o=i,l=""+o;t.caseSensitive||(l=k.toLowerCase(l));var d=l.indexOf(t.term);d>0?i=o.substr(0,d)+"<i>"+o.substr(d,t.term.length)+"</i>"+o.substr(t.term.length+d):0===d&&(i="<i>"+o.substr(0,t.term.length)+"</i>"+o.substr(t.term.length))}return s?e[t.alias]=i:e=i,e},resultIteratorCallback:function(e,t){var i={highlightTarget:"label",index:t,listItemId:"ac-list-option"+t};return"string"==typeof e?i.label=e:i=m.extend({},i,e),i.hasValue=void 0!==e.value,i.hasValue&&(i.value=e.value),i},clearResultsCallback:void 0,displayResultsCallback:void 0,searchableTextCallback:function(e){return"string"==typeof e?e:e.label}};function Ge(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,je),this.init()}Ge.prototype={init:function(){var e=this.element.attr("data-autocomplete");e&&"source"!==e&&(this.settings.source=e,this.element.removeAttr("data-autocomplete"));var t={filterMode:this.settings.filterMode,caseSensitive:this.settings.caseSensitive,highlightMatchedText:this.settings.highlightMatchedText,searchableTextCallback:this.settings.searchableTextCallback};this.listFilter?this.listFilter.updated(t):this.listFilter=new Ve(t),this.addMarkup(),this.handleEvents()},addMarkup:function(){this.element.addClass("autocomplete").attr({role:"combobox",autocomplete:"off"})},isLoading:function(){return this.element.hasClass("is-loading")&&this.element.hasClass("is-blocked")},openList:function(e,t){if(!this.element.is("[disabled], [readonly]")&&!this.isLoading()){if(!this.element.hasClass("searchfield"))if(!1===this.element.triggerHandler("beforeopen.autocomplete",{elem:this.element,value:this.element.val()}))return;var i=this;this.settings.caseSensitive||(e=k.toLowerCase(e)),this.list=$("#autocomplete-list"),0===this.list.length&&(this.list=$('<ul id="autocomplete-list" aria-expanded="true"></ul>').appendTo("body")),this.list[0].style.height="auto",this.list[0].style.width=this.element.outerWidth()+"px",this.list.addClass("autocomplete"),this.list.empty(),this.settings.width&&(this.list[0].style.width=this.settings.width+(/(px|%)/i.test(""+this.settings.width)?"":"px"));var s=$(this.element.attr("data-tmpl"));this.tmpl=$(s).length?$(s).text():"string"==typeof s?s:$(this.settings.template).length?$(this.settings.template).text():"string"==typeof this.settings.template?this.settings.template:'<li id="{{listItemId}}" data-index="{{index}}" {{#hasValue}}data-value="{{value}}"{{/hasValue}} role="listitem">\n <a href="#" tabindex="-1">\n   <span>{{{label}}}</span>\n </a>\n</li>';var n=this.listFilter.filter(t,e),a=[];!1!==n&&n.forEach(function(t,s){"string"==typeof t&&(t={label:t,value:t});var n=m.extend(!0,{},t);if(n=i.settings.resultIteratorCallback(n,s),i.settings.highlightMatchedText){var r={filterMode:i.settings.filterMode,caseSensitive:i.settings.caseSensitive,term:e};n.highlightTarget&&(r.alias=n.highlightTarget),n=i.settings.highlightCallback(n,r)}a.push(n)}),this.currentDataSet=a,"function"!=typeof this.settings.displayResultsCallback?this.handleListResults(e,t,a):this.settings.displayResultsCallback(a,function(){i.element.trigger("listopen",[a])})}},handleListResults:function(e,t,i){var s=this,a={menuId:"autocomplete-list",ariaListbox:!0,mouseFocus:!1,trigger:"immediate",attachToBody:!0,autoFocus:!1,returnFocus:!1,triggerSelect:!1,placementOpts:{parent:this.element,callback:function(e){return!0===e.wasFlipped&&(s.list.add(s.element).addClass("is-ontop"),e.y+=1),e}}};i.forEach(function(e){if(void 0!==We){var t=We.compile(s.tmpl,e);n.append(s.list,t,"*")}}),this.element.addClass("is-open").popupmenu(a).one("close.autocomplete",function(){s.closeList(!0)});var r=s.list.find("li"),o=$(r[0]).find("span").outerWidth()+20;if(o>parseInt(this.element.outerWidth(),10)){for(var l=0;l<r.length;l++)r.width(o+"px");this.maxWidth=o}s.settings.autoSelectFirstItem&&s.list.children().filter(":not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)").first().addClass("is-selected"),this.noSelect=!0,this.element.trigger("populated",[i]).focus(),s.list.on("touchend.autocomplete click.autocomplete","a",function(e){s.select(e)}).on("focusout.autocomplete",function(){s.checkActiveElement()});var d=s.list.find("a").on("focus.autocomplete touchend.autocomplete",function(){s.highlight($(this),d)});if(this.settings.offset){var c=this.list.parent()[0];this.settings.offset.left&&(c.style.left=parseInt(c.style.left,10)+this.settings.offset.left+"px"),this.settings.offset.top&&(c.style.top=parseInt(c.style.top,10)+this.settings.offset.top+"px")}n.append(s.list.parent(".popupmenu-wrapper"),'<span id="ac-is-arialive" aria-live="polite" class="audible">'+$.trim(this.list.find(">li:first-child").text())+"</span>","<div><span><a><small><img><svg><i><b><use><br><strong><em>"),this.noSelect=!0,this.element.trigger("listopen",[i])},closeList:function(e){if(this.list.off(["click.autocomplete","touchend.autocomplete","focusout.autocomplete"].join(" ")),this.list.find("a").off("focus.autocomplete touchend.autocomplete"),this.element.trigger("listclose"),"function"!=typeof this.settings.clearResultsCallback){var t=this.element.data("popupmenu");t&&(e||t.close(),$("#autocomplete-list").parent(".popupmenu-wrapper").remove(),$("#autocomplete-list").remove(),this.element.add(this.list).removeClass("is-open is-ontop"))}else this.settings.clearResultsCallback()},listIsOpen:function(){return this.list instanceof $&&this.list.length&&this.list.is(":visible")},handleAutocompleteKeydown:function(e){if(this.isLoading())return e.preventDefault(),!1;if(!this.listIsOpen())return null;function t(e){e.removeClass("is-selected is-focused")}function i(e){e.addClass("is-selected").find("a").focus()}var s=this.list.find("li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)"),n=function(e){return e.filter(".is-selected")}(s);return 40===e.keyCode&&this.listIsOpen()&&n.length&&(this.noSelect=!0,t(n),i(s.eq(s.index(n)+1)),e.preventDefault(),e.stopPropagation()),38===e.keyCode&&this.listIsOpen()&&n.length&&(this.noSelect=!0,t(n),i(s.eq(s.index(n)-1)),e.preventDefault(),e.stopPropagation()),9!==e.keyCode&&13!==e.keyCode||!this.listIsOpen()||(n.length?(e.stopPropagation(),e.preventDefault(),this.noSelect=!0,this.select(n)):this.closeList()),null},handleAutocompleteInput:function(e){var t=this;return t.isLoading()?(e.preventDefault(),!1):(this.getDataFromSource().done(function(e,i){t.currentDataSet=i,t.openList(e,i)}),null)},checkActiveElement:function(){var e=this;setTimeout(function(){var t=document.activeElement;e.listIsOpen()&&$.contains(e.list[0],t)||e.element.is(t)||e.element.trigger("safe-blur")},0)},getDataFromSource:function(){var e=this;if(e.isLoading())return!1;var t=this.element,i=$.Deferred(),n=void 0;function a(t,n,a){return e.element.triggerHandler("complete"),e.element.trigger("requestend",[t,n]),!1===a?i.reject(t):i.resolve(s.stripTags(t),n)}return clearTimeout(this.loadingTimeout),this.loadingTimeout=setTimeout(function(){if(!e.isLoading())if(""!==(n=t.val())){var s=u(e.settings.source);if(e.element.triggerHandler("start"),e.element.trigger("requeststart",[n]),"function"===s)e.settings.source(n,a,e.settings.sourceArguments);else if("object"===s){var r=$.isArray(e.settings.source)?e.settings.source:[e.settings.source];a(n,r,!0)}else if(e.settings.source)if("keyword"===e.settings.filterMode){var o=[],l=function(e){if(0===o.length)o=e;else for(var t=0;t<e.length;t++){for(var i=e[t],s=!1,n=0;n<o.length;n++)for(var a=o[n],r=0;r<Object.getOwnPropertyNames(a).length;r++){if(i[Object.getOwnPropertyNames(i)[r]]===a[Object.getOwnPropertyNames(a)[r]]){s=!0;break}}s||o.push(i)}},d=function(e){l(e),a(n,o,!0)},c=n.split(" ");""===c[c.length-1]&&c.splice(-1,1);for(var h=0;h<c.length;h++){var p=c[h];if(p.length>0){var g=e.settings.source.toString(),f=$.getJSON(g+p);h<c.length-1?f.done(l).fail(l):f.done(d).fail(d)}}}else{var m=e.settings.source.toString();$.getJSON(m+n).done(function(e){a(n,e,!0)}).fail(function(){a(n,[],!1)})}else i.reject(n)}else e.element.data("popupmenu")&&e.element.data("popupmenu").close()},e.settings.delay),i},resetFilters:function(){this.openList("",this.currentDataSet)},handleAutocompleteFocus:function(){this.noSelect?this.noSelect=!1:this.element.select()},highlight:function(e,t){var i=e.text().trim();e.find(".display-value").length>0&&(i=e.find(".display-value").text().trim()),t&&t.length&&t.parent("li").removeClass("is-selected"),e.parent("li").addClass("is-selected"),this.noSelect=!0,this.element.val(i).focus()},select:function(e,t){var i=void 0,n=void 0,a={},r=!1;e instanceof $.Event?(r=!0,i=$(e.currentTarget)):i=e,i.is("li")&&(n=i,i=i.children("a"));var o=(n=i.parent("li")).attr("data-index"),l=n.attr("data-value");if(this.element.attr("aria-activedescendant",n.attr("id")),t&&t.length||(t=this.currentDataSet),o)a=t[parseInt(o,10)];else if(l)for(var d,c=0;c<t.length;c++)(d="object"===u(t[c])&&void 0!==t[c].value?t[c].value.toString():t[c].toString())===l&&("object"===u(t[c])&&(a=t[c]),a.value=d);return a.value&&0!==!a.value.length||(a.value=i.text().trim()),this.highlight(i),this.noSelect=!0,a.label=s.stripHTML(a.label),a.highlightTarget||(a.highlightTarget="label",a.index=parseInt(o,10),a.listItemId="ac-list-option"+a.index,a.hasValue=!0),this.element.trigger("selected",[i,a]),r&&e.preventDefault(),this.closeList(),this.element.focus(),a},handleAfterListOpen:function(){return this.element.offset().left>this.list.offset().left&&this.list.width(this.list.width()+1),this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),e&&e.source&&(this.settings.source=e.source),this.teardown().init(),this},enable:function(){this.element.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0)},teardown:function(){var e=this.element.data("popupmenu");return e&&e.destroy(),this.element.off(["focus.autocomplete","focusout.autocomplete","input.autocomplete","keydown.autocomplete","listopen.autocomplete","requestend.autocomplete","resetfilter.autocomplete","updated.autocomplete"].join(" ")),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"autocomplete")},handleEvents:function(){var e=this;this.element.on("updated.autocomplete",function(){e.updated()}).on("keydown.autocomplete",function(t){e.handleAutocompleteKeydown(t)}).on("input.autocomplete",function(t){e.handleAutocompleteInput(t)}).on("focus.autocomplete",function(){e.handleAutocompleteFocus()}).on("focusout.autocomplete",function(){e.checkActiveElement()}).on("listopen.autocomplete",function(){e.handleAfterListOpen()}).on("resetfilter.autocomplete",function(){e.resetFilters()})}},$.fn.autocomplete=function(e){return this.each(function(){var t=$.data(this,"autocomplete");if("string"==typeof t){var i=""+t,s=m.extend({},e,{source:i||e.source});t=$.data(this,"autocomplete",new Ge(this,s))}else t?t.updated(e):t=$.data(this,"autocomplete",new Ge(this,e))})};var Ue=[!1,"mobile",!0],_e={resultsCallback:void 0,allResultsCallback:void 0,showAllResults:!0,showGoButton:!1,goButtonCopy:void 0,goButtonAction:void 0,categories:void 0,categoryMultiselect:!1,showCategoryText:!1,source:void 0,template:void 0,clearable:!1,collapsible:Ue[0]};function Ke(e,t){this.element=$(e),this.toolbarParent&&!this.isContainedByFlexToolbar&&void 0!==t&&(void 0===t.clearable&&(t.clearable=!0),void 0===t.collapsible&&(t.collapsible=!0)),this.settings=m.mergeSettings(e,t,_e),this.init()}Ke.prototype={get toolbarParent(){var e=this.element.parents(".toolbar"),t=this.element.parents(".flex-toolbar");if(!(e.add(t).length<1))return t.length>0?t.first()[0]:e.first()[0]},get buttonsetElem(){if(this.toolbarParent)return this.toolbarParent.querySelector(".buttonset")},get titleElem(){if(this.toolbarParent)return this.toolbarParent.querySelector(".title")},get containmentParent(){var e=this.element.closest(".module-tabs");return e.length?e.first()[0]:this.toolbarParent},get input(){return this.element[0]},get categoryButton(){return this.wrapper.find(".searchfield-category-button")},get isCollapsible(){return!1!==this.settings.collapsible},get isCurrentlyCollapsible(){return!0===this.settings.collapsible||"mobile"===this.settings.collapsible&&this.shouldBeFullWidth()},get isContainedByFlexToolbar(){return!!this.containmentParent&&this.containmentParent.className.indexOf("flex-toolbar")>-1},get toolbarFlexItem(){var e=void 0;return this.isContainedByFlexToolbar&&(e=$(this.element).data("toolbarflexitem")),e},get autocompleteAPI(){return $(this.element).data("autocomplete")},get isContextSearch(){return this.wrapper[0].className.indexOf("context")>-1},init:function(){this.coerceBooleanSettings(),this.build(),this.setupEvents()},build:function(){this.id||(this.id=m.uniqueId(this.element,"searchfield")),this.label=this.element.prev("label, .label"),this.inlineLabel=this.element.closest("label"),this.isInlineLabel=this.element.parent().is(".inline");var e=this.element.attr("data-autocomplete");e&&"source"!==e&&(this.settings.source=e,this.element.removeAttr("data-autocomplete"),$.removeData(this.element,"autocomplete")),this.settings.source&&(this.autocomplete=this.element.data("autocomplete"),this.autocomplete?this.autocomplete.updated(this.settings):(this.element.autocomplete(this.settings),this.autocomplete=this.element.data("autocomplete"))),this.element.attr("autocomplete","off");var t=this.element.attr("placeholder")||this.element.prev("label, .label").text().trim();t&&""!==t||(t=k.translate("Keyword")),this.element.attr({"aria-label":t}),this.wrapper=this.element.parent(".searchfield-wrapper"),this.wrapper&&this.wrapper.length||(this.isInlineLabel?this.wrapper=this.inlineLabel.addClass("searchfield-wrapper"):this.wrapper=this.element.wrap('<span class="searchfield-wrapper"></span>').parent()),this.checkContents(),this.toolbarParent&&this.label.prependTo(this.wrapper);for(var i=["context","alternate"],s=void 0,n=0;n<i.length;n++)this.element.hasClass(i[n])&&(s=i[n],this.wrapper.addClass(s),this.element.removeClass(s));!0===this.settings.collapsibleOnMobile&&(this.settings.collapsible=Ue[1]),this.wrapper[0].classList[!0==!this.settings.collapsible?"add":"remove"]("non-collapsible"),this.wrapper[0].classList[this.toolbarParent?"add":"remove"]("toolbar-searchfield-wrapper"),this.toolbarParent&&!this.isContainedByFlexToolbar&&this.element.add(this.wrapper).addClass("no-transition no-animation");var r=this.wrapper.find(".icon:not(.icon-dropdown)");if(r&&r.length||(r=$.createIconElement("search")),r[this.wrapper.hasClass("context")||this.wrapper.hasClass("has-categories")?"insertBefore":"insertAfter"](this.element).icon(),this.hasCategories()){this.wrapper.addClass("has-categories"),this.categoryButton.length||$('<button type="button" class="btn searchfield-category-button"></button>').insertBefore(this.element),r.appendTo(this.categoryButton),r=this.categoryButton,this.settings.showCategoryText&&this.wrapper.addClass("show-category");var o=r.find(".icon-dropdown");if(o.length||(o=$.createIconElement({classes:"icon-dropdown",icon:"dropdown"}).icon()),o.appendTo(r),this.categoryButton.data("popupmenu"))this.setCategories(this.settings.categories);else{this.list=this.wrapper.find("ul.popupmenu"),this.list&&this.list.length||(this.list=$('<ul class="popupmenu"></ul>'));var l=this.settings.categoryMultiselect?"is-multiselectable":"is-selectable";this.list.addClass(l);var d="is-selectable";this.settings.categoryMultiselect||(d="is-multiselectable"),this.list.removeClass(d),this.setCategories(this.settings.categories),this.list.insertAfter(this.element);var c=this;this.categoryButton.popupmenu({menu:this.list,offset:{y:10},returnFocus:function(){c.isFocused&&c.element.focus()}})}this.setCategoryButtonText()}this.isContainedByFlexToolbar?(this.collapseButton&&this.collapseButton.length||(this.collapseButton=$('\n          <button class="btn-secondary collapse-button" type="button">\n            <svg class="icon" focusable="false" aria-hidden="true" role="presentation">\n              <use xlink:href="#icon-exit-fullview"></use>\n            </svg>\n            <span class="audible">'+k.translate("Collapse")+"</span>\n          </button>\n        ")),this.wrapper[0].classList.add("has-collapse-button"),this.element.after(this.collapseButton)):this.wrapper[0].classList.remove("has-collapse-button");var h=this.wrapper.next(".go-button");h.length||(h=this.wrapper.find(".go-button")),h.length&&(this.settings.showGoButton=!0,this.goButton=h,this.element.after(this.goButton)),this.settings.showGoButton?(this.goButton&&this.goButton.length||(this.goButton=$('\n          <button class="btn-secondary go-button">\n            <span>'+(this.settings.goButtonCopy||k.translate("Go"))+"</span>\n          </button>\n        ")),this.goButton.attr("id",m.uniqueId(this.goButton,"searchfield-go-button-")),this.wrapper.addClass("has-go-button"),this.element.after(this.goButton)):this.wrapper.removeClass("has-go-button"),this.settings.clearable&&(this.element.clearable(),this.xButton=this.wrapper.children(".icon.close"));var u=this,p=new B({duration:1,updateCallback:function(){},timeoutCallback:function(){u.calculateSearchfieldWidth()}});return F.register(p),(!1===this.settings.collapsible||"mobile"===this.settings.collapsible&&a.isAbove("phone-to-tablet"))&&this.expand(!0),this},simpleAdjustOnBreakpoint:function(){this.shouldBeFullWidth()?this.isFocused||this.wrapper[0].classList.remove("is-open"):this.wrapper[0].classList.add("is-open")},adjustOnBreakpoint:function(){if(this.shouldBeFullWidth()){if(this.wrapper.removeAttr("style"),this.input.removeAttribute("style"),this.isFocused){if(this.appendToParent(),this.calculateOpenWidth(),this.setOpenWidth(),this.isExpanded)return;return void this.expand(!0)}return this.isCurrentlyCollapsible&&this.isExpanded&&this.collapse(),void(this.isContainedByFlexToolbar&&this.wrapper[0].classList.remove("is-open"))}this.appendToButtonset(),this.isFocused||"mobile"===this.settings.collapsible?this.isExpanded||this.expand(!0):this.isExpanded&&this.collapse()},saveFocus:function(){this.isFocused&&(this.focusElem=document.activeElement)},restoreFocus:function(){if(this.focusElem){var e=this,t=new B({duration:1,updateCallback:function(){},timeoutCallback:function(){e.focusElem&&(e.focusElem.focus(),delete e.focusElem)}});F.register(t)}},appendToParent:function(){this.containmentParent&&!this.wrapper.parent().is($(this.containmentParent))&&(this.isContainedByFlexToolbar||(this.saveFocus(),this.elemBeforeWrapper=this.wrapper.prev(),$(this.containmentParent).find(".buttonset").prepend(this.wrapper),m.fixSVGIcons(this.wrapper),this.restoreFocus()))},appendToButtonset:function(){this.containmentParent&&this.wrapper.parent().is($(this.containmentParent))&&(this.isContainedByFlexToolbar||(this.saveFocus(),this.elemBeforeWrapper instanceof $&&this.elemBeforeWrapper.length?(this.wrapper.insertAfter(this.elemBeforeWrapper),this.elemBeforeWrapper=null):this.wrapper.prependTo($(this.buttonsetElem)),$(this.toolbarParent).triggerHandler("scrollup"),m.fixSVGIcons(this.wrapper),this.restoreFocus()))},shouldBeFullWidth:function(){var e=this.wrapper.closest(".header"),t=!1;return e.length&&(t=e.width()<a.phone),t||a.isBelow("phone-to-tablet")},shouldExpandOnMobile:function(){return!0!==this.settings.collapsible&&("mobile"===this.settings.collapsible||this.shouldBeFullWidth())},coerceBooleanSettings:function(){this.settings=m.coerceSettingsToBoolean(this.settings,["showAllResults","categoryMultiselect","showCategoryText","clearable"])},hasCategories:function(){return this.settings.categories&&$.isArray(this.settings.categories)&&this.settings.categories.length>0},hasGoButton:function(){return this.settings.showGoButton&&this.goButton&&this.goButton.length},setupEvents:function(){var e=this,t=this;return t.element.on("updated."+this.id,function(e,i){t.updated(i)}).on("focus."+this.id,function(e){t.handleFocus(e)}).on("blur."+this.id,function(e){t.isContainedByFlexToolbar&&t.handleSafeBlur(e)}).on("click."+this.id,function(e){t.handleClick(e)}).on("keydown."+this.id,function(e){t.handleKeydown(e)}).on("beforeopen."+this.id,function(e,i){t.handlePopupBeforeOpen(e,i)}).on("safe-blur."+this.id,function(){t.handleSafeBlur()}).on("listclose."+this.id,function(){t.handleSafeBlur()}).on("input."+this.id,function(){t.checkContents()}),t.wrapper.on("mouseenter."+this.id,function(){$(this).addClass("is-hovered")}).on("mouseleave."+this.id,function(){$(this).removeClass("is-hovered")}),this.hasCategories()&&this.categoryButton.on("selected."+this.id,function(e,i){t.handleCategorySelected(e,i)}).on("focus."+this.id,function(e){t.handleCategoryFocus(e)}).on("blur."+this.id,function(){t.handleSafeBlur()}).on("close."+this.id,function(){t.handleSafeBlur()}).on("beforeopen."+this.id,function(e,i){t.handlePopupBeforeOpen(e,i)}),t.hasGoButton()&&t.goButton.on("click."+this.id,function(e){return t.handleGoButtonClick(e)}).on("click."+this.id,function(e){return t.handleGoButtonFocus(e)}).on("blur."+this.id,function(){return t.handleSafeBlur()}),this.isCollapsible?(this.wrapper.on("focusin."+this.id,function(e){t.handleFocus(e)}).on("focusout."+this.id,function(e){t.handleBlur(e)}).on("keydown."+this.id,function(e){t.handleKeydown(e)}).on("collapse."+this.id,function(){t.collapse()}),$("body").on("resize."+this.id,function(){t.adjustOnBreakpoint()}),t.adjustOnBreakpoint()):($("body").on("resize."+this.id,function(){t.simpleAdjustOnBreakpoint()}),t.simpleAdjustOnBreakpoint()),this.collapseButton&&this.collapseButton.length&&this.collapseButton.on("keydown."+this.id,function(e){t.collapseResponsive(e)}).on("click."+this.id,function(e){t.collapseResponsive(e)}).on("blur."+this.id,function(){return t.handleSafeBlur()}),this.toolbarParent&&$(this.toolbarParent).on("navigate."+this.id,function(){!t.isFocused&&t.isCurrentlyCollapsible&&t.collapse()}).on("rendered."+this.id,function(){t.element.removeClass("no-transition no-animation"),t.wrapper.removeClass("no-transition no-animation")}),t.element.on("populated."+this.id,function(e,i){i.length>0?t.settings.showAllResults&&t.addMoreLink():t.addNoneLink()}),t.settings.clearable&&(t.element.on("cleared."+this.id,function(){t.autocomplete&&t.autocomplete.closeList()}),t.xButton.on("blur."+this.id,function(e){t.handleSafeBlur(e)})),t.element.on("listopen."+this.id,function(){var i=$("#autocomplete-list");t.wrapper.addClass("popup-is-open"),t.element.on("selected."+e.id,function(e,i,s){if(i.hasClass("more-results")){var n=t.settings.allResultsCallback;n&&"function"==typeof n&&n(s)}}),i.find(".more-results, .no-results").on("focus."+e.id,function(){var e=$(this);i.find("li").removeClass("is-selected"),e.parent("li").addClass("is-selected"),t.element.val("")})}).on("listclose."+this.id,function(){var i=$("#autocomplete-list");t.element.off("selected."+e.id),i.off("focus."+e.id)}),this},setAsActive:function(e,t){var i=this;if(e||!this.wrapper.hasClass("active")){this.addDocumentDeactivationEvents();var s=["has-focus","active"];(this.isCurrentlyCollapsible||this.isContainedByFlexToolbar)&&(this.expand(!0),this.isContainedByFlexToolbar&&s.push("is-open")),s.forEach(function(e){i.wrapper[0].classList.add(e)}),this.toolbarParent&&this.toolbarParent.classList.add("searchfield-active"),this.isExpanded||!0===t&&this.element.focus()}},get isFocused(){var e=document.activeElement;if(this.wrapper[0].contains(e))return!0;if(this.autocomplete){var t=this.autocomplete.list;if(t&&t[0].contains(e))return!0}if(this.categoryButton&&this.categoryButton.length&&this.categoryButton.data("popupmenu").menu.has(e).length)return!0;return!!(this.xButton&&this.xButton.length&&this.xButton.has(e).length)},hasFocus:function(){return S("isFocused","hasFocus"),this.isFocused},handleFocus:function(){this.setAsActive(!0)},handleBlur:function(){"ios"===l.os.name&&$("head").triggerHandler("disable-zoom"),this.handleSafeBlur()},handleSafeBlur:function(){var e=this;this.blurTimer&&this.blurTimer.destroy(!0),this.blurTimer=new B({duration:1,updateCallback:function(){},timeoutCallback:function(){e.isFocused||(e.wrapper[0].classList.remove("has-focus","active"),e.removeDocumentDeactivationEvents(),e.clearResponsiveState(),e.isCurrentlyCollapsible?e.collapse():e.isContainedByFlexToolbar&&e.wrapper[0].classList.remove("is-open"))}}),F.register(this.blurTimer)},clearResponsiveState:function(){this.toolbarParent&&this.toolbarParent.classList.remove("searchfield-active")},handleClick:function(){this.setAsActive()},addDocumentDeactivationEvents:function(){if(!0!==this.hasDeactivationEvents){var e=this;$(document).on("click."+this.id,function(t){e.handleOutsideClick(t)}).on("keydown."+this.id,function(t){e.handleOutsideKeydown(t)}),this.hasDeactivationEvents=!0}},removeDocumentDeactivationEvents:function(){$(document).off("click."+this.id+" keydown."+this.id),this.hasDeactivationEvents=!1},handleOutsideClick:function(e){var t=e.target;this.isSearchfieldElement(t)||this.handleSafeBlur()},handleKeydown:function(e){var t=e.which,i=e.key;if(27===t&&l.browser.isIE11()&&e.preventDefault(),e.ctrlKey&&8===t&&this.element.val(""),9===t&&this.handleSafeBlur(),this.isContainedByFlexToolbar){["ArrowUp","Up","ArrowDown","Down"].indexOf(i)>-1&&this.collapse()}},handleOutsideKeydown:function(e){var t=e.which,i=e.target;9!==t||this.isSearchfieldElement(i)||this.handleSafeBlur()},handlePopupBeforeOpen:function(e,t){if(this.isCollapsible&&(this.isExpanding||!this.isExpanded)||!t)return!1;var i=this.wrapper.hasClass("context")?"addClass":"removeClass",s=this.wrapper.hasClass("alternate")?"addClass":"removeClass";return t[i]("context"),t[s]("alternate"),!!this.isExpanded||(this.categoryButton.focus(),!1)},handleGoButtonClick:function(e){var t=this.settings.goButtonAction;if("function"==typeof t){var i=this.element.val(),s=void 0;return this.hasCategories()&&(s=this.getCategoryData()),t(e,i,s)}},handleGoButtonFocus:function(){this.setAsActive(!0)},setCategoryButtonText:function(e){if(this.settings.showCategoryText&&this.categoryButton.length){var t="",i=this.wrapper.find(".btn"),s=i.find("span");if(s&&s.length||(s=$('<span class="category"></span>').insertAfter(i.find(".icon").first())),s.empty(),"string"==typeof e&&e.length)s.text(e.trim());else{var n=this.getSelectedCategories();n.length&&(t=n.length>1?n.length+" "+k.translate("Selected"):n.text().trim(),s.text(t))}}},isSearchfieldElement:function(e){if($.contains(this.wrapper[0],e))return!0;if(this.categoryButton&&this.categoryButton.length&&this.categoryButton.data("popupmenu").menu.has(e).length)return!0;return!1},getFillSize:function(e,t){var i,s,n;function a(e){if(!e)return 0;if(!isNaN(parseInt(e,10)))return parseInt(e,10);if(e instanceof jQuery){if(!e.length)return 0;e.is(".title")&&(e=e.next(".buttonset")),e=e[0]}return e}function r(e,t){if(!isNaN(e))return null==e?0:e;t&&"string"==typeof t||(t="left");var i=["left","right"];-1===$.inArray(t,i)&&(t=i[0]);var s=void 0;return(e instanceof HTMLElement||e instanceof SVGElement)&&(s=e.getBoundingClientRect()),s[t]}if(e=a(e),t=a(t),i=r(e),s=r(t,(n="left",(e===t||$(t).length&&$(t).is(".buttonset"))&&(n="right"),n)),!i&&!s)return 280;var o=s-i;return o<=280?280:o>=450?450:o},setClosedWidth:function(){var e=0;if(this.categoryButton instanceof $&&this.categoryButton.length){var t=window.getComputedStyle(this.categoryButton[0]);e+=this.categoryButton.width()+2*parseInt(t.borderLeftWidth,10)+(parseInt(t.paddingLeft,10)+parseInt(t.paddingRight,10))+4}this.wrapper[0]&&(this.wrapper[0].style.width=e+"px")},setOpenWidth:function(){var e=0;if(this.wrapper[0]&&(this.wrapper[0].style.width=this.openWidth),this.hasCategories()){var t=window.getComputedStyle(this.categoryButton[0]);e+=this.categoryButton.width()+(parseInt(t.paddingLeft,10)+parseInt(t.paddingRight,10))+2*parseInt(t.borderLeftWidth,10)}if(this.hasGoButton()){var i=window.getComputedStyle(this.goButton[0]);e+=this.goButton.width()+(parseInt(i.paddingLeft,10)+parseInt(i.paddingRight,10))+2*parseInt(i.borderLeftWidth,10)}e>0&&(this.input.style.width="calc(100% - "+e+"px)"),delete this.openWidth},calculateOpenWidth:function(){var e=this.element.parents(".toolbar").children(".buttonset"),t=this.wrapper.next(),i=void 0;if(e.length){if(t.is(".title")&&(t=e),this.shouldBeFullWidth())return i="100%",$(this.toolbarParent).closest(".header").length&&(i="calc(100% - 40px)"),$(this.toolbarParent).closest(".tab-container.module-tabs").length&&(i="calc(100% - 1px)"),void(this.openWidth=i);var s=e.offset().left+10,n=t;n.length||(n=e.offset().left+10+e.outerWidth(!0)),i=this.getFillSize(s,n),this.openWidth=i-6+"px"}},calculateSearchfieldWidth:function(){var e="100%",t=0,i=void 0;this.element[0].getAttribute("style")&&this.element[0].removeAttribute("style");var s=window.getComputedStyle(this.element[0]);s.width&&!this.isContextSearch&&(e=s.width),this.hasCategories()&&(t+=this.categoryButton.outerWidth(!0)),this.hasGoButton()&&(t+=this.goButton.outerWidth(!0)),t>0&&(i="calc("+e+" - "+t+"px)"),i&&(this.element[0].style.width=i)},handleCategorySelected:function(e,t){this.element.trigger("selected",[t]),this.settings.showCategoryText&&(this.setCategoryButtonText(e,t.text().trim()),this.calculateSearchfieldWidth(),this.settings.categoryMultiselect||this.setAsActive(!0,!0))},handleCategoryFocus:function(){this.saveFocus(),this.setAsActive(!0)},getCategories:function(){return this.list.children("li:not(.separator)")},getSelectedCategories:function(){return this.getCategories().filter(".is-checked")},getCategoryData:function(e){var t=this.getCategories(),i=[];return t.each(function(){var t=this.classList.contains("is-checked");if(!0!==e||!1!==t){var s={name:this.innerText,checked:t};this.id&&(s.id=this.id);var n=this.getAttribute("data-value");void 0!==n&&(s.value=n),i.push(s)}}),i},updateCategories:function(e){this.settings.categories=e,this.setCategories(this.settings.categories)},setCategories:function(e){this.list.empty();var t=this,i=["string","number"],s=!1;e.forEach(function(e){if("string"==typeof e&&(e={name:e}),e.name){var n="";"string"==typeof e.id&&e.id.length&&(n=' id="'+e.id+'"');var a="";i.indexOf(u(e.value))>-1&&(a=' data-value="'+e.value+'"');var r="";!0===e.checked&&!0!==s&&(r=' class="is-checked"',t.settings.categoryMultiselect||(s=!0)),t.list.append("<li"+r+n+a+'><a href="#">'+e.name+"</a></li>")}});var n=this.categoryButton.data("popupmenu");n&&"function"==typeof n.updated&&n.updated()},expand:function(e){var t=this,i=this;return new Be(function(s){if(i.isExpanded||i.isExpanding||i.isCollapsing)s();else{var n=!i.shouldBeFullWidth();i.isExpanding=!0,n||i.appendToParent();var r=0;i.buttonsetElem&&(r=parseInt(window.getComputedStyle(i.buttonsetElem).width,10));var o={buttonset:r+280};t.isContainedByFlexToolbar&&!a.isAbove("phone-to-tablet")||t.wrapper[0].classList.add("is-open"),t.calculateOpenWidth(),t.setOpenWidth(),(!e||"ios"===l.os.name||i.isFocused&&document.activeElement!==i.input)&&(i.focusElem&&(i.focusElem=i.input),i.input.focus());var d=[];o&&d.push(o),i.element.trigger("beforeexpand"),$(i.toolbarParent).triggerHandler("recalculate-buttons",d);var c=new B({duration:10,updateCallback:function(){},timeoutCallback:function(){$(i.toolbarParent).triggerHandler("recalculate-buttons",d),i.element.trigger("expanded"),delete i.isExpanding,i.isExpanded=!0,!i.isCurrentlyCollapsible||i.isFocused||i.focusElem||i.handleSafeBlur()}});F.register(c)}})},collapse:function(){var e=this,t=this;return new Be(function(i){if(t.isExpanded||!t.isExpanding||t.isCollapsing){t.isCollapsing=!0,t.appendToButtonset(),t.checkContents(),t.clearResponsiveState(),t.wrapper[0].classList.remove("active","is-open"),l.browser.isIE11&&t.wrapper[0].classList.remove("is-open"),!e.isContainedByFlexToolbar&&e.isFocused||t.wrapper[0].classList.remove("has-focus"),t.wrapper.removeAttr("style"),t.input.removeAttribute("style"),t.categoryButton&&t.categoryButton.length&&t.categoryButton.data("popupmenu").close(!1,!0),t.element.trigger("beforecollapse"),"ios"===l.os.name&&$("head").triggerHandler("enable-zoom"),delete t.isExpanded,delete t.isExpanding;var s=new B({duration:10,updateCallback:function(){},timeoutCallback:function(){delete t.isCollapsing,$(t.toolbarParent).triggerHandler("recalculate-buttons"),t.element.trigger("collapsed"),i()}});F.register(s)}else i()})},collapseResponsive:function(e){if(this.previouslyCollapsedByKey&&"click"===e.type)delete this.previouslyCollapsedByKey;else{var t=this,i=1;e&&!e.key&&(i=0,this.toolbarFlexItem&&this.toolbarFlexItem.focused&&(i=1)),"keydown"===e.type&&(this.previouslyCollapsedByKey=!0),this.collapse().then(function(){t.wrapper.trigger("collapsed-responsive",[i])})}},checkContents:function(){var e="remove";""!==(this.input.value?this.input.value.trim():"")&&(e="add"),this.wrapper[0].classList[e]("has-text")},addMoreLink:function(){var e=$("#autocomplete-list"),t=this.element.val();if(!($(".more-results",e).length>0)){var i=$('<li class="separator" role="presentation"></li>').appendTo(e),n=$('<li role="presentation"></li>').appendTo(e);this.moreLink=$('<a href="#" class="more-results" tabindex="-1" role="menuitem"></a>').html("<span>"+k.translate("AllResults")+' "'+s.ensureAlphaNumeric(t)+'"</span>').appendTo(n),this.autocomplete.maxWidth&&i.width(this.autocomplete.maxWidth+"px")}},addNoneLink:function(){var e=$("#autocomplete-list");if(!($(".no-results",e).length>0)){var t=$('<li role="presentation" class="is-placeholder"></li>').appendTo(e);this.noneLink=$('<a href="#" class="no-results" disabled="disabled" tabindex="-1" role="menuitem" aria-disabled="true"></a>').html("<span>"+k.translate("NoResults")+"</span>").appendTo(t)}},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown().init()},disable:function(){this.wrapper.addClass("is-disabled"),this.element.prop("disabled",!0)},enable:function(){this.wrapper.removeClass("is-disabled"),this.element.prop("disabled",!1)},teardown:function(){return this.element.off(["updated."+this.id,"focus."+this.id,"blur."+this.id,"click."+this.id,"keydown."+this.id,"beforeopen."+this.id,"input."+this.id,"listopen."+this.id,"listclose."+this.id,"safe-blur."+this.id,"selected."+this.id,"populated."+this.id,"cleared."+this.id].join(" ")),this.wrapper.off(["mouseenter."+this.id,"mouseleave."+this.id,"focusin."+this.id,"focusout."+this.id,"keydown."+this.id,"collapse."+this.id].join(" ")),this.toolbarParent&&$(this.toolbarParent).off("navigate.toolbarsearchfield"),this.goButton&&this.goButton.length&&(this.goButton.off("click."+this.id+" blur."+this.id).remove(),delete this.goButton),this.categoryButton&&this.categoryButton.length&&(this.categoryButton.off().remove(),delete this.categoryButton),this.collapseButton&&this.collapseButton.length&&(this.collapseButton.off().remove(),delete this.collapseButton,delete this.previouslyCollapsedByKey),this.removeDocumentDeactivationEvents(),$("body").off("resize."+this.id),this.autocomplete&&this.autocomplete.destroy(),this.wrapper.hasClass("context")&&this.element.addClass("context"),this.element.next(".icon").remove(),this.element.parent().hasClass("searchfield-wrapper")&&(this.element.parent().find("ul").remove(),this.element.parent().find(".icon").remove()),this.xButton&&this.xButton.length&&(this.xButton.off("blur."+this.id),this.xButton.remove()),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"searchfield")}},$.fn.searchfield=function(e){return this.each(function(){var t=$.data(this,"searchfield");t?t.updated(e):t=$.data(this,"searchfield",new Ke(this,e))})};var Ye={breakpoint:"phone-to-tablet",dismissOnClickMobile:!1,filterable:!1,openOnLarge:!1,triggers:[".application-menu-trigger"],onExpandSwitcher:null,onCollapseSwitcher:null};function Xe(e,t){return this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Ye),this.init()}Xe.prototype={init:function(){this.setup().handleEvents()},setup:function(){var e=this;this.hasTrigger=!1,this.isAnimating=!1,this.hasTriggers()||(this.triggers=$()),this.menu=this.element;var t=this.element.attr("data-open-on-large");this.settings.openOnLarge=void 0!==t?"true"===t:this.settings.openOnLarge;var i=this.element.attr("data-breakpoint");this.settings.breakpoint=void 0!==a[i]?i:this.settings.breakpoint,this.modifyTriggers(this.settings.triggers,!1,!0),this.scrollTarget=this.menu.parents(".header");var s=this.menu.prevAll(".masthead"),n=this.menu.prevAll(".module-tabs");s.length>0&&(this.scrollTarget=s,this.menu.addClass("short")),n.length>0&&(this.scrollTarget=n),this.element.find(".application-menu-switcher-panel .accordion").accordion(),this.accordion=this.menu.find(".accordion").last(),this.accordion.addClass("panel").addClass("inverse");var r=this.accordion.data("accordion");if(r||(this.accordion.accordion(),r=this.accordion.data("accordion")),this.accordionAPI=r,this.searchfield=this.element.find(".searchfield, .searchfield-wrapper"),this.settings.filterable&&"function"==typeof $.fn.searchfield){this.searchfield.length?this.searchfield.is(".searchfield-wrapper")&&(this.searchfield=this.searchfield.children(".searchfield")):this.searchfield=$('<div class="searchfield-wrapper"><label for="application-menu-searchfield">'+k.translate("Search")+'</label><input id="application-menu-searchfield" class="searchfield" /></div>').prependTo(this.element),this.element.addClass("has-searchfield");var o=this;this.searchfield.searchfield({clearable:!0,source:function(e,t,i){t(e,o.accordion.data("accordion").toData(!0,!0),i)},searchableTextCallback:function(e){return e.text||""},resultIteratorCallback:function(e){return e.highlightTarget="text",e},clearResultsCallback:function(){o.accordionAPI.unfilter()},displayResultsCallback:function(e,t){return o.filterResultsCallback(e,t)}})}this.isOpen()?this.openMenu(!1,!1,!0):this.adjustHeight();var l=this.element.find(".application-menu-switcher-trigger");l.length>0&&(this.switcherPanel=l.next(".expandable-area"),this.switcherPanel.data("expandablearea")||this.switcherPanel.expandablearea(),this.switcherPanel.on("beforeexpand.applicationmenu",function(){var t=e.element.height();e.element.addClass("has-open-switcher"),e.switcherPanel.find(".content").height(t-71),e.settings.onExpandSwitcher&&e.settings.onExpandSwitcher(e,e.element,e.settings)}).on("aftercollapse.applicationmenu",function(){e.element.removeClass("has-open-switcher"),e.settings.onCollapseSwitcher&&e.settings.onCollapseSwitcher(e,e.element,e.settings)}));return this},getAdjacentContainerElement:function(){var e=this.element.next(".page-container");return e.length||(e=$("body")),e},handleTriggerEvents:function(){var e=this;this.triggers.length&&this.triggers.off("click.applicationmenu").on("click.applicationmenu",function(t){return!$(t.currentTarget).find(".icon.app-header").hasClass("go-back")&&!e.isAnimating&&(e.menu.hasClass("is-open")?e.closeMenu(!0):e.openMenu(void 0,!0),!0)}),$(document).on("keydown.applicationmenu",function(t){e.handleKeyDown(t)})},handleKeyDown:function(e){return!(121===e.which&&!e.shiftKey)||(e.preventDefault(),this.isOpen()?(this.closeMenu(!0),this.triggers.length&&this.triggers.eq(0).focus()):this.openMenu(),!1)},notify:function(e,t){if(e&&void 0!==e&&(e instanceof HTMLElement&&(e=$(e)),e.is("a"))){var i=e.find(".tag");if(t&&void 0!==t&&0!==parseInt(t,10))return i.length||(i=$('<span class="tag"></span>').appendTo(e)),i.text(t.toString()),i;i.length&&i.remove()}},adjustHeight:function(){var e=this.scrollTarget.is(".is-sticky"),t=this.scrollTarget.outerHeight(!0)-(e?0:$(window).scrollTop());this.scrollTarget.prev().is(".masthead")&&(t+=this.scrollTarget.prev().outerHeight(!0)),this.menu[0].style.height=t>0?"calc(100% - "+t+"px)":"100%"},isLargerThanBreakpoint:function(){return a.isAbove(this.settings.breakpoint)},isOpen:function(){return this.menu[0].classList.contains("is-open")},testWidth:function(){if(this.isOpen()){if(a.isAbove(this.settings.breakpoint))return void this.element[0].classList.remove("show-shadow");if(this.element[0].classList.add("show-shadow"),this.isAnimating)return;this.userOpened||this.closeMenu()}else a.isBelow(this.settings.breakpoint)||this.userClosed||!this.settings.openOnLarge||this.isAnimating||this.openMenu(!0)},openMenu:function(e,t,i){if(!0!==this.isAnimating){var s=this,n=$.fn.transitonEndName;if(i||(this.isAnimating=!0),this.adjustHeight(),this.triggers.each(function(){var e=$(this);if(e.parents(".header").length>0||e.parents(".masthead").length>0){if(e.parents(".header, .masthead").parents(".page-container").length)return;e.find(".icon.app-header").removeClass("go-back").addClass("close"),e.trigger("icon-change")}}),i||(this.menu.off(n+".applicationmenu"),this.menu[0].style.display="",this.menu[0].offsetHeight,this.menu.addClass("is-open")),a.isBelow(this.settings.breakpoint)&&this.menu.addClass("show-shadow"),e&&!0===e||this.menu.find(".is-selected > a").focus(),"ios"===l.os.name)this.getAdjacentContainerElement().addClass("ios-click-target");i?r():(this.menu.one(n+".applicationmenu",r),this.timeout=setTimeout(r,300)),setTimeout(function(){$(document).on("click.applicationmenu",function(e){$(e.target).parents(".application-menu").length<1&&!s.isLargerThanBreakpoint()&&s.closeMenu(!0)})},0)}function r(){null!==s.timeout&&(clearTimeout(s.timeout),s.timeout=null),t&&(s.userOpened=!0,s.userClosed=void 0),i||(s.isAnimating=!1,s.element.trigger("applicationmenuopen"),$("body").triggerHandler("resize")),s.menu.removeClass("no-transition"),$(".page-container").removeClass("no-transition")}},closeMenu:function(e){if(!0!==this.isAnimating){var t=this,i=$.fn.transitionEndName();if(this.isAnimating=!0,this.triggers.each(function(){var e=$(this);(e.parents(".header").length>0||e.parents(".masthead").length>0)&&(e.find(".icon.app-header").removeClass("close"),e.trigger("icon-change"))}),"ios"===l.os.name)this.getAdjacentContainerElement().removeClass("ios-click-target");this.menu.one(i+".applicationmenu",s),this.timeout=setTimeout(s,300),this.menu.removeClass("is-open show-shadow").find("[tabindex]"),$(document).off("click.applicationmenu")}function s(){null!==t.timeout&&(clearTimeout(t.timeout),t.timeout=null),t.menu.off(i+".applicationmenu"),t.menu[0].style.display="none",t.isAnimating=!1,e&&(t.userOpened=void 0,t.userClosed=!0),t.element.trigger("applicationmenuclose"),$("body").triggerHandler("resize")}},hasTriggers:function(){return void 0!==this.triggers&&this.triggers instanceof $&&this.triggers.length},modifyTriggers:function(e,t,i){if(e&&e.length){var s=$();$.each(e,function(e,t){s=s.add($(t))}),this.triggers=this.triggers[t?"not":"add"](s),this.handleTriggerEvents(),i&&!0===i||this.updated()}},filterResultsCallback:function(e,t){if(!e||!e.length)return this.accordionAPI.unfilter(),void t();var i=$(e.map(function(e){return e.element}));this.accordionAPI.filter(i,!0),this.element.triggerHandler("filtered",[e]),t()},handleSearchfieldInputEvent:function(){if(this.searchfield&&this.searchfield.length){var e=this.searchfield.val();if(!e||""===e){var t=this.accordion.find(".has-filtered-children");this.accordionAPI.headers.removeClass("filtered has-filtered-children"),this.accordionAPI.collapse(t),this.accordionAPI.updated(),this.element.triggerHandler("filtered",[[]])}}},handleDismissOnClick:function(e){this.settings.dismissOnClickMobile&&(this.userOpened=!1,$(e).blur(),this.isLargerThanBreakpoint()||this.closeMenu())},closeSwitcherPanel:function(){if(this.switcherPanel){var e=this.switcherPanel.data("expandablearea");if(e&&(e.close(),this.settings.dismissOnClickMobile)){if(this.userOpened=!1,this.isLargerThanBreakpoint())return;this.closeMenu()}}},teardown:function(){if(this.menu.off("animateopencomplete animateclosedcomplete").removeClass("short").removeAttr("style"),$(window).off("scroll.applicationmenu"),$("body").off("resize.applicationmenu"),$(document).off("click.applicationmenu open-applicationmenu close-applicationmenu keydown.applicationmenu"),this.accordion.off("blur.applicationmenu selected.applicationmenu followlink.applicationmenu"),this.accordionAPI&&"function"==typeof this.accordionAPI.destroy&&(this.isFiltered&&this.accordionAPI.collapse(),this.accordionAPI.destroy()),this.switcherPanel&&this.switcherPanel.off("beforeexpand.applicationmenu aftercollapse.applicationmenu"),this.searchfield&&this.searchfield.length){this.searchfield.off("input.applicationmenu");var e=this.searchfield.data("searchfield");e&&e.destroy()}return this.hasTriggers()&&this.triggers.off("click.applicationmenu"),this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},destroy:function(){this.teardown(),$.removeData(this.element[0],"applicationmenu")},handleEvents:function(){var e=this;return this.handleTriggerEvents(),this.menu.on("notify.applicationmenu",function(t,i,s){e.notify(i,s)}).on("updated.applicationmenu",function(){e.updated()}),this.accordion.on("blur.applicationmenu",function(){e.closeMenu()}).on("selected.applicationmenu",function(t,i){var s=$(i).children("a");e.handleDismissOnClick(s)}).on("followlink.applicationmenu",function(t,i){e.handleDismissOnClick(i)}),$(document).on("open-applicationmenu",function(){e.openMenu(void 0,!0)}).on("close-applicationmenu",function(){e.closeMenu()}),$(window).on("scroll.applicationmenu",function(){e.adjustHeight()}),$("body").on("resize.applicationmenu",function(){e.testWidth()}),!0===this.settings.filterable&&this.searchfield&&this.searchfield.length&&this.searchfield.on("input.applicationmenu",function(t){e.handleSearchfieldInputEvent(t)}),this.settings.openOnLarge&&this.isLargerThanBreakpoint()&&(this.menu.addClass("no-transition"),$(".page-container").addClass("no-transition")),this.testWidth(),setTimeout(function(){e.menu.removeClass("no-transition"),$(".page-container").removeClass("no-transition")},800),this}},$.fn.applicationmenu=function(e){return this.each(function(){var t=$.data(this,"applicationmenu");return t?t.updated(e):t=$.data(this,"applicationmenu",new Xe(this,e)),t})};var Je={dataset:[],selectable:!1,paging:!1,pagesize:25,pagesizes:[10,25,50,75]};function Qe(e,t){this.element=$(e),this.settings=m.mergeSettings(e,t,Je),t.dataset&&(this.settings.dataset=t.dataset),this.init()}Qe.prototype={get pagerAPI(){return this.element.data("pager")},init:function(){return this.selectedRows=[],this.handlePaging(),this.build().handleEvents()},build:function(){return this.settings.paging&&this.element.empty(),this.render(),this},handleEvents:function(){var e=this,t=this;return this.element.on("click.blockgrid",".block",function(e){var i=$(e.currentTarget),s=$(e.target),n=s.is(".checkbox-label")||s.is(".checkbox");setTimeout(function(){t.selectBlock(i,n)},0),e.stopPropagation(),e.preventDefault()}),this.element.on("focus.blockgrid",".checkbox",function(e){$(e.currentTarget).parent().addClass("has-focus")}),this.element.on("blur.blockgrid",".checkbox",function(e){$(e.currentTarget).parent().removeClass("has-focus")}),this.element.on("keypress.blockgrid",".block",function(e){if(32===e.which){var i=$(e.target);t.selectBlock(i,!1)}}),this.element.on("updated.blockgrid",function(){t.updated()}),this.pagerAPI&&this.element.on("page.blockgrid",function(){e.previousFocusedElement=!0,e.build()}).on("pagesizechange.blockgrid",function(){e.previousFocusedElement=!0,e.build()}),this},handlePaging:function(){this.settings.paging&&(this.element.addClass("paginated"),this.element.pager({componentAPI:this,dataset:this.settings.dataset,pagesize:this.settings.pagesize,pagesizes:this.settings.pagesizes}))},selectBlock:function(e,t){return D(this.select,this.selectBlock).apply(this,[e,t])},select:function(e,t){var i=this.element.find(".block"),s=this.element.find(".checkbox"),n=e.find(".checkbox"),a=n.is(":checked"),r="",o=Number(n.data("idx"));if("single"===this.settings.selectable&&(this.selectedRows=[],i.removeClass("is-selected").removeAttr("aria-selected"),s.prop("checked",!1)),"multiple"===this.settings.selectable&&a||"mixed"===this.settings.selectable&&t&&a){e.removeClass("is-selected").removeAttr("aria-selected"),n.prop("checked",!1);for(var l=0;l<this.selectedRows.length;l++)o===this.selectedRows[l].idx&&this.selectedRows.splice(l,1);this.element.triggerHandler("deselected",[{selectedRows:this.selectedRows,action:"deselect"}])}else{if(!1===this.settings.selectable||"mixed"===this.settings.selectable&&!t||(a||(e.addClass("is-selected").attr("aria-selected","true"),n.prop("checked",!0)),this.selectedRows.push({idx:o,data:this.settings.dataset[o],elem:e}),r=a?"deselected":"selected"),"mixed"===this.settings.selectable&&!t){var d=e.hasClass("is-activated");return i.removeClass("is-activated"),void(d?(e.removeClass("is-activated"),this.element.triggerHandler("deactivated",[{row:o,item:this.settings.dataset[o]}])):(e.addClass("is-activated"),this.element.triggerHandler("activated",[{row:o,item:this.settings.dataset[o]}])))}this.element.triggerHandler(a?"deselected":"selected",[{selectedRows:this.selectedRows,action:r}])}},render:function(){var e=this,t="",i=this.settings.dataset,s=k?k.translate("Select"):"Select";if(this.pagerAPI){var n=this.pagerAPI.state;if(n.pages>1){var a=n.activePage>0?n.activePage-1:0,r=n.pagesize*a,o=n.pagesize*(a+1);if((i=i.slice(r,o)).length!==this.settings.dataset.length)for(var l=0;l<o-r+1&&!i[l].id;l++)i[l].id=r+l}}var d=[];this.selectedRows.forEach(function(e){d.push(e.idx)});for(var c=0;c<i.length;c++){var h=i[c],u="mixed"===this.settings.selectable?"0":"-1",p="",g="";d.indexOf(h.id)>-1&&(p=" is-selected",g=" checked"),t+='<div class="block is-selectable'+p+'" role="listitem" tabindex="0">\n        <input type="checkbox" aria-hidden="true" role="presentation" class="checkbox" id="checkbox'+c+'" tabindex="'+u+'" data-idx="'+h.id+'"'+g+'>\n        <label for="checkbox'+c+'" class="checkbox-label">\n          <span class="audible">'+s+'</span>\n        </label>\n        <img alt="Placeholder Image" src="'+(h.img||h.image)+'" class="image-round">\n        <p> '+(h.maintxt||h.title)+" <br> "+(h.subtxt||h.subtitle)+" </p>\n      </div>"}this.element.attr("role","list").append(t),this.previousFocusedElement&&setTimeout(function(){e.element.find(".block").first().focus(),delete e.previousFocusedElement},0)},renderBlock:function(){return D(this.render,this.renderBlock).apply(this)},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.teardown(),this.init(),this},teardown:function(){return this.element.off("updated.blockgrid"),this.element.off("click.blockgrid"),this.element.empty(),this.selectedRows=[],this},destroy:function(){this.teardown(),$.removeData(this.element[0],"blockgrid")}},$.fn.blockgrid=function(e){return this.each(function(){var t=$.data(this,"blockgrid");t?t.updated(e):t=$.data(this,"blockgrid",new Qe(this,e))})};var Ze={blockUI:!0,text:null,displayDelay:1e3,timeToComplete:0,transparentOverlay:!1,overlayOnly:!1};function et(e,t){this.settings=m.mergeSettings(e,t,Ze),this.element=$(e),this.init()}et.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.setup().handleEvents()},setup:function(){var e=this.element.attr("data-block-ui"),t=this.element.attr("data-display-delay"),i=this.element.attr("data-completion-time");this.blockUI=void 0!==e?e:this.settings.blockUI,this.settings.overlayOnly||(this.loadingText=this.settings.text?this.settings.text:k.translate("Loading"),this.label&&this.label.text(this.loadingText));var s=void 0!==t&&!isNaN(t)&&parseInt(t,10)>20,n=!isNaN(this.settings.displayDelay)&&this.settings.displayDelay>=20?this.settings.displayDelay:20;return this.delay=s?t:n,this.completionTime=void 0===i||isNaN(i)?this.settings.timeToComplete:parseInt(i,10),this},activate:function(){var e=this;if(!e.isActive()){if(this.container)return e.closeTimeout&&clearTimeout(e.closeTimeout),this.label.remove(),this.settings.overlayOnly||(this.label=$("<span>"+this.loadingText+"</span>").appendTo(this.container),this.element.is("input, .dropdown, .multiselect, .busy-xs, .busy-sm")&&this.label.addClass("audible")),void this.container.removeClass("is-hidden").trigger("afterstart");this.container=$('<div class="busy-indicator-container is-hidden"></div>').attr({"aria-live":"polite",role:"status"}),this.loader=$('<div class="busy-indicator active"></div>').appendTo(this.container),this.settings.overlayOnly||($('<div class="bar one"></div><div class="bar two"></div><div class="bar three"></div><div class="bar four"></div><div class="bar five"></div>').appendTo(this.loader),this.label=$("<span>"+this.loadingText+"</span>").appendTo(this.container));var t="";if(this.blockUI&&(this.settings.transparentOverlay&&(t=" transparent"),this.originalPositionProp=this.element[0].style.position,this.element[0].style.position="relative",this.overlay=$('<div class="overlay busy is-hidden'+t+'"></div>').appendTo(this.element),this.container.addClass("blocked-ui")),this.label&&this.element.is(".busy-xs, .busy-sm")&&this.label.addClass("audible"),this.element.is("input, .dropdown, .multiselect")){this.element.addClass("is-loading"),this.blockUI&&this.element.addClass("is-blocked"),this.label&&this.label.addClass("audible");var i=void 0;if(this.element.is("input"))i=this.element,this.container.insertAfter(this.isInlineLabel?this.inlineLabel:this.element);else i=this.element.data("dropdown").pseudoElem,this.container.appendTo(i.parent());this.overlay&&this.overlay.insertAfter(this.container);for(var s=i.position(),n=i.outerHeight(),a=i.outerWidth(),r=this.container.add(this.overlay),o=function(e,t,i){e.style[t]=i+"px"},l=0,d=r.length;l<d;l++)o(r[l],"left",s.left),o(r[l],"top",s.top),o(r[l],"bottom",s.bottom),o(r[l],"right",s.right),o(r[l],"height",n),o(r[l],"width",a)}else this.container.appendTo(this.element);setTimeout(function(){e.container&&e.container.removeClass("is-hidden"),e.overlay&&e.overlay.removeClass("is-hidden"),e.blockUI&&e.addScrollParent()},e.delay),this.element.trigger("afterstart"),$.fn.cssPropSupport("animation")||(e.isAnimating=!0,e.animateWithJS()),this.completionTime>0&&setTimeout(function(){e.element.trigger("complete")},e.completionTime)}},close:function(e){var t=this;t.isActive()&&(this.removeScrollParent(),e&&(this.element.removeClass("is-loading"),this.element.removeClass("is-blocked")),this.container&&this.container.addClass("is-hidden"),this.overlay&&this.overlay.addClass("is-hidden"),t.closeTimeout=setTimeout(function(){clearTimeout(t.closeTimeout),t.container&&t.container.remove(),t.container=void 0,t.loader=void 0,t.label=void 0,t.overlay&&(t.overlay.remove(),t.element[0].style.position=t.originalPositionProp,t.originalPositionProp=void 0),t.overlay=void 0,t.element.trigger("aftercomplete.busyindicator"),t.element.off("complete.busyindicator")},600))},animateWithJS:function(){var e=this,t=this.container.find(".bar.one"),i=this.container.find(".bar.two"),s=this.container.find(".bar.three"),n=this.container.find(".bar.four"),a=this.container.find(".bar.five"),r=0,o=null;setInterval(function(){e.isAnimating?(1===(r+=1)&&t.addClass("half"),13===r&&(t.removeClass("half").addClass("full"),i.addClass("half")),26===r&&(t.removeClass("full").addClass("half"),i.removeClass("half").addClass("full"),s.addClass("half")),39===r&&(t.removeClass("half"),i.removeClass("full").addClass("half"),s.removeClass("half").addClass("full"),n.addClass("half")),51===r&&(i.removeClass("half"),s.removeClass("full").addClass("half"),n.removeClass("half").addClass("full"),a.addClass("half")),64===r&&(s.removeClass("half"),n.removeClass("full").addClass("half"),a.removeClass("half").addClass("full")),77===r&&(n.removeClass("half"),a.removeClass("full").addClass("half")),90===r&&a.removeClass("half"),103===r&&(r=0)):clearInterval(o)},10)},addScrollParent:function(){var e=this;if(this.blockUI){this.scrollParent=$(this.getScrollParent(this.element[0]));var t=this.scrollParent.length?this.scrollParent.outerHeight():0;if(t&&t<this.element.outerHeight()){var i=t/2-58;this.container.css({top:i}),this.scrollParent.off("scroll.parent.busyindicator").on("scroll.parent.busyindicator",function(){var t=i+e.scrollParent.scrollTop();e.container.css({top:t})})}}},removeScrollParent:function(){this.scrollParent&&(this.scrollParent.off("scroll.parent.busyindicator"),delete this.scrollParent)},getScrollParent:function(e){var t=["overflow","overflow-x","overflow-y"],i=function(e){return t.reduce(function(t,i){return t+function(e,t){return getComputedStyle(e,null).getPropertyValue(t)}(e,i)},0)},s=/(auto|scroll)/,n=function(e){return s.test(i(e))};return function(e){for(var t=!1,i=e.parentNode;!t&&i&&i.tagName&&"body"!==i.tagName.toLowerCase();){if(n(i)){t=!0;break}i=i.parentNode}return t?i:null}(e)},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this.setup()},isActive:function(){return!!this.container&&this.container.children(".busy-indicator").is(".active")},destroy:function(){this.removeScrollParent(),this.close(!0),this.element.off("start.busyindicator complete.busyindicator afterstart.busyindicator aftercomplete.busyindicator updated.busyindicator"),$.removeData(this.element[0],"busyindicator")},handleEvents:function(){var e=this;return this.element.on("start.busyindicator",function(t){t.stopPropagation(),e.activate()}).on("afterstart.busyindicator",function(){e.element.on("complete.busyindicator",function(t){t.stopPropagation(),e.close(!0)})}).on("updated.busyindicator",function(){e.close(!0),e.updated()}),this}},$.fn.busyindicator=function(e){return this.each(function(){var t=$.data(this,"busyindicator");t?t.updated(e):t=$.data(this,"busyindicator",new et(this,e))})};var tt={tooltip:{}};tt.isIE="ie"===l.browser.name,tt.isIEEdge="edge"===l.browser.name,tt.tooltipSize=function(e){return n.html(this.tooltip.find(".tooltip-content"),e,"*"),{height:this.tooltip.outerHeight(),width:this.tooltip.outerWidth()}},tt.formatToSettings=function(e,t){var i=e.data?e.data:e;return"value"===t.show?t.formatter?d3.format(t.formatter)(i.value):i.value:"label"===t.show?i.name:"label (percent)"===t.show?i.name+" ("+(isNaN(i.percentRound)?0:i.percentRound)+"%)":"label (value)"===t.show?i.name+" ("+(t.formatter?d3.format(t.formatter)(i.value):i.value)+")":"percent"===t.show?(isNaN(i.percentRound)?0:i.percentRound)+"%":"function"==typeof t.show?t.show(i):i.value},tt.appendTooltip=function(e){var t=this;this.tooltip=$("#svg-tooltip"),0===this.tooltip.length&&(this.tooltip=$('<div id="svg-tooltip" class="tooltip '+e+' right is-hidden">\n      <div class="arrow"></div>\n        <div class="tooltip-content">\n          <p><b>32</b> Element</p>\n        </div>\n      </div>').appendTo("body"),this.isTouch&&(this.tooltip[0].style.pointerEvents="auto",this.tooltip.on("touchend.svgtooltip",function(){t.hideTooltip()})))},tt.hideTooltip=function(){var e=this;d3.select("#svg-tooltip").classed("is-personalizable",!1).classed("is-hidden",!0).style("left","-999px"),$("body, .scrollable").off("scroll.chart-tooltip",function(){e.hideTooltip()})},tt.removeTooltip=function(){this.tooltip&&this.tooltip.remove&&this.tooltip.remove()},tt.colorRange=function(){var e=H.themeColors().palette;return[e.azure[70].value,e.turquoise[30].value,e.amethyst[30].value,e.graphite[60].value,e.amber[50].value,e.emerald[60].value,e.ruby[60].value,e.azure[30].value,e.amber[90].value,e.turquoise[80].value,e.ruby[20].value,e.graphite[50].value,e.emerald[50].value,e.azure[50].value,e.amethyst[80].value,e.emerald[30].value,e.turquoise[50].value,e.amber[70].value,e.graphite[20].value,e.azure[20].value,e.emerald[100].value,e.amethyst[20].value]},tt.colorNameRange=["azure07","turquoise03","amethyst03","graphite06","amber05","emerald06","ruby06","azure03","amber09","turquoise08","ruby02","graphite05","emerald05","amethyst03","azure05","amethyst08","emerald03","turquoise06","amber07","graphite02"],tt.colorNames="undefined"!=typeof d3?d3.scaleOrdinal().range(tt.colorNameRange):[],tt.chartColor=function(e,t,i){var s=tt.colorRange(),n=i&&i.color?i.color:null;if(n){if("error"===n)return H.themeColors().status.danger.value;if("alert"===n)return H.themeColors().status.warning.value;if("alertYellow"===n)return H.themeColors().status.caution.value;if("good"===n)return H.themeColors().status.success.value;if("neutral"===n)return H.themeColors().palette.graphite[30].value;if(n&&0===n.indexOf("#"))return i.color}return/^(pie|donut)$/.test(t)?s[e]:/^(bar-single|column-single)$/.test(t)?H.themeColors().palette.azure[80].value:/^(bar|bar-stacked|bar-grouped|bar-normalized|line|scatterplot|column-stacked|column-grouped|column-positive-negative)$/.test(t)?s[e]:""},tt.chartColorName=function(e,t,i){var s=i&&i.color?i.color:null;if(s){if("error"===s)return"alert01";if("alert"===s)return"alert02";if("alertYellow"===s)return"alert03";if("good"===s)return"alert04";if("neutral"===s)return"graphite03";if(s&&0===s.indexOf("#"))return i.color}return/^(pie|donut)$/.test(t)?this.colorNameRange[e]:/^(bar-single|column-single)$/.test(t)?"azure08":/^(bar|bar-stacked|bar-grouped|bar-normalized|line|scatterplot|column-stacked|column-grouped|column-positive-negative)$/.test(t)?this.colorNames(e):""},tt.showTooltip=function(e,t,i,s){var a=this;e<0&&(e=2),this.tooltip[0].style.left=e+"px",this.tooltip[0].style.top=t+"px",n.html(this.tooltip.find(".tooltip-content"),i,"*"),this.tooltip.removeClass("bottom top left right").addClass(s),this.tooltip.removeClass("is-hidden"),$("body").off("scroll.chart-tooltip").on("scroll.chart-tooltip",function(){a.hideTooltip()}),$(".scrollable").off("scroll.chart-tooltip").on("scroll.chart-tooltip",function(){a.hideTooltip()})},tt.addLegend=function(e,t,i,n){var a=void 0;if(0!==e.length){var r=e[0].display&&"twocolumn"===e[0].display,o=r?$('<div class="chart-legend '+(e[0].placement?"is-"+e[0].placement:"is-bottom")+'"></div>'):$('<div class="chart-legend"></div>');"pie"!==t&&"donut"!==t||!i.showMobile||(o=$('<div class="chart-legend"><div class="container"></div></div>'));var l=0,d=void 0;for(a=0;a<e.length;a++)d=e[a].name?6*e[a].name.length:6,l=e[a].name&&d>l?d:l;var c=(l+=55)/$(n).width()*100;for(a=0;a<e.length;a++)if(e[a].name){var h="";(r||e[a].display&&"block"===e[a].display)&&(h+=" lg"),"column-positive-negative"===i.type&&e[a].option&&(h+=" "+e[a].option);var u='<span class="chart-legend-item'+h+'" tabindex="0"></span>',p=tt.chartColor(a,t||(1===e.length?"bar-single":"bar"),e[a]),g=tt.chartColorName(a,t||(1===e.length?"bar-single":"bar"),e[a]),f="";"#"===g.substr(0,1)?(f=$('<span class="chart-legend-color"></span>'),e[a].pattern||f.css("background-color",p)):f=$('<span class="chart-legend-color '+(e[a].pattern?"":g)+'"></span>'),"scatterplot"===t&&(f=$('<span class="chart-legend-color"></span>'));var m=$('<span class="chart-legend-item-text">'+s.stripTags(e[a].name)+"</span>");if(e[a].pattern&&(f.append('<svg width="12" height="12"><rect height="12" width="12" mask="url(#'+e[a].pattern+')"/></svg>'),f.find("rect").css("fill",p)),e[a].percent){var v=$('<span class="chart-legend-percent"></span>').text(e[a].percent);m.append(v)}e[a].display&&"block"===e[a].display&&(u='<span class="chart-legend-item'+h+'" tabindex="0"></span>'),r&&(u=c>45&&"right"!==i.legendPlacement?'<span class="chart-legend-item'+h+'" tabindex="0"></span>':'<span class="chart-legend-item'+h+' is-two-column" tabindex="0" ></span>'),(u=$(u)).append(f,m),"pie"!==t&&"donut"!==t||!i.showMobile?o.append(u):o.find(".container").append(u),(e[a].display&&"block"===e[a].display||r&&c>45&&"right"!==i.legendPlacement)&&u.css({float:"none",display:"block",margin:"0 auto",width:l+"px"}),"scatterplot"===t&&(self.svg=d3.select(f[0]).append("svg").attr("width","24").attr("height","24").append("path").attr("class","symbol").attr("transform","translate(10, 10)").attr("d",d3.symbol().size("80").type(function(){return d3.symbols[a]})).style("fill",p)),innerWidth<=480&&e[a].data&&e[a].data.legendAbbrName&&m.replaceWith('<span class="chart-legend-item-text">'+e[a].data.legendAbbrName+"</span>"),innerWidth>=481&&innerWidth<=768&&e[a].data&&e[a].data.legendShortName&&m.replaceWith('<span class="chart-legend-item-text">'+e[a].data.legendShortName+"</span>")}o instanceof $&&(o.on("click.chart",".chart-legend-item",function(){tt.handleElementClick(this,e,i)}).on("keypress.chart",".chart-legend-item",function(t){13!==t.which&&32!==t.which||tt.handleElementClick(this,e,i)}),$(n).append(o))}},tt.handleElementClick=function(e,t,i){var s=$(e).index(),n=t[s],a=void 0;if("radar"===i.type&&(a=d3.select(i.svg.selectAll(".chart-radar-area").nodes()[s])),"pie"===i.type||"donut"===i.type)a=d3.select(i.svg.selectAll(".slice").nodes()[s]);else if("column-positive-negative"===i.type)a=!n.option||n.option&&"target"===n.option?i.svg.select(".target-bar"):i.svg.select(".bar."+n.option);else if(-1!==["column","bar","bar-stacked","bar-grouped","bar-normalized","column-grouped","column-stacked","column-positive-negative"].indexOf(i.type))if(i.isGrouped||i.isSingle)a=i.svg.select(".series-"+s);else if(i.isStacked&&!i.isSingle){a=d3.select(i.svg.selectAll("bar"===i.type||"bar-stacked"===i.type||"bar-normalized"===i.type?".series-group":".g").nodes()[s]).select(".bar")}-1!==["radar","pie","donut","column","bar","bar-stacked","bar-grouped","bar-normalized","column-grouped","column-stacked","column-positive-negative"].indexOf(i.type)&&(tt.clickedLegend=!0,a.on("click").call(a.node(),a.datum(),s,!0)),n.selectionObj&&tt.selectElement(d3.select(n.selectionObj.nodes()[s]),n.selectionInverse,n.data)},tt.selected=[],tt.selectElement=function(e,t,i,s){var n=e.node()&&e.classed("is-selected"),a=[{elem:e.nodes(),data:n?{}:i}];t.classed("is-selected",!1).classed("is-not-selected",!n),e.classed("is-not-selected",!1).classed("is-selected",!n),tt.selected=$.isEmptyObject(a[0].data)?[]:a,$(s).triggerHandler("selected",[a])},tt.setSelectedElement=function(e){var t=e.dataset,i="column-positive-negative"===e.type,s=/^(bar|bar-stacked|bar-grouped|bar-normalized)$/.test(e.type),n="pie"===e.type||"donut"===e.type,a=/^(column|column-grouped|column-stacked|column-positive-negative)$/.test(e.type),r=e.svg,o=e.isSingle,l=e.isGrouped,d=e.isStacked,c="selected"===e.task,h=d3.select(e.selector),u=h.classed("positive"),p=e.svg.selectAll(".axis.x .tick"),g=e.svg.selectAll(".axis.y .tick"),f=e.svg.selectAll(".bartext.positive, .target-bartext.positive"),m=e.svg.selectAll(".bartext.negative, .target-bartext.negative"),v=e.svg.selectAll(".target-bartext.positive, .target-bartext.negative"),b=d3.select(e.selector.parentNode),y=parseInt(b.node()?b.attr("data-group-id"):0,10),w=[],x=[],C=void 0;if(t=d||n?t||null:t&&t[y]?t[y].data||t[y]:null,p.style("font-weight","normal"),g.style("font-weight","normal"),f.style("font-weight","normal"),m.style("font-weight","normal"),r.selectAll(".is-selected").classed("is-selected",!1),n&&r.selectAll(".is-not-selected").classed("is-not-selected",!1),c)if(r.selectAll(".bar, .target-bar").style("opacity",.6),tt.clickedLegend&&!n)i?(e.isTargetBar?(e.svg.selectAll(".target-bar").classed("is-selected",!0).style("opacity",1),v.style("font-weight","bolder")):(e.svg.selectAll(u?".bar.positive, .target-bar.positive":".bar.negative, .target-bar.negative").classed("is-selected",!0).style("opacity",1),(u?f:m).style("font-weight","bolder")),r.selectAll(".bar").each(function(e,i){var s=d3.select(this);s.classed("is-selected")&&x.push({elem:s.node(),data:t?t[i]:e})}),w=x):(a||s)&&(l||o?e.svg.selectAll(".series-"+e.i).classed("is-selected",!0).style("opacity",1):b.classed("is-selected",!0).selectAll(".bar").classed("is-selected",!0).style("opacity",1),r.selectAll(".bar.is-selected").each(function(t,i){var n=d3.select(this);(C=e.dataset)||(C=t),s?(C[0][e.i]&&(C=C[0][e.i]),C[e.i]&&C[e.i][i]&&(C=C[e.i][i]),C[i]&&C[i][e.i]&&(C=C[i][e.i])):(C[0].data[e.i]&&(C=C[0].data[e.i]),C[e.i]&&C[e.i].data[i]&&(C=C[e.i].data[i]),C[i]&&C[i].data[e.i]&&(C=C[i].data[e.i])),x.push({elem:n.node(),data:C})}),w=x);else if(o&&d&&a)C=t[0]&&t[0].data?t[0].data:e.d,h.classed("is-selected",!0).style("opacity",1),w.push({elem:h.nodes(),data:C[e.i]});else if(!o&&!l||d||!a&&!s){if(a||s)r.selectAll((a?".axis.x":".axis.y")+" .tick:nth-child("+(e.i+2)+")").style("font-weight","bolder"),r.selectAll(".bar:nth-child("+(e.i+1)+")").classed("is-selected",!0).style("opacity",1),r.selectAll(".bar.is-selected").each(function(i,n){var a=d3.select(this),r=i;t&&(r=s&&d?t[n][e.i]:t[n].data[e.i]),x.push({elem:a.node(),data:r})}),w=x;else if(n){r.selectAll(".slice").classed("is-selected",!1).classed("is-not-selected",!0).attr("transform","");var k=t&&t[0]&&t[0].data?t[0].data[e.i]:e.d?e.d.data:e.d;h.classed("is-selected",!0).classed("is-not-selected",!1).attr("transform","scale(1.025, 1.025)"),w.push({elem:h.nodes(),data:k,index:e.i})}}else{if(r.selectAll((a?".axis.x":".axis.y")+" .tick:nth-child("+((l?y:e.i)+2)+")").style("font-weight","bolder"),h.classed("is-selected",!0).style("opacity",1),i){var T=e.isTargetBar?e.i:e.i-e.dataset[0].data.length;r.select(".target-bar.series-"+T).classed("is-selected",!0).style("opacity",1),r.select(".bar.series-"+T).classed("is-selected",!0).style("opacity",1),d3.select(r.selectAll(".bartext").nodes()[T]).style("font-weight","bolder"),d3.select(r.selectAll(".target-bartext").nodes()[T]).style("font-weight","bolder")}(l||i||a)&&((!i&&!a||a&&l)&&b.classed("is-selected",!0).selectAll(".bar").classed("is-selected",!0).style("opacity",1),b.selectAll(".bar").each(function(e,i){var s=d3.select(this);s.classed("is-selected")&&x.push({elem:s.node(),data:t?t[i]:e})}),l?w.push({groupIndex:y,groupElem:b.nodes()[0],groupItems:x}):w=x)}else r.selectAll(".bar, .target-bar").style("opacity",1),f.style("font-weight","bolder"),m.style("font-weight","bolder"),n&&h.classed("is-selected",!1).style("stroke","#fff").style("stroke-width","1px").attr("transform","");tt.clickedLegend&&(tt.clickedLegend=!1),tt.selected=w,e.isTrigger&&$(e.container).triggerHandler(c?"selected":"unselected",[w])},tt.setSelected=function(e,t,i){if(e){var s,n=0,a=m.equals,r=i.isPie?i.svg.node().nextSibling:i.svg.node().parentNode.nextSibling,o=d3.select(r),l=o.node()&&o.classed("chart-legend"),d=void 0,c=void 0,h=void 0,u=void 0,p=function(t){var s=!!t;(t=s?d3.select(t):i.svg).selectAll(".bar").each(function(t,r){t&&n<1&&(void 0!==e.fieldName&&void 0!==e.fieldValue&&e.fieldValue===t[e.fieldName]||void 0!==e.index&&e.index===r||e.data&&a(e.data,i.chartData[t.index].data[r])||e.elem&&$(this).is(e.elem))&&(n++,c=d3.select(this),d=r,s&&!i.isStacked&&(h=!0))})};i.isGrouped||i.isStacked&&!i.isSingle?(i.chartData.forEach(function(t,s){n<1&&(u=$(i.svg.select('[data-group-id="'+s+'"]').node()),(void 0!==e.groupName&&void 0!==e.groupValue&&e.groupValue===t[e.groupName]||void 0!==e.groupIndex&&e.groupIndex===s||e.data&&a(e.data,t)||e.elem&&u.is(e.elem))&&void 0===e.fieldName&&void 0===e.fieldValue&&void 0===e.index&&(n++,c=i.svg.select('[data-group-id="'+s+'"]').select(".bar"),d=s,i.isStacked&&!i.isGrouped&&(h=!0)))}),n<1&&(s=i.svg.selectAll(".series-group")).nodes().length&&s.each(function(){p(this)})):p(),n>0&&(t||!c.classed("is-selected"))&&(h?l&&$(o.selectAll(".chart-legend-item").nodes()[d]).trigger("click.chart"):c.on("click").call(c.node(),c.datum(),d))}},tt.labelsColide=function(e){var t=e.selectAll(".x text"),i=!1;return t.each(function(e,s){var n=this.getBoundingClientRect(),a=void 0;t.each(function(e,t){s!==t&&(a=this.getBoundingClientRect(),!(n.right<a.left||n.left>a.right||n.bottom<a.top||n.top>a.bottom)&&(i=!0))})}),i},tt.applyAltLabels=function(e,t,i,s,n){(s?e.selectAll(s):e.selectAll(".x text")).each(function(e,s){var a=t[s]?t[s][i]:"";a=a||(n?d3.select(this).text().substring(0,1):d3.select(this).text().substring(0,6)+"..."),d3.select(this).text(a)})},tt.triggerContextMenu=function(e,t,i){d3.event.preventDefault(),d3.event.stopPropagation(),d3.event.stopImmediatePropagation();var s=$.Event("contextmenu");s.target=t,s.pageX=d3.event.pageX,s.pageY=d3.event.pageY,$(e).trigger(s,[t,i])},tt.wrap=function(e,t,i){i||(i=1.27),t||(i=60),e.each(function(){var e=d3.select(this),s=e.text().split(/\s+/).reverse(),n="",a=[],r=0;if(!(s.length<=1))for(var o=i,l=e.attr("y"),d=e.attr("x"),c=parseFloat(e.attr("dy")),h=e.text(null).append("tspan").attr("x",d).attr("y",l).attr("dy",c+"em");n=s.pop();)a.push(n),h.text(a.join(" ")),h.node().getComputedTextLength()>t&&(a.pop(),h.text(a.join(" ")),a=[n],h=e.append("tspan").attr("x",d).attr("y",l).attr("dy",++r*o+c+"em").text(n))})};var it={dataset:[],animate:!0,redrawOnResize:!0};function st(e,t){this.settings=m.mergeSettings(e,t,it),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}st.prototype={init:function(){return this.width=0,this.build().handleEvents(),"initial"===this.settings.animate&&(this.settings.animate=!1),this},build:function(){var e=this,t=this.settings.dataset[0],i=this.element.closest(".is-personalizable").length>0;this.element.addClass("bullet-chart");var s=0,n=[],a=t.data[0]?t.data[0].tooltip:[],r=!1,o=this.element.parent(),l=30,d=35,c=35,h=40,p=o.width()-h-d,g=o.height()-l-c-30;g=g<0?50:g;var f=d3.select(this.element[0]).append("svg").attr("width",p+h+d).attr("height",g+l+c).append("g").attr("transform","translate("+h+","+l+")");for(var m=function(o){var l=e.settings.animate?600:0,d=e,c=t.data[o],h=c.ranges.slice().sort(d3.descending),g=c.markers?c.markers.slice().sort(d3.descending):[],m=c.measures?c.measures.slice().sort(d3.descending):[],v=c.ranges.slice().sort(d3.ascending),b=c.markers?c.markers.slice().sort(d3.ascending):[],y=c.measures?c.measures.slice().sort(d3.ascending):[];0===g.length&&(g=m,b=y,r=!0);var w=f.append("g").attr("class","bullet").attr("transform","translate(0, "+70*o+")");w.append("g").append("text").attr("class","title").attr("dy","-10px").text(function(){return c.title}).append("tspan").attr("class","subtitle").attr("dx","15px").text(function(){return c.subtitle});var x=Math.max(h[0],g[0],m[0]),C=Math.min(v[0],b[0],y[0]);C=C<0?C:0;var k,T,S=d3.scaleLinear().domain([C,x]).range([0,p]).nice(),A=(T=(k=S)(0),function(e){return Math.abs(k(e)-T)}),D=w.selectAll("rect.range").data(h);D.enter().append("rect").attr("class",function(e,t){return"range s"+t}).attr("data-idx",o).attr("width",0).attr("x",function(e){return S(e<0?e:0)}).style("fill",function(e,i){return t.barColors?t.barColors[i]:""}).attr("height",20).on("click",function(){var e=d3.select(this);d.element.trigger("selected",[e,t.data[e.attr("data-idx")]])}).on("mouseenter",function(e,r){var l=d3.select(this),d=t.data[l.attr("data-idx")],c=this.getBoundingClientRect(),h="<p>"+e+"</p>",p=function(){var e=tt.tooltipSize(h),t=c.left+c.width-e.width/2,s=c.top-e.height+$(window).scrollTop()-5;""!==h&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[i?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(t,s,h,"top"))};if(d.tooltip&&d.tooltip[r]&&(h=d.tooltip[d.tooltip.length-r-1]),a&&"function"==typeof a&&!n[r]){h="";var g=!0;s=setInterval(function(){g&&(g=!1,a(function(e){h=e,n[o]=e})),""!==h&&(clearInterval(s),p())},10)}else a="object"===(void 0===a?"undefined":u(a))?"":a,h=n[o]||a||h||"",p()}).on("mouseleave",function(){clearInterval(s),tt.hideTooltip()}).merge(D).transition().duration(l).attr("width",A);var I=w.selectAll("rect.measure").data(m);I.enter().append("rect").attr("class",function(e,t){return"measure s"+t}).attr("width",0).attr("height",3).attr("x",function(e){return S(e<0?e:0)}).style("fill",function(e,i){return t.lineColors?t.lineColors[i]:""}).attr("y",8.5).merge(I).transition().duration(l).attr("width",A);var E=w.selectAll("line.marker").data(g);E.enter().append("line").attr("class",r?"hidden":"marker").attr("x1",0).attr("x2",0).style("stroke",function(e,i){return t.markerColors?t.markerColors[i]:""}).attr("y1",20/6).attr("y2",100/6).merge(E).transition().duration(l).attr("x1",S).attr("x2",S).attr("y1",20/6).attr("y2",100/6);var L=(g[0]>m[0]?"-":"+")+Math.abs(g[0]-m[0]);0!==Math.abs(g[0]-m[0])&&E.enter().append("text").attr("class","inverse").attr("text-anchor","middle").attr("y",14).attr("dx","20px").attr("x",0).text(L).merge(E).transition().duration(l).attr("x",function(){var e=0;return w.selectAll(".measure").each(function(t){var i=A(t),s=S(t);i>e&&(e=i),s>e&&(e=s)}),e}).style("opacity",1);var P=w.selectAll("g.tick").data(S.ticks(8)).enter().append("g").attr("class","tick").attr("transform","translate(0,0)").style("opacity",0);P.append("line").attr("y1",20).attr("y2",Math.round(140/4.7)),P.append("text").attr("text-anchor","middle").attr("dy","1.1em").attr("y",Math.round(140/4.7)).attr("class",function(e){return e<0?"negative-value":"positive-value"}).text(function(e){return e}),P.transition().duration(l).attr("transform",function(e){return"translate("+S(e)+",0)"}).style("opacity",1)},v=0;v<t.data.length;v++)m(v);return tt.appendTooltip(),this.element.trigger("rendered"),this},handleEvents:function(){var e=this;return this.element.on("updated.bullet",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.bullet",function(){e.handleResize()}),this.element.on("resize.bullet",function(){e.handleResize()})),this},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.element.empty(),this.build()},teardown:function(){return this.element.off("updated.bullet resize.bullet"),$("body").off("resize.bullet"),this},destroy:function(){this.element.empty().removeClass("bullet-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"bullet"),$.removeData(this.element[0],"chart")}};var nt={dataset:[]};function at(e,t){this.settings=m.mergeSettings(e,t,nt),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}at.prototype={init:function(){return this.build().handleEvents(),this},build:function(){var e=this,t=this.settings.dataset[0];0===this.settings.dataset.length&&((t={}).data=[{name:{text:k?k.translate("NoData"):"No Data Available"},completed:{value:0}}]);var i=t.data[0],s="completion-target"===this.settings.type,a="targeted-achievement"===this.settings.type;$(this.element).addClass("completion-chart"+("targeted-achievement"===this.settings.type?" chart-targeted-achievement":"")),i.total=$.extend({},{value:100},i.total);var r=function(e){return void 0===e},o=function(e,t){var i=t?0:"";return r(e)?i:e},l=function(e,t){return t=t||i,Math.round(e/o(t.total.value,!0)*100)},d=function(e){return k.formatNumber(e/100,{style:"percent",maximumFractionDigits:0})},c=function(e,t){var s=e.toString();return-1!==s.indexOf("%")?function(e,t){return e/100*o((t=t||i).total.value,!0)}(s.replace(/%/g,""),t):e},h=function(e,t,i){var s=l(t,i),n=(s=s<0?0:s)>100?100:s;e[0].style.width=n+"%",0===n&&(e[0].className+="is-empty")},u=function(e,t,i){var s=i?e._value:e.value;return e&&!r(s)&&e.format?function(e,t,i){return".0%"===t?d(l(e,i)):d3.format(t||"")(e)}(c(s,t),e.format,t):e?c(s,t):0},p=this,g=$.extend({},{show:!1,color1:"",color2:"inverse"},i.percentText),f=void 0;r(g.color)||""!==g.color1||(g.color1=g.color);var m,v={body:$('<div class="total bar" />')},b=function(e){var t={};return(e=e||i).info&&!r(e.info.color)&&0===i.info.color.indexOf("#")&&(t.info=!0),e.completed&&!r(e.completed.color)&&0===e.completed.color.indexOf("#")&&(t.completed=!0),e.remaining&&!r(e.remaining.color)&&0===e.remaining.color.indexOf("#")&&(t.remaining=!0),e.targetline&&!r(e.targetline.color)&&0===e.targetline.color.indexOf("#")&&(t.targetline=!0),t}();if(s||a){var y=function(e){var t="",s={};return(e=e||i).total.difference&&(s.value=e.total.value-e.completed.value,s.format=i.total.format),t=(e.total.textOnly?"":u(e.total.difference?s:e.total))+(e.total.text||""),t=a&&e.remaining?(e.remaining.textOnly?"":u(e.remaining))+(e.remaining.text||""):t}();v.body.addClass("chart-completion-target"+(a?" chart-targeted-achievement":"")),v.label='<span class="label">\n        <span class="name">'+o(i.name.text)+" "+(i.completed.color&&"error"===i.completed.color?$.createIcon({icon:"error",classes:"icon-error"}):"")+'</span>\n        <span class="l-pull-right total value">'+y+"</span>\n      </span>"}else{v.body.addClass("chart-completion");var w=o(i.name.text),x=o(i.completed.color),C=o(i.info.color),T=i.info.color&&!b.info?C:"",S=o(i.info.text);b.completed||(T=x);var A="";i.info.color&&b.info&&(A=C),b.completed&&(A=x);var D=i.info&&!r(i.info.value)?o(i.info.value):u(i.completed);v.label='<b class="label name">'+w+'</b>\n      <b class="label info '+T+' colored">\n      <span class="value '+T+'" '+(A?'style="color:'+A:"")+'">'+D+'</span>\n      <span class="text '+T+'" '+(A?'style="color:'+A:"")+'">'+S+"</span>\n      </b>"}return i.remaining?v.remaining='<div class="target remaining bar'+(b.remaining?"":" "+o(i.remaining.color))+'"'+(b.remaining?' style="color:'+i.remaining.color+";background-color:"+i.remaining.color+';"':"")+'">'+(a?"":'<span aria-hidden="true"'+(s||a?"":' class="audible"')+'><span class="value'+(b.remaining?"":" "+o(i.remaining.color))+'"'+(b.remaining?' style="color:'+i.remaining.color+';"':"")+'">'+u(i.remaining)+'</span><br /><span class="text'+(b.remaining?"":" "+o(i.remaining.color))+'"'+(b.remaining?' style="color:'+i.remaining.color+';"':"")+'">'+o(i.remaining.text)+"</span></span>")+"</div>":v.remaining='<div class="target remaining bar" style="opacity: 0"></div>',i.completed&&a&&(m=m||i,g._value=m.completed?m.completed.value:0,g.percent=l(o(g._value,!0),m),g.format=".0%",g._text=void 0!==g.text?g.text:void 0!==g.value?d(g.value):u(g,m,!0),g.color=g[g.percent>55?"color2":"color1"],b.percentText=0===g.color.indexOf("#"),v.completed='<div class="completed bar'+(b.completed?"":" "+o(i.completed.color))+'"'+(b.completed?' style="color:'+i.completed.color+";background-color:"+i.completed.color+';"':"")+'"></div>'+(g.show?'<div class="chart-percent-text'+(b.percentText||""===g.color?"":" "+g.color)+'"'+(b.percentText?' style="color:'+g.color+';"':"")+">"+g._text+"</div>":"")+'<span class="completed-label" aria-hidden="true"'+(s||a?"":' class="audible"')+'><span class="text">'+o(i.completed.text)+"</span></span>"),(i.completed.text||i.completed.format&&!a)&&this.element.addClass("chart-completion-target-padding"),i.completed&&!a&&(v.completed='<div class="completed bar'+(b.completed?"":" "+o(i.completed.color))+'"'+(b.completed?' style="color:'+i.completed.color+";background-color:"+i.completed.color+';"':"")+'><span aria-hidden="true"'+(s||a?"":' class="audible"')+'><span class="value'+(b.completed?"":" "+o(i.completed.color))+'"'+(b.completed?' style="color:'+i.completed.color+';"':"")+'">'+u(i.completed)+'</span><br /><span class="text'+(b.completed?"":" "+o(i.completed.color))+'"'+(b.completed?' style="color:'+i.completed.color+';"':"")+'">'+o(i.completed.text)+"</span></span></div>"),i.targetline&&(v.targetline='<div class="target-line targetline bar'+(b.targetline?"":" "+o(i.targetline.color))+'"'+(b.targetline?' style="color:'+i.targetline.color+";background-color:"+i.targetline.color+';"':"")+'"><span aria-hidden="true"'+(s||a?"":' class="audible"')+'><span class="value'+(b.targetline?"":" "+o(i.targetline.color))+'"'+(b.targetline?' style="color:'+i.targetline.color+';"':"")+'">'+u(i.targetline)+'</span><br /><span class="text'+(b.targetline?"":" "+o(i.targetline.color))+'"'+(b.targetline?' style="color:'+i.targetline.color+';"':"")+'">'+o(i.targetline.text)+"</span></span></div>"),n.append(v.body,(v.remaining||"")+(v.completed||"")+(v.targetline||""),"<a><use><svg><div><span><br>"),n.append(this.element,v.label+v.body.prop("outerHTML"),"<a><use><svg><div><span><br>"),f={name:$(".name",e.element),info:{value:$(".info .value",e.element),text:$(".info .text",e.element)},completed:{bar:$(".completed.bar",e.element),value:$(".completed .value",e.element),text:$(".completed .text, .completed-label .text",e.element)},remaining:{bar:$(".remaining.bar",e.element),value:$(".remaining .value",e.element),text:$(".remaining .text",e.element)},targetline:{bar:$(".targetline",e.element),value:$(".targetline .value",e.element),text:$(".targetline .text",e.element)},total:{bar:$(".total.bar",e.element),value:$(".total.value",e.element)},percentText:$(".chart-percent-text",e.element)},function(e){e=e||i,f.name.data("jsonData",{name:e.name}),f.info.value.add(f.info.text).data("jsonData",{info:e.info}),f.completed.bar.add(f.completed.value).add(f.completed.text).data("jsonData",{completed:e.completed}),f.remaining.bar.add(f.remaining.value).add(f.remaining.text).data("jsonData",{remaining:e.remaining}),f.targetline.bar.add(f.targetline.value).add(f.targetline.text).data("jsonData",{targetline:e.targetline}),f.total.bar.add(f.total.value).data("jsonData",{total:e.total}),f.percentText.data("jsonData",{percentText:e.percentText})}(),function(e){var t=void 0;(e=e||i).completed&&(t=c(e.completed.value,e),h(f.completed.bar,t,e)),e.remaining&&(t=c(e.completed.value,e)+c(e.remaining.value,e),h(f.remaining.bar,t,e),s&&!a&&setTimeout(function(){var e=$(".remaining",p.element),t=$(".total",p.element),i=$(".completed .value",p.element)[0].getBoundingClientRect(),s=e.find(".value")[0].getBoundingClientRect();e.add(t)[i.right>s.left-20?"addClass":"removeClass"]("overlap")},500)),e.targetline&&(t=c(e.targetline.value,e),function(e,t){var i=t>100?100:t<0?0:t;e[0].style.left=i+"%"}(f.targetline.bar,t))}(),this},handleEvents:function(){var e=this;return this.element.on("updated.completion-chart",function(){e.updated()}),this},updated:function(e){var t=e.type||this.settings.type;return this.settings=e,this.settings.type=t,e&&e.dataset&&(this.settings.dataset=e.dataset),this.element.empty(),this.teardown().init()},teardown:function(){return this.element.off("updated.completion-chart"),this},destroy:function(){this.element.empty().removeClass("completion-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"completion-chart"),$.removeData(this.element[0],"chart")}};var rt={dataset:[],colors:["#1D5F8A","#999999","#bdbdbd","#d8d8d8"],isDots:!1,isPeakDot:!1,isMinMax:!1,isMedianRange:!1};function ot(e,t){this.settings=m.mergeSettings(e,t,rt),this.element=$(e),this.init()}ot.prototype={init:function(){return this.sparklineColors=d3.scaleOrdinal().range(this.settings.colors),this.build().handleEvents()},build:function(){var e=this,t=this.element.closest(".is-personalizable").length>0,i=void 0,s=void 0,n=[],a=[],r=e.settings.tooltip,o=0,l=0,d=0,c=void 0,h=this.calculateAspectRatioFit({srcWidth:385,srcHeight:65,maxWidth:this.element.width(),maxHeight:600}),p=h.width>300?4:3,g=e.settings.dataset;for(c=0;c<g.length;c++)l=d3.min([d3.min(g[c].data),l]),o=d3.max([d3.max(g[c].data),o]),d=d3.max([g[c].data.length,d]);var f=h.width,m=h.height,v=d3.scaleLinear().domain([0,d]).range([10,f-10]),b=d3.scaleLinear().domain([l,o]).range([m-10,10]),y=d3.line().x(function(e,t){return v(t)}).y(function(e){return b(e)});tt.appendTooltip();var w=d3.select(this.element[0]).append("svg").attr("height",m).attr("width",f);if(e.settings.isMedianRange){o=d3.max(g[0].data),l=d3.min(g[0].data);var x=f-45,C=d3.median(g[0].data),$=o-l,T=d3.scaleLinear().domain([l,o]).range([0,m]),S=m-T(C>$?C:$),A=m-T(C<$?C:$);w.append("g").attr("class","medianrange").attr("transform",function(){return"translate(10,"+S+")"}).append("rect").attr("width",x).attr("height",A).style("fill","#d8d8d8").on("mouseenter",function(){var s=this.getBoundingClientRect(),a='<p class="sparkline-tooltip">'+k.translate("Median")+"<b>"+C+"</b><br>"+k.translate("Range")+"<b>"+$+"</b>"+(e.settings.isPeakDot?"<br>"+k.translate("Peak")+"<b>"+o+"</b>":"")+"</p>",l=function(){var e=tt.tooltipSize(a),i=s.left+(s.width-e.width)/2,n=s.top-e.height-5;""!==a&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[t?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(i,n,a,"top"))};if(r&&"function"==typeof r&&!n[c]){a="";var d=!0;i=setInterval(function(){d&&(d=!1,r(function(e){a=e,n[c]=e})),""!==a&&(clearInterval(i),l())},10)}else r="object"===(void 0===r?"undefined":u(r))?"":r,a=n[c]||r||g[0].tooltip||a||"",l()}).on("mouseleave",function(){clearInterval(i),tt.hideTooltip()})}for(c=0;c<g.length;c++){var D=g[c];w.append("g").append("path").attr("d",y(D.data)).attr("stroke",e.settings.isMinMax?"#999999":this.sparklineColors(c)).attr("class","team connected-line")}return l=d3.min(g[0].data),w.selectAll(".point").data(g[0].data).enter().append("circle").attr("r",function(t){return e.settings.isMinMax&&o===t||e.settings.isMinMax&&l===t?p+1:e.settings.isDots||e.settings.isPeakDot&&o===t?p:0}).attr("class",function(t){return e.settings.isPeakDot&&o===t&&!e.settings.isMinMax?"point peak":e.settings.isMinMax&&o===t?"point max":e.settings.isMinMax&&l===t?"point min":"point"}).style("fill",function(t){return e.settings.isPeakDot&&o===t&&!e.settings.isMinMax?"#ffffff":e.settings.isMinMax&&o===t?"#56932E":e.settings.isMinMax&&l===t?"#941E1E":e.sparklineColors(0)}).style("stroke",function(t){return e.settings.isPeakDot&&o===t&&!e.settings.isMinMax?e.sparklineColors(0):e.settings.isMinMax&&o===t?"none":e.settings.isMinMax&&l===t?"none":"#ffffff"}).style("cursor","pointer").attr("cx",function(e,t){return v(t)}).attr("cy",function(e){return b(e)}).on("mouseenter",function(i){var n=this.getBoundingClientRect(),d="<p>"+(g[0].name?g[0].name+"<br> "+(e.settings.isMinMax&&o===i?k.translate("Highest")+": ":e.settings.isMinMax&&l===i?k.translate("Lowest")+": ":e.settings.isPeakDot&&o===i?k.translate("Peak")+": ":""):"")+"<b>"+i+"</b></p>",h=function(){var e=tt.tooltipSize(d),i=n.left-e.width/2+6,s=n.top-e.height-8;""!==d&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[t?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(i,s,d,"top"))};if(r&&"function"==typeof r&&!a[c]){d="";var f=!0;s=setInterval(function(){f&&(f=!1,r(function(e){d=e,a[c]=e})),""!==d&&(clearInterval(s),h())},10)}else r="object"===(void 0===r?"undefined":u(r))?"":r,d=a[c]||r||g[0].tooltip||d||"",h();d3.select(this).attr("r",e.settings.isMinMax&&o===i||e.settings.isMinMax&&l===i?p+2:p+1)}).on("mouseleave",function(t){clearInterval(s),tt.hideTooltip(),d3.select(this).attr("r",e.settings.isMinMax&&o===t||e.settings.isMinMax&&l===t?p+1:p)}),this.element.trigger("rendered",w),this},calculateAspectRatioFit:function(e){var t=Math.min(e.maxWidth/e.srcWidth,e.maxHeight/e.srcHeight);return{width:e.srcWidth*t,height:e.srcHeight*t}},handleEvents:function(){var e=this;return this.element.on("updated.sparkline",function(){e.updated()}),this},updated:function(e){var t=e.type||this.settings.type;return this.settings=e,this.settings.type=t,this.element.empty(),this.teardown().init()},teardown:function(){return this.element.off("updated.sparkline"),this},destroy:function(){tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"sparkline"),$.removeData(this.element[0],"chart")}};var lt={title:null,info:null,icon:null,button:null,color:"graphite"};function dt(e,t){this.settings=m.mergeSettings(e,t,lt),this.element=$(e),this.init()}dt.prototype={init:function(){this.setup().build()},setup:function(){return this.element.addClass("empty-message"),this},build:function(){var e=this.settings;return e.icon&&$('<div class="empty-icon">\n          <svg class="icon-empty-state is-'+this.settings.color+'" focusable="false" aria-hidden="true" role="presentation">\n            <use xlink:href="#'+e.icon+'"></use>\n          </svg></div>').appendTo(this.element),e.title&&("[NoData]"===e.title&&(e.title=k?k.translate("NoData"):"No Data Available"),$('<div class="empty-title">'+e.title+"</div>").appendTo(this.element)),e.info&&$('<div class="empty-info">'+e.info+"</div>").appendTo(this.element),e.button&&($('<div class="empty-actions"><button type="button" class="btn-secondary hide-focus '+e.button.cssClass+'" id="'+e.button.id+'"><span>'+e.button.text+"</span></button></div>").appendTo(this.element),e.button.click&&this.element.on("click",e.button.click)),this},updated:function(e){this.settings=m.mergeSettings(this.element,e,this.settings),this.element.empty(),this.build()},destroy:function(){$.removeData(this.element[0],"emptymessage"),this.element.empty()}},$.fn.emptymessage=function(e){return this.each(function(){var t=$.data(this,"emptymessage");t?t.updated(e):t=$.data(this,"emptymessage",new dt(this,e))})};var ct={dataset:[],isArea:!1,isBubble:!1,isScatterPlot:!1,showLegend:!0,hideDots:!1,animate:!0,redrawOnResize:!0,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function ht(e,t){this.settings=m.mergeSettings(e,t,ct),this.element=$(e),this.init()}ht.prototype={init:function(){return this.build().handleEvents(),"initial"===this.settings.animate&&(this.settings.animate=!1),this.element.trigger("rendered",[this.svg]),this},build:function(){var e=this,t=this.element.closest(".is-personalizable").length>0,i=!!this.settings.formatterString;if(this.element.addClass("line-chart"+(e.settings.isBubble?" bubble":"")),this.element.addClass("line-chart"+(e.settings.isScatterPlot?" scatterplot":"")),0===e.settings.dataset.length)return e.element.emptymessage(e.settings.emptyMessage),this;var s={radius:5,radiusOnHover:7,strokeWidth:2,class:"dot"};e.settings.isBubble&&(s.radius=0,s.radiusOnHover=0,s.strokeWidth=0),e.settings.isScatterPlot&&(s.radius=0,s.strokeWidth=50),$.extend(!0,s,this.settings.dots);var a=k.isRTL(),r=void 0,o=[],l=e.settings.tooltip,d=void 0,c=void 0,h={},p={atLeastOne:!1},g=["left","top","right","bottom"];if(e.settings.axisLabels&&$.extend(!0,h,e.settings.axisLabels),!$.isEmptyObject(h))for(d=0,c=g.length;d<c;d++){var f=h[g[d]];f&&"string"==typeof f&&""!==$.trim(f)&&(p[g[d]]=!0,p.atLeastOne=!0)}var v="",b=0,y=this.settings.dataset,w=e.settings.xAxis&&void 0!==e.settings.xAxis.rotate,x=function(e,t){return d3.max(e.data,function(e){return t?e.value[t]:e.value})};w&&(y[0].data.map(function(e){e.name.length>v.length&&(v=e.name)}),b=v.length);var C=this.settings.hideDots,T=this.element.parent(),S=!!$(".widget-chart-action",T).length,A=T.width()<450,D=p.top?S?15:40:S?5:30,I=p.right?A?45:65:A?45:55,E=p.bottom?w?60:50:w?5*b+35:35,L=p.right?A?55:75:A?45:65,P=T.width()-L-I,M=T.height()-D-E-30;S&&(M-=40),e.svg=d3.select(this.element[0]).append("svg").attr("width",P+L+I).attr("height",M+D+E).append("g").attr("transform","translate("+L+","+D+")");var B=y[0].data.map(function(e){return e.name}),R={};y[0]&&y[0].valueFormatterString&&$.extend(!0,R,y[0].valueFormatterString);var F=function(e,t){return!$.isEmptyObject(R)&&e?d3.format(e)("0.0%"===e?t/100:t):t},O={name:"Name",value:{x:"Value.x",y:"Value.y",z:"Value.z"}};y[0]&&y[0].labels&&$.extend(!0,O,y[0].labels);var N=void 0,z=(e.settings.xAxis&&e.settings.xAxis.scale?e.settings.xAxis.scale:d3.scaleLinear()).range([0,P]),H=d3.scaleLinear().range([M,0]),q=d3.scaleLinear().range([1,25]);N=e.settings.isBubble?{x:y.map(function(e){return x(e,"x")}),y:y.map(function(e){return x(e,"y")}),z:y.map(function(e){return x(e,"z")})}:e.settings.isScatterPlot?{x:y.map(function(e){return x(e,"x")}),y:y.map(function(e){return x(e,"y")})}:y.map(function(e){return x(e)});var V=void 0;V=d3.max(y.map(function(e){return e.data.length}))<=1?d3.max(y.map(function(e){return e.data.length})):d3.max(y.map(function(e){return e.data.length}))-1;var W=z.domain(e.settings.xAxis&&e.settings.xAxis.domain?e.settings.xAxis.domain:[0,e.settings.isBubble||e.settings.isScatterPlot?d3.max(N.x):V]),j=H.domain([0,d3.max(e.settings.isBubble||e.settings.isScatterPlot?N.y:N)]).nice(),G=q.domain([0,d3.max(e.settings.isBubble?N.z:N)]).nice(),U=V;e.settings.xAxis&&e.settings.xAxis.ticks&&(U="auto"===e.settings.xAxis.ticks?Math.max(P/85,2):e.settings.xAxis.ticks,(e.settings.isBubble||e.settings.isScatterPlot&&A)&&(U=Math.round(V/2)));var _,K=d3.axisBottom(W).ticks(U).tickPadding(10).tickSize(e.settings.isBubble||e.settings.isScatterPlot?-(M+10):0).tickFormat(function(t,i){if(e.settings.xAxis){if(e.settings.xAxis.formatter)return e.settings.xAxis.formatter(t,i);if("auto"===e.settings.xAxis.ticks)return B[t]}return e.settings.isBubble||e.settings.isScatterPlot?t:B[i]}),Y=d3.axisLeft(j).ticks(8).tickSize(-(P+20)).tickPadding(a?-18:20);if(e.settings.yAxis&&e.settings.yAxis.formatter&&Y.tickFormat(function(t,i){return"function"==typeof e.settings.yAxis.formatter?e.settings.yAxis.formatter(t,i):t}),e.settings.yAxis&&e.settings.yAxis.ticks&&Y.ticks(e.settings.yAxis.ticks.number,e.settings.yAxis.ticks.format),p.atLeastOne){var X=e.svg.append("g").attr("class","axis-labels"),J={top:"translate("+P/2+","+-10+")",right:"translate("+(P+28)+","+M/2+")rotate(90)",bottom:"translate("+P/2+","+(M+40)+")",left:"translate(-40,"+M/2+")rotate(-90)"},Q={top:"rotate(0deg) scaleX(-1) translate(-"+P/2+"px, "+-10+"px)",right:"rotate(90deg) scaleX(-1) translate(-"+(M/2+5)+"px, -"+(P+28)+"px)",bottom:"rotate(0deg) scaleX(-1) translate(-"+P/2+"px, "+(M+40)+"px)",left:"rotate(90deg) scaleX(-1) translate(-"+(M/2-5)+"px, 55px)"};for(d=0,c=g.length;d<c;d++)p[_=g[d]]&&X.append("text").attr("class","axis-label-"+_).attr("text-anchor","middle").attr("transform",a?"":J[_]).style("font-size","1.25em").style("transform",a?Q[_]:"").text(h[_])}e.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+M+")").call(K),e.svg.append("g").attr("class","y axis").call(Y),e.svg.selectAll(".tick line").attr("x1","-10"),(e.settings.isBubble||e.settings.isScatterPlot)&&(e.svg.selectAll(".x.axis .tick line, .y.axis .tick line").style("opacity",0),e.svg.select(".x.axis .tick line").attr("x2","-10").style("opacity",1),e.svg.select(".y.axis .tick line").style("opacity",1)),a&&(e.svg.selectAll("text").attr("transform","scale(-1, 1)"),e.svg.selectAll(".y.axis text").style("text-anchor","end")),w&&e.svg.selectAll(".x.axis .tick text").attr("y",0).attr("x",function(){return-(this.getBBox().width+10)}).attr("dy","1em").attr("transform","rotate("+e.settings.xAxis.rotate+")").style("text-anchor","start"),e.settings.xAxis&&e.settings.xAxis.formatText&&e.svg.selectAll(".x.axis .tick text").each(function(t){var i=d3.select(this),s=d3.select(this).text(),a=e.settings.xAxis.formatText(s,t);n.html(i.node(),a,"<tspan><text><glyph>")});var Z=d3.line().x(function(t,i){return e.settings.xAxis&&e.settings.xAxis.parser?W(e.settings.xAxis.parser(t,i)):W(e.settings.isBubble||e.settings.isScatterPlot?t.value.x:i)}).y(function(t){return j(e.settings.isBubble||e.settings.isScatterPlot?t.value.y:t.value)});y.forEach(function(n,a){var c=e.svg.append("g").attr("data-group-id",a).attr("class","line-group");if(e.settings.isArea){var h=d3.area().x(function(e,t){return W(t)}).y0(M).y1(function(t){return j(e.settings.isBubble||e.settings.isScatterPlot?t.value.y:t.value)});c.append("path").datum(n.data).attr("fill",function(){return tt.chartColor(a,"line",n)}).style("opacity",".2").attr("class","area").attr("d",h)}var p=c.append("path").datum(n.data).attr("d",Z(n.data)).attr("stroke",function(){return e.settings.isBubble||e.settings.isScatterPlot?"":tt.chartColor(a,"line",n)}).attr("stroke-width",2).attr("fill","none").attr("class","line").on("click.chart",function(){tt.selectElement(d3.select(this.parentNode),e.svg.selectAll(".line-group"),n,e.element)}),g=p.node().getTotalLength();p.attr("stroke-dasharray",g+" "+g).attr("stroke-dashoffset",g).transition().duration(e.settings.animate?600:0).ease(d3.easeCubic).attr("stroke-dashoffset",0);var f=function(a,c){var h,p=a.getBoundingClientRect(),g="<p><b>"+c.name+" </b> "+(h=c.value,i?d3.format(e.settings.formatterString)(h):h)+"</p>",f=function(){var i=tt.tooltipSize(g),s=p.left-i.width/2+6,n=p.top-i.height-18;s=e.settings.isBubble||e.settings.isScatterPlot?p.left+p.width/2-i.width/2:s,""!==g&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[t?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(s,n,g,"top"))};if(e.settings.isBubble||e.settings.isScatterPlot){for(var m in g='<div class="chart-swatch line"><div class="swatch-caption"><span class="indicator-box"></span>\n            <b>'+c.name+"</b></div>",c)if(c.hasOwnProperty(m))if("object"!==u(c[m]))g+='<div class="swatch-row"><span>'+O[m]+"</span><b>"+n.name+"</b></div>";else{var v=c[m];for(var b in v)v.hasOwnProperty(b)&&(g+='<div class="swatch-row"><span class="text-capitalize">'+O[m][b]+"</span><b>"+F(R[b],v[b])+"</b></div>")}g+="</div>"}if(l&&"function"==typeof l&&!o[d]){g="";var y=!0;r=setInterval(function(){y&&(y=!1,l(function(e){g=e,o[d]=e})),""!==g&&(clearInterval(r),f())},10)}else{l="object"===(void 0===l?"undefined":u(l))?"":l,g=o[d]||l||c.tooltip||n.tooltip||g||"",f();for(var w=document.querySelectorAll("#svg-tooltip .swatch-caption span"),x=0;x<w.length;x++)w[x].style.backgroundColor=tt.chartColor(e.settings.isBubble||e.settings.isScatterPlot?c.lineIdx:x,"line",c)}d3.select(this).attr("r",function(t){return e.settings.isBubble?2+G(t.value.z):s.radiusOnHover})};C||(e.settings.isScatterPlot||c.selectAll("circle").data(n.data).enter().append("circle").attr("class",s.class).attr("cx",function(t,i){return e.settings.xAxis&&e.settings.xAxis.parser?W(e.settings.xAxis.parser(t,i)):W(e.settings.isBubble||e.settings.isScatterPlot?t.value.x:i)}).attr("cy",function(t){return j(e.settings.isBubble||e.settings.isScatterPlot?0:t.value)}).attr("r",s.radius).style("stroke-width",s.strokeWidth).style("fill",function(){return tt.chartColor(a,"line",n)}).style("opacity",e.settings.isBubble||e.settings.isScatterPlot?".7":"1").on("mouseenter.chart",function(e){e.lineIdx=a,f(this,e)}).on("mouseleave.chart",function(){clearInterval(r),tt.hideTooltip(),d3.select(this).attr("r",function(t){return e.settings.isBubble?G(t.value.z):s.radius})}).on("click.chart",function(t){tt.selectElement(d3.select(this.parentNode),e.svg.selectAll(".line-group"),t,e.element)}),e.settings.isScatterPlot&&c.selectAll(".symbol").data(n.data).enter().append("path").attr("class","symbol").attr("transform",function(e){return"translate("+W(e.value.x)+","+j(e.value.y)+")"}).attr("d",d3.symbol().size(s.strokeWidth).type(function(){return d3.symbols[a]})).style("opacity",0).style("fill",function(){return tt.chartColor(a,"line",n)}).on("mouseenter.chart",function(e){e.lineIdx=a,f(this,e)}).on("mouseleave.chart",function(){clearInterval(r),tt.hideTooltip(),d3.select(this).attr("r",function(){return s.radius})}).on("click.chart",function(t){tt.selectElement(d3.select(this.parentNode),e.svg.selectAll(".line-group"),t,e.element)}),e.settings.isBubble&&c.selectAll("circle").attr("cy",function(e){return j(e.value.y)}).transition().duration(e.settings.animate?750:0).ease(d3.easeCubic).attr("r",function(e){return G(e.value.z)}),e.settings.isScatterPlot&&c.selectAll(".symbol").transition().duration(e.settings.animate?750:0).ease(d3.easeCubic).style("opacity",1))}),e.svg.selectAll(".y.axis .tick").attr("class",function(e){return"tick"+(0===e?" tick0":"")});var ee=y.map(function(t){return{color:t.color,name:t.name,selectionObj:e.svg.selectAll(".line-group"),selectionInverse:e.svg.selectAll(".line-group"),data:t}});return this.settings.showLegend&&tt.addLegend(ee,e.settings.isScatterPlot?"scatterplot":"line",this.settings,this.element),tt.appendTooltip(),tt.setSelected=function(t,i){var s=0,n=m.equals,a=void 0,r=void 0,o=void 0,l=function(i,l,d,c){d?(o=e.svg.select('[data-group-id="'+l+'"]').select(".dot:nth-child("+(c+2)+")"),("number"==typeof t.groupIndex&&void 0!==t.fieldName&&void 0!==t.fieldValue&&t.groupIndex===l&&t.fieldValue===d[t.fieldName]||void 0!==t.index&&"number"==typeof t.groupIndex&&t.groupIndex===l&&t.index===c||t.elem&&$(o.node()).is(t.elem)||t.data&&n(t.data,d))&&(s++,r=d,a=e.svg.select('[data-group-id="'+l+'"]'))):(o=e.svg.select('[data-group-id="'+l+'"]'),(void 0!==t.groupName&&void 0!==t.groupValue&&t.groupValue===i[t.groupName]||void 0!==t.groupIndex&&t.groupIndex===l||t.elem&&$(o.node()).is(t.elem)||t.data&&n(t.data,i))&&(s++,r=i,a=o))};y.forEach(function(e,t){s<1&&e&&e.data&&(e.data.forEach(function(i,n){s<1&&i&&l(e,t,i,n)}),s<1&&l(e,t))}),s>0&&(i||!a.classed("is-selected"))&&tt.selectElement(a,e.svg.selectAll(".line-group"),r,e.element)},this.setInitialSelected(),this.element.trigger("rendered"),this},setInitialSelected:function(){var e=this,t=0,i=void 0,s=void 0,n=function(n,a,r){n.selected&&t<1&&(t++,i=d3.select(e.svg.selectAll(".line-group").nodes()[r]),s=a)};this.settings.dataset.forEach(function(e,t){e&&n(e,e,t)}),this.settings.dataset.forEach(function(e,t){(e||e.data)&&e.data.forEach(function(i){n(i,e,t)})}),t>0&&tt.selectElement(i,e.svg.selectAll(".line-group"),s,e.element)},handleEvents:function(){var e=this;return this.element.on("updated.line",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.line",function(){e.handleResize()}),this.element.on("resize.line",function(){e.handleResize()})),$("html").on("themechanged.line",function(){e.updated()}),this},width:0,getSelected:function(){return tt.selected},setSelected:function(e,t){var i={svg:this.svg,chartData:this.settings.dataset,isStacked:!1,isGrouped:!1,isSingle:!1};tt.setSelected(e,t,i)},toggleSelected:function(e){this.setSelected(e,!0)},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this.element.empty(),e&&e.dataset&&(this.settings.dataset=e.dataset),this.build()},teardown:function(){return this.element.off("updated.line"),$("body").off("resize.line"),$("html").off("themechanged.line"),this},destroy:function(){this.element.empty().removeClass("line-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"line"),$.removeData(this.element[0],"chart")}};var ut={dataset:[],isStacked:!1,showLegend:!0,animate:!0,format:null,redrawOnResize:!0,ticks:9,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function pt(e,t){this.settings=m.mergeSettings(e,t,ut),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}pt.prototype={init:function(){return this.width=0,this.build().handleEvents(),"initial"===this.settings.animate&&(this.settings.animate=!1),this},build:function(){var e=this,t=this.element.closest(".is-personalizable").length>0,i=!!this.settings.formatterString,s=function(t){return i?d3.format(e.settings.formatterString)(t):t},a=void 0,r=this.settings.dataset;if(this.dataset=r,0===r.length)return e.element.emptymessage(e.settings.emptyMessage),this;var o=this.element.parent(),l=k.isRTL(),d="column-positive-negative"===this.settings.type||"positive-negative"===this.settings.type,c=1===r.length;this.isSingle=c;var h=!(c||!c&&e.settings.isStacked);this.isGrouped=h;var u=40,g=40,f=c&&void 0===r[0].name?e.settings.isStacked?20:50:35,v=45,b=o.width()-v-g-10,y=o.height()-u-f-(c&&void 0===r[0].name?e.settings.isStacked||d?30:0:40),w=void 0,x=void 0,C=void 0,T=void 0,S=void 0,A=void 0,D=void 0,I=void 0,E=d3.min(r,function(e){return d3.min(e.data,function(e){return e.value})}),L=d3.max(r,function(e){return d3.max(e.data,function(e){return e.value})});d&&(w=d3.min(r,function(e){return d3.min(e.data,function(e){return e.target})}),x=d3.max(r,function(e){return d3.max(e.data,function(e){return e.target})}),E=d3.min([E,w]),L=d3.max([L,x]),D={target:"Target",positive:"Positive",negative:"Negative"},S={target:"neutral",positive:"good",negative:"error"},A={},r[0]&&(r[0].colors&&$.extend(!0,S,r[0].colors),r[0].legends&&$.extend(!0,D,r[0].legends),r[0].patterns&&$.extend(!0,A,r[0].patterns)),I=[],$.each(D,function(e,t){I.push({name:t,color:S[e],pattern:A[e],option:e})})),this.element.addClass("column-chart");var P=void 0,M=[],B=e.settings.tooltip,R=d3.scaleBand().range([0,b]).round(!0).padding(.1),F=d3.scaleBand(),O=d3.scaleLinear().range([y,0]),N=null,z=null;if(e.settings.isStacked){var H={y1:[],y2:[]};a=c?r[0].data.map(function(e,t){var i=0;return 0===t?(H.y1.push(e.value),H.y2.push(0)):(i=H.y1[0]+H.y2[0],H.y1[0]=e.value,H.y2[0]=i),[$.extend({},e,{y0:i,y:e.value,x:e.name,color:e.color,pattern:e.pattern,parentName:e.name,tooltip:e.tooltip})]}):r.map(function(e,t){return e.data.map(function(i,s){var n=0;return 0===t?(H.y1.push(i.value),H.y2.push(0)):(n=H.y1[s]+H.y2[s],H.y1[s]=i.value,H.y2[s]=n),$.extend({},i,{y0:n,y:i.value,x:i.name,color:i.color,pattern:i.pattern,parentName:e.name,tooltip:e.tooltip})})}),d3.stack()(a),N=d3.scaleBand().domain(d3.range(a[0].length)).rangeRound([0,b],.05),c&&e.settings.isStacked&&N.paddingInner(.095),z=d3.scaleLinear().domain([0,d3.max(a,function(e){return d3.max(e,function(e){return e.y0+e.y})})]).range([0,y])}var q=r[0].data.map(function(e){return e.name}),V=d3.axisBottom(R).tickSize(0).tickPadding(12),W=d3.axisLeft(O).tickSize(-b).tickPadding(l?-12:12).ticks(e.settings.ticks||9,d3.format(e.settings.format||"s"));e.settings.yAxis&&(e.settings.yAxis.formatter&&W.tickFormat(function(t,i){return"function"==typeof e.settings.yAxis.formatter?e.settings.yAxis.formatter(t,i):t}),e.settings.yAxis.ticks&&e.settings.yAxis.ticks.number>1&&e.settings.yAxis.ticks.format&&W.ticks(e.settings.yAxis.ticks.number,e.settings.yAxis.ticks.format));var j=d3.select(this.element[0]).append("svg").attr("width",b+v+g).attr("height",y+u+f).append("g").attr("transform","translate("+v+","+u+")");this.svg=j;var G=r.map(function(e){return e.name}),U=void 0,_=r.map(function(e){return d3.max(e.data,function(e){return d?e.target:e.value})});if(e.settings.isStacked&&(U=a.map(function(e){return d3.max(e,function(e){return e.y+e.y0})})),c&&(G=r[0].data.map(function(e){return e.name})),d&&(E+=E/O.ticks().length,_[0]+=_[0]/(O.ticks().length/2)),function(){if(e.settings.isStacked&&c)C=r[0].data;else for(var t=void 0,i=r.length-1;i>-1;i--)t=r[i].data.map(function(e){return e}),$.extend(!0,C,t),C=$.map(C,function(e){return e})}(),e.settings.isStacked&&!c&&(T=G.map(function(e,t){return r[t]})),R.domain(e.settings.isStacked?q:G),F.domain(q).rangeRound([0,c||e.settings.isStacked?b:R.bandwidth()]),O.domain([E<0?E:e.settings.minValue||0,d3.max(e.settings.isStacked?U:_)]).nice(),(!c||c&&!e.settings.isStacked)&&j.append("g").attr("class","x axis").attr("transform","translate(0,"+(y+(d?10:0))+")").call(V),j.append("g").attr("class","y axis").call(W),l&&E<0){var K=0,Y=void 0;j.selectAll(".axis.y text").attr("class",function(e){return Y=d3.select(this).text().length,K=Y>K?Y:K,e<0?"negative-value":"positive-value"}).attr("x",function(e){return K*(e<0?9:5)})}var X=[];r.forEach(function(e){X.push($.extend({},e,{values:e.data}))}),c&&(X=[],G=r[0].data.forEach(function(e){X.push(e)}));var J=void 0,Q=void 0,Z=X[0]&&X[0].values?X[0].values.length:0,ee=b/X.length>35*(Z+1),te=function(e){return tt.chartColor(0,"",{color:e})},ie=function(e,t){var i=void 0;e.empty()?t():(i=e.size(),e.on("end",function(){0===--i&&t()}))},se=function(t){var i=void 0;if(t=d&&t,c||d){if(i=e.svg.selectAll("rect"+(t?".target-bar":".bar")).data(e.settings.isStacked?a:X).enter().append("rect").attr("class",function(e,i){var s="bar series-"+i;return d&&(s=(t?"target-bar series-"+i:s)+(e.value>0?" positive":" negative")),s}).attr("width",Math.min.apply(null,[F.bandwidth()-2,35])).attr("x",function(t){return e.settings.isStacked?N(0):F(t.name)+(F.bandwidth()-35)/2}).attr("y",function(){return O(0)>y?y:O(0)}).attr("height",function(){return 0}).attr("mask",function(e){return d?t?A.target?"url(#"+A.target+")":null:e.value<0?A.negative?"url(#"+A.negative+")":null:A.positive?"url(#"+A.positive+")":null:null}).style("fill",function(e){return d?te(t?S.target:e.value<0?S.negative:S.positive):null}),d){j.selectAll(t?".target-bartext":".bartext").data(X).enter().append("text").attr("class",function(e){return(t?"target-bartext":"bartext")+(e.value>0?" positive":" negative")}).attr("text-anchor","middle").attr("x",function(e){return(F(e.name)+F.bandwidth()/2)*(l?-1:1)}).attr("y",function(e){return t?O(e.target)-6:O(e.value>0?0:e.value)+12}).style("opacity",0).style("fill",function(e){return t?"":e.value<0?te(S.negative):te(S.positive)}).style("font-weight","bold").text(function(e){return s(t?e.target:e.value)})}i.transition().duration(e.settings.animate?1e3:0).call(ie,function(){j.selectAll(".target-bartext, .bartext").transition().duration(e.settings.animate?300:0).style("opacity",1)}).attr("y",function(i){var s=e.settings.isStacked?y-z(i[0].y)-z(i[0].y0):i.value<0?O(0):O(i.value);return t?O(i.target):i.value<0?s:s>y-3?y-2:s}).attr("height",function(i){var s=void 0;return s=e.settings.isStacked?z(i[0].y):i.value<0?y-O(0)-(y-O(i.value)):y-O(i.value)-(y-O(0)),s=i.value<0?s:s<3?2:s>y?y-O(i.value):s,t?y-O(i.target)-(y-O(0)):s})}else{(i=j.selectAll(".x-value").data(e.settings.isStacked?a:X).enter().append("g").attr("class","series-group g").attr("data-group-id",function(e,t){return t}).attr("transform",function(t){var i=R(e.settings.isStacked?q[0]:t.name),s=R.bandwidth();(!e.settings.isStacked&&ee&&s>35*X.length*2&&(i+=R.bandwidth()/2/X.length/2),e.isGrouped&&!e.settings.isStacked)&&(i-=35/(R.bandwidth()>150?2:4));return"translate("+i+",0)"}).selectAll("rect").data(function(t){return e.settings.isStacked?t:t.values}).enter().append("rect").attr("class",function(e,t){return"series-"+t+" bar"}).attr("width",Math.min.apply(null,[F.bandwidth()-2,35])).attr("x",function(t,i){var s=Math.min.apply(null,[F.bandwidth()-2,35]);return e.settings.isStacked?N(i):F.bandwidth()/2+(s+2)*i-(1===X[0].values.length||5===X[0].values.length||4===X[0].values.length?s/2:0)}).attr("y",function(){return O(0)>y?y:O(0)}).attr("height",function(){return 0})).transition().duration(e.settings.animate?600:0).attr("y",function(t){var i=e.settings.isStacked?y-z(t.y)-z(t.y0):t.value<0?O(0):O(t.value);return t.value<0?i:i>y-3?y-2:i}).attr("height",function(t){var i=void 0;return i=e.settings.isStacked?z(t.y):t.value<0?y-O(0)-(y-O(t.value)):y-O(t.value)-(y-O(0)),t.value<0?i:i<3?2:i>y?y-O(t.value):i})}return i};d&&(J=se(!0));var ne=se();return d&&(Q=d3.selectAll([].concat(p(J.nodes()),p(ne.nodes())))),d||(e.settings.isStacked?e.settings.isStacked&&!c?ne.style("fill",function(){var e=d3.select(this.parentNode).attr("data-group-id");return tt.chartColor(e,"bar",r[e])}).attr("mask",function(){var e=d3.select(this.parentNode).attr("data-group-id");return r[e].pattern?"url(#"+r[e].pattern+")":null}):e.settings.isStacked&&c&&ne.style("fill",function(e,t){return tt.chartColor(t,"bar",e[0])}).attr("mask",function(e){return e[0].pattern?"url(#"+e[0].pattern+")":null}):ne.style("fill",function(e,t){return c?tt.chartColor(t,"column-single",r[0].data[t]):tt.chartColor(t,"bar",C[t])}).attr("mask",function(e,t){return c?r[0].data[t].pattern?"url(#"+r[0].data[t].pattern+")":null:C[t].pattern?"url(#"+C[t].pattern+")":null})),$.extend(tt.settings,{svg:j,chartType:"Column",isSingle:c,isGrouped:h,isStacked:e.settings.isStacked}),(d?Q:ne).on("mouseenter",function(i,n){var o=void 0,l=void 0,h=void 0,u=void 0,p=void 0,g=void 0,f=void 0,m=this,v=$(this),b="",y=d3.event.pageY,w=function(e,t){return e&&t?'<svg width="12" height="12"><rect style="fill: '+t+'" mask="url(#'+e+')" height="12" width="12" /></svg>':""},x=function(i){g=tt.tooltipSize(b),o=v[0].getBoundingClientRect().left-g.width/2+v.attr("width")/2,e.settings.isStacked?l=v[0].getBoundingClientRect().top-g.height-10:(l=y-tt.tooltip.outerHeight()-25,r.length>1&&(o=m.parentNode.getBoundingClientRect().left-g.width/2+m.parentNode.getBoundingClientRect().width/2,i?(l+=tt.tooltip.outerHeight()+50)>m.parentNode.getBoundingClientRect().bottom+10&&(l=m.parentNode.getBoundingClientRect().bottom+10):l=m.parentNode.getBoundingClientRect().top-tt.tooltip.outerHeight()+25)),""!==b&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[t?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(o,l,b,i?"bottom":"top"))},k=function(){"string"==typeof b?b=function(e,t,i){if(null==i?i=/{{(\w+)}}/g:"string"==typeof i&&(i=new RegExp(i,"g")),"string"==typeof e&&"function"==typeof t&&i instanceof RegExp)for(var s=9999;i.test(e)&&s>0;)e=e.replace(i,function(e,i){return t(e,i)}),s--;return e}(b,function(e,t){return s(i[t])}):"number"==typeof b&&(b=b.toString())},T=function(e){b="";var t={index:n,data:i},s=function(e){"string"!=typeof e&&"number"!=typeof e||(b=e,k(),M[n]=b)},a=!0;P=setInterval(function(){a&&(a=!1,e(s,t)),""!==b&&(clearInterval(P),x())},10)};if(e.settings.isStacked){if(c)b="<p><b>"+s(i[0].value)+"</b> "+i[0].name+"</p>";else{for(b='<div class="chart-swatch"><div class="swatch-caption"><b>'+a[0][n].name+"</b></div>",h=a.length-1,u=0;h>=u;h--)p=tt.chartColor(h,"bar",r[h]),b+='<div class="swatch-row"><div style="background-color:'+(r[h].pattern?"transparent":p)+';">'+w(r[h].pattern,p)+"</div><span>"+a[h][n].parentName+"</span><b>"+s(a[h][n].value)+"</b></div>";b+="</div>"}g=tt.tooltipSize(b),o=v[0].getBoundingClientRect().left-g.width/2+v.attr("width")/2,l=v[0].getBoundingClientRect().top-g.height-10}else{if(d)b='<div class="chart-swatch"><div class="swatch-caption"><b>'+i.name+'</b></div><div class="swatch-row"><div style="background-color:'+(A.target?"transparent":te(S.target))+';">'+w(A.target,te(S.target))+"</div><span>"+D.target+"</span><b>"+s(i.target)+'</b></div><div class="swatch-row"><div style="background-color:'+(i.value<0?A.negative?"transparent":te(S.negative):A.positive?"transparent":te(S.positive))+';">'+(i.value<0?w(A.negative,te(S.negative)):w(A.positive,te(S.positive)))+"</div><span>"+D[i.value<0?"negative":"positive"]+"</span><b>"+s(i.value)+"</b></div></div>";else if(1===r.length)b="<p><b>"+s(i.value)+"</b> "+i.name+"</p>";else{var I=d3.select(this.parentNode).datum().values;for(b='<div class="chart-swatch">',h=0,u=I.length;h<u;h++)p=tt.chartColor(h,"bar",C[h]),b+='<div class="swatch-row"><div style="background-color:'+(C[h].pattern?"transparent":p)+';">'+w(C[h].pattern,p)+"</div><span>"+I[h].name+"</span><b>"+s(I[h].value)+"</b></div>";b+="</div>",f=I.length>6}g=tt.tooltipSize(b),o=v[0].getBoundingClientRect().left-g.width/2+v.attr("width")/2,l=y-tt.tooltip.outerHeight()-25,r.length>1&&(o=this.parentNode.getBoundingClientRect().left-g.width/2+this.parentNode.getBoundingClientRect().width/2,l=this.parentNode.getBoundingClientRect().top-tt.tooltip.outerHeight()+25)}B&&"function"==typeof B&&void 0===i.tooltip&&!M[n]?T(B):(b=M[n]||B||b||"",M[n]||!1===i.tooltip||void 0===i.tooltip||null===i.tooltip||("function"==typeof i.tooltip?T(i.tooltip):(b=i.tooltip.toString(),k(),M[n]=b)),"string"==typeof b&&""!==b&&x(f))}).on("mouseleave",function(){clearInterval(P),tt.hideTooltip()}).on("click",function(t,i,s){var n=this&&d3.select(this).classed("target-bar"),a=this&&d3.select(this).classed("is-selected"),r=parseInt(d3.select(this.parentNode).attr("data-group-id"),10);if(n)for(var o=d3.selectAll(".bar").nodes(),l=o.length,d=0;d<l;d++){var c=o[d];if(d3.select(c).classed("is-selected")){a=!1;break}}tt.setSelectedElement({task:a?"unselected":"selected",container:e.element,selector:this,isTrigger:!a,isTargetBar:n,triggerGroup:h,d:t,i:i,type:e.settings.type,dataset:e.dataset,isSingle:e.isSingle,isGrouped:e.isGrouped,isStacked:e.settings.isStacked,svg:e.svg,clickedLegend:!0===s}),a&&e.element.triggerHandler("selected",[d3.select(this).nodes(),{},h?r:i])}).on("contextmenu",function(t){tt.triggerContextMenu(e.element,d3.select(this).nodes()[0],t)}),e.settings.isGrouped=h,e.settings.isSingle=c,e.settings.svg=this.svg,e.settings.showLegend&&(c&&r[0].name?tt.addLegend(r,"column-single",e.settings,e.element):d?tt.addLegend(I,e.settings.type,e.settings,e.element):e.settings.isStacked&&c?tt.addLegend(C,e.settings.type,e.settings,e.element):c||tt.addLegend(e.settings.isStacked?T:C,e.settings.type,e.settings,e.element)),e.settings.xAxis&&e.settings.xAxis.formatText&&e.svg.selectAll(".x.axis .tick text").each(function(t){var i=d3.select(this),s=d3.select(this).text(),a=e.settings.xAxis.formatText(s,t);n.html(i.node(),a,"<tspan>")}),j.selectAll(".y.axis .tick").attr("class",function(e){return"tick"+(0===e?" tick0":"")}),tt.appendTooltip(),tt.labelsColide(j)&&tt.applyAltLabels(j,X,"shortName"),tt.labelsColide(j)&&tt.applyAltLabels(j,X,"abbrName"),tt.labelsColide(j)&&(tt.applyAltLabels(j,X,null,null,!0),d&&j.selectAll(".target-bartext, .bartext").attr("x",function(){return+d3.select(this).attr("x")-(l?-6:6)})),tt.setSelected=function(t,i){var s,n=0,a=m.equals,o=j.node().parentNode.nextSibling,l=d3.select(o),d=l.node()&&l.classed("chart-legend"),u=void 0,p=void 0,g=void 0,f=void 0,v=function(i,s){var o=!!i;i=o?d3.select(i):j,s=void 0!==s?s:0,i.selectAll(".bar").each(function(i,l){i&&n<1&&(void 0!==t.fieldName&&void 0!==t.fieldValue&&t.fieldValue===(c&&e.settings.isStacked?i[0][t.fieldName]:i[t.fieldName])||void 0!==t.index&&t.index===l||t.data&&a(t.data,r[s].data[l])||t.elem&&$(this).is(t.elem))&&(n++,p=d3.select(this),u=l,o&&!e.settings.isStacked&&(g=!0))})};h||e.settings.isStacked&&!c&&!h?(r.forEach(function(i,s){n<1&&(f=$(j.select('[data-group-id="'+s+'"]').node()),(void 0!==t.groupName&&void 0!==t.groupValue&&t.groupValue===i[t.groupName]||void 0!==t.groupIndex&&t.groupIndex===s||t.data&&a(t.data,i)||t.elem&&f.is(t.elem))&&void 0===t.fieldName&&void 0===t.fieldValue&&void 0===t.index&&(n++,p=j.select('[data-group-id="'+s+'"]').select(".bar"),u=s,e.settings.isStacked&&!h&&(g=!0)))}),n<1&&(s=j.selectAll(".series-group")).nodes().length&&s.each(function(e,t){v(this,t)})):v(),n>0&&(i||!p.classed("is-selected"))&&(g?d&&$(l.selectAll(".chart-legend-item")[0][u]).trigger("click.chart"):p.on("click").call(p.node(),p.datum(),u))},this.setInitialSelected(),this.element.trigger("rendered"),this},setInitialSelected:function(){var e,t=0,i=this,s=i.svg.node().parentNode.nextSibling,n=d3.select(s),a=n.node()&&n.classed("chart-legend"),r=void 0,o=void 0,l=void 0,d=function(e){(e=e?d3.select(e):i.svg).selectAll(".bar").each(function(e,s){e&&(i.isSingle&&i.settings.isStacked?e[0].selected:e.selected)&&t<1&&(t++,o=d3.select(this),r=s)})};i.isGrouped||i.settings.isStacked&&!i.isSingle&&!i.isGrouped?(i.dataset.forEach(function(e,s){e.selected&&t<1&&(t++,o=i.svg.select('[data-group-id="'+s+'"]').select(".bar"),r=s,!i.settings.isStacked||i.isSingle||i.isGrouped||(l=!0))}),t<1&&(e=i.svg.selectAll(".series-group")).nodes().length&&e.each(function(){d(this)})):d(),t>0&&(l?a&&$(n.selectAll(".chart-legend-item")[0][r]).trigger("click.chart"):o.on("click").call(o.node(),o.datum(),r))},handleEvents:function(){var e=this;return this.element.on("updated.column",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.column",function(){e.handleResize()}),this.element.on("resize.column",function(){e.handleResize()})),$("html").on("themechanged.column",function(){e.updated()}),this},getSelected:function(){return tt.selected},setSelected:function(e,t){var i={svg:this.svg,chartData:this.settings.dataset,isStacked:!1,isGrouped:!1,isSingle:!1};tt.setSelected(e,t,i)},toggleSelected:function(e){this.setSelected(e,!0)},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.element.empty(),this.build()},teardown:function(){return this.element.off("updated.column"),$("body").off("resize.column"),$("html").off("themechanged.column"),this},destroy:function(){this.element.empty().removeClass("column-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"column"),$.removeData(this.element[0],"chart")}};var gt={dataset:[],isStacked:!0,isNormalized:!1,isGrouped:!1,showLegend:!0,animate:!0,longText:!1,format:null,redrawOnResize:!0,tooltip:null,useLogScale:!1,ticks:null,showLines:!0,labelFactor:1.27,wrapWidth:60,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function ft(e,t){this.settings=m.mergeSettings(e,t,gt),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}ft.prototype={init:function(){return this.width=0,this.build().handleEvents(),"initial"===this.settings.animate&&(this.settings.animate=!1),this.element.trigger("rendered",[this.svg]),this},build:function(){var e=this,t=k.isRTL(),i=this.element.closest(".is-personalizable").length>0,s=!!this.settings.formatterString,n=function(t){return s?d3.format(e.settings.formatterString)(t):t},a=void 0,r=void 0,o=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0,p=void 0,g=void 0,f=[],m=e.settings.tooltip,v=30,b=this.element.parent().width()<450,w=innerWidth<=480,x=innerWidth>=481&&innerWidth<=992,C=innerWidth>992,T=this.settings.dataset,S=20,A=30,D=1===T.length?5:30;if(this.element.addClass("bar-chart"),this.settings.isGrouped&&this.element.addClass("bar-chart-grouped"),this.settings.isStacked&&this.element.addClass("bar-chart-stacked"),0===T.length)return e.element.emptymessage(e.settings.emptyMessage),this;var I=parseInt(this.element.parent().height(),10)-S-D-30,E=T.map(function(e){return{name:e.name,color:e.color,pattern:e.pattern}}),L={y1:[],y2:[]};T=T.map(function(e,t){return e.data.map(function(e,i){var s=0;return 0===t?(L.y1.push(e.value),L.y2.push(0)):(s=L.y1[i]+L.y2[i],L.y1[i]=e.value,L.y2[i]=s),$.extend({},e,{y0:s,y:e.value,x:e.name,color:e.color,pattern:e.pattern})})}),a=0,T=T.map(function(t,i){return e.settings.isStacked||E[i]&&(a=E[i].name.length>a?E[i].name.length:a),t.map(function(t){return e.settings.isStacked&&(a=t.x.length>a?t.x.length:a),$.extend({},t,{x:t.y,y:t.x,x0:t.y0,color:t.color,pattern:t.pattern})})});var P=this.settings.longText,M=parseInt(this.element.parent().height(),10)-D-(e.settings.isStacked?0:15),B=parseInt(this.element.parent().width(),10)-A,R=void 0;w?R=A+1*a:x?R=A+4*a:C&&(R=A+6*a),P||(R=A+6*a),e.svg=d3.select(this.element[0]).append("svg").attr("width",B).attr("height",M).append("g").attr("class","group").attr("transform","translate("+R+","+S+")");var F=d3.min(T,function(t){return d3.min(t,function(t){return e.settings.isStacked?t.x+t.x0:t.x})}),O=d3.max(T,function(t){return d3.max(t,function(t){return e.settings.isStacked?t.x+t.x0:t.x})});if(e.settings.isStacked&&e.settings.isNormalized){var N=[];T.forEach(function(e){e.forEach(function(e,t){N[t]=(void 0===N[t]?0:N[t])+e.x})}),T.forEach(function(e){e.forEach(function(e,t){var i=N[t]/100;e.x/=i,e.x0/=i})}),O=100}var z=B-R-A,H=void 0;H=e.settings.useLogScale?d3.scaleLog().domain([F>0?F:1,O]).range([1,z]).nice():d3.scaleLinear().domain([F<0?F:0,O]).range([0,z]).nice(),e.settings.isStacked?(r=T[0].map(function(e){return e.y}),p=.32):(r=E.map(function(e){return e.name}),function(){var e=void 0,t=void 0;for(e=T.length-1,-1;e>-1;e--)t=T[e].map(function(e){return e}),$.extend(!0,o,t),o=$.map(o,function(e){return e})}(),l=0,d=o.length,p=(c=I/r.length)/d,u=c-(h=d>1?c-.6*p:v),v=h/d,p=0);var q=d3.scaleBand().domain(r).rangeRound([0,I]).padding(p,p),V=d3.axisBottom().scale(H).tickSize(-I);b&&V.ticks(R<100?5:3),e.settings.isStacked&&e.settings.isNormalized&&V.tickFormat(function(e){return e+"%"}),e.settings.useLogScale&&(V.ticks(10,",.1s"),!1===e.settings.showLines&&V.tickSize(0)),e.settings.ticks&&!e.settings.useLogScale&&(w?V.ticks(e.settings.ticks.smallNumber,e.settings.ticks.format):x?V.ticks(e.settings.ticks.mediumNumber,e.settings.ticks.format):C&&V.ticks(e.settings.ticks.largeNumber,e.settings.ticks.format));var W=d3.axisLeft().scale(q).tickPadding(15).tickSize(0);e.svg.append("g").attr("class","axis x").attr("transform","translate(0,"+I+")").call(V),e.svg.append("g").attr("class","axis y").call(W);var j=e.svg.selectAll("g.group").data(T).enter().append("g").attr("class","series-group").attr("data-group-id",function(e,t){return t});if(e.settings.isGrouped=e.svg.selectAll(".series-group").nodes().length>1&&!e.settings.isStacked,e.settings.isSingle=1===e.svg.selectAll(".series-group").nodes().length&&e.settings.isStacked,j.selectAll("rect").data(function(t,i){return t.forEach(function(t){t.index=i,e.settings.isStacked||(t.gindex=l++)}),t}).enter().append("rect").attr("class",function(e,t){return"bar series-"+t}).style("fill",function(t,i){return e.settings.isStacked?1===E.length?tt.chartColor(i,"bar-single",t):tt.chartColor(t.index,"bar",E[t.index]):tt.chartColor(i,"bar",o[i])}).attr("mask",function(t,i){return 1===T.length&&T[0][i].pattern?"url(#"+T[0][i].pattern+")":e.settings.isStacked&&E[t.index].pattern?"url(#"+E[t.index].pattern+")":!e.settings.isStacked&&o[i].pattern?"url(#"+o[i].pattern+")":""}).attr("x",function(t){return e.settings.useLogScale?0:e.settings.isStacked&&!e.settings.isSingle?H(t.x0)+1:H(0)+1}).attr("y",function(t){return e.settings.isStacked?q(t.y):(c-h)/2+t.gindex*v+t.index*u}).attr("height",function(){return e.settings.isStacked?q.bandwidth():v}).attr("width",0).on("mouseenter",function(t,a){var r=void 0,l=void 0,d=void 0,c=0,h=[],u="",p=d3.select(this.parentNode).datum(),v=Math.round(p.length/2),b=d3.select(this),y=function(e,t){return e&&t?'<svg width="12" height="12"><rect mask="url(#'+e+')" height="12" width="12" /></svg>':""},w=function(e,t,s){var n=tt.tooltipSize(u),a=e+parseFloat(b.attr("width"))/2-n.width/2,r=s?t:t-n.height-13;""!==u&&(tt.tooltip&&tt.tooltip.length&&tt.tooltip[i?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(a,r,u,s?"bottom":"top"))},x=function(){"string"==typeof u?u=function(e,t,i){if(null==i?i=/{{(\w+)}}/g:"string"==typeof i&&(i=new RegExp(i,"g")),"string"==typeof e&&"function"==typeof t&&i instanceof RegExp)for(var s=9999;i.test(e)&&s>0;)e=e.replace(i,function(e,i){return t(e,i)}),s--;return e}(u,function(e,i){return n(t[i])}):"number"==typeof u&&(u=u.toString())};if(1===T.length)u="<p><b>"+t.y+" </b>"+t.x+"</p>";else{if(u='<div class="chart-swatch">',e.settings.isStacked)for(r=0,l=T.length;r<l;r++){c=0,d=tt.chartColor(r,"bar",E[r]);for(var C=0,S=T.length;C<S;C++)c+=T[C][a].x,h[C]=T[C][a].x;u+='<div class="swatch-row">\n                  <div class="swatch-color">'+y(E[r].pattern,d)+"</div>\n                  <span>"+E[r].name+"</span>\n                  <b> "+(s?n(h[r]):Math.round(h[r]/c*100)+"%")+" </b>\n                </div>"}else for(v>1&&(b=d3.select(this.parentNode).select(".series-"+v)),r=0,l=p.length;r<l;r++)d=tt.chartColor(r,"bar",o[r]),u+='<div class="swatch-row">\n                    <div class="swatch-color">'+y(o[r].pattern,d)+"</div>\n                  <span>"+p[r].name+"</span><b>"+n(p[r].value)+"</b>\n                </div>";u+="</div>"}c>0&&(u='<span class="chart-tooltip-total"><b>'+c+"</b> "+k.translate("Total")+"</span>"+u);var A=b.nodes()[0].getBoundingClientRect().top+$(window).scrollTop(),D=b.nodes()[0].getBoundingClientRect().left+$(window).scrollLeft(),I=!e.settings.isStacked&&p.length>6;if(m&&"function"==typeof m&&!f[a]){u="";var L=!0;g=setInterval(function(){L&&(L=!1,m(function(e){u=e,f[a]=e})),""!==u&&(clearInterval(g),w(D,A,I))},10)}else if(u=f[a]||m||u||"",f[a]||!1===t.tooltip||void 0===t.tooltip||null===t.tooltip||("function"==typeof t.tooltip?function(e){u="";var i={index:a,data:t},s=function(e){"string"!=typeof e&&"number"!=typeof e||(u=e,x(),f[a]=u)},n=!0;g=setInterval(function(){n&&(n=!1,e(s,i)),""!==u&&(clearInterval(g),w())},10)}(t.tooltip):(u=t.tooltip.toString(),x(),f[a]=u)),"string"==typeof u&&""!==u&&w(D,A,I),e.settings.isStacked)for(r=0,l=T.length;r<l;r++){d=tt.chartColor(r,"bar",E[r]);var P=$("#svg-tooltip").find(".swatch-row").eq(r);E[r].pattern||P.find("div").css("background-color",d),P.find("rect").css("fill",d)}else for(r=0,l=p.length;r<l;r++){d=tt.chartColor(r,"bar",o[r]);var M=$("#svg-tooltip").find(".swatch-row").eq(r);o[r].pattern||M.find("div").css("background-color",d),M.find("rect").css("fill",d)}}).on("mouseleave",function(){clearInterval(g),tt.hideTooltip()}).on("click",function(t,i){var s=this&&d3.select(this).classed("is-selected");parseInt(d3.select(this.parentNode).attr("data-group-id"),10);tt.setSelectedElement({task:s?"unselected":"selected",container:e.element,selector:this,isTrigger:!s,triggerGroup:e.settings.isGrouped,d:t,i:i,type:e.settings.type,dataset:T,isSingle:e.isSingular,isGrouped:e.settings.isGrouped,isStacked:e.settings.isStacked,svg:e.svg,clickedLegend:e.settings.clickedLegend}),s&&e.element.triggerHandler("selected",[d3.select(this).nodes(),{},i])}),e.svg.selectAll(".axis.y text").attr("x",function(){return t?15:-15}),e.svg.selectAll(".axis.x text").attr("class",function(e){return e<0?"negative-value":"positive-value"}),t&&(tt.isIE||tt.isIEEdge)&&(e.svg.selectAll("text").attr("transform","scale(-1, 1)"),e.svg.selectAll(".y.axis text").style("text-anchor","start")),b&&e.settings.useLogScale){var G=d3.selectAll(".x .tick text"),U=!1;G.attr("class",function(t,i){var s=Math.round(G.size()/2);i>=s&&!U&&t.toString().startsWith("1")&&(U=!0,s=t),0!==i&&i!==G.size()-1&&(e.settings.useLogScale?t!==s:i!==s)&&d3.select(this).remove()})}return e.svg.selectAll(".x.axis .tick").attr("class",function(e){return"tick"+(0===e?" tick0":"")}),e.svg.selectAll(".bar").transition().duration(e.settings.animate?600:0).attr("width",function(e){var t=H(e.x),i=H(0);return!isNaN(t)&&y.isFinite(t)||(t=0),!isNaN(i)&&y.isFinite(i)||(i=0),Math.abs(t-i)}).attr("x",function(t){return e.settings.useLogScale?0:e.settings.isStacked&&!e.settings.isSingle?H(t.x0)+1:t.x<0?H(t.x)+1:H(0)+1}),e.settings.svg=e.svg,e.settings.showLegend&&tt.addLegend(e.settings.isStacked?E:o,e.settings.type,e.settings,this.element),tt.appendTooltip(),this.setInitialSelected(),this.setTextValues(),this.element.trigger("rendered"),this},setTextValues:function(){if(!this.settings.isGrouped)for(var e=document.querySelectorAll(".bar-chart .axis.y .tick text"),t=this.settings.dataset,i=function(i){Object.keys(t[i]).map(function(e){return t[i][e]}).forEach(function(t){if(t&&t.constructor===Array)for(var i=0;i<t.length;i++)innerWidth<=480?e[i].textContent=t[i].shortName||t[i].name:innerWidth>=481&&innerWidth<=992?e[i].textContent=t[i].abbrName||t[i].name:innerWidth>992&&(e[i].textContent=t[i].name)})},s=0;s<t.length;s++)i(s)},setInitialSelected:function(){var e,t=0,i=this,s=i.svg.node().parentNode.nextSibling,n=d3.select(s),a=n.node()&&n.classed("chart-legend"),r=void 0,o=void 0,l=void 0,d=function(e){(e=e?d3.select(e):i.svg).selectAll(".bar").each(function(e,i){e&&e.selected&&t<1&&(t++,o=d3.select(this),r=i)})};i.settings.isGrouped||i.settings.isStacked&&!i.settings.isSingle?(i.settings.dataset.forEach(function(e,s){e.selected&&t<1&&(t++,o=i.svg.select('[data-group-id="'+s+'"]').select(".bar"),r=s,i.settings.isStacked&&!i.settings.isGrouped&&(l=!0))}),t<1&&(e=i.svg.selectAll(".series-group")).nodes().length&&e.each(function(){d(this)})):d(),t>0&&(l?a&&$(n.selectAll(".chart-legend-item")[0][r]).trigger("click.chart"):o.on("click").call(o.node(),o.datum(),r))},handleEvents:function(){var e=this;return this.element.on("updated.bar",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.bar",function(){e.handleResize()}),this.element.on("resize.bar",function(){e.handleResize()})),$("html").on("themechanged.bar",function(){e.updated()}),this},getSelected:function(){return tt.selected},setSelected:function(e,t){var i={svg:this.svg,chartData:this.settings.dataset,isStacked:this.settingsisStacked,isGrouped:this.settings.isGrouped,isSingle:this.settings.isSingle};tt.setSelected(e,t,i)},toggleSelected:function(e){this.setSelected(e,!0)},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.element.empty(),this.build().element.trigger("rendered",[this.svg])},teardown:function(){return this.element.off("updated.bar"),$("body").off("resize.bar"),$("html").off("themechanged.bar"),this},destroy:function(){this.element.empty().removeClass("bar-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"bar"),$.removeData(this.element[0],"chart")}};var mt={dataset:[],isDonut:!1,redrawOnResize:!0,hideCenterLabel:!1,showLines:!0,showLinesMobile:!1,lines:{show:"value",formatter:".0f"},showLegend:!0,legendPlacement:"right",legend:{show:"label (percent)",formatter:".0f"},showTooltips:!0,tooltip:{show:"label (value)",formatter:".0f"},emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function vt(e,t){this.settings=m.mergeSettings(e,t,mt),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}vt.prototype={init:function(){return this.width=0,this.isFirefox="firefox"===l.browser.name,0===this.settings.dataset.length?(this.element.emptymessage(this.settings.emptyMessage),this):(this.build().handleEvents(),this.element.trigger("rendered",[this.svg]),this)},build:function(){var e=this;e.svg=d3.select(this.element[0]).append("svg"),e.mainGroup=e.svg.append("g"),e.mainGroup.append("g").attr("class","slices"),e.mainGroup.append("g").attr("class","labels"),e.mainGroup.append("g").attr("class","lines"),this.element.addClass("chart-pie"),this.settings.showMobile&&(this.settings.legendPlacement="bottom"),e.settings.legendPlacement&&this.element.addClass("has-"+e.settings.legendPlacement+"-legend");var t=parseInt(this.element.width(),10),i=parseInt(this.element.height(),10),s={height:i,width:t};"right"===e.settings.legendPlacement&&(s.width=.75*t),this.settings.showMobile&&(s.height=.8*i,this.element.addClass("is-mobile")),s.radius=Math.min(s.width,s.height)/2,e.dims=s,e.pie=d3.pie().sort(null).value(function(e){return e.value}),e.arc=d3.arc().outerRadius(.75*s.radius).innerRadius(e.settings.isDonut?.5*s.radius:0),e.outerArc=d3.arc().innerRadius(.75*s.radius).outerRadius(.75*s.radius+20),e.svg.attr("width","right"===e.settings.legendPlacement?"75%":"100%").attr("height",e.settings.showMobile?"80%":"100%"),e.mainGroup.attr("transform","translate("+s.width/2+","+s.height/2+")"),s.center={x:s.width/2,y:s.height/2},e.key=function(e){return e.data.name};var n=!e.settings.dataset||0===e.settings.dataset.length;this.chartData=n?[]:e.settings.dataset[0].data,this.sum=d3.sum(this.chartData,function(e){return e.value});var a=this.chartData.map(function(t){return t.value/e.sum*100}),r=this.roundLargestRemainer(a);this.chartData=this.chartData.map(function(t,i){return t.percent=t.value/e.sum,t.percentRound=r[i],t});var o=0;if(this.chartData.map(function(e){o+=e.percentRound}),n||0===o||isNaN(o)){var l=H.themeColors().palette;this.chartData.push({data:{},color:l.graphite[30].value,name:"Empty-Pie",value:100,percent:1,percentRound:100})}if(e.updateData(e.chartData),e.settings.showTooltips&&tt.appendTooltip("is-pie"),this.settings.showLegend){var d=e.chartData.map(function(t){var i=tt.formatToSettings(t,e.settings.legend);return e.settings.legendFormatter&&(i=t.name+" ("+d3.format(e.settings.legendFormatter)(t.value)+")"),"Empty-Pie"===t.name&&(i=""),{name:i,display:"twocolumn",placement:e.settings.legendPlacement,color:t.color}});this.settings.svg=e.svg,tt.addLegend(d,"pie",this.settings,this.element)}return this.setInitialSelected(),this.addCenterLabel(),this.element.trigger("rendered"),this},randomize:function(e){var t=this;this.chartData=this.chartData.map(function(t){return t.value=e?0:Math.random(),t}),this.sum=d3.sum(this.chartData,function(e){return e.value});var i=this.chartData.map(function(e){return e.value/t.sum*100}),s=this.roundLargestRemainer(i);return this.chartData=this.chartData.map(function(e,i){return e.percent=e.value/t.sum,e.percentRound=s[i],e}),this.chartData},addCenterLabel:function(){if(this.settings.isDonut&&!this.settings.hideCenterLabel){var e=this.settings.dataset[0].centerLabel,t=this.svg.selectAll(".slices");if(t.append("text").attr("dy",".35em").style("text-anchor","middle").attr("class","chart-donut-text").html(e),tt.isIE&&!tt.isIEEdge)if(m.isHTML(e)){var i=t.select(".chart-donut-text"),s=document.createElement("text");s.innerHTML=e,Array.prototype.slice.call(s.childNodes).forEach(function(e){i.append("tspan").attr("style",e.getAttribute&&e.getAttribute("style")).attr("x",e.getAttribute&&e.getAttribute("x")).attr("dy",e.getAttribute&&e.getAttribute("dy")).text(e.textContent)})}else t.select(".chart-donut-text").text(e)}},updateData:function(e){var t=this,i=this.element.closest(".is-personalizable").length>0,s=void 0,n=!t.settings.dataset||0===t.settings.dataset.length,a=t.svg.select(".slices").selectAll("path.slice").data(t.pie(e),t.key);if(t.isRTL=k.isRTL(),a.enter().insert("path").style("fill",function(e,t){return tt.chartColor(t,"pie",e.data)}).attr("class","slice").on("contextmenu",function(e){tt.triggerContextMenu(t.element,d3.select(this).select("path").nodes()[0],e)}).on("click",function(e,i){clearTimeout(s);var n=this&&d3.select(this).classed("is-selected");tt.setSelectedElement({task:n?"unselected":"selected",container:t.element,selector:n?".chart-container .is-selected":this,isTrigger:!n,d:e.data,i:i,type:t.settings.type,dataset:t.settings.dataset,svg:t.svg}),n&&t.element.triggerHandler("selected",[d3.select(this).nodes(),{},i])}).on("mouseenter",function(e,n){if(t.settings.showTooltips){var a=function(e){var i=document.body,s=void 0;if(t.isFirefox&&0===t.settings.dotSize){var n=d3.select(e);n.attr("r",2),s=e.getBoundingClientRect(),n.attr("r",t.settings.dotSize)}else s=e.getBoundingClientRect();return{top:s.top+i.scrollTop,left:s.left+i.scrollLeft}}(t.svg.selectAll("circle").nodes()[n]),r=t.midAngle(e),o=r<=Math.PI/4&&r>=0||r>7*Math.PI/4,l=r<=3*Math.PI/4&&r>=Math.PI/4,d=r<=5*Math.PI/4&&r>=3*Math.PI/4,c=r<=7*Math.PI/4&&r>=5*Math.PI/4,h="",u=tt.formatToSettings(e,t.settings.tooltip);-1===(h=(h=(h=(h=(h=e.data.tooltip||u).replace("{{percent}}",e.data.percentRound+"%")).replace("{{value}}",e.value)).replace("%percent%",e.data.percentRound+"%")).replace("%value%",e.value)).indexOf("<b>")&&(h=(h=h.replace("(","<b>")).replace(")","</b>")),null!=s&&clearTimeout(s),s=setTimeout(function(){!function(){if(""!==h){var e=tt.tooltipSize(h),t=a.left,s=a.top;tt.tooltip&&tt.tooltip.length&&(o||l||d||c)&&tt.tooltip[i?"addClass":"removeClass"]("is-personalizable"),o&&(t-=e.width/2,s-=e.height-5,tt.showTooltip(t,s,h,"top")),l&&(s-=e.height/2,tt.showTooltip(t,s,h,"right")),d&&(t-=e.width/2,tt.showTooltip(t,s,h,"bottom")),c&&(t-=e.width-5,s-=e.height/2,tt.showTooltip(t,s,h,"left"))}}()},300)}}).on("mouseleave",function(){clearTimeout(s),tt.hideTooltip()}).merge(a).transition().duration(t.settings.animationSpeed).attrTween("d",function(e){this.current=this.current||e;var i=d3.interpolate(this.current,e);return this.current=i(0),function(e){return t.arc(i(e))}}),a.exit().remove(),!n){var r=t.element.parent().width()<520,o=t.settings.showLines;if(!t.settings.showLinesMobile&&o&&(o=!r),t.settings.dotSize=o?2:0,o){var l=t.svg.select(".labels").selectAll("text").data(t.pie(e),t.key);l.enter().append("text").attr("dy",".35em").text(function(e){return tt.formatToSettings(e,t.settings.lines)}).merge(l).transition().duration(t.settings.animationSpeed).attrTween("transform",function(e){this.current=this.current||e;var i=d3.interpolate(this.current,e);return this.current=i(0),function(e){var s=i(e),n=t.outerArc.centroid(s);return n[0]=t.dims.radius*(t.midAngle(s)<Math.PI?1:-1),n[0]-=t.midAngle(s)<Math.PI?20:-20,"translate("+n+")"}}).styleTween("text-anchor",function(e){this.current=this.current||e;var i=d3.interpolate(this.current,e);return this.current=i(0),function(e){var s=i(e);return t.isRTL?t.midAngle(s)>Math.PI?"start":"end":t.midAngle(s)<Math.PI?"start":"end"}}),l.exit().remove();var d=t.svg.select(".lines").selectAll("polyline").data(t.pie(e),t.key);d.enter().append("polyline").merge(d).transition().duration(t.settings.animationSpeed).attrTween("points",function(e){this.current=this.current||e;var i=d3.interpolate(this.current,e);return this.current=i(0),function(e){var s=i(e),n=t.outerArc.centroid(s);return n[0]=.85*t.dims.radius*(t.midAngle(s)<Math.PI?1:-1),[t.outerArc.centroid(s),t.outerArc.centroid(s),n]}}),d.exit().remove()}var c=t.svg.select(".lines").selectAll("circle").data(t.pie(e),t.key);c.enter().append("circle").attr("class","circles").attr("r",t.settings.dotSize).merge(c).transition().duration(t.settings.animationSpeed).attrTween("transform",function(e){this.current=this.current||e;var i=d3.interpolate(this.current,e);return this.current=i(0),function(e){var s=i(e);return"translate("+t.outerArc.centroid(s)+" )"}}),c.exit().remove()}},setInitialSelected:function(){var e=0,t=void 0;this.svg.selectAll(".slice").each(function(i,s){i&&i.data&&i.data.selected&&e<1&&(e++,(t=d3.select(this)).on("click").call(t.node(),t.datum(),s))})},handleEvents:function(){var e=this;return this.element.on("updated.pie",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.pie",function(){e.handleResize()}),this.element.on("resize.pie",function(){e.handleResize()})),$("html").on("themechanged.pie",function(){e.updated()}),this},getSelected:function(){return tt.selected},setSelected:function(e,t){var i=this,s=void 0,n=void 0,a=0,r=m.equals;this.svg.selectAll(".slice").each(function(t,o){t&&t.data&&a<1&&(void 0!==e.fieldName&&void 0!==e.fieldValue&&e.fieldValue===t.data[e.fieldName]||void 0!==e.index&&e.index===o||e.data&&r(e.data,i.chartData[o].data)||e.elem&&$(this).is(e.elem))&&(a++,s=d3.select(this),n=o)}),a>0&&(t||!s.classed("is-selected"))&&s.on("click").call(s.node(),s.datum(),n)},toggleSelected:function(e){this.setSelected(e,!0)},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.element.empty(),this.build().element.trigger("rendered",[this.svg])},roundLargestRemainer:function(e){for(var t=0,i=0,s=0,n=[],a=0;a<e.length;a++)t+=parseInt(e[a],10),n[a]=a;var r=100-t;n.sort(function(t,i){return s=e[t]-parseInt(e[t],10),e[i]-parseInt(e[i],10)-s}),e.sort(function(e,t){return s=e-parseInt(e,10),t-parseInt(t,10)-s});for(var o=0;o<e.length;o++)i=o,e[o]=i<r?parseInt(e[o],10)+1:parseInt(e[o],10);for(var l=[],d=0;d<e.length;d++)l[n[d]]=e[d];return l},teardown:function(){return this.element.off("updated.pie"),$("body").off("resize.pie"),$("html").off("themechanged.pie"),this},midAngle:function(e){return e.startAngle+(e.endAngle-e.startAngle)/2},destroy:function(){this.element.empty().removeClass("pie-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"pie"),$.removeData(this.element[0],"chart")}};var bt={dataset:[],redrawOnResize:!0,margin:{top:50,right:0,bottom:50,left:0},levels:4,maxValue:0,labelFactor:1.27,wrapWidth:60,opacityArea:.2,dotRadius:3,opacityCircles:0,strokeWidth:1,roundStrokes:!0,showCrosslines:!0,showAxisLabels:!0,colors:null,showTooltips:!0,tooltip:{show:"value",formatter:".0%"},axisFormatter:".0%",showLegend:!0,legendPlacement:"right",emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function yt(e,t){this.settings=m.mergeSettings(e,t,bt),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}yt.prototype={init:function(){return this.width=0,this.setupColors().build().handleEvents(),this.element.trigger("rendered",[this.svg]),this},build:function(){return this.updateData(this.settings.dataset),this.setInitialSelected(),this},setupColors:function(){return this.settings.colors&&!this.useBuiltInColors||(this.settings.colors=tt.colorRange(),this.useBuiltInColors=!0),this},updateData:function(e){var t=this,i=this.element.closest(".is-personalizable").length>0,s=t.settings,n={w:parseInt(this.element.parent().width(),10),h:parseInt(this.element.parent().height()-115,10)};if("right"===s.legendPlacement&&(n.w*=.75),this.element.addClass("chart-radar"),0!==e.length){var a=void 0,r=d3.scaleOrdinal(t.settings.colors),o=Math.max(s.maxValue,d3.max(e,function(e){return d3.max(e.data.map(function(e){return e.value}))})),l=e[0].data.map(function(e){return function(e){var t=328,i=469,s="";return n.w<=t?s=e.shortName||e.abbrName||e.name||"":n.w>=t+1&&n.w<=i?s=e.abbrName||e.name||"":n.w>i&&(s=e.name||""),s}(e)}),d=l.length,c=Math.min(n.w/2,n.h/2),h=2*Math.PI/d;if(n.w<=328){var u=n.w<225?75:50;c=Math.min((n.w-u)/2,(n.h-u)/2)}var p=d3.scaleLinear().range([0,c]).domain([0,o]),g=this.element[0];d3.select(g).select("svg").remove();var f=d3.select(g).append("svg").attr("width",n.w+s.margin.left+s.margin.right).attr("height",n.h+s.margin.top+s.margin.bottom).attr("class","chart-radar");this.svg=f;var m=f.append("g").attr("transform","translate("+(n.w/2+s.margin.left)+","+(n.h/2+s.margin.top)+")");if(s.opacityCircles>0){var v=m.append("defs").append("filter").attr("id","glow");v.append("feGaussianBlur").attr("stdDeviation","2.5").attr("result","coloredBlur");var b=v.append("feMerge");b.append("feMergeNode").attr("in","coloredBlur"),b.append("feMergeNode").attr("in","SourceGraphic")}var y=m.append("g").attr("class","chart-radar-axis-wrapper");y.selectAll(".levels").data(d3.range(1,s.levels+1).reverse()).enter().append("circle").attr("class","chart-radar-grid-circle").attr("r",function(e){return c/s.levels*e}).style("fill-opacity",s.opacityCircles).style("filter",s.opacityCircles>0?"url(#glow)":""),this.settings.showAxisLabels&&y.selectAll(".axis-label").data(d3.range(1,s.levels+1).reverse()).enter().append("text").attr("class","axis-label").attr("x",4).attr("y",function(e){return-e*c/s.levels}).attr("dy","0.4em").style("font-size",H.uplift?"12px":"10px").attr("fill","#737373").text(function(e){var t=Math.round(10*o)/10;return s.axisFormatter.indexOf("%")>-1?d3.format(s.axisFormatter)(t*e/s.levels):d3.format(s.axisFormatter)(e/s.levels)});var w=y.selectAll(".axis").data(l).enter().append("g").attr("class","axis");this.settings.showCrosslines&&w.append("line").attr("x1",0).attr("y1",0).attr("x2",function(e,t){return p(1.05*o)*Math.cos(h*t-Math.PI/2)}).attr("y2",function(e,t){return p(1.05*o)*Math.sin(h*t-Math.PI/2)}).attr("class","chart-radar-crossline").style("stroke-width","1px"),w.append("text").attr("class","legend").style("font-size",H.uplift?"14px":"12px").attr("text-anchor","middle").attr("dy","0.35em").attr("x",function(e,t){return p(o*s.labelFactor)*Math.cos(h*t-Math.PI/2)}).attr("y",function(e,t){return p(o*s.labelFactor)*Math.sin(h*t-Math.PI/2)}).text(function(e){return e}),this.element[n.w<420?"addClass":"removeClass"]("is-small"),n.w>456&&f.selectAll(".chart-radar-axis-wrapper .axis .legend").each(function(){tt.wrap(d3.select(this),s.wrapWidth,s.labelFactor)});var x=d3.lineRadial().curve(d3.curveBasisClosed).radius(function(e){return p(e.value)}).angle(function(e,t){return t*h});s.roundStrokes&&x.curve(d3.curveCardinalClosed);var C=m.selectAll(".radarWrapper").data(e.map(function(e){return e.data})).enter().append("g").attr("class","chart-radar-wrapper");if(C.append("path").attr("class","chart-radar-area").attr("d",function(e){return x(e)}).style("fill",function(e,t){return r(t)}).style("fill-opacity",s.opacityArea).on("click",function(e,i){clearTimeout(a);var s=d3.select(this),n=s.classed("is-selected");f.selectAll(".is-selected").classed("is-selected",!1),f.selectAll(".is-not-selected").classed("is-not-selected",!1),n||(f.selectAll(".chart-radar-area").classed("is-not-selected",!0),s.classed("is-selected",!0).classed("is-not-selected",!1),s.style("fill-opacity",t.settings.opacityArea));var r={elem:s.nodes(),data:e,index:i};t.element.triggerHandler(n?"deselected":"selected",r),tt.selected=n?[]:r}),C.append("path").attr("class","chart-radar-stroke").attr("d",function(e){return x(e)}).style("stroke-width",s.strokeWidth+"px").style("stroke",function(e,t){return r(t)}).style("fill","none").style("filter",s.opacityCircles>0?"url(#glow)":""),C.selectAll(".chart-radar-circle").data(function(e){return e}).enter().append("circle").attr("class","chart-radar-circle").attr("r",s.dotRadius).attr("cx",function(e,t){return p(e.value)*Math.cos(h*t-Math.PI/2)}).attr("cy",function(e,t){return p(e.value)*Math.sin(h*t-Math.PI/2)}).style("fill",function(){return r($(this.parentNode).index()-1)}).style("fill-opacity",.6),m.selectAll(".radar-circle-wrapper").data(e.map(function(e){return e.data})).enter().append("g").attr("class","radar-circle-wrapper").selectAll(".radar-invisible-circle").data(function(e){return e}).enter().append("circle").attr("class","radar-invisible-circle").attr("r",1.5*s.dotRadius).attr("cx",function(e,t){return p(e.value)*Math.cos(h*t-Math.PI/2)}).attr("cy",function(e,t){return p(e.value)*Math.sin(h*t-Math.PI/2)}).style("fill","none").style("pointer-events","all").on("mouseenter",function(e){if(s.showTooltips){var n=$(this).offset(),r=tt.formatToSettings(e,t.settings.tooltip);-1===r.indexOf("<b>")&&(r=(r=r.replace("(","<b>")).replace(")","</b>"));var o=tt.tooltipSize(r),l=n.left,d=n.top;l-=o.width/2-6,d-=o.height+6,null!=a&&clearTimeout(a),a=setTimeout(function(){tt.tooltip&&tt.tooltip.length&&tt.tooltip[i?"addClass":"removeClass"]("is-personalizable"),tt.showTooltip(l,d,r,"top")},300)}}).on("mouseleave",function(){clearTimeout(a),tt.hideTooltip()}),s.showTooltips&&tt.appendTooltip("is-pie"),s.showLegend){s.legendPlacement&&this.element.addClass("has-"+s.legendPlacement+"-legend");var k=t.settings.dataset.map(function(e,i){return{name:e.name,display:"twocolumn",placement:t.settings.legendPlacement,color:r(i)}});this.settings.svg=t.svg,tt.addLegend(k,"pie",this.settings,this.element)}}else t.element.emptymessage(t.settings.emptyMessage)},setInitialSelected:function(){},handleEvents:function(){var e=this;return this.element.on("updated.radar",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.radar",function(){e.handleResize()}),this.element.on("resize.radar",function(){e.handleResize()})),$("html").on("themechanged.radar",function(){e.updated()}),this},getSelected:function(){return tt.selected},setSelected:function(e,t){var i=void 0,s=void 0,n=0,a=this;this.svg.selectAll(".chart-radar-area").each(function(t,r){var o=a.settings.dataset[r];o&&o.data&&n<1&&(void 0!==e.fieldName&&void 0!==e.fieldValue&&e.fieldValue===o[e.fieldName]||void 0!==e.index&&e.index===r||e.elem&&$(this).is(e.elem))&&(n++,i=d3.select(this),s=r)}),n>0&&(t||!i.classed("is-selected"))&&i.on("click").call(i.node(),i.datum(),s)},toggleSelected:function(e){this.setSelected(e,!0)},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset?(this.element.find(".chart-legend").remove(),this.settings.dataset=e.dataset,this.updateData(this.settings.dataset),this):(this.element.empty(),this.setupColors().build())},teardown:function(){return this.element.off("updated.radar"),$("body").off("resize.radar"),$("html").off("themechanged.radar"),this},destroy:function(){this.element.empty().removeClass("radar-chart"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"radar"),$.removeData(this.element[0],"radar")}},$.fn.chart=function(e){var t=null;switch(this.empty(),e.type){case"targeted-achievement":case"completion":case"completion-target":if(t=this.data(e.type))return t.updated(e),this;var i=new at(this,e);this.data("completion-chart",i),this.data("chart",i),this.data(e.type,i);break;case"bullet":if(t=this.data("bullet"))return t.updated(e),this;var s=new st(this,e);this.data("bullet",s),this.data("chart",s);break;case"radar":if(t=this.data("radar"))return t.updated(e),this;var n=new yt(this,e);this.data("radar",n),this.data("chart",n);break;case"sparkline":if(t=this.data("sparkline"))return t.updated(e),this;var a=new ot(this,e);this.data("sparkline",a),this.data("chart",a);break;case"sparkline-dots":if(e.isDots=!0,t=this.data("sparkline"))return t.updated(e),this;var r=new ot(this,e);this.data("sparkline",r),this.data("chart",r);break;case"sparkline-peak":if(e.isPeakDot=!0,t=this.data("sparkline"))return t.updated(e),this;var o=new ot(this,e);this.data("sparkline",o),this.data("chart",o);break;case"sparkline-dots-n-peak":if(e.isPeakDot=!0,e.isDots=!0,t=this.data("sparkline"))return t.updated(e),this;var l=new ot(this,e);this.data("sparkline",l),this.data("chart",l);break;case"sparkline-minmax":if(e.isMinMax=!0,t=this.data("sparkline"))return t.updated(e),this;var d=new ot(this,e);this.data("sparkline",d),this.data("chart",d);break;case"sparkline-medianrange":if(e.isMedianRange=!0,t=this.data("sparkline"))return t.updated(e),this;var c=new ot(this,e);this.data("sparkline",c),this.data("chart",c);break;case"sparkline-medianrange-n-peak":if(e.isMedianRange=!0,e.isPeakDot=!0,t=this.data("sparkline"))return t.updated(e),this;var h=new ot(this,e);this.data("sparkline",h),this.data("chart",h);break;case"line":if(t=this.data("line"))return t.updated(e),this;var u=new ht(this,e);this.data("line",u),this.data("chart",u);break;case"area":if(e.isArea=!0,t=this.data("line"))return t.updated(e),this;var p=new ht(this,e);this.data("line",p),this.data("chart",p);break;case"bubble":if(e.isBubble=!0,t=this.data("line"))return t.updated(e),this;var g=new ht(this,e);this.data("line",g),this.data("chart",g);break;case"scatterplot":if(e.isScatterPlot=!0,t=this.data("line"))return t.updated(e),this;var f=new ht(this,e);this.data("line",f),this.data("chart",f);break;case"column":case"column-grouped":case"positive-negative":case"column-positive-negative":if(t=this.data("column"))return t.updated(e),this;var m=new pt(this,e);this.data("column",m),this.data("chart",m);break;case"column-stacked":if(e.isStacked=!0,t=this.data("column"))return t.updated(e),this;var v=new pt(this,e);this.data("column",v),this.data("chart",v);break;case"bar":if(e.isStacked=!0,t=this.data("bar"))return t.updated(e),this;var b=new ft(this,e);this.data("bar",b),this.data("chart",b);break;case"bar-stacked":if(e.isStacked=!0,t=this.data("bar"))return t.updated(e),this;var y=new ft(this,e);this.data("bar",y),this.data("chart",y);break;case"bar-normalized":if(e.isNormalized=!0,t=this.data("bar"))return t.updated(e),this;var w=new ft(this,e);this.data("bar",w),this.data("chart",w);break;case"bar-grouped":if(e.isStacked=!1,e.isGrouped=!0,t=this.data("bar"))return t.updated(e),this;var x=new ft(this,e);this.data("bar",x),this.data("chart",x);break;case"pie":if(t=this.data("pie"))return t.updated(e),this;var C=new vt(this,e);this.data("pie",C),this.data("chart",C);break;case"donut":if(e.isDonut=!0,t=this.data("pie"))return t.updated(e),this;var k=new vt(this,e);this.data("pie",k),this.data("chart",k);break;default:t=null}return this};var wt={locale:null,month:(new Date).getMonth(),year:(new Date).getFullYear(),activeDate:null,activeDateIslamic:null,isPopup:!1,headerStyle:"full",firstDayOfWeek:null,disable:{dates:[],minDate:"",maxDate:"",dayOfWeek:[],isEnable:!1,restrictMonths:!1},legend:[{name:"Public Holiday",color:"#76B051",dates:[]},{name:"Weekends",color:"#EFA836",dayOfWeek:[]}],hideDays:!1,showMonthYearPicker:!0,yearsAhead:5,yearsBack:4,range:{useRange:!1,start:"",end:"",separator:" - ",minDays:0,maxDays:0,selectForward:!1,selectBackward:!1,includeDisabled:!1},selectable:!0,onSelected:null};function xt(e,t){this.settings=m.mergeSettings(e,t,wt),this.element=$(e),this.init()}xt.prototype={init:function(){return this.build()},setLocale:function(){var e=this;!this.settings.locale||this.locale&&this.locale.name===this.settings.locale?this.settings.locale||(this.locale=k.currentLocale):k.getLocale(this.settings.locale).done(function(t){e.locale=k.cultures[t],e.setCurrentCalendar(),e.build().handleEvents()})},build:function(){var e=this;if("false"===this.settings.showMonthYearPicker&&(this.settings.showMonthYearPicker=!1),this.setLocale(),this.rendered||this.settings.locale&&(!this.locale||this.locale.name!==this.settings.locale))return this.rendered=!1,this;this.rendered=!0,this.setCurrentCalendar(),this.prevButton='<button type="button" class="btn-icon prev">\n        '+$.createIcon("caret-left")+"\n        <span>"+k.translate("PreviousMonth",{locale:this.locale.name})+"</span>\n      </button>",this.nextButton='<button type="button" class="btn-icon next">\n        '+$.createIcon("caret-right")+"\n        <span>"+k.translate("NextMonth",{locale:this.locale.name})+"</span>\n      </button>";var t='<button type="button" class="btn btn-monthyear-pane expandable-area-trigger" id="btn-monthyear-pane">\n        <span class="month">november</span>\n        <span class="year">2015</span>\n        <svg class="icon icon-closed" focusable="false" aria-hidden="true" role="presentation">\n          <use xlink:href="#icon-dropdown"></use>\n        </svg>\n        <svg class="icon icon-opened" focusable="false" aria-hidden="true" role="presentation">\n          <use xlink:href="#icon-dropdown"></use>\n        </svg>\n      </button>';return this.settings.hideDays&&(t=""),this.header=$('<div class="monthview-header">\n        '+(this.settings.showMonthYearPicker?t:'<span class="month">november</span><span class="year">2015</span>')+"\n        "+(this.isRTL?this.nextButton+this.prevButton:this.prevButton+this.nextButton)+"\n      </div>"),this.table=$('<table class="monthview-table" aria-label="'+k.translate("Calendar",{locale:this.locale.name})+'" role="application"></table>'),this.dayNames=$("<thead>\n        <tr>\n          <th>SU</th>\n          <th>MO</th>\n          <th>TU</th>\n          <th>WE</th>\n          <th>TH</th>\n          <th>FR</th>\n          <th>SA</th>\n        </tr>\n      </thead>").appendTo(this.table),this.days=$('<tbody>\n        <tr>\n          <td class="alternate">26</td>\n          <td class="alternate">27</td>\n          <td class="alternate">28</td>\n          <td class="alternate">29</td>\n          <td class="alternate" >30</td>\n          <td class="alternate">31</td>\n          <td>1</td>\n        </tr><tr>\n          <td>2</td>\n          <td>3</td>\n          <td>4</td>\n          <td>5</td>\n          <td>6</td>\n          <td>7</td>\n          <td>8</td>\n        </tr><tr>\n          <td>9</td>\n          <td>10</td>\n          <td>11</td>\n          <td>12</td>\n          <td>13</td>\n          <td>14</td>\n          <td>15</td>\n        </tr><tr>\n          <td>16</td>\n          <td>17</td>\n          <td>18</td>\n          <td>19</td>\n          <td class="is-today">20</td>\n          <td>21</td>\n          <td>22</td>\n        </tr><tr>\n          <td>23</td>\n          <td>24</td>\n          <td>25</td>\n          <td>26</td>\n          <td>27</td>\n          <td>28</td>\n          <td class="alternate">1</td>\n        </tr><tr>\n          <td class="alternate">2</td>\n          <td class="alternate">3</td>\n          <td class="alternate">4</td>\n          <td class="alternate">5</td>\n          <td class="alternate">6</td>\n          <td class="alternate">7</td>\n          <td class="alternate">8</td>\n        </tr>\n      </tbody>').appendTo(this.table),this.monthYearPane=$(this.settings.showMonthYearPicker?'<div class="monthview-monthyear-pane expandable-area '+(this.settings.hideDays?" is-expanded":"")+'">\n      <div class="expandable-pane">\n        <div class="content"><div class="picklist-section is-month"></div><div class="picklist-section is-year"></div></div>\n      </div>\n    </div>':""),this.settings.hideDays&&(this.table=""),"full"===this.settings.headerStyle&&(this.header=$('<div class="monthview-header full">\n          '+(this.isRTL?this.nextButton+this.prevButton:this.prevButton+this.nextButton)+'\n          <span class="monthview-datepicker">\n            <span class="hidden month"></span><span class="hidden year"></span>\n            <input aria-label="'+k.translate("Today",{locale:this.locale.name})+'" id="monthview-datepicker-field" readonly data-init="false" class="datepicker" name="monthview-datepicker-field" type="text"/>\n          </span>\n          <a class="hyperlink today" href="#">'+k.translate("Today",{locale:this.locale.name})+"</a>\n        </div>"),this.monthPicker=this.header.find("#monthview-datepicker-field"),this.todayLink=this.header.find(".hyperlink.today")),this.showMonth(this.settings.month,this.settings.year),this.calendar=this.element.addClass("monthview").append(this.header,this.monthYearPane,this.table),this.settings.isPopup||this.element.addClass("is-fullsize"),this.addLegend(),"full"===this.settings.headerStyle&&(this.monthPicker.datepicker({autoSize:!0,dateFormat:k.calendar(this.locale.name).dateFormat.year,locale:this.settings.locale,showMonthYearPicker:!0,onOpenCalendar:function(){return e.currentDate}}),this.header.find("button, a").hideFocus()),this.handleEvents(),this},setCurrentCalendar:function(){this.currentCalendar=k.calendar(this.locale.name,this.settings.calendarName),this.isIslamic="islamic-umalqura"===this.currentCalendar.name,this.isRTL="right-to-left"===this.locale.direction,this.conversions=this.currentCalendar.conversions},showMonth:function(e,t){var i=this,n=this.settings,a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0);var r=n.activeDate&&n.activeDate.getDate()?n.activeDate:a;if(this.setCurrentCalendar(),this.isIslamic)if(n.activeDateIslamic)r=n.activeDateIslamic;else{var o=new Date;this.todayDateIslamic=this.conversions.fromGregorian(o),n.activeDateIslamic=[],n.activeDateIslamic[0]=this.todayDateIslamic[0],n.activeDateIslamic[1]=this.todayDateIslamic[1],n.activeDateIslamic[2]=this.todayDateIslamic[2],t=n.activeDateIslamic[0],e=n.activeDateIslamic[1],r=this.conversions.fromGregorian(a)}t.toString().length<4&&(t=(new Date).getFullYear()),12===e&&(t++,e=0,this.currentMonth=e,this.currentYear=t),e<0&&(t--,e=11,this.currentMonth=e,this.currentYear=t),this.currentDay=this.currentDay||a.getDate();var l=this.currentCalendar.days.narrow;l=l||this.currentCalendar.days.abbreviated,n.isPopup||(l=this.currentCalendar.days.abbreviated);var d=this.currentCalendar.months.wide[e];this.currentMonth=e,this.currentYear=t;var c=this.currentCalendar.firstDayofWeek||0;if(n.firstDayOfWeek&&(c=n.firstDayOfWeek),this.dayNames.find("th").each(function(e){$(this).text(l[(e+c)%7])}),this.yearFirst=this.currentCalendar.dateFormat.year&&"y"===this.currentCalendar.dateFormat.year.substr(1,1),this.header.find(".month").attr("data-month",e).text(s.stripTags(d)+" "),this.header.find(".year").text(" "+t),this.yearFirst&&!this.isIslamic&&!this.isRTL){r.setFullYear(t);var h=k.formatDate(r,{date:"year",locale:this.locale.name}).split(" ")[0];this.header.find(".year").text(h+" "),this.header.find(".year").insertBefore(this.header.find(".month"))}"full"===n.headerStyle&&this.monthPicker&&(this.monthPicker.val(k.formatDate(new Date(t,e,1),{date:"year",locale:this.locale.name})),this.monthPicker.prev(".year").text(t),this.monthPicker.prev().prev(".month").text(e),this.monthPicker.data("datepicker")&&this.monthPicker.data("datepicker").setSize()),this.appendMonthYearPicker(e,t);var u=(this.firstDayOfMonth(t,e)-c+7)%7,p=this.daysInMonth(t,e+(this.isIslamic?1:0)),g=this.daysInMonth(t,e+(this.isIslamic?0:1)),f=1,m=1,v=void 0,b=void 0,y=void 0;this.dayMap=[],this.days.find("td").each(function(a){var o=$(this).removeClass("alternate prev-month next-month is-selected range is-today");if(o.removeAttr("aria-selected"),o.removeAttr("tabindex"),a<u&&(y=p-u+1+a,b=0===e?11:e-1,v=0===e?t-1:t,i.setDisabled(o,v,b,y),i.setLegendColor(o,v,b,y),i.dayMap.push({key:w.padDate(v,b,y),elem:o}),o.addClass("alternate prev-month").html('<span class="day-container"><span aria-hidden="true" class="day-text">'+s.stripTags(y)+"</span></span>"),o.attr("data-key",w.padDate(v,b,y))),a>=u&&m<=g){if(i.dayMap.push({key:w.padDate(t,e,m),elem:o}),o.html('<span class="day-container"><span aria-hidden="true" class="day-text">'+s.stripTags(m)+"</span></span>"),o.attr("data-key",w.padDate(t,e,m)),i.isIslamic)t===r[0]&&e===r[1]&&m===r[2]&&o.addClass("is-selected"+(n.range.useRange?" range":"")).attr("aria-selected","true").attr("tabindex","0");else{var l=r.getHours(),d=r.getMinutes(),c=i.isSeconds?r.getSeconds():0;new Date(t,e,m).setHours(l,d,c,0)===r.setHours(l,d,c,0)&&o.addClass("is-selected"+(n.range.useRange?" range":"")).attr("aria-selected","true").attr("tabindex","0")}m===i.todayDay&&i.currentMonth===i.todayMonth&&i.currentYear===i.todayYear&&o.addClass("is-today"),o.attr("aria-label",k.formatDate(new Date(i.currentYear,i.currentMonth,m),{date:"full",locale:i.locale.name}));var h=w.padDate(i.currentYear,i.currentMonth,m);return o.attr("data-key",h),i.setDisabled(o,t,e,m),i.setLegendColor(o,t,e,m),o.attr("role","link"),void m++}m>=g+1&&(y=f,b=11===e?0:e+1,v=11===e?t+1:t,i.dayMap.push({key:w.padDate(v,b,y),elem:o}),i.setDisabled(o,v,b,y),i.setLegendColor(o,v,b,y),o.addClass("alternate next-month").html('<span class="day-container"><span aria-hidden="true" class="day-text">'+f+"</span></span>"),o.attr("data-key",w.padDate(v,b,y)),f++)});var x=this.days.find("tr").eq(5);7===x.find("td.alternate").length?x.hide():x.show(),this.currentDate||(this.isIslamic?(this.currentIslamicDate=[this.currentYear,this.currentMonth,this.currentDay],this.currentDate=this.conversions.toGregorian(this.currentYear,this.currentMonth,this.currentDay)):this.currentDate=new Date(this.currentYear,this.currentMonth,this.currentDay)),this.setRangeSelection(),this.validatePrevNext(),n.range.useRange||0!==this.element.find("td.is-selected").length||(this.element.find("td[tabindex]").removeAttr("tabindex"),this.element.find("td:not(.alternate) .day-text").filter(function(){var e=i.currentDay;return n.activeDate&&(e=n.activeDate.getDate(),i.currentDay=e),parseInt($(this).text(),10)===parseInt(e,10)}).closest("td").addClass("is-selected").attr("tabindex","0")),this.element.trigger("monthrendered",{year:t,month:e,elem:this.element,api:this})},setRangeSelection:function(){if(this.settings.range.useRange){var e={};e.date=new Date(this.currentYear,this.currentMonth,1),e.date.setDate(e.date.getDate()-(this.days.find(".prev-month:visible").length+1)),e.formatedDate=k.formatDate(e.date,{date:"full",locale:this.locale.name}),e.cell=this.days.find('[aria-label="'+e.formatedDate+'"]'),this.setRangeOnCell(!this.settings.range.second&&e.cell)}},appendMonthYearPicker:function(e,t){if(this.settings.showMonthYearPicker){var i='<ul class="picklist is-month">';this.currentCalendar.months.wide.map(function(t,s){i+='<li class="picklist-item'+(s===e?" is-selected ":"")+'"><a href="#" '+(s===e?'tabindex="0" ':'tabindex="-1" ')+'data-month="'+s+'">'+t+"</a></li>"}),i+="</ul>",this.monthYearPane.find(".picklist-section.is-month").empty().append(i);var s=[],n='<ul class="picklist is-year">';n+='<li class="picklist-item up"><a href="#" tabindex="0"><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-caret-up"></use></svg></a></li>';for(var a=this.settings.yearsBack;a>=1;a--)s.push(parseInt(t,10)-a);s.push(t);for(var r=1;r<=this.settings.yearsAhead;r++)s.push(parseInt(t,10)+r);s.map(function(e){n+='<li class="picklist-item'+(t===e?" is-selected ":"")+'"><a href="#" '+(t===e?'tabindex="0" ':'tabindex="-1" ')+'data-year="'+e+'">'+e+"</a></li>"}),n+='<li class="picklist-item down"><a tabindex="0"><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-caret-down"></use></svg></a></li>',n+="</ul>",this.monthYearPane.find(".picklist-section.is-year").empty().append(n),this.yearFirst&&this.monthYearPane.addClass("is-yearfirst")}},firstDayOfMonth:function(e,t){if(this.isIslamic){var i=this.conversions.toGregorian(e,t,1);return null===i?1:i.getDay()}return new Date(e,t,1).getDay()},daysInMonth:function(e,t){if(this.isIslamic){for(var i=this.conversions.yearInfo[this.islamicYearIndex(e)][0],s=0;s<=t;s++){if(s===t)return 29+(1&i);i>>=1}return 0}return new Date(e,t,0).getDate()},islamicYearIndex:function(e){var t=e-1318;return t<0||t>=this.conversions.yearInfo.length?0:t},setDisabled:function(e,t,i,s){var n=this.settings,a=this.isDateDisabled(t,i,s);e.removeClass("is-disabled").removeAttr("aria-disabled"),(a&&!n.disable.isEnable||!a&&n.disable.isEnable)&&e.addClass("is-disabled").attr("aria-disabled","true").removeClass("is-selected range").removeAttr("aria-selected")},isDateDisabled:function(e,t,i){var s=this.settings,n=new Date(s.disable.minDate).setHours(0,0,0,0),a=new Date(s.disable.maxDate).setHours(0,0,0,0),r=new Date(e,t,i);if(-1!==s.disable.dayOfWeek.indexOf(r.getDay()))return!0;if((r=r.setHours(0,0,0,0))<=n||r>=a)return!0;s.disable.dates.length&&"string"==typeof s.disable.dates&&(s.disable.dates=[s.disable.dates]);for(var o=0,l=s.disable.dates.length;o<l;o++){if(r===new Date(s.disable.dates[o]).setHours(0,0,0,0))return!0}return!1},getDateRange:function(e,t,i){var s=[],n=new Date(e);for(i=void 0!==i?i:this.settings.range.includeDisabled;t.getTime()>=n.getTime();)(i||!i&&!this.isDateDisabled(n.getFullYear(),n.getMonth(),n.getDate()))&&s.push(new Date(n)),n.setDate(n.getDate()+1);return s},setLegendColor:function(e,t,i,s){if(this.settings.showLegend&&e[0]){var n=this.getLegendColor(t,i,s);if(e[0].style.backgroundColor="",e.off("mouseenter.legend mouseleave.legend"),n){e.addClass("is-colored"),e[0].style.backgroundColor=z.hexToRgba(n,.3);var a=z.hexToRgba(n,.3),r=z.hexToRgba(n,.7);e.on("mouseenter.legend",function(){var e=$(this);e[0].style.backgroundColor=r,e.find("span")[0].style.backgroundColor="transparent"}).on("mouseleave.legend",function(){var e=$(this);e[0].style.backgroundColor=a,e.find("span")[0].style.backgroundColor=""})}}},getLegendColor:function(e,t,i){var s=this.settings;if(s.showLegend){for(var n=new Date(e,t,i),a=n.setHours(0,0,0,0),r=0;r<s.legend.length;r++){var o=s.legend[r];if(o.dayOfWeek&&-1!==o.dayOfWeek.indexOf(n.getDay()))return o.color;if(o.dates)for(var l=0;l<o.dates.length;l++){if(a===new Date(o.dates[l]).setHours(0,0,0,0))return o.color}}return""}},handleEvents:function(){var e=this,t=this,i=this.settings;return this.element.off("updated.monthview").on("updated.monthview",function(){e.updated()}),this.header.off("click.monthview").on("click.monthview",".btn-icon",function(){var e=$(this).is(".next"),s={},n={month:t.currentMonth,year:t.currentYear};i.range.useRange?(e?s.date=new Date(n.year,n.month+1,t.element.find(".next-month:visible").length+1):(s.date=new Date(n.year,n.month,1),s.date.setDate(s.date.getDate()-(t.days.find(".prev-month:visible").length+1))),n.month+=e?1:-1):(t.currentMonth+=e?1:-1,t.currentDate.setMonth(t.currentMonth),t.currentYear=parseInt(t.element[0].querySelector("span.year").innerText,10),t.currentDate.setFullYear(t.currentYear),n.month=t.currentMonth,n.year=t.currentYear),t.showMonth(n.month,n.year),i.range.useRange&&(s.formatedDate=k.formatDate(s.date,{date:"full",locale:t.locale.name}),s.cell=t.days.find('[aria-label="'+s.formatedDate+'"]'),t.setRangeOnCell(!i.range.second&&s.cell))}),i.range.useRange&&(this.header.off("mouseover.datepicker").on("mouseover.datepicker","button",function(){i.range.extra&&t.setRangeOnCell($(this).is(".next")?i.range.extra.maxCell:i.range.extra.minCell)}).off("focus.datepicker").on("focus.datepicker","button:not(.hide-focus)",function(){i.range.extra&&t.setRangeOnCell($(this).is(".next")?i.range.extra.maxCell:i.range.extra.minCell)}),this.days.off("mouseover.datepicker").on("mouseover.datepicker","td",function(){t.setRangeOnCell(this)})),"full"===i.headerStyle&&this.monthPicker&&(this.monthPicker.off("change.monthview").on("change.monthview",function(){var e=$(this).data("datepicker");t.selectDay(e.currentDate,!1,!0)}),this.todayLink.off("click.monthview").on("click.monthview",function(){e.selectToday()})),i.selectable&&this.element.addClass("is-selectable").off("click.monthview-day").on("click.monthview-day","td",function(t){var i=t.currentTarget.getAttribute("data-key");e.lastClickedKey=i,t.currentTarget.classList.contains("is-disabled")||e.selectDay(i,!1,!0)}),this.handleMonthYearPane().handleKeys(),this},handleMonthYearPane:function(){var e=this,t=this.settings,i=function(t){var i=e.monthYearPane[0].querySelector(".picklist.is-year"),s=i.children,a=s["up"===t?1:s.length-2].querySelector("a").getAttribute("data-year"),r=parseInt(a,10)+("up"===t?-1:1);n.remove(s["up"===t?s.length-2:1]);var o=document.createElement("a");o.setAttribute("href","#"),o.setAttribute("tabindex","-1"),o.setAttribute("data-year",r),o.innerHTML=r;var l=document.createElement("li");n.addClass(l,"picklist-item"),l.appendChild(o),i.insertBefore(l,s["up"===t?1:s.length-1]),e.monthYearPane[0].querySelector(".picklist.is-year li.is-selected")||(n.addClass(l,"is-selected"),o.setAttribute("tabindex","0"))},s=null;this.monthYearPane.off("touchstart.monthviewpane mousedown.monthviewpane").on("touchstart.monthviewpane mousedown.monthviewpane",".picklist.is-year li",function(e){return s=setInterval(function(){return e.currentTarget.classList.contains("up")&&i("up"),e.currentTarget.classList.contains("down")&&i("down"),e.stopImmediatePropagation(),e.stopPropagation(),!1},200),!0}).off("touchend.monthviewpane touchcancel.monthviewpane mouseup.monthviewpane mouseout.monthviewpane").on("touchend.monthviewpane touchcancel.monthviewpane mouseup.monthviewpane mouseout.monthviewpane",".picklist.is-year li",function(){return clearInterval(s),!0});var a=function(i,s){var a=function(t){return e.monthYearPane[0].querySelector(".is-"+t+" .is-selected a")},r="is-month"===s?{month:parseInt(i.getAttribute("data-month"),10),year:parseInt(a("year").getAttribute("data-year"),10)}:{month:parseInt(a("month").getAttribute("data-month"),10),year:parseInt(i.getAttribute("data-year"),10)};t.range.useRange||(e.currentMonth=r.month,e.currentDate.setMonth(e.currentMonth),e.currentYear=r.year,e.currentDate.setFullYear(e.currentYear),r.month=e.currentMonth,r.year=e.currentYear),function(t,i){var s=e.monthYearPane[0].querySelector(".picklist."+i+" .is-selected");n.removeClass(s,"is-selected"),s.querySelector("a").setAttribute("tabindex","-1"),n.addClass(t.parentNode,"is-selected"),t.setAttribute("tabindex","0")}(i,s),e.element.hasClass(s+"only")&&e.monthYearPane.parent().find("button.is-select-month").click()};this.monthYearPane.off("click.picklist-month").on("click.picklist-month",".picklist.is-month li",function(e){a(e.target,"is-month"),e.preventDefault()}),this.monthYearPane.off("click.picklist-month-a").on("click.picklist-month-a",".picklist.is-month li a",function(e){e.preventDefault()}),this.monthYearPane.off("click.picklist-year").on("click.picklist-year",".picklist.is-year li",function(e){e.currentTarget.classList.contains("up")?i("up"):e.currentTarget.classList.contains("down")?i("down"):(a(e.target,"is-year"),e.preventDefault())}),this.monthYearPane.off("click.picklist-year-a").on("click.picklist-year-a",".picklist.is-year li a",function(e){e.preventDefault()}),this.monthYearPane.on("expand.monthviewpane",function(){t.hideDays||(e.element.find(".btn-icon, td.is-selected").attr("disabled","true"),e.element.find("td.is-selected").removeAttr("tabindex"),e.monthYearPane.find(".content").css("height",e.header.parent().height()-e.header.height()-55),e.element.find(".is-today").hide(),e.element.find(".popup-footer").addClass("is-half"),e.element.find(".is-select").removeClass("is-select").addClass("is-select-month-pane"),e.element.find(".is-cancel").removeClass("is-cancel").addClass("is-cancel-month-pane").text(k.translate("Cancel"))),setTimeout(function(){e.monthYearPane.find(".is-month .is-selected a").focus(),e.monthYearPane.parent().hasClass("is-yearonly")&&e.monthYearPane.find(".is-year .is-selected a").focus()})}).on("collapse.monthviewpane",function(){t.hideDays||(e.element.find(".btn-icon").removeAttr("disabled"),e.element.find("td.is-selected").attr("tabindex","0"),e.element.find(".is-today").show(),e.element.find(".popup-footer").removeClass("is-half"),e.element.find(".is-select-month-pane").addClass("is-select").removeClass("is-select-month-pane"),e.element.find(".is-cancel-month-pane").addClass("is-cancel").removeClass("is-cancel-month-pane").text(k.translate("Clear")))});var r=function(e,t){var i=e.currentTarget,s=e.currentTarget.parentNode,a="prev"===t?s.previousSibling:s.nextSibling;a||(a=s.parentNode.children["prev"===t?s.parentNode.children.length-1:0]);var r=a.querySelector("a");i.setAttribute("tabindex","-1"),s.parentNode.querySelector(".is-selected").classList.remove("is-selected"),n.addClass(a,"is-selected"),r.setAttribute("tabindex","0"),r.focus()};return this.monthYearPane.off("keydown.monthviewpane").on("keydown.monthviewpane",".picklist-item a",function(e){var t=e.currentTarget.parentNode.classList.contains("up"),s=e.currentTarget.parentNode.classList.contains("down"),n=e.currentTarget.parentNode.parentNode.classList.contains("is-year"),o=e.currentTarget.parentNode.parentNode.classList.contains("is-month"),l=!1;"ArrowUp"===e.key&&(n||o)?(r(e,"prev"),l=!0):"ArrowDown"===e.key&&(n||o)?(r(e,"next"),l=!0):"Enter"===e.key&&(t||s?(i(t?"up":"down"),l=!0):(n||o)&&(a(e.target,n?"is-year":"is-month"),l=!0)),l&&e.preventDefault()}),this},selectDay:function(e,t,i){this.isIslamic&&"string"!=typeof e&&(this.currentIslamicDate=this.currentCalendar.conversions.fromGregorian(e),e=w.padDate(this.currentIslamicDate[0],this.currentIslamicDate[1],this.currentIslamicDate[2])),this.isIslamic||"string"==typeof e||(e=w.padDate(e.getFullYear(),e.getMonth(),e.getDate()));var s=this.dayMap.filter(function(t){return t.key===e}),n=parseInt(e.substr(0,4),10),a=parseInt(e.substr(4,2),10)-1,r=parseInt(e.substr(6,2),10);if(this.isIslamic?(this.currentIslamicDate=e,this.currentDate=this.conversions.toGregorian(n,a,r)):this.currentDate=new Date(n,a,r),this.currentYear=n,this.currentMonth=a,this.currentDay=r,(0===s.length||s[0].elem.hasClass("alternate"))&&(this.showMonth(a,n),s=this.dayMap.filter(function(t){return t.key===e})),0!==!s.length){var o=s[0].elem[0],l={node:o,key:e,day:r,month:a,year:n,close:t};delete this.isKeyClick,this.element.find("td.is-selected").removeClass("is-selected").removeAttr("tabindex"),$(o).addClass("is-selected").attr("tabindex","0").focus(),(i="full"===this.settings.headerStyle||i)&&this.settings.onSelected&&this.settings.onSelected(o,l),i&&this.element.trigger("selected",l)}},selectToday:function(){this.selectDay(new Date,!1,!0)},handleKeys:function(){var e=this,t=this.settings;this.element.off("keydown.monthview").on("keydown.monthview",".monthview-table",function(i){var s=i.keyCode||i.charCode||0,n=$(i.target),a=e.days.find("td:visible"),r=a.length,o=null,l=null,d=!1,c=new Date(t.disable.minDate),h=new Date(t.disable.maxDate),u=function(){e.datepickerApi&&t.range.useRange&&t.range.first&&t.range.first.date&&t.range.second&&t.range.second.date&&e.datepickerApi.resetRange({isData:!0})};if(40===s&&(d=!0,t.range.useRange?(o=a.index(i.target)+7,l=a.eq(o),o<r&&(u(),e.setRangeOnCell(l.is(".is-selected")?null:l),e.setRangeSelBeforeFirstSel(l),e.activeTabindex(l,!0))):t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?(e.currentDate.getMonth()<h.getMonth()?e.currentDate.setDate(e.currentDate.getDate()+7):h.getDate()-1>=e.currentDate.getDate()+7&&e.currentDate.setDate(e.currentDate.getDate()+7),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setDate(e.currentDate.getDate()+7),e.selectDay(e.currentDate,!1,!1))),38===s&&(d=!0,t.range.useRange?(o=a.index(i.target)-7,l=a.eq(o),o>-1&&(u(),e.setRangeOnCell(l.is(".is-selected")?null:l),e.setRangeSelBeforeFirstSel(l),e.activeTabindex(l,!0))):t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?(e.currentDate.getMonth()>c.getMonth()?e.currentDate.setDate(e.currentDate.getDate()-7):c.getDate()+1<=e.currentDate.getDate()-7&&e.currentDate.setDate(e.currentDate.getDate()-7),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setDate(e.currentDate.getDate()-7),e.selectDay(e.currentDate,!1,!1))),37===s&&(d=!0,t.range.useRange?(o=a.index(i.target)-1,l=a.eq(o),o>-1&&(u(),e.setRangeOnCell(l.is(".is-selected")?null:l),e.setRangeSelBeforeFirstSel(l),e.activeTabindex(l,!0))):t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?(e.currentDate.getMonth()>c.getMonth()?e.currentDate.setDate(e.currentDate.getDate()-1):c.getDate()+1!==e.currentDate.getDate()&&e.currentDate.setDate(e.currentDate.getDate()-1),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setDate(e.currentDate.getDate()-1),e.selectDay(e.currentDate,!1,!1))),39===s&&(d=!0,t.range.useRange?(o=a.index(i.target)+1,l=a.eq(o),o<r&&(u(),e.setRangeOnCell(l.is(".is-selected")?null:l),e.setRangeSelBeforeFirstSel(l),e.activeTabindex(l,!0))):t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?(e.currentDate.getMonth()<h.getMonth()?e.currentDate.setDate(e.currentDate.getDate()+1):h.getDate()-1!==e.currentDate.getDate()&&e.currentDate.setDate(e.currentDate.getDate()+1),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setDate(e.currentDate.getDate()+1),e.selectDay(e.currentDate,!1,!1))),33!==s||i.altKey||(d=!0,u(),t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?c.getMonth()!==e.currentDate.getMonth()&&(e.currentDate.setMonth(e.currentDate.getMonth()-1),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setMonth(e.currentDate.getMonth()-1),e.selectDay(e.currentDate,!1,!1))),34!==s||i.altKey||(d=!0,u(),t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?e.currentDate.getMonth()!==h.getMonth()&&(e.currentDate.setMonth(e.currentDate.getMonth()+1),e.selectDay(e.currentDate,!1,!1)):(e.currentDate.setMonth(e.currentDate.getMonth()+1),e.selectDay(e.currentDate,!1,!1))),33===s&&i.ctrlKey&&(d=!0,u(),e.currentDate.setFullYear(e.currentDate.getFullYear()-1),e.selectDay(e.currentDate,!1,!1)),34===s&&i.ctrlKey&&(d=!0,u(),e.currentDate.setFullYear(e.currentDate.getFullYear()+1),e.selectDay(e.currentDate,!1,!1)),36===s){d=!0;var p=e.currentDate,g=void 0;u(),t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?c.getMonth()!==e.currentDate.getMonth()?g=new Date(p.getFullYear(),p.getMonth(),1):(g=new Date(c.getFullYear(),c.getMonth(),c.getDate())).setDate(g.getDate()+1):g=new Date(p.getFullYear(),p.getMonth(),1),e.currentDate=g,e.isIslamic&&(e.currentIslamicDate=e.conversions.fromGregorian(e.currentDate)),e.selectDay(e.currentDate,!1,!1)}if(35===s){d=!0;var f=e.currentDate,m=void 0;u(),t.disable.restrictMonths&&t.disable.minDate&&t.disable.maxDate?e.currentDate.getMonth()!==h.getMonth()?m=new Date(f.getFullYear(),f.getMonth()+1,0):(m=new Date(h.getFullYear(),h.getMonth(),h.getDate())).setDate(m.getDate()-1):m=new Date(f.getFullYear(),f.getMonth()+1,0),e.currentDate=m,e.isIslamic&&(e.currentIslamicDate=e.conversions.fromGregorian(e.currentDate)),e.selectDay(e.currentDate,!1,!1)}if(84===s){if(t.range.useRange&&e.datepickerApi){u();var v=!(t.range.first&&t.range.first.date&&(!t.range.second||t.range.second&&!t.range.second.date));e.datepickerApi.setToday(v),!v&&e.datepickerApi&&"function"==typeof e.datepickerApi.closeCalendar&&e.datepickerApi.closeCalendar()}else e.selectToday();d=!0}if(32===s||13===s){if(d=!0,t.range.useRange)return(!t.range.first||t.range.first&&!t.range.first.date)&&a.removeClass("is-selected"),n.focus().trigger("click"),!1;var b=e.getCellDate(n);e.isIslamic?(e.currentIslamicDate=[b.year,b.month,b.day],e.currentDate=e.conversions.toGregorian(e.currentIslamicDate[0],e.currentIslamicDate[1],e.currentIslamicDate[2])):e.currentDate=new Date(b.year,b.month,b.day),e.selectDay(e.currentDate,!0,!0)}return!d||(i.stopPropagation(),i.preventDefault(),!1)})},validatePrevNext:function(){if(this.settings.disable.restrictMonths&&this.settings.disable.minDate&&this.settings.disable.maxDate){var e=new Date(this.settings.disable.minDate),t=new Date(this.settings.disable.maxDate);if(this.element.find(".prev").prop("disabled",!1),this.element.find(".next").prop("disabled",!1),e.getFullYear()>this.currentYear||this.currentYear>t.getFullYear())return this.element.find(".prev").prop("disabled",!0),void this.element.find(".next").prop("disabled",!0);this.currentMonth-1<e.getMonth()&&this.element.find(".prev").prop("disabled",!0),this.currentMonth+1>t.getMonth()&&this.element.find(".next").prop("disabled",!0)}},addLegend:function(){var e=this.settings;if(e.showLegend){this.legend&&this.legend.length&&this.legend.remove(),this.legend=$('<div class="monthview-legend"></div>');for(var t=0;t<e.legend.length;t++){var i=e.legend[t],s='<div class="monthview-legend-item">\n          <span class="monthview-legend-swatch" style="background-color: '+z.hexToRgba(i.color,.3)+'"></span>\n          <span class="monthview-legend-text">'+i.name+"</span>\n        </div>";this.legend.append(s)}this.table.after(this.legend)}},setRangeOnCell:function(e){var t=this.settings;if(t.range.useRange&&t.range.first&&!t.range.second){var i=t.range.first,s=t.range.extra,n=s.cellLength-1,a=i.rowIdx+i.cellIdx+n*i.rowIdx;if((e=$(e)).length&&!e.is(".is-disabled, .is-selected")){var r=e.closest("tr"),o=e.index(),l=r.index(),d=l+o+n*l,c=this.getCellDate(e),h=new Date(c.year,c.month,c.day),u=this.getDifferenceToDate(t.range.first.date,t.range.maxDays);this.days.find("td:visible").each(function(e){var i=$(this);h>t.range.first.date&&!t.range.selectBackward&&(!t.range.maxDays||t.range.maxDays>0&&h.getTime()<=u.aftertime)&&(e>a&&e<=d||h>s.max&&e<=d)?i.addClass("range-next"):h<t.range.first.date&&!t.range.selectForward&&(!t.range.maxDays||t.range.maxDays>0&&h.getTime()>=u.beforetime)&&(e<a&&e>=d||h<s.min&&e>=d)?i.addClass("range-prev"):i.removeClass("range-next range-prev")})}else e.length||this.days.find("td").removeClass("range-next range-prev")}!e&&t.range.second&&this.setRangeSelected()},getDifferenceToDate:function(e,t,i){var s=this,n={},a=function(e,t,a){for(e=new Date(e);t>0;)e.setDate(e.getDate()+(a?1:-1)),(i||!i&&!s.isDateDisabled(e.getFullYear(),e.getMonth(),e.getDate()))&&(t--,n[a?"after":"before"]=new Date(e));a&&n.after?n.aftertime=n.after.getTime():n.before&&(n.beforetime=n.before.getTime())};return i=void 0!==i?i:this.settings.range.includeDisabled,a(e,t),a(e,t,!0),n},setRangeSelected:function(){var e=this,t=this.settings;t.range.useRange&&t.range.second&&t.range.second.date&&this.days&&this.days.length&&(this.days.find("td").removeClass("range range-next range-prev range-selection end-date is-selected"),this.days.find("td:visible").each(function(){var i,s=$(this),n=s.is(".is-disabled")&&!t.range.includeDisabled,a=s.is(".is-disabled")&&t.range.includeDisabled?" include-disabled":"",r=function(e){return(e=new Date(e)).setHours(0,0,0),e.getTime()},o=r((i=e.getCellDate(s),new Date(i.year,i.month,i.day))),l=r(t.range.first.date),d=r(t.range.second.date);o!==l&&o!==d||n?o>l&&o<d&&!n&&s.addClass("range-selection"+a):s.addClass("is-selected"+a+(l!==d?" range-selection"+(o===d?" end-date":""):""))}))},setRangeSelByClick:function(){var e=0,t=this.settings;if(t.range.useRange)if(t.range.first&&t.range.first.date&&t.range.second&&t.range.second.date){if(t.showTime&&this.datepickerApi){var i=function(e){return new Date(e).getTime()},s={time1:i(t.range.first.date),time2:i(t.range.second.date),first:this.datepickerApi.setTime(t.range.first.date),second:this.datepickerApi.setTime(t.range.second.date)};s.time1!==i(s.first)&&(this.datepickerApi.setRangeToElem(s.first,!0),this.datepickerApi.setRangeToElem(s.second,!1),e=2)}e=0===e?1:e}else{var n=void 0;if(!t.range.first||t.range.first&&!t.range.first.date)(n=this.dayMap.filter(function(e){return e.elem.is(".is-selected")}))&&n.length&&(this.days.find("td:visible").removeClass("is-selected").removeAttr("aria-selected"),n[0].elem.focus().trigger("click"),e=3);else if(!t.range.second||t.range.second&&!t.range.second.date){if((n=this.days.find("td.range-prev:visible").first()).length||(n=this.days.find("td.range-next:visible").last()),n.length||(n=this.dayMap.filter(function(e){return e.elem.is(".is-selected")})),n&&n.length)(n[0].elem||n).focus().trigger("click"),e=3}}return e},getCellDate:function(e){var t=parseInt(e.text(),10),i=parseInt(this.header.find(".month").attr("data-month"),10),s=parseInt(this.header.find(".year").text(),10);return e.hasClass("prev-month")?0===i?(i=11,s--):i--:e.hasClass("next-month")&&(11===i?(i=0,s++):i++),{year:s,month:i,day:t}},setRangeSelBeforeFirstSel:function(e){var t=this.settings;t.range.useRange&&$("#monthview-popup:visible")&&(t.range.first||($("td",this.element).removeClass("is-selected"),e.addClass("is-selected")))},activeTabindex:function(e,t){return $("td",this.element).removeAttr("tabindex"),e.attr("tabindex",0),t&&e.focus(),e},updated:function(){return this.destroy().init()},teardown:function(){return this.header.off(),this.days.off(),this.element.off(),this.monthYearPane&&(this.monthYearPane.off(),this.monthYearPane=null),this},destroy:function(){return this.teardown(),this.element.empty(),$.removeData(this.element[0],"monthview"),this}};var Ct={eventTypes:[{id:"example",label:"Example",color:"emerald07",checked:!0,click:function(){}}],events:[],locale:null,month:(new Date).getMonth(),year:(new Date).getFullYear(),showViewChanger:!0,onRenderMonth:null,template:null,upcomingEventDays:14,modalTemplate:null,menuId:null,menuSelected:null,newEventDefaults:{title:"NewEvent",subject:"",isAllDay:!0,comments:""}};function kt(e,t){this.settings=m.mergeSettings(e,t,Ct),this.element=$(e),this.init()}kt.prototype={init:function(){return this.build()},build:function(){return this.setLocale(),this.rendered||this.settings.locale&&(!this.locale||this.locale.name!==this.settings.locale)?(this.rendered=!1,this):(this.rendered=!0,this.setCurrentCalendar().renderEventTypes().renderMonth().renderViewChanger().handleEvents(),this)},setLocale:function(){var e=this;return!this.settings.locale||this.locale&&this.locale.name===this.settings.locale?this.settings.locale||(this.locale=k.currentLocale):k.getLocale(this.settings.locale).done(function(t){e.locale=k.cultures[t],e.setCurrentCalendar(),e.build()}),this},setCurrentCalendar:function(){return this.isRTL="right-to-left"===this.locale.direction,this},renderEventTypes:function(){if(this.eventTypeContainer=document.querySelector(".calendar-event-types"),!this.eventTypeContainer)return this;for(var e="",t=0;t<this.settings.eventTypes.length;t++){var i=this.settings.eventTypes[t];e+='<input type="checkbox" class="checkbox '+i.color+'07" name="'+i.id+'" id="'+i.id+'" checked="'+(i.checked?"true":"false")+'" '+(i.disabled?'disabled="true"':"")+' />\n        <label for="'+i.id+'" class="checkbox-label">'+(i.translationKey?k.translate(i.translationKey,{locale:this.locale.name}):i.label)+"</label><br/>"}return this.eventTypeContainer.innerHTML=e,this},renderMonth:function(){return this.monthViewContainer=document.querySelector(".calendar .calendar-monthview"),this.monthView=new xt(this.monthViewContainer,{onRenderMonth:this.settings.onRenderMonth,onSelected:this.settings.onSelected,selectable:!0,locale:this.settings.locale,month:this.settings.month,year:this.settings.year}),this.monthViewHeader=document.querySelector(".calendar .monthview-header"),this.renderAllEvents(),this},appendUpcomingEvent:function(e){if(this.upcomingEventsContainer=document.querySelector(".calendar-upcoming-events"),this.upcomingEventsContainer&&!(e.daysUntil>0)){var t=Math.abs(e.daysUntil);if(!(t<0||t>this.settings.upcomingEventDays)){var i=document.createElement("a");i.setAttribute("href","#"),i.setAttribute("data-key",e.startKey),n.addClass(i,"calendar-upcoming-event");var s="",a=k.formatDate(e.starts,{pattern:"d",locale:this.locale.name}),r=k.formatDate(e.ends,{pattern:"d",locale:this.locale.name}),o=k.formatDate(e.starts,{pattern:"MMMM",locale:this.locale.name})+" "+(a===r?a:a+"-"+r)+", "+k.formatDate(e.starts,{pattern:"yyyy",locale:this.locale.name});if(parseInt(r,10)<parseInt(a,10)){var l=new Date(e.starts);l.setDate(1),l.setMonth(l.getMonth()+1);var d=l.getFullYear();o=k.formatDate(e.starts,{pattern:"MMMM",locale:this.locale.name})+" "+a+" - "+k.formatDate(l,{pattern:"MMMM",locale:this.locale.name})+" "+r+", "+d}s+='\n      <span class="calendar-upcoming-date">'+o+'</span>\n      <span class="calendar-upcoming-event-color '+(e.color||"")+'">'+(e.color||"")+'</span>\n      <span class="calendar-upcoming-description">'+(e.subject||"")+'</span>\n      <span class="calendar-upcoming-status-text">'+(e.status||"")+'</span>\n      <span class="calendar-upcoming-duration">'+(e.isDays?e.duration:e.durationHours)+" "+(e.durationUnits||"")+"</span>",i.innerHTML=s,this.upcomingEventsContainer.appendChild(i)}}},renderViewChanger:function(){if(!this.settings.showViewChanger)return this;var e='<label for="calendar-view-changer" class="label audible">'+k.translate("ChangeView",{locale:this.locale.name})+'</label>\n      <select id="calendar-view-changer" name="calendar-view-changer" class="dropdown">\n        <option value="month" selected>'+k.translate("Month",{locale:this.locale.name})+'</option>\n        <option value="week" disabled>'+k.translate("Week",{locale:this.locale.name})+'</option>\n        <option value="day" disabled>'+k.translate("Day",{locale:this.locale.name})+'</option>\n        <option value="schedule" disabled>'+k.translate("Schedule",{locale:this.locale.name})+"</option>\n      </select>\n    </div>";return $(this.monthViewHeader).append(e),this.viewChangerHtml=$("#calendar-view-changer"),this.viewChangerHtml.dropdown(),this},renderEventDetails:function(e,t){if(this.settings.events){var i=this.settings.events.filter(function(t){return t.id===e});if(i&&0!==i.length&&(this.eventDetailsContainer=document.querySelector(".calendar-event-details"),this.eventDetailsContainer)){this.renderTmpl(i[0],this.settings.template,this.eventDetailsContainer,t>1);var s=$(this.eventDetailsContainer).data("accordion");s&&s.destroy(),$(this.eventDetailsContainer).accordion(),n.hasClass(this.eventDetailsContainer,"has-only-one")&&$(this.eventDetailsContainer).find(".accordion-header, .accordion-header a").off("click")}}},renderSelectedEventDetails:function(){var e=this.getDayEvents();if(this.clearEventDetails(),e.events&&0!==e.events.length)for(var t=0;t<e.events.length;t++)this.renderEventDetails(e.events[t].id,e.events.length)},clearEventDetails:function(){this.eventDetailsContainer=document.querySelector(".calendar-event-details"),this.eventDetailsContainer&&(this.eventDetailsContainer.innerHTML="")},clearUpcomingEvents:function(){this.upcomingEventsContainer&&(this.upcomingEventsContainer.innerHTML="")},filterEventTypes:function(){var e=[];if(!this.eventTypeContainer)return e;for(var t=this.eventTypeContainer.querySelectorAll(".checkbox"),i=0;i<t.length;i++){var s=t[i];s.checked||e.push(s.getAttribute("id"))}return e},dateDiff:function(e,t,i,s){var n=Math.round((t-e)/(36e5*(i?1:24)));return s&&(n+=1),n},renderAllEvents:function(e){if(this.settings.onRenderMonth&&!e)return this.callOnRenderMonth(),this;var t=this.filterEventTypes();this.removeAllEvents(),this.clearUpcomingEvents(),this.clearEventDetails();var i=this.settings.events.slice(0);i.sort(function(e,t){return e.starts<t.starts?-1:e.starts>t.starts?1:0});for(var s=0;s<i.length;s++){var n=i[s];t.indexOf(n.type)>-1||this.renderEvent(n)}return this.renderSelectedEventDetails(),this},renderEvent:function(e){var t=new Date(e.starts),i=w.padDate(t.getFullYear(),t.getMonth(),t.getDate()),s=new Date(e.ends),n=w.padDate(s.getFullYear(),s.getMonth(),s.getDate()),a=this.monthView.dayMap.filter(function(e){return e.key>=i&&e.key<=n});e.endKey=n,e.startKey=i,e=this.addCalculatedFields(e);for(var r=-1,o=0;o<this.monthView.dayMap.length;++o)if(this.monthView.dayMap[o].key>=i&&this.monthView.dayMap[o].key<=n){r=o;break}if(1===a.length&&this.appendEvent(a[0].elem[0],e,"event-day-start-end",r),a.length>1)for(var l=0;l<a.length;l++){var d=0===l?"event-day-start":"event-day-span";a.length-1===l&&(d="event-day-end"),this.appendEvent(a[l].elem[0],e,d,r+l)}this.appendUpcomingEvent(e,a,r)},removeAllEvents:function(){for(var e=this.monthViewContainer.querySelectorAll(".calendar-event-more"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);for(var i=this.monthViewContainer.querySelectorAll(".calendar-event"),s=0;s<i.length;s++)i[s].parentNode.removeChild(i[s]);for(var n=0;n<this.monthView.dayMap.length;n++)this.monthView.dayMap[n].events=[]},addCalculatedFields:function(e){if(e.color=this.getEventTypeColor(e.type),e.duration=Math.abs(this.dateDiff(new Date(e.ends),new Date(e.starts),!1,e.isFullDay)),e.durationUnits=e.duration>1?k.translate("Days",{locale:this.locale.name}):k.translate("Day",{locale:this.locale.name}),e.daysUntil=e.starts?this.dateDiff(new Date(e.starts),new Date):0,e.durationHours=this.dateDiff(new Date(e.starts),new Date(e.ends),!0),e.isDays=!0,void 0===e.isAllDay&&(e.isAllDay=!0),e.durationHours<24&&(e.isDays=!1,e.isAllDay=!1,delete e.duration,e.durationUnits=e.durationHours>1?k.translate("Hours",{locale:this.locale.name}):k.translate("Hour",{locale:this.locale.name})),"true"===e.isAllDay.toString()&&(e.isDays=!0,delete e.durationHours,e.durationUnits=e.duration>1?k.translate("Days",{locale:this.locale.name}):k.translate("Day",{locale:this.locale.name}),e.duration=this.dateDiff(new Date(e.starts),new Date(e.ends))),0===e.duration&&"true"===e.isAllDay.toString()&&(e.isDays=!0,e.duration=1,e.durationUnits=k.translate("Day",{locale:this.locale.name})),e.starts){var t=k.parseDate(e.starts,{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name});e.startsLocale=k.formatDate(t,{locale:this.locale.name})}if(e.ends){var i=k.parseDate(e.ends,{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name});e.endsLocale=k.formatDate(i,{locale:this.locale.name})}return e.eventTypes=this.settings.eventTypes,e.isAllDay=e.isAllDay.toString(),"false"===e.isAllDay.toString()&&delete e.isAllDay,e},appendEvent:function(e,t,i,s){var a=this,r=void 0,o=e.querySelectorAll(".calendar-event").length;if(s>-1&&(this.monthView.dayMap[s].events||(this.monthView.dayMap[s].events=[]),this.monthView.dayMap[s].events.push(t)),o>=2){var l=e.querySelector(".calendar-event-more"),d=k.translate("More",{locale:this.locale.name}).replace("...","");if(l){var c=l.getAttribute("data-count");c++,l.setAttribute("data-count",c),l.innerHTML="+ "+c+" "+d}else r=document.createElement("span"),n.addClass(r,"calendar-event-more"),r.innerHTML="+ 1 "+d,r.setAttribute("data-count",1),e.querySelector(".day-container").appendChild(r);return this}return r=document.createElement("a"),n.addClass(r,"calendar-event",t.color,i),r.setAttribute("data-id",t.id),r.setAttribute("data-key",t.startKey),r.innerHTML='<div class="calendar-event-content">\n      '+(t.icon?'<span class="calendar-event-icon"><svg class="icon '+t.icon+'" focusable="false" aria-hidden="true" role="presentation" data-status="'+t.status+'"><use xlink:href="#'+t.icon+'"></use></svg></span>':"")+'\n      <span class="calendar-event-title">'+(t.shortSubject||t.subject)+"</span>\n    </div>",e.querySelector(".day-container").appendChild(r),t.shortSubject||(r.setAttribute("title",t.subject),$(r).tooltip({beforeShow:function(e,t){var i=t[0].querySelector(".calendar-event-title"),s=t[0].querySelector(".calendar-event-icon"),n=s?s.querySelector(".icon").getAttribute("data-status"):"";i.offsetWidth>t[0].scrollWidth-(s?s.offsetWidth:0)?e(i.innerText+(n?" ("+k.translate(n,{locale:a.locale.name},!1)+")":"")):e(!1)}})),this},getEventTypeColor:function(e){var t="azure";if(!e)return t;var i=this.settings.eventTypes.filter(function(t){return t.id===e});return 1===i.length&&(t=i[0].color||"azure"),t},getEventTypeLabel:function(e){var t="";if(!e)return t;var i=this.settings.eventTypes.filter(function(t){return t.id===e});return 1===i.length&&(t=i[0].label),t},handleEvents:function(){var e=this,t=this;this.element.off("updated.calendar").on("updated.calendar",function(){e.updated()}),this.isSwitchingMonth=!1,this.element.off("monthrendered.calendar").on("monthrendered.calendar",function(t,i){e.isSwitchingMonth=!0,e.modalVisible()&&e.removeModal(),e.settings.year=i.year,e.settings.month=i.month,e.renderAllEvents(),setTimeout(function(){e.isSwitchingMonth=!1},500)}),this.element.off("change.calendar").on("change.calendar",".checkbox",function(){e.renderAllEvents(!0)}),$(this.monthViewContainer).off("selected.calendar").on("selected.calendar",function(){e.renderSelectedEventDetails()}),this.element.off("click.calendar-upcoming").on("click.calendar-upcoming",".calendar-upcoming-event",function(t){var i=t.currentTarget.getAttribute("data-key");e.monthView.selectDay(i)}),this.settings.menuId&&this.element.off("contextmenu.calendar").on("contextmenu.calendar",".calendar-event",function(i){i.preventDefault();var s=$(i.currentTarget);s.popupmenu({attachToBody:!0,menuId:e.settings.menuId,trigger:"immediate",offset:{y:5}}),s.off("selected.calendar").on("selected.calendar",function(e,i){var s=this.getAttribute("data-id");if(t.settings.menuSelected&&t.settings.menuSelected(e,i,s),"delete-event"===i.attr("data-action")&&t.deleteEvent({id:s}),"show-event"===i.attr("data-action")){var n=this.getAttribute("data-key");t.monthView.selectDay(n)}})});var i=function(t,i){e.showEventModal(t,function(t,s){for(var n=t.querySelectorAll("input, textarea, select"),a=0;a<n.length;a++)s[n[a].id]="checkbox"===n[a].getAttribute("type")?n[a].checked:n[a].value;i?e.addEvent(s):e.updateEvent(s)})},s=0,n=!1;return this.element.off("click.calendar-event").on("click.calendar-event",".calendar-event",function(t){s=setTimeout(function(){if(!n){var s=t.currentTarget.getAttribute("data-id"),a=e.settings.events.filter(function(e){return e.id===s});if(!a||0===a.length)return;i(a[0],!1),e.element.triggerHandler("eventclick",{month:e.settings.month,year:e.settings.year,event:a[0]})}n=!1},100)}),this.element.off("dblclick.calendar-event").on("dblclick.calendar-event",".calendar-event",function(t){clearTimeout(s),n=!0;var i=t.currentTarget.getAttribute("data-id"),a=e.settings.events.filter(function(e){return e.id===i});a&&0!==a.length&&e.element.trigger("eventdblclick",{month:e.settings.month,year:e.settings.year,event:a[0]})}),this.element.off("dblclick.calendar").on("dblclick.calendar","td",function(t){if(!e.isSwitchingMonth&&!e.modalVisible()){var s=t.currentTarget.getAttribute("data-key"),n=new Date(s.substr(0,4),s.substr(4,2)-1,s.substr(6,2)),a=m.extend({},e.settings.newEventDefaults);a.startKey=s,a.endKey=s,a.starts=n,a.ends=n,t.stopPropagation(),e.cleanEventData(a,!1),i(a,!0),e.element.triggerHandler("dblclick",{eventData:a,api:e})}}),this},callOnRenderMonth:function(){var e=this;this.settings.onRenderMonth(this.element,function(t,i){i&&i.length>0&&(e.settings.eventTypes=i,e.renderEventTypes()),t&&t.length>0&&(e.settings.events=t,e.renderAllEvents(!0))},{api:e,month:this.settings.month,year:this.settings.year})},currentDate:function(){return this.isRTL?this.monthView.currentIslamicDate:this.monthView.currentDate},getDayEvents:function(e){e||(e=this.currentDate()),"string"==typeof e||this.isRTL||(e=w.padDate(e.getFullYear(),e.getMonth(),e.getDate())),this.isRTL&&(e=w.padDate(e[0],e[1],e[2]));var t=this.monthView.dayMap.filter(function(t){return t.key===e}),i={date:this.monthView.currentDate,events:[]};return 0===t.length?[]:(i.events=t[0].events,i.elem=t[0].elem,i)},renderTmpl:function(e,t,i,s){if("object"===(void 0===We?"undefined":u(We))&&t){t instanceof $?t=""+t.html():"string"==typeof t&&(w.containsHTML(t)||(t=$("#"+t).html())),e.color=this.getEventTypeColor(e.type),e.startsLong=k.formatDate(e.starts,{date:"long",locale:this.locale.name}),e.endsLong=k.formatDate(e.ends,{date:"long",locale:this.locale.name}),e.typeLabel=this.getEventTypeLabel(e.type);var a=We.compile(t,{event:e});i.classList.remove("has-only-one"),s?n.append(i,a,"*"):(i.innerHTML=a,i.classList.add("has-only-one"))}},addEvent:function(e){this.cleanEventData(e,!0),this.settings.events.push(e),this.renderEvent(e),this.renderSelectedEventDetails()},updateEvent:function(e){for(var t=e.id,i=this.settings.events.length-1;i>=0;i--)this.settings.events[i].id===t&&(this.settings.events[i]=m.extend(!0,this.settings.events[i],e),this.cleanEventData(this.settings.events[i],!0));this.renderAllEvents()},deleteEvent:function(e){for(var t=e.id,i=this.settings.events.length-1;i>=0;i--)this.settings.events[i].id===t&&this.settings.events.splice(i,1);this.renderAllEvents()},cleanEventData:function(e,t){var i="on"===e.isAllDay||"true"===e.isAllDay||e.isAllDay,s=new Date(e.starts),n=new Date(e.ends);if(k.isValidDate(s)||(s=this.currentDate()),k.isValidDate(n)||(n=this.currentDate()),i?(s.setHours(0,0,0,0),e.starts=k.formatDate(new Date(s),{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name}),n.setHours(23,59,59,999),e.ends=k.formatDate(new Date(n),{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name}),e.duration=e.starts===e.ends?1:null,e.isAllDay=!0):(s===n?(n.setHours(n.getHours()+parseInt(e.durationHours,10)),e.ends=k.formatDate(n.toISOString(),{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name}),e.duration=null):e.ends=k.formatDate(new Date(n),{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name}),e.starts=k.formatDate(new Date(s),{pattern:"yyyy-MM-ddTHH:mm:ss.SSS",locale:this.locale.name}),e.isAllDay=!1),void 0===e.comments&&t&&(e.comments=k.translate("NoCommentsEntered",{locale:this.locale.name}),e.noComments=!0),!e.subject&&t&&(e.subject=k.translate("NoTitle",{locale:this.locale.name})),e.type||(e.type=this.settings.eventTypes[0].id),void 0===e.id&&t){var a=0===this.settings.events.length?0:parseInt(this.settings.events[this.settings.events.length-1].id,10);e.id=(a+1).toString()}"NewEvent"===e.title&&(e.title=k.translate("NewEvent",{locale:this.locale.name}))},showEventModal:function(e,t){var i=this;if(this.settings.modalTemplate){this.modalVisible()&&this.removeModal(),this.modalContents=document.createElement("div"),n.addClass(this.modalContents,"calendar-event-modal","hidden"),document.getElementsByTagName("body")[0].appendChild(this.modalContents),e=this.addCalculatedFields(e),this.renderTmpl(e||{},this.settings.modalTemplate,this.modalContents);var s=this.getDayEvents(),a=this.settings.modalOptions||{content:$(this.modalContents),closebutton:!0,placement:6===s.elem.index()?"left":"right",popover:!0,offset:{y:10},title:e.title||e.subject,trigger:"immediate",keepOpen:!0,extraClass:"calendar-popup",tooltipElement:"#calendar-popup",headerClass:e.color},r=!0;s.elem.off("hide.calendar").on("hide.calendar",function(){r?i.removeModal():(t(i.modalContents,e),i.element.trigger("hidemodal",{elem:i.modalContents,event:e}),i.removeModal(),r=!0)}).popover(a).off("show.calendar").on("show.calendar",function(t,n){i.element.trigger("showmodal",{elem:i.modalContents,event:e}),n.find("#isAllDay").off().on("click.calendar",function(e){$(e.currentTarget).prop("checked")?n.find("#durationHours").data("spinbox").disable():n.find("#durationHours").data("spinbox").enable()}),n.find("#type").val(e.type).trigger("updated"),n.find("#comments").val(e.comments),n.find("#subject").focus(),n.find("button").on("click",function(e){var t=s.elem.data("tooltip"),i=e.currentTarget.getAttribute("data-action");r="submit"!==i,t&&t.hide(!0)})}),this.activeElem=s.elem}},modalVisible:function(){return null!==document.querySelector(".calendar-event-modal")},removeModal:function(){this.modalContents=null,this.activeElem&&(this.activeElem.off(),this.activeElem.data("tooltip").destroy()),n.remove(document.getElementById("calendar-popup")),n.remove(document.querySelector(".calendar-event-modal"))},clearEvents:function(){this.settings.events=[],this.renderAllEvents()},updated:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e||(e={}),e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),e.locale||e.template||e.upcomingEventDays?(this.destroy().init(),this):(this.monthView.showMonth(this.settings.month,this.settings.year),this.renderAllEvents(),this)},teardown:function(){return this.element.off(),$(this.monthViewContainer).off(),this},destroy:function(){return this.eventTypeContainer&&(this.eventTypeContainer.innerHTML=""),this.monthViewContainer&&(this.monthViewContainer.innerHTML=""),this.upcomingEventsContainer&&(this.upcomingEventsContainer.innerHTML=""),this.eventDetailsContainer&&(this.eventDetailsContainer.innerHTML=""),this.removeModal(),this.teardown(),$.removeData(this.element[0],"calendar"),this}},$.fn.calendar=function(e){return this.each(function(){var t=$.data(this,"calendar");t?t.updated(e):t=$.data(this,"calendar",new kt(this,e))})};var $t={slidesToShow:1,startingSlide:null,loop:!1};function Tt(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,$t),this.init()}Tt.prototype={init:function(){this.setElements(),this.slides.length&&(this.createControls(),this.handleEvents(),this.initActiveSlide(),this.showCollapsedView())},setElements:function(){var e=this.settings;this.container=$(".slides",this.element),this.slidesJQ=$(".slide",this.element),this.slidesToShow=e.slidesToShow,this.slides=[],this.isVisible=!0;for(var t=0,i=this.slidesJQ.length;t<i;t++)this.slides.push({node:$(this.slidesJQ[t])});this.activeIndex=null!==e.startingSlide&&e.startingSlide>-1&&e.startingSlide<this.slides.length?e.startingSlide:0},createControls:function(){for(var e=this.slides.length,t='<div class="controls">',i="",s=0,n=void 0,a=void 0,r=void 0,o=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0,p=0,g=e;p<g;p+=this.slidesToShow){a="",s++,h=1===this.slidesToShow||e-p==1,o=k.translate(h?"SlideOf":"SlidesOf"),r=h?"#slide {0} of {1}":"#slides {0} and {1} of {2}";for(var f=0;f<this.slidesToShow&&p+f<e;f++)a+=p+f+1+", ";o=o.replace(h?"{1}":"{2}",e),r=r.replace(h?"{1}":"{2}",e),c=(a=a.slice(0,-2)).lastIndexOf(","),d=a.substr(c+2),h?(u="",(n=this.slides[p].node).is(".is-disabled, [disabled]")&&!n.is('[disabled="false"]')&&(u=' disabled tabindex="-1"',this.slides[p].isDisabled=!0),n.is(".active")&&null===this.settings.startingSlide&&""===u&&(this.activeIndex=p),o=(l=n.attr("data-button-text"))&&l.length?l:o.replace("{0}",a),r=r.replace("{0}",a)):(a=a.substr(0,c),o=o.replace("{1}",d).replace("{0}",a),r=r.replace("{1}",d).replace("{0}",a)),i+='<a href="'+(r=r.toLowerCase().replace(/[\s,--]+/g,"-"))+'" class="control-button hyperlink hide-focus"'+u+'><span class="audible">'+o+"</span></a>"}t+=i+"</div>",this.isBulletsNav=this.element.width()>29*s;var m=$(".btn-previous",this.element),v=$(".btn-next",this.element);this.isBulletsNav?m.add(v).remove():(m.length||(t+='<button class="btn-previous" type="button">\n            '+$.createIcon("left-arrow")+'\n            <span class="audible"> '+k.translate("Previous")+"</span>\n          </button>"),v.length||(t+='<button class="btn-next" type="button">\n            '+$.createIcon("right-arrow")+'\n            <span class="audible">'+k.translate("Next")+"</span>\n          </button>")),this.activeIndex>0&&this.activeIndex>s-1&&(this.activeIndex=s-1),s>1&&this.element.append(t)},isVisibleInContainer:function(e){if(e&&e[0]){var t=e[0].getBoundingClientRect(),i=this.element[0].getBoundingClientRect();return t.left>i.left&&t.left<i.left+i.width&&t.top>i.top&&t.top<i.top+i.height}return-1},updateSlidesToShow:function(e){if(this.isActive)return this.settings.slidesToShow=e||1,this.updated(),this},responsiveSlidesToShow:function(e){var t=this;this.isActive&&(this.slidesToShow=e||this.settings.slidesToShow,this.unbind().slidesJQ.css("width",""),this.slides.length&&setTimeout(function(){t.createControls(),t.handleEvents(),t.initActiveSlide(),t.showCollapsedView()},0))},show:function(e){if(this.isActive){e=void 0!==e?e:this.activeIndex,this.activeIndex=e;var t=e>0?(k.isRTL()?"":"-")+100*e+"%":0;this.controlButtons.removeClass("is-active").eq(e).addClass("is-active"),this.container[0].style.left=t,this.isBulletsNav?(this.element.removeClass("is-bullets-nav-hidden"),this.controlButtons.find("span").addClass("audible")):(this.element.addClass("is-bullets-nav-hidden"),this.controlButtons.find("span").addClass("audible").end().eq(e).find("span").removeClass("audible")),this.isFocus&&this.isBulletsNav&&(this.isFocus=!1,this.controlButtons.eq(e).focus())}},first:function(){this.show(0)},last:function(){this.show(Math.round(this.slides.length/this.slidesToShow)-1)},prev:function(){var e=this,t=void 0;if(t=this.activeIndex>0?this.activeIndex-1:this.settings.loop?Math.round(this.slides.length/this.slidesToShow)-1:0,this.slides[t].isDisabled)return setTimeout(function(){e.prev()},0),this.activeIndex=t,!1;this.show(t)},next:function(){var e=this,t=void 0;if(t=this.activeIndex>=Math.round(this.slides.length/this.slidesToShow)-1?this.settings.loop?0:this.activeIndex:this.activeIndex+1,this.slides[t].isDisabled)return setTimeout(function(){e.next()},0),this.activeIndex=t,!1;this.show(t)},showCollapsedView:function(){if(this.isActive=!0,this.element.addClass("is-active"),this.container[0].style.width=100*this.slides.length+"%",this.settings.slidesToShow>1&&this.slidesJQ.eq(0).width()*this.slidesToShow>this.element.width())this.responsiveSlidesToShow(this.slidesToShow-1);else{for(var e=0,t=this.slidesJQ.length;e<t;e++)this.slidesJQ[e].style.width=100/this.slidesToShow/this.slides.length+"%";this.show()}},showExpandedView:function(){this.isActive=!1,this.element.removeClass("is-active"),this.element&&this.element[0]&&(this.element[0].style.width=""),this.container&&this.container[0]&&(this.container[0].style.width="",this.container[0].style.left="")},initActiveSlide:function(){if(this.slides[this.activeIndex].isDisabled)return this.next(),!1;this.show(),this.slidesJQ.addClass("is-visible")},unbind:function(){return $("body").off("resize.circlepager"),this.element.off("focus.circlepager keydown.circlepager","*"),this.controlButtons&&this.controlButtons.off("click.circlepager keydown.circlepager"),$(".btn-previous, .btn-next",this.element).off("click.circlepager"),$(".controls",this.element).remove(),this.showExpandedView(),this.element.closest(".tab-panel-container").prev(".tab-container").off("activated.circlepager"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,$t)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"circlepager")},handleEvents:function(){var e=this,t=this;$(".btn-previous",this.element).on("click.circlepager",function(t){e.prev(),t.stopImmediatePropagation()}),$(".btn-next",this.element).on("click.circlepager",function(t){e.next(),t.stopImmediatePropagation()}),this.controlButtons=$(".control-button",this.element);for(var i=function(t,i){var s=$(e.controlButtons[t]);s.hideFocus(),s.on("click.circlepager",function(i){i.preventDefault(),e.slides[t].isDisabled||e.show(t)})},s=0,n=this.controlButtons.length;s<n;s++)i(s);this.element.on("focus.circlepager","*",function(e){var i=!1;if(!t.isVisibleInContainer($(this)))for(var s=t.element.find(":focusable"),n=0,a=s.length;n<a;n++)if(t.isVisibleInContainer(s.eq(n))){s.eq(n).focus(),i=!0;break}if(e.stopPropagation(),i)return!1}),this.element.on("keydown.circlepager","*",function(e){var i=!1,s=e.which||e.keyCode||e.charCode||0,n=$(":focusable"),a=n.index(this);if(9===s)if(e.shiftKey){for(var r=a-1;r>=0;r--)if(t.element.has(n.eq(r)).length<1||t.isVisibleInContainer(n.eq(r))){n.eq(r).focus(),i=!0;break}}else t.isVisibleInContainer(n.eq(a+1))||(t.controlButtons.first().focus(),i=!0);if(e.stopPropagation(),i)return!1}),this.controlButtons.on("keydown.circlepager",function(e){var i=!1,s=e.which||e.keyCode||e.charCode||0,n=k.isRTL();if(-1!==[37,39].indexOf(s)&&(t.isFocus=!0,e.altKey?37===s&&!n||39===s&&n?t.first():t.last():(!n&&37===s||n&&39===s?t.prev():t.next(),i=!0)),i)return e.preventDefault(),e.stopPropagation(),!1}),$("body").on("resize.circlepager",function(){t.responsiveSlidesToShow()}),t.element.closest(".tab-panel-container").prev(".tab-container").off("activated.circlepager").on("activated.circlepager",function(){t.responsiveSlidesToShow()})}},$.fn.circlepager=function(e){return this.each(function(){var t=$.data(this,"circlepager");t?t.updated(e):t=$.data(this,"circlepager",new Tt(this,e))})};var St={themes:{light:{border:"matched-only",checkmark:{one:[1,2],two:[3,10]}},dark:{border:"matched-only",checkmark:{one:[1,2],two:[3,10]}},contrast:{border:"all",checkmark:{one:[1,3],two:[4,10]}}},customColors:!1,colors:[{label:"Slate",number:"10",value:"1a1a1a"},{label:"Slate",number:"09",value:"292929"},{label:"Slate",number:"08",value:"383838",border:"dark"},{label:"Slate",number:"07",value:"454545",border:"dark"},{label:"Slate",number:"06",value:"5C5C5C"},{label:"Slate",number:"05",value:"737373"},{label:"Slate",number:"04",value:"999999"},{label:"Slate",number:"03",value:"BDBDBD"},{label:"Slate",number:"02",value:"D8D8D8"},{label:"Slate",number:"01",value:"F0F0F0",border:"light, contrast"},{label:"Amber",number:"10",value:"D66221"},{label:"Amber",number:"09",value:"DE7223"},{label:"Amber",number:"08",value:"E68425"},{label:"Amber",number:"07",value:"EB9728"},{label:"Amber",number:"06",value:"EFAA30"},{label:"Amber",number:"05",value:"F2BC41"},{label:"Amber",number:"04",value:"F4C951"},{label:"Amber",number:"03",value:"F7D475"},{label:"Amber",number:"02",value:"F8E09C"},{label:"Amber",number:"01",value:"FBE9BF"},{label:"Ruby",number:"10",value:"880E0E"},{label:"Ruby",number:"09",value:"941E1E"},{label:"Ruby",number:"08",value:"A13030"},{label:"Ruby",number:"07",value:"AD4242"},{label:"Ruby",number:"06",value:"B94E4E"},{label:"Ruby",number:"05",value:"C65F5F"},{label:"Ruby",number:"04",value:"D26D6D"},{label:"Ruby",number:"03",value:"DE8181"},{label:"Ruby",number:"02",value:"EB9D9D"},{label:"Ruby",number:"01",value:"F4BCBC"},{label:"Turquoise",number:"10",value:"0E5B52"},{label:"Turquoise",number:"09",value:"206B62"},{label:"Turquoise",number:"08",value:"317C73"},{label:"Turquoise",number:"07",value:"448D83"},{label:"Turquoise",number:"06",value:"579E95"},{label:"Turquoise",number:"05",value:"69ADA3"},{label:"Turquoise",number:"04",value:"7BBFB5"},{label:"Turquoise",number:"03",value:"8ED1C6"},{label:"Turquoise",number:"02",value:"A9E1D6"},{label:"Turquoise",number:"01",value:"C0EDE3"},{label:"Emerald",number:"10",value:"397514"},{label:"Emerald",number:"09",value:"44831F"},{label:"Emerald",number:"08",value:"56932E"},{label:"Emerald",number:"07",value:"66A140"},{label:"Emerald",number:"06",value:"76B051"},{label:"Emerald",number:"05",value:"89BF65"},{label:"Emerald",number:"04",value:"9CCE7C"},{label:"Emerald",number:"03",value:"AFDC91"},{label:"Emerald",number:"02",value:"C3E8AC"},{label:"Emerald",number:"01",value:"D5F6C0"},{label:"Amethyst",number:"10",value:"4B2A5E"},{label:"Amethyst",number:"09",value:"5A3A6F"},{label:"Amethyst",number:"08",value:"6C4B81"},{label:"Amethyst",number:"07",value:"7D5F92"},{label:"Amethyst",number:"06",value:"8E72A4"},{label:"Amethyst",number:"05",value:"A189B8"},{label:"Amethyst",number:"04",value:"B59ECA"},{label:"Amethyst",number:"03",value:"C7B4DB"},{label:"Amethyst",number:"02",value:"DACCEC"},{label:"Amethyst",number:"01",value:"EDE3FC"},{label:"Azure",number:"10",value:"133C59"},{label:"Azure",number:"09",value:"134D71"},{label:"Azure",number:"08",value:"1D5F8A"},{label:"Azure",number:"07",value:"2876A8"},{label:"Azure",number:"06",value:"368AC0"},{label:"Azure",number:"05",value:"4EA0D1"},{label:"Azure",number:"04",value:"69B5DD"},{label:"Azure",number:"03",value:"8DC9E6"},{label:"Azure",number:"02",value:"ADD8EB"},{label:"Azure",number:"01",value:"C8E9F4"}],placeIn:null,showLabel:!1,editable:!0,disabled:!1,uppercase:!0,colorOnly:!1,clearable:!0,clearableText:null};function At(e,t){this.settings=m.mergeSettings(e,t,St),t&&t.colors&&(this.settings.colors=t.colors),this.element=$(e),this.init()}At.prototype={init:function(){this.isIe="ie"===l.browser.name,this.isIeEdge="edge"===l.browser.name,this.isIe11=this.isIe&&"11"===l.browser.version,this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.settings.clearableText||(this.settings.clearableText=k?k.translate("None"):"None"),this.build(),this.handleEvents(),this.setCustomWidth()},build:function(){this.isEditor="editor"===this.settings.placeIn;var e=this.element,t=this.isEditor?this.element.attr("data-value"):this.element.val(),i="swatch"+(t&&""!==$.trim(t)?"":" is-empty");if(!this.isEditor)if(this.isInlineLabel?this.inlineLabel.addClass("colorpicker-container"):(this.container=$('<span class="colorpicker-container"></span>'),e.wrap(this.container)),this.container=e.parent(),this.swatch=$('<span class="'+i+'"></span>').prependTo(this.container),this.settings.showLabel){var s=e.data("mask");s&&"function"==typeof s.destroy&&s.destroy()}else{e.mask({pattern:["#",/[0-9a-fA-F]/,/[0-9a-fA-F]/,/[0-9a-fA-F]/,/[0-9a-fA-F]/,/[0-9a-fA-F]/,/[0-9a-fA-F]/]})}var n=this.element.children(".trigger");this.container&&this.container.length&&(n=this.container.children(".trigger")),n&&n.length&&n.children(".icon").length||(this.icon=$.createIconElement("dropdown").appendTo(this.isEditor?this.element:this.container),this.icon.wrap('<span class="trigger"></span>')),t&&this.setColor(t),(this.element.is(":disabled")||this.settings.disabled)&&this.disable(),this.element.prop("readonly")&&this.readonly(),this.settings.editable||this.settings.disabled||this.readonly(),this.settings.colorOnly&&this.element.parent().addClass("color-only"),this.addAria()},getHexFromLabel:function(e){for(var t=0;t<this.settings.colors.length;t++){var i=this.settings.colors[t],s=k.translate(i.label,!0);if(e===i.label+i.number||e===s+i.number){var n=i.value;return"#"!==n.substr(0,1)&&(n="#"+n),n}}return""},getLabelFromHex:function(e){if(!e)return"";for(var t=0;t<this.settings.colors.length;t++){var i=this.settings.colors[t];if(e.replace("#","")===i.value.replace("#",""))return this.translateColorLabel(i.label)+i.number}return""},setCustomWidth:function(){if(this.element[0].style&&this.element[0].style.width){var e=parseInt(this.element[0].style.width,10);this.container.css({width:e}),this.element.css({width:e-2-this.swatch.width()})}},getHexValue:function(){return this.element.attr("value")},getLabelValue:function(){return this.settings.showLabel?this.element.val():this.getLabelFromHex(this.element.val())},addAria:function(){this.element.attr({role:"combobox","aria-autocomplete":"list"}),$('label[for="'+this.element.attr("id")+'"]').append('<span class="audible">'+k.translate("UseArrow")+"</span>")},toggleList:function(){var e=this,t=$("#colorpicker-menu");if(!(this.element.is(":disabled")||this.element.prop("readonly")&&this.settings.editable||t.length&&this.isPickerOpen)){t=this.updateColorMenu();var i={ariaListbox:!0,menuId:"colorpicker-menu",trigger:"immediate",attachToBody:!0,placementOpts:{containerOffsetX:10,containerOffsetY:10,parentXAlignment:k.isRTL()?"right":"left",strategies:["flip","nudge","shrink"]},offset:{x:0,y:10}};this.element.popupmenu(i).on("open.colorpicker",function(){e.element.parent().addClass("is-open"),e.isPickerOpen=!0}).on("close.colorpicker",function(){[].slice.call(e.menu[0].querySelectorAll("a")).forEach(function(e){var t=$(e).data("tooltip");t&&t.hide()}),t.on("destroy.colorpicker",function(){e.element.off("open.colorpicker selected.colorpicker close.colorpicker"),e.menu.off("destroy.colorpicker").remove()}),e.element.parent().removeClass("is-open"),e.isPickerOpen=!1,e.element.trigger("listclosed","select")}).on("selected.colorpicker",function(t,i){e.isEditor||e.setColor(i.data("value"),i.data("label")),e.element.focus(),e.element.trigger("change")}),this.menu=$("#colorpicker-menu"),setTimeout(function(){e.menu.find(".is-selected").focus()},1)}},setColor:function(e,t){e=e||"";var i=this.settings,s=e,n=t;"#"!==e.substr(0,1)&&""!==e&&(s="#"+s);var a=/(^#[0-9a-fA-F]{6}$)|(^#[0-9a-fA-F]{3}$)/i.test(s);if(i.showLabel&&t===i.clearableText)this.setValueOnField({hex:s,label:i.clearableText,isEmpty:!0});else{if(!a){if(!i.showLabel)return s="#"!==s?s:"",void this.setValueOnField({hex:s,invalid:!0});n=e.replace("#",""),s=this.getHexFromLabel(n)}n||(n=this.getLabelFromHex(s)),this.setValueOnField({hex:s,label:n})}},setValueOnField:function(e){var t=this.settings,i=this.isEditor?"data-value":"value",s="";e.isEmpty||"string"!=typeof e.hex||(s=t.uppercase?e.hex.toUpperCase():e.hex.toLowerCase()),this.swatch&&(e.isEmpty||e.invalid?(this.swatch.addClass(e.isEmpty?"is-empty":"is-invalid"),this.swatch[0].style.backgroundColor=""):(this.swatch.removeClass("is-empty is-invalid"),this.swatch[0].style.backgroundColor=s)),this.element[0].value=t.showLabel?e.label:s,this.element[0].setAttribute(i,s),this.element[0].setAttribute("aria-describedby",e.label||"")},translateColorLabel:function(e){return e?"string"==typeof k.translate(e,!0)?k.translate(e,!0):e:""},getThemeVariant:function(e){var t=Object.keys(St.themes).filter(function(t){return e.indexOf(t)>-1}),i="light";return t.length>0&&(i=t[0]),i},updateColorMenu:function(){for(var e=this,t=this.settings,i=!!$("#colorpicker-menu").length,s=$('<ul id="colorpicker-menu" class="popupmenu colorpicker"></ul>'),n=j.currentTheme,a=this.getThemeVariant(n),r="all"===t.themes[a].border,o=t.themes[a].checkmark,l="",d=function(a,d){var c=$("<li></li>"),h=$('<a href="#"><span class="swatch"></span></a>').appendTo(c),u=(e.translateColorLabel(t.colors[a].label)||t.colors[a].label)+(t.colors[a].number||""),p=parseInt(t.colors[a].number,10),g=new RegExp("\\b"+n+"\\b"),f=t.colors[a].value,m=!1,v=e.isEditor?e.element.attr("data-value"):e.element.val();t.showLabel&&!e.isEditor&&(v=e.getHexFromLabel(v)),(r||g.test(t.colors[a].border))&&(m=!0),v&&(""+v).toLowerCase().replace("#","")===(""+f).toLowerCase()&&(o&&$.each(o,function(e,t){p>=t[0]&&p<=t[1]&&(l=" checkmark-"+e)}),h.addClass("is-selected"+l)),f=t.uppercase?f.toUpperCase():f.toLowerCase();var b=h.find(".swatch");b[0]&&(b[0].style.backgroundColor="#"+f),b.addClass(m?"is-border":""),h.data("label",u).data("value",f).attr("title",u+" #"+f).tooltip(),i||s.append(c)},c=0,h=t.colors.length;c<h;c++)d(c);if(!i){if(t.clearable){var u=$("<li></li>");$('<a href="#" title="'+t.clearableText+'"><span class="swatch is-empty'+(r?" is-border":"")+'"></span></a>').appendTo(u).data("label",t.clearableText).data("value","").tooltip(),s.append(u)}$("body").append(s)}return s},enable:function(){this.element.prop("disabled",!1),this.element.prop("readonly",!1),this.element.parent().removeClass("is-disabled is-readonly")},disable:function(){this.element.prop("disabled",!0),this.element.parent().addClass("is-disabled")},readonly:function(){this.enable(),this.element.prop("readonly",!0),this.element.parent().addClass("is-readonly"),this.settings.editable||this.element.parent().addClass("is-not-editable")},isDisabled:function(){return this.element.prop("disabled")},decimal2rgb:function(e){return"number"!=typeof e?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")"},rgb2hex:function(e){if(!e||-1===e.search("rgb"))return e;if("rgba(0, 0, 0, 0)"===e)return"transparent";var t=function(e){return("0"+parseInt(e,10).toString(16)).slice(-2)},i=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);return"#"+t(i[1])+t(i[2])+t(i[3])},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown(),this.init()},teardown:function(){this.element.off(["keypress.colorpicker","keyup.colorpicker","blur.colorpicker","openlist.colorpicker","change.colorpicker","paste.colorpicker"].join(" ")),this.swatch&&this.swatch.length&&(this.swatch.off("click.colorpicker"),this.swatch.remove(),delete this.swatch);var e=this.element.data("mask");if(e&&e.destroy(),this.icon&&this.icon.length){var t=this.icon.parent(".trigger");this.icon.off().remove(),t.off().remove(),delete this.icon}this.container&&this.container.length&&(this.container.find(".trigger").remove(),this.element.unwrap(),delete this.container)},destroy:function(){return this.teardown(),$.removeData(this.element[0],"colorpicker"),this},handleEvents:function(){var e=this,t=this.element,i=t.parent(),s=void 0;this.icon.parent().on("click.colorpicker",function(){e.toggleList()}),t.on("focus.colorpicker",function(){s=t.val(),i.addClass("is-focused")}).on("blur.colorpicker",function(){i.removeClass("is-focused"),e.isIeEdge&&!t.is(".is-open")&&s!==t.val()&&t.triggerHandler("change")}).on("openlist.colorpicker",function(){e.toggleList()});var n="blur.colorpicker paste.colorpicker change.colorpicker";n+=this.isIe11?"keypress.colorpicker":"keyup.colorpicker",t.on(n,function(){var i=e.isEditor?t.attr("data-value"):t.val();e.settings.showLabel?e.setColor(t.attr("value"),i):e.setColor(i)}),t.on("keydown.colorpicker",function(i){38!==i.keyCode&&40!==i.keyCode||e.toggleList(),13===i.keyCode&&e.setColor(t.val())})}},$.fn.colorpicker=function(e){return this.each(function(){var t=$.data(this,"colorpicker");t?t.updated(e):t=$.data(this,"colorpicker",new At(this,e))})};var Dt={trigger:null,bottomBorder:!1,animationSpeed:300};function It(e,t){this.settings=m.mergeSettings(e,t,Dt),this.element=$(e),this.init()}It.prototype={init:function(){this.setup().build().handleEvents()},setup:function(){return this.id=this.element.attr("id"),this.id&&void 0!==this.id||(this.id="expandable-area-"+$("body").find(".expandable-area").index(this.element)),this.element.prev(".expandable-area-trigger").length>0&&(this.expander=this.element.prev(".expandable-area-trigger"),this.settings.trigger=this.expander.attr("id")||"expandable-area-trigger-"+$("body").find(".expandable-area").index(this.element)),this.header=this.settings.trigger?this.element:this.element.children(".expandable-header"),this.footer=this.element.children(".expandable-footer"),this.content=this.element.children(".expandable-pane"),this.isCard=this.element.is(".card, .widget"),this},build:function(){var e,t,i,s=this,n=this.element.hasClass("is-expanded");return this.header.attr({"aria-expanded":""+n,"aria-controls":this.id+"-content",id:this.id+"-header"}),this.content.attr({id:this.id+"-content"}),this.isCard||this.footer.length||this.settings.trigger||(this.footer=$('<div class="expandable-footer"></div>').appendTo(this.element)),this.expander=(e=this,t=this.isCard,i=void 0,!0===t?((i=e.header.find("expandable-expander")).length||(i=$('<a href="#" target="_self" class="btn-expander"><svg class="chevron icon" focusable="false" aria-hidden="true" role="presenation"><use xlink:href="#icon-caret-down"></use></svg><span class="audible">'+k.translate("ShowMore")+"</span></a>").appendTo(e.header)),i):((i=e.footer.find(".expandable-expander")).length||(i=$('<a href="#" target="_self" class="expandable-expander hyperlink"><span data-translated="true">'+k.translate("ShowMore")+"</span></a>").prependTo(e.footer)),i)),this.expander.attr("href","#").hideFocus(),0===this.expander.length&&(this.expander=$("#"+this.settings.trigger)),this.settings.bottomBorder&&this.element.addClass("has-bottom-border"),n&&(this.content.addClass("no-transition"),this.element.one("afterexpand.expandable-area",function(){s.content.removeClass("no-transition")}),this.open()),n||(this.content.addClass("no-transition"),this.element.one("aftercollapse.expandable-area",function(){s.content.removeClass("no-transition")}),this.close()),this.resize(),this},isDisabled:function(){return this.element.hasClass("is-disabled")},isExpanded:function(){return this.element.is(".is-expanded")},toggleExpanded:function(){this.isExpanded()?this.close():this.open()},open:function(){var e=this;!1!==this.element.triggerHandler("beforeexpand",[this.element])&&(this.element.addClass("is-expanded"),this.header.attr("aria-expanded","true"),this.expander.addClass("active"),this.element.triggerHandler("expand",[this.element]),this.expander.find('span[data-translated="true"]').text(k.translate("ShowLess")?k.translate("ShowLess"):"Show Less"),this.isCard&&this.expander.find(".icon").addClass("active"),this.content[0]&&(this.content[0].style.display="block"),this.content.one("animateopencomplete",function(){e.element.triggerHandler("afterexpand",[e.element])}).animateOpen({timing:this.settings.animationSpeed}),this.applyIE11Fix())},close:function(){var e=this;!1!==this.element.triggerHandler("beforecollapse",[this.element])&&(this.expander.removeClass("active"),this.element.triggerHandler("collapse",[this.element]),this.expander.find('span[data-translated="true"]').text(k.translate("ShowMore")?k.translate("ShowMore"):"Show More"),this.isCard&&this.expander.find(".icon").removeClass("active"),this.content.one("animateclosedcomplete",function(){e.element.removeClass("is-expanded"),e.header.attr("aria-expanded","false"),e.element.triggerHandler("aftercollapse",[e.element]),e.content[0].style.display="none"}).animateClosed({timing:this.settings.animationSpeed}),this.applyIE11Fix())},applyIE11Fix:function(){var e=this,t=$("html").hasClass("ie11");setTimeout(function(){t&&e.element.hasClass("is-expanded")?e.element.css("min-height",e.element.children(".expandable-pane").outerHeight(!0)+e.element.children(".expandable-footer").outerHeight(!0)):t&&!e.element.hasClass("is-expanded")&&e.element.css("min-height","auto")},300)},resize:function(){var e=this;$("body").on("resize.expandablearea",function(){e.applyIE11Fix()})},disable:function(){this.element.addClass("is-disabled")},enable:function(){this.element.removeClass("is-disabled")},destroy:function(){this.header.children("a").off(),this.header.off(),this.header.removeAttr("aria-controls").removeAttr("aria-expanded").removeAttr("id"),this.content.removeAttr("id").removeClass("no-transition"),$.removeData(this.element[0],"expandablearea")},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this},handleEvents:function(){var e=this;return this.expander.on("click.expandablearea",function(t){e.isDisabled()||(t.preventDefault(),e.toggleExpanded())}),this}},$.fn.expandablearea=function(e){return this.each(function(){var t=$.data(this,"expandablearea");t?t.updated(e):t=$.data(this,"expandablearea",new It(this,e))})};var Et={breakpoint:"phone-to-tablet",trigger:null,expandedText:k.translate("ShowLess"),collapsedText:k.translate("ShowMore")};function Lt(e,t){this.settings=m.mergeSettings(e,t,Et),this.element=$(e),this.init(),A("CompositeForm")}Lt.prototype={init:function(){return this.build().handleEvents()},build:function(){var e=this.element[0].classList;e.contains("composite-form")||e.add("composite-form");var t=this.element.find(".expandable-area");return t.length?(this.hasSummary=!0,this.expandableArea=t,this.expandableAreaAPI=this.expandableArea.data("expandablearea"),this.expandableAreaAPI||(this.expandableArea.expandablearea({trigger:this.settings.trigger}),this.expandableAreaAPI=this.expandableArea.data("expandablearea")),this.expander=this.expandableAreaAPI.expander,this.setExpanderText(this.settings.expandedText)):this.hasSummary=!1,this.checkResponsive(),this},handleEvents:function(){var e=this;function t(){var t=e.expandableAreaAPI.isExpanded();e.setExpanderText(e.settings[t?"expandedText":"collapsedText"])}return $("body").off("resize.compositeform").on("resize.compositeform",function(t){e.checkResponsive(t)}),this.element.on("updated.compositeform",function(){e.updated()}),this.hasSummary&&this.expandableArea.on("expand.compositeform",t).on("collapse.compositeform",t),this},checkResponsive:function(){var e=this.element[0].classList;a.isBelow(this.settings.breakpoint)?e.add("is-in-responsive-mode"):(e.remove("is-in-responsive-mode"),this.isSideOriented()&&!this.expandableAreaAPI.isExpanded()&&this.expandableAreaAPI.open())},setExpanderText:function(e){if(this.hasSummary&&e instanceof String&&e.length){var t=this.expander.find("span");t||(t=this.expander),t.text(e)}},isSideOriented:function(){return this.element[0].classList.contains("on-side")},updated:function(){return this.teardown().init()},teardown:function(){return $("body").off("resize.compositeform"),this.element.off("updated.compositeform"),this.hasSummary&&this.expandableArea.off("expand.compositeform collapse.compositeform"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"compositeform")}},$.fn.compositeform=function(e){return this.each(function(){var t=$.data(this,"compositeform");t?t.updated(e):t=$.data(this,"compositeform",new Lt(this,e))})};var Pt={id:"contextual-action-modal-"+(parseInt($(".modal").length,10)+1),buttons:null,title:"Contextual Action Panel",content:null,initializeContent:!0,trigger:"click",showCloseButton:!1,centerTitle:!1};function Mt(e,t){this.settings=m.mergeSettings(e,t,Pt),this.element=$(e),this.init()}Mt.prototype={get modalAPI(){var e=void 0;return this.panel&&this.panel.length&&(e=this.panel.data("modal")),e},init:function(){this.setup().build().handleEvents()},setup:function(){var e=this;this.panel=this.element.next(".contextual-action-panel");var t=this.element.data("modal"),i=function(t){var i=$("#"+t);i.length&&(e.panel=i)};return"string"==typeof t?i(t):"object"===(void 0===t?"undefined":u(t))&&i(this.element.attr("data-modal")),1===this.element.closest(".popupmenu").length&&(this.panel=this.element.closest(".popupmenu").next(".contextual-action-panel")),this.panel[0]&&(this.panel[0].style.display="none"),this.panel.addClass("is-animating"),this},build:function(){var e=this;if(0===this.panel.length)if(this.settings.content instanceof jQuery){if(this.settings.content.is(".contextual-action-panel")?this.panel=this.settings.content:(this.settings.content.wrap('<div class="contextual-action-panel"></div>'),this.panel=this.settings.content.parent()),this.panel.addClass("modal").appendTo("body"),this.settings.content.is("iframe"))return this.settings.content.ready(function(){e.completeBuild(),e.settings.content.show()}),e;this.settings.content.show()}else this.panel=$('<div class="contextual-action-panel">'+this.settings.content+"</div>").appendTo("body"),this.panel.addClass("modal").attr("id",this.settings.id);return this.completeBuild(),this},completeBuild:function(){var e=void 0,t=!1,i=void 0,s=!1,n=!0;this.panel.find("svg").icon(),0===this.panel.find(".modal-content").length&&((e=this.panel.children()).is("iframe")&&(i=e.contents(),this.toolbar=i.find(".toolbar, .flex-toolbar"),t=!0),t||(e.wrapAll('<div class="modal-content"></div>').wrapAll('<div class="modal-body"></div>'),this.panel.addClass("modal")));var a=this.panel.find(".modal-header");0===a.length&&(a=$('<div class="modal-header"></div>')).insertBefore(this.panel.find(".modal-body")),this.header=a;var r=this.panel.find(".toolbar .buttonset, .flex-toolbar .buttonset");if(this.toolbar||(this.toolbar=this.panel.find(".toolbar, .flex-toolbar")),!this.toolbar.length)if(n=!1,this.settings.buttons&&this.settings.buttons.forEach(function(e){"input"===e.type&&(s=!0)}),this.settings.title&&this.settings.centerTitle){var o=s?'<div class="toolbar-section search"></div>':"",l='<div class="flex-toolbar">\n          <div class="toolbar-section static"></div>\n          <div class="toolbar-section title center-text">\n            <h2>'+this.settings.title+"</h2>\n          </div>\n          "+o+'\n          <div class="toolbar-section buttonset static"></div>\n        </div>';this.toolbar=$(l)}else if(!r.length){var d=this.settings.useFlexToolbar?"flex-toolbar":"toolbar",c=this.settings.useFlexToolbar?'<div class="toolbar-section title"><h2>'+this.settings.title+"</h2></div>":"",h='<div class="'+(this.settings.useFlexToolbar?"toolbar-section buttonset":"buttonset")+'"></div>',u=this.settings.useFlexToolbar&&s?'<div class="toolbar-section search"></div>':"",p=$('<div class="'+d+'">\n          '+c+"\n          "+u+"\n          "+h+"\n        </div>");p.appendTo(this.panel.find(".modal-header")),this.toolbar=p,r=p.children(".buttonset")}if(this.toolbar.appendTo(this.header),!n){r&&(r.length||this.settings.centerTitle)||(r=$('<div class="toolbar-section buttonset"></div>')).appendTo(this.toolbar);var g=this.toolbar.find(".title");if(!g.length){var f=this.settings.centerTitle?" center-text":"";g=$('\n          <div class="toolbar-section title'+f+'">\n            <h2>'+this.settings.title+"</h2>\n          </div>\n        "),r?g.insertBefore(r):this.toolbar.prepend(g)}g.length||(g=$('\n          <div class="title">\n            '+this.settings.title+"\n          </div>\n        "),this.toolbar.prepend(g))}if(t||this.panel.detach().appendTo("body"),this.element.attr("data-modal",this.settings.id),this.panel.attr("id")||this.panel.attr("id",this.settings.id),this.panel.modal({buttons:this.settings.buttons,centerTitle:this.settings.centerTitle,useFlexToolbar:this.settings.useFlexToolbar,trigger:this.settings.trigger?this.settings.trigger:"click"}),this.buttons=this.panel.find(".buttonset").children("button"),this.closeButton=this.panel.find(".modal-header").find('.btn-close, [name="close"], button.close-button'),!n&&this.settings.showCloseButton&&!this.closeButton.length)if(this.closeButton=$('\n        <button class="btn-close" type="button">\n          <svg class="icon icon-close" focusable="false" aria-hidden="true" role="presentation">\n            <use xlink:href="#icon-close"></use>\n          </svg>\n          <span>Close</span>\n        </button>\n      '),this.settings.useFlexToolbar){var v=$('<div class="toolbar-section static"></div>').append(this.closeButton),b=this.toolbar.find(".toolbar-section.more");v.after(b.length?b:r)}else{var y=$('<div class="close-button"></div>').append(this.closeButton);this.header.append(y)}return this.closeButton.length&&this.toolbar.addClass("has-close-button"),this.toolbar.is(".toolbar")&&this.toolbar.toolbar(),this.toolbar.is(".flex-toolbar")&&this.toolbar.toolbarflex(),m.fixSVGIcons(this.element),this},handleEvents:function(){var e=this;function t(t){e.element.triggerHandler(t.type)}return this.panel.addClass("is-animating").off("open.contextualactionpanel").on("open.contextualactionpanel",function(i){t(i),e.panel.removeClass("is-animating")}).off("beforeclose.contextualactionpanel").on("beforeclose.contextualactionpanel",function(){e.panel.addClass("is-animating")}).off("close.contextualactionpanel").on("close.contextualactionpanel",function(e){t(e)}).off("beforeopen.contextualactionpanel").on("beforeopen.contextualactionpanel",function(i){e.settings.initializeContent&&$(this).initialize(),t(i)}).off("afteropen.contextualactionpanel").on("afteropen.contextualactionpanel",function(){if(e.toolbar&&e.toolbar.trigger("recalculate-buttons"),e.toolbar.length){var t=e.toolbar.find(".buttonset > .is-selected");if(t.length||(t=e.toolbar.find(".buttonset > *:first-child")).is(".searchfield-wrapper")&&(t=t.children(".searchfield")),!t.length&&e.toolbar.is(".flex-toolbar"))return void(t=e.toolbar.find("button").first()).focus();var i=e.toolbar.data("toolbar");i&&i.setActiveButton(t,!0)}e.panel.find(".modal-body-wrapper").find(":focusable").first().focus(),m.fixSVGIcons(e.panel)}),e.closeButton&&e.closeButton.length&&e.closeButton.on("click.contextualactionpanel",function(){e.handleToolbarSelected()}),this},handleToolbarSelected:function(){this.close()},teardown:function(){var e=this.toolbar.children(".buttonset");this.panel.off("open.contextualactionpanel close.contextualactionpanel beforeopen.contextualactionpanel afterclose.contextualactionpanel"),e.children("*:not(.searchfield)").off("click.contextualactionpanel"),e.children(".btn-menu").each(function(){var e=$(this).data("popupmenu");e&&e.destroy()}),this.header&&this.header.remove(),this.panel.find(".modal-body").children().first().unwrap().unwrap(),this.element.removeAttr("data-modal"),this.closeButton&&this.closeButton.length&&(this.closeButton.off("click.contextualactionpanel"),delete this.closeButton),this.element.trigger("afterteardown")},close:function(){var e=void 0;"immediate"===this.settings.trigger&&(e=!0),this.modalAPI&&this.modalAPI.close(e)},disable:function(){this.element.prop("disabled",!0),this.panel.hasClass("is-visible")&&this.close()},enable:function(){this.element.prop("disabled",!1)},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this.setup(),this.modalAPI&&this.modalAPI.updated(e),this},destroy:function(){this.modalAPI&&this.modalAPI.isOpen&&this.modalAPI.close(!0),$.removeData(this.element[0],"contextualactionpanel")}},$.fn.contextualactionpanel=function(e){return this.each(function(){var t=$.data(this,"contextualactionpanel");t?t.updated(e):t=$.data(this,"contextualactionpanel",new Mt(this,e))})};var Bt={content:null,offset:{top:10,left:10},placement:"top",trigger:"hover",title:null,beforeShow:null,popover:null,closebutton:null,isError:!1,isErrorColor:!1,tooltipElement:null,parentElement:null,keepOpen:!1,extraClass:null,placementOpts:{},maxWidth:null,initializeContent:!0,headerClass:null};function Rt(e,t){this.settings=m.mergeSettings(e,t,Bt),this.element=$(e),this.init()}Rt.prototype={get visible(){return!1===n.hasClass(this.element[0],"is-hidden")},get popupmenuAPI(){return this.element.data("popupmenu")},init:function(){this.uniqueId=m.uniqueId(this.element,"tooltip"),this.isTouch=l.features.touch,this.setup(),this.appendTooltip(),"immediate"!==this.settings.trigger&&this.setContent(this.settings.content,!0),this.handleEvents()},setup:function(){this.activeElement=this.settings.parentElement instanceof $&&this.settings.parentElement.length?this.settings.parentElement:this.element,this.descriptionId=$(".tooltip-description").length+1,this.description=this.element.parent().find(".tooltip-description"),!this.description.length&&this.settings.isError&&(this.description=$('<span id="tooltip-description-'+this.descriptionId+'" class="tooltip-description audible"></span>').insertAfter(this.element)),this.element.is(".dropdown, .multiselect")&&(this.activeElement=this.element.nextAll(".dropdown-wrapper:first").find(">.dropdown"));var e=this.element.attr("title");(!this.settings.popover&&e&&e.length||!this.settings.popover&&this.settings.title)&&(this.settings.content=this.settings.title?this.settings.title:e,this.element.removeAttr("title")),"hover"===this.settings.trigger&&this.isTouch&&this.element.addClass("longpress-target"),this.isPopover=null!==this.settings.content&&"object"===u(this.settings.content)||!0===this.settings.popover,this.settings.closebutton=!(!this.settings.closebutton&&!this.element.data("closebutton")),this.element.data("extraClass")&&this.element.data("extraClass").length&&(this.settings.extraClass=this.element.data("extraClass")),this.isRTL=k.isRTL()},addAria:function(){this.content&&(this.description.text(this.content),this.content=this.addClassToLinks(this.content,"links-clickable"),this.isPopover||this.element.removeAttr("title").attr("aria-describedby",this.description.attr("id")),this.isPopover&&"click"===this.settings.trigger&&this.element.attr("aria-haspopup",!0))},addClassToLinks:function(e,t){if(e instanceof $&&e.length>0)return e;var i=$("<div/>").html(e);return $("a",i).addClass(t),i.html()},appendTooltip:function(){if(this.tooltip=this.settings.tooltipElement?$(this.settings.tooltipElement):$("#tooltip"),!this.tooltip.length){var e=this.settings.tooltipElement?this.settings.tooltipElement.substring(1,this.settings.tooltipElement.length):"tooltip";this.tooltip=$('<div class="'+(this.isPopover?"popover":"tooltip")+' bottom is-hidden" role="tooltip" id="'+e+'"><div class="arrow"></div><div class="tooltip-content"></div></div>')}this.tooltip.place({container:this.scrollparent,parent:this.activeElement,placement:this.settings.placement,strategy:"flip"}),this.setTargetContainer()},handleEvents:function(){var e=this,t=400,i=void 0;function s(){clearTimeout(i),e.show()}function n(){clearTimeout(i),e.hide()}function a(){e.visible?s():n()}"hover"!==this.settings.trigger||this.settings.isError||(this.element.is(".dropdown, .multiselect, span.longpress-target")?this.activeElement:this.element).on("mouseenter.tooltip",function(){e.isTouch||(clearTimeout(i),i=setTimeout(function(){e.element.is(":visible")&&e.show()},t))}).on("mouseleave.tooltip",function(){clearTimeout(i),i=setTimeout(function(){e.hide()},t)}).on("click.tooltip",function(){e.isTouch||s()}).on("longpress.tooltip",function(){s()}).on("updated.tooltip",function(){e.updated()}),"click"===this.settings.trigger&&this.element.on("click.tooltip",function(){a()}),"immediate"===this.settings.trigger&&(i=setTimeout(function(){a()},1)),"focus"===this.settings.trigger&&this.element.on("focus.tooltip",function(){s()}).on("blur.tooltip",function(){e.settings.keepOpen||n()}),$(window).on("orientationchange.tooltip",function(){e.visible&&n()},!1)},setContent:function(e,t){var i=this,n=this.settings.content,a=null==e;function r(){!0!==t&&(i.addAria(),i.render())}if(a&&null==n)return!1;if("function"==typeof n&&(e=n),a&&(e=n),e===this.content)return r(),!0;if(e instanceof $&&e.length)return this.content=e.addClass("hidden"),r(),!0;if("string"==typeof e){if(!e.length)return!1;if(0===(e=k.translate(e,{showAsUndefined:!0})||e).indexOf("#")){var o=$(""+e);return!!o.length&&(this.content=o,r(),!0)}}else{if("function"!=typeof e)return!1;var l=e.call(this.element);if(!l||"string"!=typeof l||!l.length)return!1;e=l}return this.content=s.sanitizeHTML(e),this.content="<p>"+this.content+"</p>",r(),!0},render:function(){return this.isPopover?this.renderPopover():this.renderTooltip()},renderTooltip:function(){var e=this.tooltip[0].querySelectorAll(".tooltip-title")[0],t=this.tooltip[0].querySelectorAll(".tooltip-content")[0],i=this.settings.extraClass,s=this.content,a="tooltip is-hidden";i&&(a+=" "+i),this.tooltip[0].setAttribute("class",a),e&&(e.style.display="none"),t&&t.previousElementSibling&&!t.previousElementSibling.classList.contains("arrow")&&t.insertAdjacentHTML("beforebegin",'<div class="arrow"></div>');var r="string"==typeof this.content?s:s[0].innerHTML;n.html(t,r,"<div><p><span><ul><li><a><abbr><b><i><kbd><small><strong><sub><svg><use><br>")},renderPopover:function(){var e=this,t=this.settings.extraClass,i=this.tooltip.find(".tooltip-content"),s=this.tooltip[0].querySelector(".tooltip-title"),a=this.content,r="popover is-hidden";t&&(r+=" "+t),this.tooltip[0].setAttribute("class",r),"string"==typeof a?(a=$(a),i.html(a),i.find(".hidden").removeClass("hidden")):i.html(a);var o=i.width();this.settings.placementOpts||(this.settings.placementOpts={}),this.settings.placementOpts.parent||(this.settings.placementOpts.parent=this.element),a[0].classList.remove("hidden"),i[0].firstElementChild.classList.remove("hidden");var l=this.settings.placementOpts.parent.width();if(k.isRTL()?this.settings.placementOpts.parentXAlignment=l>o?"left":"right":this.settings.placementOpts.parentXAlignment=l>o?"right":"left",null!==this.settings.title)if(s)s.style.display="",s.childNodes[0].nodeValue=this.settings.title;else{var d=document.createDocumentFragment();s=document.createElement("div"),n.html(s,this.settings.title,"*"),s.classList.add("tooltip-title"),this.settings.headerClass&&n.addClass(s,this.settings.headerClass,"filled"),d.appendChild(s),this.tooltip[0].insertBefore(d,this.tooltip[0].firstChild)}else s&&(s.style.display="none");if(this.settings.closebutton&&s&&!s.firstElementChild){var c=$('<button type="button" class="btn-icon l-pull-right btn-close">'+$.createIcon({classes:["icon-close"],icon:"close"})+"<span>Close</span></button>").on("click",function(){e.hide(!0)});s.appendChild(c[0])}this.settings.initializeContent&&a.initialize()},open:function(){return this.show()},show:function(e,t){var i=this;if(this.isInPopup=!1,e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),!this.popupmenuAPI||!this.popupmenuAPI.isOpen){if(this.settings.beforeShow&&!t){var s=function(e){("boolean"!=typeof e||e)&&(i.content=e,i.show({content:e},!0))};return"string"==typeof this.settings.beforeShow?void window[this.settings.beforeShow](s,this.element):void this.settings.beforeShow(s,this.element)}if(!1!==this.setContent(this.content)&&!1!==this.element.triggerHandler("beforeshow",[this.tooltip])){this.tooltip[0].removeAttribute("style"),this.tooltip[0].classList.add(this.settings.placement),(this.settings.isError||this.settings.isErrorColor)&&this.tooltip[0].classList.add("is-error"),this.position(),m.fixSVGIcons(this.tooltip),this.element.trigger("show",[this.tooltip]);var n=this.isTouch?"touchend":"mouseup",a=i.element.closest(".is-personalizable").length>0;i.tooltip[0].classList[a?"add":"remove"]("is-personalizable"),setTimeout(function(){$(document).on(n+".tooltip-"+i.uniqueId,function(e){var t=$(e.target);i.settings.isError||"focus"===i.settings.trigger||t.is(i.element)&&t.is("svg.icon")||$("#editor-popup").length&&$("#colorpicker-menu").length||(0===t.closest(".popover").length&&0===t.closest(".dropdown-list").length&&i.hide(),1===t.closest(".popover").length&&t.closest(".popover").not(".monthview-popup").length&&i.element.prev().is(".datepicker")&&i.hide(e))}).on("keydown.tooltip-"+i.uniqueId,function(e){(27===e.which||i.settings.isError)&&i.hide()}),i.settings.isError&&!i.element.is(":visible, .dropdown")&&i.element.is("[aria-describedby]")&&i.hide(),void 0===window.orientation&&$("body").on("resize.tooltip",function(){i.hide()}),$("body").on("scroll.tooltip",function(){i.hide()}),i.element.closest(".modal-body-wrapper").on("scroll.tooltip",function(){i.hide()}),i.element.closest(".scrollable").on("scroll.tooltip",function(){i.hide()}),i.element.closest(".datagrid-body").on("scroll.tooltip",function(){i.hide()}),i.settings.isError&&i.tooltip.on("click.tooltip",function(){i.hide()}),i.element.trigger("aftershow",[i.tooltip])},400)}}},setTargetContainer:function(){var e=$("body");this.scrollparent=this.element.closest(".page-container.scrollable"),this.scrollparent.length&&(e=this.scrollparent),this.settings.parentElement&&(e=this.settings.parentElement),e[0].appendChild(this.tooltip[0])},handleAfterPlace:function(e,t){this.tooltip.data("place").setArrowPosition(e,t,this.tooltip),this.tooltip.triggerHandler("tooltipafterplace",[t])},position:function(){this.setTargetContainer(),this.tooltip[0].classList.remove("is-hidden");var e=this,t=this.isPopover?20:10,i=this.settings.placementOpts||{},s=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=this.tooltip[0].getBoundingClientRect(),r=$.extend({},{x:0,y:t,container:this.scrollparent,containerOffsetX:i.containerOffsetX||this.settings.offset.left,containerOffsetY:i.containerOffsetY||this.settings.offset.top,parent:i.parent||this.activeElement,placement:i.placement||this.settings.placement,strategies:["flip","nudge"]},i);return"left"!==r.placement&&"right"!==r.placement||(r.x=t,r.y=0),a.width>=s&&/left|right/g.test(r.placement)?this.tooltip[0].classList.add("no-arrow"):a.height>=n&&/top|bottom/g.test(r.placement)?this.tooltip[0].classList.add("no-arrow"):this.tooltip[0].classList.remove("no-arrow"),this.tooltip.one("afterplace.tooltip",function(t,i){e.handleAfterPlace(t,i)}),this.tooltip.data("place")?this.tooltip.data("place").place(r):(this.tooltip.place(r),this.tooltip.data("place").place(r)),this},close:function(){return this.hide()},hide:function(e){this.settings.keepOpen&&!e||!this.visible||(this.isInPopup?this.settings.content.addClass("hidden"):(this.tooltip[0].classList.remove("is-personalizable"),this.tooltip[0].classList.add("is-hidden"),this.tooltip[0].style.left="",this.tooltip[0].style.top="",this.tooltip.find(".arrow").removeAttr("style"),this.detachOpenEvents(),0===$(".popover").not(".is-hidden").length&&($(document).off("mouseup.tooltip keydown.tooltip"),$("body").off("resize.tooltip")),this.element.triggerHandler("hide",[this.tooltip])))},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings));var t=this;return"immediate"===t.settings.trigger?setTimeout(function(){t.show()},100):t.setContent(),this},detachOpenEvents:function(){this.tooltip.off("click.tooltip"),$(document).off(["keydown.tooltip-"+self.uniqueId,"mouseup.tooltip-"+self.uniqueId,"touchend.tooltip-"+self.uniqueId].join(" ")),$("body").off(["resize.tooltip","scroll.tooltip"].join(" ")),this.element.closest(".modal-body-wrapper").off("scroll.tooltip"),this.element.closest(".scrollable").off("scroll.tooltip"),this.element.closest(".datagrid-body").off("scroll.tooltip")},teardown:function(){return this.description.remove(),this.descriptionId=void 0,this.activeElement=void 0,this.element.removeAttr("aria-describedby").removeAttr("aria-haspopup"),this.tooltip.hasClass("is-hidden")||this.hide(),this.tooltip&&this.tooltip.data("place")&&this.tooltip.data("place").destroy(),this.element.off(["mouseenter.tooltip","mouseleave.tooltip","longpress.tooltip","click.tooltip","updated.tooltip","focus.tooltip","blur.tooltip"].join(" ")),this.detachOpenEvents(),$(window).off("orientationchange.tooltip"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"tooltip")}},$.fn.tooltip=function(e){return this.each(function(){var t=$.data(this,"tooltip");t?t.updated(e):t=$.data(this,"tooltip",new Rt(this,e))})},$.fn.popover=$.fn.tooltip;var Ft=["none","all","group"],Ot={closeOnSelect:!0,cssClass:null,filterMode:"contains",maxSelected:void 0,moveSelected:"none",moveSelectedToTop:void 0,multiple:!1,noSearch:!1,showEmptyGroupHeaders:!1,showSelectAll:!1,source:void 0,sourceArguments:{},reload:"none",empty:!1,delay:300,maxWidth:null,placementOpts:null,onKeyDown:null};function Nt(e,t){this.settings=m.mergeSettings(e,t,Ot),this.element=$(e),this.init()}Nt.prototype={get value(){var e=this.settings.reload,t=this.settings.multiple;if("typeahead"===e)return t?this.selectedValues:this.element.val();for(var i=[],s=this.element[0].options,n=void 0,a=0;a<s.length;a++)(n=s[a]).selected&&i.push(n.value||n.text);return t||1!==i.length?i:i[0]},get overflowed(){if(!this.isMobile()||this.isMobile()&&!this.isOpen()){var e=this.pseudoElem.find("span").css("max-width","");if(Math.round(e.width())>Math.round(this.pseudoElem.width()))return e.css("max-width","100%"),!0}return!1},init:function(){var e=this,t=this.element.attr("id");t=t?s.stripTags(t):"",this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.timer=null,this.filterTerm="",t||(t=m.uniqueId(this.element,"dropdown"),n.setAttribute(this.element[0],"id",t),n.setAttribute(this.element.parent().find("label").first()[0],"for",t)),"ios"!==l.os.name&&"android"!==l.os.name||(this.settings.noSearch=!0);var i=this.element[0].classList;0===i.length&&(this.element[0].classList="dropdown");var a=i.contains("dropdown-xs")?"dropdown input-xs":i.contains("dropdown-sm")?"dropdown input-sm":i.contains("dropdown-lg")?"dropdown input-lg":"dropdown",r=this.element.attr("style");this.isHidden=r&&r.indexOf("display: none")>=0;var o=this.isInlineLabel?this.inlineLabel:this.element;this.wrapper=o.next(".dropdown-wrapper"),this.isWrapped=this.wrapper.length>0,this.isWrapped||(this.wrapper=$('<div class="dropdown-wrapper"></div>').insertAfter(o)),this.isWrapped?(this.pseudoElem=this.wrapper.find("."+a),this.trigger=this.wrapper.find(".trigger")):this.pseudoElem=$("div#"+t+"-shdo"),i.contains("text-align-reverse")?a+=" text-align-reverse":i.contains("text-align-center")&&(a+=" text-align-center"),this.label=$('label[for="'+s.stripTags(t)+'"]'),this.pseudoElem.length?this.pseudoElem[0].setAttribute("class",a):this.pseudoElem=$('<div class="'+a+'">'),this.isWrapped||this.pseudoElem.append($("<span></span>"));var d,c,h,u=n.getAttributes(this.element[0]),p=this.getDataAttributes(u,["data-validate"]);this.pseudoElem.attr(p.obj).attr({role:"button","aria-haspopup":"listbox"}),c=(d=this).element.prop("disabled"),h=d.element.prop("readonly"),c?d.disable():h?d.readonly():d.enable(),this.isWrapped||this.wrapper.append(this.pseudoElem,this.trigger),this.icon=this.wrapper.find(".icon"),this.icon.length||(this.icon=$.createIconElement("dropdown"),this.wrapper.append(this.icon)),this.element.prop("multiple")&&!this.settings.multiple&&(this.settings.multiple=!0),this.settings.multiple&&!this.element.prop("multiple")&&this.element.prop("multiple",!0),"typeahead"===this.settings.reload?this.selectedValues=[]:delete this.selectedValues;var g=this.element.attr("data-source");g&&"source"!==g&&(this.settings.source=g);var f=this.element.attr("data-maxselected");function v(e,t){switch(e){case!t||"true":return"all";case!!t&&"false":return"none";default:return Ft.indexOf(e)>-1?e:"none"}}f&&!isNaN(f)&&(this.settings.maxSelected=parseInt(f,10)),void 0!==this.settings.moveSelectedToTop&&(this.settings.moveSelected=this.settings.moveSelectedToTop);var b=this.element.attr("data-move-selected");this.settings.moveSelected=b?v(b,!0):v(this.settings.moveSelected),this.settings.reloadSourceOnOpen&&(this.settings.reload="open",delete this.settings.reloadSourceOnOpen);var y=this.element.attr("data-close-on-select");y&&!this.settings.closeOnSelect&&(this.settings.closeOnSelect="true"===y);var w=this.element.attr("data-no-search");w&&!this.settings.noSearch&&(this.settings.noSearch="true"===w);for(var x=["-xs","-sm","-mm","-md","-lg"],C=this.element.attr("class"),k=null,T=0;T<x.length;T++)k=x[T],C.match(k)&&this.pseudoElem.addClass("dropdown"+k);return this.dataset=[],this.listfilter=new Ve({filterMode:this.settings.filterMode}),this.setListIcon(),this.setDisplayedValues(),this.setInitial(),this.setWidth(),setTimeout(function(){e.toggleTooltip()},0),this.element.triggerHandler("rendered"),this.handleEvents()},inputTimer:function(){if(this.inputTimeout)return!1;var e=this;return this.inputTimeout=setTimeout(function(){clearTimeout(e.inputTimeout),e.inputTimeout=null},100),!0},setWidth:function(){var e=this.element[0].style;e.width&&(this.pseudoElem[0].style.width=e.width),"absolute"===e.position&&(this.pseudoElem[0].style.position="absolute",this.pseudoElem[0].style.left=e.left,this.pseudoElem[0].style.top=e.top,this.pseudoElem[0].style.bottom=e.bottom,this.pseudoElem[0].style.right=e.right)},setItemIcon:function(e){if(!e.icon)return e.isIcon=!1,e.html="",void this.listIcon.items.push(e);"object"===u(e.icon)&&(e.obj=e.icon,e.icon=e.icon.icon,e.obj.color?0===e.obj.color.indexOf("#")?e.specColor=e.obj.color:e.classList=" "+e.obj.color:e.obj.class&&(0===e.obj.class.indexOf("#")?e.specColor=e.obj.class:e.classList=" "+e.obj.class),e.obj.colorOver?0===e.obj.colorOver.indexOf("#")?e.specColorOver=e.obj.colorOver:e.classListOver=" "+e.obj.colorOver:e.obj.classOver&&(0===e.obj.classOver.indexOf("#")?e.specColorOver=e.obj.classOver:e.classListOver=" "+e.obj.classOver)),e.isIcon=e.icon&&e.icon.length,e.classList&&e.classList.length&&(e.isClassList=!0),e.classListOver&&e.classListOver.length&&(e.isClassListOver=!0),e.html=$.createIcon({icon:e.isIcon?e.icon:"",class:"listoption-icon"+(e.isClassList?" "+e.classList:"")}),"swatch"===e.icon&&(e.isSwatch=!0,e.html='<span class="swatch '+(e.isClassList?e.classList:"")+'"></span>'),this.listIcon.items.push(e)},setListIcon:function(){var e=this,t=!e.settings.multiple&&e.element.find("[data-icon]").length>0,i=t?this.element.find("option"):[];if(e.listIcon={hasIcons:t,items:[]},t){var s=0;i.each(function(t){var i=$(this).attr("data-icon"),n=null;"string"==typeof i&&i.length&&(n=0!==i.indexOf("{")?i:$.fn.parseOptions(this,"data-icon"),e.setItemIcon({html:"",icon:n}),e.listIcon.items[t]&&e.listIcon.items[t].isIcon&&s++)}),t=s>0}t&&(e.pseudoElem.prepend($.createIcon({icon:"",class:"listoption-icon"})),e.listIcon.pseudoElemIcon=e.pseudoElem.find("> .listoption-icon"),e.listIcon.idx=-1),e.listIcon.hasIcons=t},toggleTooltip:function(){this.overflowed?this.setTooltip():this.tooltipApi&&this.removeTooltip()},setTooltip:function(){var e=this,t=this.element.find("option:selected"),i=this.getOptionText(t);this.tooltipApi=this.pseudoElem.find("span").tooltip({content:i,parentElement:this.pseudoElem,trigger:this.isMobile()?"immediate":"hover"}).on("blur.dropdowntooltip",function(){e.removeTooltip()}).data("tooltip")},removeTooltip:function(){this.tooltipApi&&(this.tooltipApi.element.off("blur.dropdowntooltip"),this.tooltipApi.destroy(),this.tooltipApi=null)},setItemIconOverColor:function(e){var t=this;if(t.listIcon.hasIcons){var i=e?e.find(".listoption-icon"):null;t.list.find("li").each(function(s){var n=$(this),a=n.find(".listoption-icon"),r=t.listIcon.items[s];r&&(n.is(".is-focused")&&r.isClassListOver&&a.removeClass(r.classListOver).addClass(r.classList),i&&n.is(e)&&r.isClassListOver&&(i.removeClass(r.classList),i.addClass(r.classListOver)))})}},updateItemIcon:function(e){if(this.listIcon.hasIcons){var t=this.listIcon.pseudoElemIcon,i=e.index(),s=this.listIcon.idx,n=this.listIcon.items[i],a=n&&n.isIcon?n.icon:"";if(!n)return;if(s>-1){var r=this.listIcon.items[s];r&&(t.removeClass(r.classList+" "+r.classListOver),t[0].style.fill="")}this.listIcon.idx=i,t.changeIcon(a),n.isClassList&&t.addClass(n.classList)}},updateList:function(e){var t=this,i=t.isMobile(),s=void 0!==t.list&&null!==t.list&&t.list.length>0,a="",r="",o=0,l=this.element.find("optgroup").length,d="",c=!0===this.settings.multiple,h=""+this.settings.moveSelected,u=!0===this.settings.showSelectAll;this.element[0].classList.contains("text-align-reverse")?d=" text-align-reverse":this.element[0].classList.contains("text-align-center")&&(d=" text-align-center"),s||(a='<div class="dropdown-list'+d+(i?" mobile":"")+(this.settings.multiple?" multiple":"")+'" id="dropdown-list" '+(this.settings.multiple?'aria-multiselectable="true"':"")+'>\n        <label for="dropdown-search" class="audible">'+k.translate("TypeToFilter")+'</label>\n        <input type="text" class="dropdown-search'+d+'" id="dropdown-search" autocomplete="off" />\n        <span class="trigger">'+(i?$.createIcon({icon:"close",classes:["close"]}):$.createIcon("dropdown"))+'<span class="audible">'+(i?k.translate("Close"):k.translate("Collapse"))+'</span></span>\n        <ul role="listbox" aria-label="'+k.translate("Dropdown")+'">');var p=this.element.find("option"),g=this.element.find("optgroup"),f=":selected",m=[];"typeahead"===this.settings.reload&&(f=function(e,i){return!!t.selectedValues&&t.selectedValues.indexOf(i.value)>-1});var v=p.filter(f);function b(e){return'<li role="presentation" class="group-label" focusable="false">\n        '+e+"\n      </li>"}function y(i,s){var a="",r=i.innerHTML,o=n.getAttributes(i),l=o.getNamedItem("value"),d=o.getNamedItem("title"),c=d?'" title="'+d.value+'"':"",h=o.getNamedItem("data-badge"),u=o.getNamedItem("data-badge-color"),p="",g=i.selected?" is-selected":"",f=i.disabled?" is-disabled":"",m=i.className?" "+i.className.value:"",v=m.indexOf("clear")>-1?' class="clear-selection"':"",b=' tabIndex="'+(s&&0===s?0:-1)+'"',y=" "+t.getDataAttributes(o,["data-badge","data-badge-color","data-val","data-icon"]).str,w=(l&&"value"in l?l.value:r).replace(/"/g,"/quot/"),x="";if(t.listIcon.hasIcons&&t.listIcon.items[s]&&(x=t.listIcon.items[s].html),h&&(p='<span class="badge '+(u?u.value:"azure07")+'">'+h.value+"</span>"),m.indexOf("clear")>-1&&""===r&&(r=k.translate("ClearSelection")),e&&e.length>0){var C=t.getSearchRegex(e);r=r.replace(C,"<i>$1</i>").trim()}return t.listIcon.hasIcons&&t.listIcon.items[s]&&t.listIcon.items[s].isSwatch&&(m+=" is-swatch"),a+='<li class="dropdown-option'+g+f+m+'" '+(g?'aria-selected="true"':"")+' data-val="'+w+'" '+y+b+c+' role="option">\n        <a id="list-option-'+s+'" href="#" '+v+' role="option">'+x+r+p+"</a></li>"}if("typeahead"===this.settings.reload&&v.prop("selected",!0),c&&u){var w=p.not("[disabled], .hidden").length===v.not("[disabled], .hidden").length;r+='<li role="presentation" class="dropdown-select-all-list-item'+(w?" is-selected":"")+'"><a role="option" href="#" id="dropdown-select-all-anchor" class="dropdown-select-all-anchor">'+k.translate("SelectAll")+"</a></li>"}"group"===h&&(g&&g.length?g.each(function(e,t){var i=v.filter(function(){return $.contains(t,this)});m.push(i)}):h="all"),"all"===h&&(p=p.not(v),v.length>0&&(r+=b(k.translate("Selected")+" "+(t.isInlineLabel?t.inlineLabelText.text():this.label.text()))),v.each(function(e){r+=y(this,e),o++}),!l&&p.length>0&&(r+=b(k.translate("All")+" "+(t.isInlineLabel?t.inlineLabelText.text():this.label.text())))),p.each(function(e){var t=e+o,i=$(this),s=i.parent(),n=void 0;s.is("optgroup")&&g.length&&(n=s.index(),g.index(s)>-1&&(g=g.not(s),r+=b(""+s.attr("label")),"group"===h&&m[n].each(function(e){r+=y(this,e),o++}))),"none"!==h&&i.is(":selected")||(r+=y(this,t))}),s?this.listUl.html(r):(a+=r+"</ul></div>",this.list=$(a),this.listUl=this.list.find("ul"),this.searchInput=this.list.find("#dropdown-search")),this.listIcon.hasIcons&&(this.list.addClass("has-icons"),this.listIcon.pseudoElemIcon.clone().appendTo(this.list)),l&&this.listUl.addClass("has-groups"),$.fn.tooltip&&this.listUl.find("[title]").addClass("has-tooltip").tooltip(),this.position(),this.isOpen()&&this.highlightOption(this.listUl.find("li:visible:not(.separator):not(.group-label):not(.is-disabled)").first())},setDisplayedValues:function(){var e=this.element.find("option:selected"),t=this.getOptionText(e);if(e.hasClass("clear")&&(t=""),this.settings.empty&&0===e.length){var i=this.pseudoElem.find("span").first();return n.html(i,'<span class="audible">'+this.label.text()+" </span>","<div><p><span><ul><li><a><abbr><b><i><kbd><small><strong><sub><svg><use><br>"),i=$("#"+this.element.attr("id")).next().find("span").first(),void n.html(i,'<span class="audible">'+this.label.text()+" </span>","<div><p><span><ul><li><a><abbr><b><i><kbd><small><strong><sub><svg><use><br>")}var s=this.element.attr("maxlength");s&&(t=t.substr(0,s)),t=t.trim();var a=this.pseudoElem.find("span");a.length>0&&(a[0].innerHTML='<span class="audible">'+this.label.text()+" </span>"+t),this.element.attr("placeholder")&&this.pseudoElem.find("span").not(".audible").attr("data-selected-text",t),this.previousActiveDescendant=e.first().val(),this.updateItemIcon(e),this.setBadge(e)},copyClass:function(e,t,i){e.hasClass(i)&&t.addClass(i)},setInitial:function(){this.element.is(":disabled")&&this.disable(),this.element.is("[readonly]")&&this.readonly(),this.isHidden&&(this.pseudoElem.hide().prev("label").hide(),this.pseudoElem.next("svg").hide()),this.element.attr("placeholder")&&(this.pseudoElem.find("span").not(".audible").attr("data-placeholder-text",this.element.attr("placeholder")),this.pseudoElem.find("span").not(".audible").attr("data-selected-text",""))},ignoreKeys:function(e,t){var i=t.which;if(t.altKey&&38===i)return t.stopPropagation(),t.preventDefault(),!1;if(!e.is(":disabled")&&!e.hasClass("is-readonly")){if(t.ctrlKey)if(this.settings.onKeyDown)if(!1===this.settings.onKeyDown(t))return t.stopPropagation(),t.preventDefault(),!1;return!0}},handleSearchEvents:function(){var e=this;this.settings.noSearch&&this.searchInput.prop("readonly",!0),this.filterTerm||(this.searchKeyMode=!1),this.searchInput.on("keydown.dropdown",function(t){var i=$(e);return!!e.ignoreKeys(i,t)&&e.handleKeyDown(i,t)}).on("input.dropdown",function(t){e.isFiltering=!0,e.handleAutoComplete(t)})},filterList:function(e){var t=!1;this.settings.source&&"typeahead"===this.settings.reload&&(t=!0,this.callSource());var i=this,s=!1,n=$(".dropdown-option",this.listUl),a=$(".group-label",this.listUl),r=!1,o=void 0;n.length&&this.list&&(!this.list||this.list.length)&&(e||(e=""),o=!t&&e&&e.length?this.listfilter.filter(n,e):n,this.list.addClass("search-mode"),this.list.find(".trigger").find(".icon").attr("class","icon search").changeIcon("search"),this.searchInput.removeAttr("aria-activedescendant"),this.unhighlightOptions(),o&&(o.length||e)?(o.removeClass("hidden"),n.not(o).add(a).addClass("hidden"),n.filter(o).each(function(t){var n=$(this);n.attr("tabindex",0===t?"0":"-1"),s||(i.highlightOption(n),s=!0);var a=i.getSearchRegex(e),o=n.text().replace(a,'<span class="dropdown-highlight">$1</span>').trim(),l=0!==n.children("a").find("svg").length?(new XMLSerializer).serializeToString(n.children("a").find("svg")[0]):"";l&&(r=!0),n.children("a").html(l+o)}),a.each(function(){var e=$(this).nextUntil(".group-label, .selector").not(".hidden");(i.settings.showEmptyGroupHeaders||e.length)&&$(this).removeClass("hidden")}),e="",this.position(),r&&this.list.find("svg").length>2&&this.list.find("svg").last().changeIcon("icon-empty-circle")):this.resetList())},resetList:function(){if(this.settings.source&&"typeahead"===this.settings.reload)return this.filterTerm="",this.searchKeyMode=!1,void this.callSource(null,!0);if(this.list&&(!this.list||this.list.length)){this.list.removeClass("search-mode");var e=this.listUl.find("li"),t=!1;e.removeAttr("style").each(function(){var e=$(this).children("a"),i=$(this),s=e.text(),n=0!==i.children("a").find("svg").length?(new XMLSerializer).serializeToString(i.children("a").find("svg")[0]):"";n&&(t=!0),e.html(n+s)}),this.list.hasClass("is-ontop")&&(this.list[0].style.top=this.pseudoElem.offset().top-this.list.height()+this.pseudoElem.outerHeight()-2+"px"),this.settings.multiple&&this.updateList(),e.removeClass("hidden"),this.position(),t&&this.list.find("svg").length>2&&this.list.find("svg").last().changeIcon("icon-empty-circle"),2===this.list.find("svg").length&&this.list.find("svg").last().remove()}},selectBlank:function(){var e=this.element.find("option").filter(function(){return!this.value||0===$.trim(this.value).length});e.length&&(e[0].selected=!0,e[0].setAttribute("selected",!0),this.element.triggerHandler("updated"),this.element.triggerHandler("change"))},handleKeyDown:function(e,t){var i=this.element[0].selectedIndex||-1,s=this.element[0].options,n=t.which,a=void 0;if(!this.isLoading()){if(this.settings.onKeyDown)if(!1===this.settings.onKeyDown(t))return t.stopPropagation(),t.preventDefault(),!1;switch(this.isOpen()&&(s=this.listUl.find("li:visible:not(.separator):not(.group-label):not(.is-disabled)"),i=-1,$(s).each(function(e){$(this).is(".is-focused")&&(i=e)})),n){case 37:case 8:case 46:if(!this.isOpen())return this.selectBlank(),t.stopPropagation(),t.preventDefault(),!1;break;case 9:return this.isOpen()&&(this.closeList("tab"),this.activate()),!0;case 27:if(this.isOpen()){this.element.closest(".modal.is-visible").data("listclosed",!0);var r=this.pseudoElem?this.pseudoElem.parents("td"):null;return this.closeList("cancel"),this.activate(),r&&r.focus(),t.stopPropagation(),!1}break;case 32:case 13:if(this.isOpen()){if(32===n&&!0===this.searchKeyMode)break;t.preventDefault(),s.length&&i>-1&&this.selectOption($(s[i])),this.settings.closeOnSelect&&(this.closeList("select"),this.activate())}return t.stopPropagation(),!1;case 38:if(t.shiftKey)return;return this.searchKeyMode=!1,i>0&&(a=$(s[i-1]),this.highlightOption(a),this.setItemIconOverColor(a),a.parent().find(".is-focused").removeClass("is-focused"),a.addClass("is-focused")),t.stopPropagation(),t.preventDefault(),!1;case 40:if(t.shiftKey)return;return this.searchKeyMode=!1,i<s.length-1&&(a=$(s[i+1]),this.highlightOption(a),this.setItemIconOverColor(a),a.parent().find(".is-focused").removeClass("is-focused"),a.addClass("is-focused")),t.stopPropagation(),t.preventDefault(),!1;case 35:this.searchKeyMode=!1;var o=$(s[s.length-1]);return this.highlightOption(o),t.stopPropagation(),!1;case 36:this.searchKeyMode=!1;var l=$(s[0]);return this.highlightOption(l),t.stopPropagation(),!1}return this.isOpen()||this.isControl(n)||this.settings.source||this.settings.noSearch||(this.isFiltering=!0,this.filterTerm=$.actualChar(t),this.searchInput&&this.searchInput.length&&this.searchInput.val($.actualChar(t)),this.toggle()),this.searchKeyMode=!0,this.searchInput&&this.searchInput.attr("aria-activedescendant",""),!0}},handlePseudoElemKeydown:function(e){var t=$(e.target),i=e.key;if(t.is(".is-readonly"))return!0;var s="Esc"===i||"Escape"===i;if(["Alt","Shift","Control","Meta"].indexOf(i)>-1)return!1;if(!this.ignoreKeys(t,e))return!1;if(this.settings.onKeyDown&&!1===this.settings.onKeyDown(e))return e.stopPropagation(),e.preventDefault(),!1;if(["ArrowDown","ArrowUp","Down","Up","Enter","Spacebar"," "].indexOf(i)>-1)return this.isOpen()||this.open(),this.settings.noSearch&&!e.ctrlKey&&this.handleKeyDown(t,e),!1;var n="Mac OS X"===l.os.name;return!n&&"Delete"===i||n&&"Backspace"===i?(this.selectBlank(),"Backspace"===i&&(e.stopPropagation(),e.preventDefault()),!0):s||"Tab"===i?!this.settings.noSearch||!this.isOpen()||this.handleKeyDown(t,e):(this.handleAutoComplete(e),!0)},handleAutoComplete:function(e){var t=this;if(!this.isLoading()){var i=this;if(this.timer&&clearTimeout(this.timer),"input"===e.type)this.filterTerm=this.searchInput.val();else{if(this.filterTerm+=$.actualChar(e).toLowerCase(),""===this.filterTerm)return;e.key===this.filterTerm||e.key.toLowerCase()!==this.filterTerm||i.settings.noSearch||(this.filterTerm=e.key)}this.timer=setTimeout(function(){i.settings.noSearch?i.selectStartsWith(i.filterTerm):(t.searchKeyMode=!0,i.isOpen()?s():i.open(s))},i.settings.delay)}function s(){""===i.filterTerm?i.resetList():i.filterList(i.filterTerm.toLowerCase())}},isControl:function(e){return e>7&&e<48||e>90&&e<94||e>111&&e<146},activate:function(e){var t=this,i=this.pseudoElem;(e||t.isMobile())&&(i=this.searchInput),e&&i&&(i.hasClass("is-readonly")||!0===i.prop("readonly"))||(t.isMobile()||t.filterTerm||!i||(i[0].setSelectionRange?i[0].setSelectionRange(0,i[0].value.length):"INPUT"===i[0].tagName&&i[0].select()),i&&i[0].focus())},getSearchRegex:function(e){var t=void 0;try{t=new RegExp("("+e+")","i")}catch(e){t=/[\s\S]*/i}return t},getOptionText:function(e){var t="";return e||(e=this.element.find("option:selected")),e.each(function(){t.length>0&&(t+=", "),t+=$(this).text().trim()}),t},open:function(e){var t=this;function i(){t.isMobile()&&$(".tooltip:not(.is-hidden)").hide(),t.updateList(),t.openList(),e&&"function"==typeof e&&e.call(this)}this.inputTimer()&&(this.element.is(":disabled")||this.pseudoElem.hasClass("is-disabled")||this.pseudoElem.hasClass("is-readonly")||t.callSource(i)||i())},openList:function(){var e=this.previousActiveDescendant?this.list.find('.dropdown-option[data-val="'+this.previousActiveDescendant.replace(/"/g,"/quot/")+'"]'):this.list.find(".is-selected"),t=this,i=10,s=!0,n=void 0;this.touchPrevented=!1,e.length>0&&(s=!0),"ios"===l.os.name&&$("head").triggerHandler("disable-zoom"),$("select").each(function(){var e=$(this).data();e.dropdown&&e.dropdown.closeList("cancel")}),$(".popupmenu.is-open").filter(function(){return 0===$(this).parents(".popupmenu").length}).each(function(){var e=$(this).data("trigger");if(e&&e.length){var t=$(this).data("trigger").data("popupmenu");t&&"function"==typeof t.close&&t.close()}}),this.isOpen()||this.list.appendTo("body"),this.list.show();var a=1===this.element.closest(".field-short").length;if(this.list.addClass(a?"dropdown-short":""),this.pseudoElem.attr("aria-expanded","true").addClass("is-open"),this.searchInput.attr("aria-activedescendant",e.children("a").attr("id")),this.isInGrid=1===this.pseudoElem.closest(".datagrid-row").length,this.pseudoElem.parent().hasClass("is-inline")&&(this.isInGrid=!1),this.isInGrid){var r=this.pseudoElem.closest(".datagrid").attr("class").replace("datagrid","");this.list.addClass("datagrid-dropdown-list "+r)}1===this.pseudoElem.closest(".datagrid-filter-wrapper").length&&this.list.addClass("datagrid-filter-dropdown");var o=this.settings.cssClass;if(o&&"string"==typeof o&&this.list.addClass(o),this.position(),this.settings.maxWidth&&this.list.css("max-width",this.settings.maxWidth+"px"),this.filterTerm)this.searchInput.val(this.filterTerm);else{var d=this.pseudoElem.find("span:not(.audible)").contents().eq(1).text().trim();this.searchInput.val(d),this.element.attr("placeholder")&&this.pseudoElem.find("span").not(".audible").attr("data-selected-text","")}var c=this.settings.multiple;function h(e){return e.closest(".dropdown, .multiselect").length>0||e.closest(".dropdown-list").length>0||!0===t.touchmove}function u(e){var i=$(e.target);if(t.touchPrevented||h(i)&&!i.is(".icon"))return e.preventDefault(),void(t.touchPrevented=!1);t.closeList("cancel")}this.highlightOption(e,c),this.settings.multiple&&this.listUl.find(".is-selected").length>0&&(this.highlightOption(this.listUl.find(".dropdown-option").eq(0)),setTimeout(function(){t.listUl.scrollTop(0)},0)),this.settings.multiple||s||this.searchInput.val(e.find("a").text()),this.handleSearchEvents(),this.activate(!0),this.element.trigger("listopened"),this.isMobile()&&t.searchInput.on("keypress.dropdown",function(e){13===e.which&&t.closeList("select")}),t.list.removeClass("dropdown-tall").on("touchend.list click.list","li",function(e){if(!t.touchPrevented){var i=t.selectListItem($(this));e.preventDefault(),i&&e.stopPropagation()}}).on("mouseenter.list","li",function(){t.highlightOption($(this),!0)}),setTimeout(function(){t.list.addClass("is-closable")},100),$(document).on("touchstart.dropdown",function(e){t.touchPrevented=!1,n={x:e.originalEvent.touches[0].pageX,y:e.originalEvent.touches[0].pageY},$(document).on("touchmove.dropdown",function(e){var s=e.originalEvent.touches[0].pageX,a=e.originalEvent.touches[0].pageY;(s>=n.x+i||s<=n.x-i||a>=n.y+i||a<=n.y-i)&&(t.touchPrevented=!0)})}).on("touchend.dropdown touchcancel.dropdown",function(e){if($(document).off("touchmove.dropdown"),e.preventDefault(),t.touchPrevented)return e.stopPropagation(),!1;u(e)}).on("click.dropdown",u);var p=$(".modal.is-visible .modal-body-wrapper"),g=t.element.closest(".scrollable").length?t.element.closest(".scrollable"):$(document);g=t.element.closest(".scrollable-y").length?t.element.closest(".scrollable-y"):g,(g=p.length?p:g).on("scroll.dropdown",function(e){var i=$("*:focus");t.touchPrevented||h($(e.target))||i.is(".timepicker")?t.touchPrevented=!1:t.closeList("cancel")}),$("body").on("resize.dropdown",function(){t.position(),void 0===window.orientation&&t.closeList("cancel")}),void 0!==window.orientation&&$(window).on("orientationchange.dropdown",function(){t.closeList("cancel")}),"ios"===l.os.name&&$("head").triggerHandler("enable-zoom")},position:function(){var e=this,t={parentXAlignment:"left",placement:"bottom",strategies:["flip","shrink-y"]};this.list[0].removeAttribute("style"),this.listUl[0].removeAttribute("style");var i=this.pseudoElem;this.isInGrid&&(i=this.element.closest(".datagrid-cell-wrapper"));var s=window.getComputedStyle(i[0]),n=2*parseInt(s.borderLeftWidth,10),a=Math.round(parseInt(i[0].clientWidth,10)+n);this.searchInput[0].style.cssText="width: "+a+"px !important";var r=Math.round(this.list.width())<=a;this.searchInput[0].style.width="",t.parent=i,t.useParentWidth=r;var o=window.devicePixelRatio>1,d="chrome"===l.browser.name;t.y=-(parseInt(i[0].clientHeight,10)+parseInt(s.borderTopWidth,10)+parseInt(s.borderBottomWidth,10)-(!d&&o?1:0)),t.x=0,e.settings.placementOpts&&e.settings.placementOpts.x&&(t.x=e.settings.placementOpts.x),this.list.one("afterplace.dropdown",function(t,i){!0===i.wasFlipped&&(e.list.addClass("is-ontop"),e.listUl.prependTo(e.list));var s=parseInt(e.listUl[0].offsetHeight,10),n=parseInt(e.list[0].offsetHeight,10)+5,a=$(this).hasClass("dropdown-short")?24:34,r=parseInt(e.list[0].offsetTop,10)+parseInt(e.list[0].offsetHeight,10)>=window.innerHeight,o=a<n-2*a&&s+a>=n;return o&&!r&&(e.listUl[0].style.height=n-2*a+"px"),o&&r&&(e.listUl[0].style.height=n-2*a+"px",e.list[0].style.height=parseInt(e.list[0].style.height,10)-10+"px"),i.wasFlipped&&(e.listUl[0].style.height=parseInt(e.listUl[0].style.height,10)+(a-5)+"px"),i}).place(t),this.list.data("place").place(t)},selectListItem:function(e){var t=e.closest("li");if(t.length&&(e=t),e.is(".separator, .group-label"))return!1;if(e.is(".dropdown-select-all-anchor")&&(e=e.parent()),this.settings.multiple&&e[0].classList.contains("dropdown-select-all-list-item")){var i=!e[0].classList.contains("is-selected");return e[0].classList[i?"add":"remove"]("is-selected"),i?e[0].setAttribute("aria-selected","true"):e[0].removeAttribute("aria-selected"),this.selectAll(i),!0}var s=e.attr("data-val").replace(/"/g,"/quot/"),n=this.element.find('option[value="'+s+'"]');if((0===n.length||n.length>1)&&(n=this.element.find("option").filter(function(){var e=$(this),t=e.attr("value");return e.text()===s||t&&t.replace(/"/g,"/quot/")===s})),n.is(":disabled"))return!1;if(this.selectOption(n),this.settings.closeOnSelect&&this.closeList("select"),this.isMobile())return!0;if(this.activate(!this.settings.closeOnSelect),this.settings.showSelectAll&&this.list){var a=this.element.find("option"),r=a.filter(":selected");a.length>r.length?this.list.find(".dropdown-select-all-list-item").removeClass("is-selected").removeAttr("aria-selected"):this.list.find(".dropdown-select-all-list-item").addClass("is-selected").attr("aria-selected","true")}return!0},close:function(){return this.closeList("cancel")},closeList:function(e){if(this.list&&this.list.is(":visible")&&this.isListClosable()&&this.inputTimer()){this.touchmove&&(this.touchmove=!1),this.filterTerm="",this.searchKeyMode=!1,this.setDisplayedValues(),this.searchInput.off(["input.dropdown","keydown.dropdown"].join(" ")),this.listUl.find(".has-tooltip").each(function(){var e=$(this).data("tooltip");e&&e.destroy()}),this.list.off(["click.dropdown","touchmove.dropdown","touchend.dropdown","touchcancel.dropdown","mousewheel.dropdown","mouseenter.dropdown"].join(" ")).remove(),this.pseudoElem.removeClass("is-open").removeAttr("aria-expanded"),this.searchInput.removeAttr("aria-activedescendant"),$(document).off(["click.dropdown","scroll.dropdown","touchstart.dropdown","touchmove.dropdown","touchend.dropdown","touchcancel.dropdown"].join(" "));var t=$(".modal.is-visible .modal-body-wrapper"),i=this.element.closest(".scrollable").length?this.element.closest(".scrollable"):$(document);i=this.element.closest(".scrollable-y").length?this.element.closest(".scrollable-y"):i,(i=t.length?t:i).off("scroll.dropdown"),$("body").off("resize.dropdown"),$(window).off("orientationchange.dropdown"),this.element.trigger("listclosed",e),this.activate(),this.toggleTooltip(),this.list=null,this.searchInput=null,this.listUl=null}},scrollToOption:function(e){e&&0!==e.length&&(this.listUl.scrollTop(0),this.listUl.scrollTop(e.offset().top-this.listUl.offset().top-this.listUl.scrollTop()-40))},handleBlur:function(){return this.closeList("cancel"),!0},isLoading:function(){return this.element.is(".is-loading")&&this.element.is(".is-blocked")},isOpen:function(){return!!this.pseudoElem.hasClass("is-open")},toggle:function(){this.isOpen()||this.isLoading()?this.closeList("cancel"):this.open()},toggleList:function(){return D(this.toggle,this.toggleList).apply(this)},highlightOption:function(e,t){if(e&&(0===e.length&&(e=this.list.find(".dropdown-option").eq(0)),!e.is(".separator, .group-label"))){var i=this.element.find('option[value="'+e.attr("data-val")+'"]');i.hasClass(".is-disabled")||i.is(":disabled")||this.isOpen()&&(this.setItemIconOverColor(),this.list.find(".is-focused").removeClass("is-focused").attr({tabindex:"-1"}),i.hasClass("clear")||(this.setItemIconOverColor(e),e.addClass("is-focused").attr({tabindex:"0"})),this.searchInput.attr("aria-activedescendant",e.children("a").attr("id")),t&&!1!==t&&void 0!==t||this.scrollToOption(e))}},unhighlightOptions:function(e,t){e&&e.length||(e=this.list.find(".is-selected")),this.setItemIconOverColor(),e.removeClass("is-focused").attr({tabindex:"-1"}),this.searchInput.removeAttr("aria-activedescendant"),t&&!1!==t&&void 0!==t||this.scrollToOption(e.first())},selectAll:function(e){var t="option:not(.is-disabled):not(:disabled)",i="li.dropdown-option:not(.separator):not(.group-label):not(.is-disabled)",s=[].slice.call(this.element[0].querySelectorAll(t)),n=[].slice.call(this.listUl[0].querySelectorAll(i)),a=s[s.length-1],r="";if(e){n.forEach(function(e){e.classList.add("is-selected"),e.setAttribute("aria-selected",!0)}),s.forEach(function(e){e.selected=!0,e.setAttribute("selected",!0)}),r=this.getOptionText($(s));var o=this.element[0].getAttribute("maxlength");o&&(r=r.substr(0,o))}else n.forEach(function(e){e.classList.remove("is-selected"),e.removeAttribute("aria-selected")}),s.forEach(function(e){e.selected=!1,e.setAttribute("selected",!1),e.removeAttribute("selected")});this.previousActiveDescendant=a.value||"",this.pseudoElem[0].querySelector("span").textContent=r,this.searchInput[0].value=r,this.updateItemIcon(a),this.list[0].classList.contains("search-mode")&&this.resetList(),this.activate(!0),this.setBadge(a),this.toggleTooltip(),this.element.trigger("change").triggerHandler("selected")},selectOptions:function(e,t){Array.isArray(e)&&(e=$(e));var i=this;e.each(function(){i.selectOption($(this),t)}),i.element.trigger("change").triggerHandler("selected")},selectOption:function(e,t){if(e&&e.length){var i=void 0;e.is("li")&&(i=e,0===(e=this.element.find('option[value="'+e.attr("data-val")+'"]')).length&&(e=this.element.find("option").filter(function(){return $(this).text()===i.attr("data-val")})));var s=e.val();if(e&&(i||"string"!=typeof s||(s=s.replace(/"/g,"/quot/"),i=this.listUl.find('li[data-val="'+s+'"]')),!e.hasClass("is-disabled")&&!e.is(":disabled"))){var n=e.val(),a=this.element.val(),r="",o="",d=!1;"typeahead"===this.settings.reload&&(a=this.selectedValues||[]);var c=!0;if(!e.hasClass("clear")&&i||(d=!0),this.settings.multiple){if(a||(a=[]),-1!==$.inArray(n,a))a=$.grep(a,function(e){return e!==n}),i.removeClass("is-selected").removeAttr("aria-selected"),this.previousActiveDescendant=void 0,c=!1;else{if(!isNaN(this.settings.maxSelected)&&this.element.find("option:selected").length>=this.settings.maxSelected)return;(a="string"==typeof a?[a]:a).push(n),i.addClass("is-selected").attr("aria-selected","true"),this.previousActiveDescendant=e.val()}var h=this.element.find("option").filter(function(){return-1!==$.inArray($(this)[0].value,a)});r=this.getOptionText(h)}else a=n,this.listUl.find("li.is-selected").removeClass("is-selected").removeAttr("aria-selected"),d||i.addClass("is-selected").attr("aria-selected","true"),this.previousActiveDescendant=e.val(),r=e.text();if(d||this.element.find("option").each(function(){if(this.value===n)return $(this).prop("selected",!0),!1}),this.element.attr("maxlength")&&(o=r.substr(0,this.element.attr("maxlength")),this.pseudoElem.find("span").text(o),this.searchInput.val(o)),this.selectedValues=a,this.element.val(a),this.updateItemIcon(e),t||(this.element.trigger("change").triggerHandler("selected",[e,c]),this.toggleTooltip()),this.settings.multiple&&this.activate(!0),this.setBadge(e),"ie"===l.browser.name&&"11"===l.browser.version){var u=$("#"+this.element.attr("id")).html(),p=$("#"+this.element.attr("id")).val();this.element.html(u),this.element.val(p)}}}},selectValue:function(e){if("string"==typeof e){var t=this.element.find('option[value="'+e+'"]');t&&t.length&&(this.element.find("option:selected").prop("selected",!1),t.prop("selected",!0),this.updated())}},selectStartsWith:function(e){if("string"==typeof e){var t=this.element[0];this.filterTerm="";var i=-1,s=0;this.searchMatches&&this.searchMatches[e]||(this.searchMatches={},this.searchMatches[e]=[]);for(var n=0;n<t.options.length;n++){if(0===t.options[n].innerText.toLowerCase().indexOf(e)){if(-1===this.searchMatches[e].indexOf(n)){this.searchMatches[e].push(n),i=n;break}s++}else;}if(-1===i){if(!this.searchMatches[e].length)return;s===this.searchMatches[e].length&&(i=this.searchMatches[e][0],this.searchMatches[e].length=1)}t.selectedIndex=i,this.updated(),this.element.trigger("change")}},setBadge:function(e){if(this.badges){var t=this.element.parent().find(".badge");0===t.length&&(this.element.parent().find(".dropdown-wrapper").append('<span class="badge">1</span>'),t=this.element.parent().find(".badge")),t.attr("class","badge "+(e.attr("data-badge-color")?e.attr("data-badge-color"):"azure07")).text(e.attr("data-badge"))}},callSource:function(e,t){var i=this,s="";if(t||!this.isOpen()||this.element.hasClass("search-mode")||(s=this.searchInput.val()),!this.settings.source)return!1;this.isFiltering=!1;var n=u(this.settings.source),a=function(t,n){var a="",r=i.element.val();function o(e){return e.replace(/"/g,"'")}function l(e){if(null!=e){var t="",s="",n="";"string"==typeof e&&(e={value:e}),void 0!==e.value&&(e.value=o(e.value)),void 0!==e.id&&(isNaN(e.id)||(e.id=""+e.id),e.id=o(e.id),t=' id="'+e.id+'"'),void 0!==e.label&&e.label.length&&(e.label=o(e.label),n=e.label);var l=i.selectedValues&&i.selectedValues.indexOf(r)>-1;i.settings.multiple?r.forEach(function(t){t===e.value&&(e.selected=!0,s=" selected")}):(e.value===r||l)&&(e.selected=!0,s=" selected"),n.length||n===e.value||(n+=e.value),a+="<option"+t+' value="'+e.value+'"'+s+">\n          "+n+"\n        </option>"}}if(!i.isFiltering&&!m.equals(t,i.dataset)){if(i.dataset=t,!n){i.element.empty();for(var d=0;d<t.length;d++){var c=void 0;if(t[d].group){c=t[d].options,a+='<optgroup label="'+t[d].group+'">';for(var h=0;h<c.length;h++)l(c[h]);a+="</optgroup>"}else l(t[d])}i.element.append(a)}i.updateList(s)}i.element.triggerHandler("complete"),i.element.trigger("requestend",[s,t]),"function"==typeof e&&e()};if(i.element.triggerHandler("start"),i.element.trigger("requeststart"),"function"===n)this.settings.source(a,s,this.settings.sourceArguments);else if("object"===n){var r=$.isArray(this.settings.source)?this.settings.source:[this.settings.source];a(r)}else{var o=this.settings.source.toString();$.getJSON(o).done(function(e){a(e)}).fail(function(){a([])})}return!0},getDataAttributes:function(e,t){if(e){"string"==typeof e&&(e=[e]);var i=t||[];"string"==typeof i&&(i=[i]);var s={obj:{},str:"",isExclude:function(e){return $.inArray(e,i)>-1}};for(var n in e)e.hasOwnProperty(n)&&(s.name=""+e[n].name,s.isData="data-"===s.name.substr(0,5),s.isData&&!s.isExclude(s.name)&&(s.obj[s.name]=e[n].value,s.str+=" "+s.name+'="'+e[n].value+'"'));return{str:s.str,obj:s.obj}}},setCode:function(e){S(this.setCode,this.element.val);var t=this,i=function(){t.element.val(e),t.updated()};t.callSource(i)||i()},isMobile:function(){return["ios","android"].indexOf(l.os.name)>-1},isListClosable:function(){return this.list.hasClass("is-closable")},disable:function(){this.element.prop("disabled",!0).prop("readonly",!1),this.pseudoElem.is($(document.activeElement))&&this.pseudoElem.blur(),this.pseudoElem.addClass("is-disabled").removeClass("is-readonly").attr("tabindex","-1").prop("readonly",!1).prop("disabled",!0),this.closeList("cancel")},isDisabled:function(){return this.element.prop("disabled")},enable:function(){this.element.prop("disabled",!1).prop("readonly",!1),this.pseudoElem.prop("disabled",!1).prop("readonly",!1).attr("tabindex","0").removeClass("is-disabled").removeClass("is-readonly")},readonly:function(){this.element.prop("disabled",!1).prop("readonly",!0),this.pseudoElem.removeClass("is-disabled").addClass("is-readonly").attr("tabindex",this.element.attr("tabindex")||"0").prop("disabled",!1).prop("readonly",!0),this.closeList("cancel")},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.closeList("cancel"),this.pseudoElem&&this.pseudoElem.hasClass("is-open")&&this.pseudoElem.removeClass("is-open").removeAttr("aria-expanded"),this.settings.multiple&&!0===this.settings.multiple?this.element.prop("multiple",!0):this.element.prop("multiple",!1),!0===this.element.prop("readonly")?this.readonly():this.pseudoElem.removeClass("is-readonly"),this.pseudoElem[this.element.prop("disabled")?"addClass":"removeClass"]("is-disabled"),this.updateList(),this.setDisplayedValues(),this.toggleTooltip(),this.element.trigger("has-updated"),this},destroy:function(){this.selectedValues&&delete this.selectedValues,$.removeData(this.element[0],"dropdown"),this.closeList("cancel"),this.pseudoElem.off().remove(),this.icon.remove(),this.wrapper.remove(),this.listfilter.destroy(),this.element.removeAttr("style"),this.element.closest("form").off("reset.dropdown"),this.element.off(),this.label.off();var e=document.body.querySelector("#dropdown-list");e&&this.isOpen()&&e.parentNode.removeChild(e)},handleEvents:function(){var e=this,t=this;this.pseudoElem.on("keydown.dropdown",function(t){return e.handlePseudoElemKeydown(t)}).on("click.dropdown",function(e){e.originalEvent.ctrlKey&&e.originalEvent.shiftKey||e.stopPropagation()}).on("mouseup.dropdown",function(e){2!==e.button&&t.toggle()}).on("touchend.dropdown touchcancel.dropdown",function(e){e.stopPropagation(),t.toggle(),e.preventDefault()}),t.element.on("activated.dropdown",function(){t.label.trigger("click")}).on("updated.dropdown",function(e){e.stopPropagation(),t.updated()}).on("openlist.dropdown",function(){t.toggle()}),t.element.closest("form").on("reset.dropdown",function(){setTimeout(function(){t.element.triggerHandler("updated")},1)}),this.label.on("click",function(){t.pseudoElem.focus()})}},$.fn.dropdown=function(e){return this.each(function(){var t=$.data(this,"dropdown");t?t.updated(e):t=$.data(this,"dropdown",new Nt(this,e))})};var zt=["standard","range"],Ht=function(){return{locale:"",timeFormat:void 0,minuteInterval:5,secondInterval:5,mode:zt[0],roundToInterval:!0,parentElement:null,returnFocus:!0}};function qt(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Ht),this.init()}qt.prototype={init:function(){this.setLocale(),this.settings.locale||this.setCurrentCalendar().build()},setLocale:function(){var e=this;this.locale=k.currentLocale,this.settings.locale&&k.getLocale(this.settings.locale).done(function(t){e.locale=k.cultures[t],e.setCurrentCalendar()})},setCurrentCalendar:function(){return this.currentCalendar=k.calendar(this.locale.name,this.settings.calendarName),void 0===this.settings.timeFormat&&(this.settings.timeFormat=this.currentCalendar.timeFormat||"h:mm a"),this.isRTL="right-to-left"===this.locale.direction,this.build(),this},setup:function(){function e(e,t){(!t||["minute","second"].indexOf(t)<0)&&(t="minute");var i=Ht()[t+"Interval"];if(void 0===e||isNaN(e))return i;var s=parseInt(e,10);return s>0&&s<60?s:i}function t(e){return!0===e}var i;return this.id=m.uniqueId(this.element,"timepicker")+"-id",this.hoursId="timepicker-hours-"+this.id.toString(),this.minutesId="timepicker-minutes-"+this.id.toString(),this.secondsId="timepicker-seconds-"+this.id.toString(),this.periodId="timepicker-period-"+this.id.toString(),this.element.is("[data-round-to-interval]")&&(this.settings.roundToInterval=t(this.element.attr("data-round-to-interval"))),this.element.is("[data-minute-interval]")&&(this.settings.minuteInterval=e(this.element.attr("data-minute-interval"),"minute")),this.settings.timeFormat=(i=24===parseInt(this.element.attr("data-force-hour-mode"),10)?"HH:mm":this.settings.timeFormat)&&i.toUpperCase().match("H")&&i.match("mm")?i:Ht().timeFormat,this.settings.minuteInterval=e(this.settings.minuteInterval,"minute"),this.settings.secondInterval=e(this.settings.secondInterval,"second"),this.settings.mode=function(e){return $.inArray(e,["standard","range"])>-1?e:Ht().mode}(this.settings.mode),this.settings.roundToInterval=t(this.settings.roundToInterval),this.dayPeriods=this.currentCalendar.dayPeriods,this},build:function(){return this.setup(),this.settings.parentElement?(this.settings.parentElement.empty(),this.trigger=$(),this.buildStandardPopup(),this.setupStandardEvents(),this):(this.trigger=this.element.next("svg.icon"),0===this.trigger.length&&(this.trigger=$.createIconElement("clock").insertAfter(this.element)),this.addAria().addMask().handleEvents().roundMinutes(),this)},addAria:function(){return this.element.attr({"aria-expanded":"false",role:"combobox"}),this.label=$('label[for="'+this.element.attr("id")+'"]'),this.label.find(".audible").remove(),this.label.append('<span class="audible">'+k.translate("UseArrow",{locale:this.locale.name})+"</span>"),this},handleKeys:function(){var e=this;this.element.on("keydown.timepicker",function(t){var i=!1;return 27===t.which&&e.isOpen()&&(i=!0,e.closeTimePopup()),40!==t.which||e.isOpen()||(i=!0,e.openTimePopup()),!i||(t.stopPropagation(),t.preventDefault(),!1)})},handleBlur:function(){var e=this;this.element.on("blur.timepicker",function(){e.roundMinutes(),setTimeout(function(){e.isOpen()&&0===e.popup.find(":focus").length&&e.closeTimePopup()},20)})},is24HourFormat:function(e){return e||(e=this.settings.timeFormat),(e.match("H")||[]).length>0},hourText:function(e){return((this.settings.timeFormat.toUpperCase().match("HH")||[]).length>0&&e<10?"0":"")+e},hasSeconds:function(e){return e||(e=this.settings.timeFormat),(e.match("ss")||[]).length>0},hasDayPeriods:function(e){return e||(e=this.settings.timeFormat),(e.match("a")||[]).length>0},getTimeSeparator:function(){return this.currentCalendar.dateFormat.timeSeparator},roundMinutes:function(){if(w.toBoolean(this.settings.roundToInterval)){var e=this.element.val(),t=this.getTimeSeparator(),i=e?e.split(t):[],s=this.settings.minuteInterval;if(i[1]){if(!this.is24HourFormat(this.settings.timeFormat)){var n=i[1].split(" ");i[1]=n[0],n[1]&&i.push(n[1])}if(i[1]=parseInt(i[1],10),i[1]%s!=0){i[1]=Math.round(i[1]/s)*s,i[1]=i[1].toString(),i[1]=(i[1].length<2?"0":"")+i[1],"60"===i[1]&&(i[1]="00",i[0]=(parseInt(i[0],10)+1).toString());var a=i[0]+t+i[1]+" "+(i[2]?i[2]:"");this.element.val(a)}}}},addMask:function(){this.element.data("mask")&&"object"===u(this.element.data("mask"))&&this.element.data("mask").destroy(),this.element.data("mask",void 0);var e={keepCharacterPositions:!0,process:"date",patternOptions:{format:this.settings.timeFormat}};return this.element[0].getAttribute("data-validate")||this.element.attr("data-validate","time").attr("data-validation-events",JSON.stringify({time:"blur change enter"})).validate(),e&&this.element.mask(e),this},buildStandardPopup:function(){var e=this,t=$('<div class="timepicker-popup-content"></div>'),i=this.getTimeSeparator(),s="",n=void 0;this.initValues=e.getTimeFromField();var a=$('<div class="time-parts"></div>').appendTo(t),r=this.is24HourFormat(),o=this.hasSeconds(),l=this.hasDayPeriods(),d=r?0:1,c=r?24:13;for(this.hourSelect=$('<select id="'+this.hoursId+'" data-options="{\'noSearch\': \'true\'}" class="hours dropdown"></select>');d<c;)n="",parseInt(e.initValues.hours,10)===d&&(n=" selected"),e.hourSelect.append($("<option"+n+">"+e.hourText(d)+"</option>")),d++;a.append($('<label for="'+this.hoursId+'" class="audible">'+k.translate("Hours",{locale:this.locale.name})+"</label>")),a.append(this.hourSelect),a.append($('<span class="label colons">'+i+"</span>"));var h=0;for(this.minuteSelect=$('<select id="'+this.minutesId+'" data-options="{\'noSearch\': \'true\'}" class="minutes dropdown"></select>');h<=59;)s=h<10?"0"+h:h,n="",parseInt(e.initValues.minutes,10)===h&&(n=" selected"),e.minuteSelect.append($("<option"+n+">"+s+"</option>")),h+=e.settings.minuteInterval;if(this.minuteSelect.find("option[selected]").length||this.minuteSelect.prepend($("<option selected>"+e.initValues.minutes+"</option>")),a.append($('<label for="'+this.minutesId+'" class="audible">'+k.translate("Minutes",{locale:this.locale.name})+"</label>")),a.append(this.minuteSelect),o){var u=0;for(this.secondSelect=$('<select id="'+this.secondsId+'" data-options="{\'noSearch\': \'true\'}" class="seconds dropdown"></select>');u<=59;)s=u<10?"0"+u:u,n="",(parseInt(e.initValues.seconds,10)===u||!e.initValues.seconds&&"00"===s)&&(n=" selected"),this.secondSelect.append($("<option"+n+">"+s+"</option>")),u+=e.settings.secondInterval;this.secondSelect.find("option[selected]").length||this.secondSelect.prepend($("<option selected>"+e.initValues.seconds+"</option>")),a.append($('<span class="label colons">'+i+"</span>")),a.append($('<label for="'+this.secondsId+'" class="audible">'+k.translate("Seconds",{locale:this.locale.name})+"</label>")),a.append(this.secondSelect)}if(!r&&l){this.periodSelect=$('<select id="'+this.periodId+'" data-options="{\'noSearch\': \'true\'}" class="period dropdown"></select>'),a.append($('<span class="label colons"></span>'));for(var p=this.currentCalendar.dayPeriods,g=0,f=new RegExp(e.initValues.period,"i"),m="AM";g<2;)m=0===g?"AM":"PM",n="",f.test(p[g])&&(n=" selected"),this.periodSelect.append($('<option value="'+m+'"'+n+">"+p[g]+"</option>")),g++;a.append($('<label for="'+this.periodId+'" class="audible">'+k.translate("TimePeriod",{locale:this.locale.name})+"</label>")),a.append(this.periodSelect)}if(this.settings.parentElement)this.settings.parentElement.append(t),e.popup=this.settings.parentElement.find(".timepicker-popup-content").addClass("timepicker-popup").attr("id","timepicker-popup");else{t.append('<div class="modal-buttonset"><button type="button" class="btn-modal-primary set-time">'+k.translate("SetTime",{locale:this.locale.name})+"</button></div>");var v=this.element,b=this.isRTL?"right":"left";this.element.parent().is(".datagrid-cell-wrapper")&&(b="center",v=this.element.next(".icon")),this.trigger.popover({content:t,trigger:"immediate",placement:"bottom",placementOpts:{parent:v,parentXAlignment:b,strategies:["flip","nudge","shrink"]},tooltipElement:"#timepicker-popup"}).on("show.timepicker",function(t,i){e.afterShow(i)}).on("hide.timepicker",function(){e.settings.returnFocus&&e.element.focus()})}this.trigger.data("tooltip")&&(e.popup=this.trigger.data("tooltip").tooltip,e.popup.addClass("timepicker-popup"))},afterShow:function(e){var t=this;e.find("button").button(),this.hourSelect.val(this.initValues.hours),this.hourSelect.data("dropdown").pseudoElem.find("span").text(this.initValues.hours),this.minuteSelect.val(this.initValues.minutes),this.minuteSelect.data("dropdown").pseudoElem.find("span").text(this.initValues.minutes),this.secondSelect&&(this.secondSelect.val(this.initValues.seconds),this.secondSelect.data("dropdown").pseudoElem.find("span").text(this.initValues.seconds)),t.hasDayPeriods()&&(this.periodSelect.val(this.initValues.period),this.periodSelect.data("dropdown").pseudoElem.find("span").text(this.initValues.period)),e.find("div.dropdown").first().focus(),e.find(".set-time").off("click.timepicker").on("click.timepicker",function(e){e.preventDefault(),t.setTimeOnField(),t.closeTimePopup()}),this.settings.parentElement||e.on("keydown.timepicker","button, div.dropdown",function(e){return 9!==(e.keyCode||e.charCode||0)||(t.containFocus(e),e.stopPropagation(),e.preventDefault(),!1)})},containFocus:function(e){var t=e.shiftKey,i=this.popup.find(":focusable"),s=i.index($(":focus")),n=s+1>=i.length?0:s+1,a=s-1<0?i.length:s-1;s=t?a:n,i.eq(s).focus()},setupStandardEvents:function(){var e=this;e.popup.on("touchend.timepicker touchcancel.timepicker",".set-time",function(e){e.preventDefault(),e.target.click()}).on("keydown.timepicker","input.dropdown",function(t){var i=!1;if(27===t.which&&(i=!0,e.closeTimePopup(),e.element.focus()),32===t.which&&(i=!0,e.popup.find(".set-time").click()),37===t.which||39===t.which){i=!0;var s=e.popup.find('input[id$="-shdo"]');if(37===t.which){var n=s.eq(s.index(this)-1);n&&0!==n.length||(n=s.eq(s.length)),n.focus()}if(39===t.which){var a=s.eq(s.index(this)+1);a&&0!==a.length||(a=s.eq(0)),a.focus()}}return!i||(t.preventDefault(),t.stopPropagation(),!1)}),e.trigger.on("hide.timepicker",function(){e.onPopupHide()})},buildRangePopup:function(){},setupRangeEvents:function(){},getTimeFromField:function(e){var t,i=this,s=e||this.element.val(),n=this.getTimeSeparator(),a=void 0,r=void 0,o={};function l(e){return e.replace(/^\s+|\s+$/g,"")}function d(e){return!e||isNaN(e)?"00":e=(e=parseInt(e,10))<10?"0"+e:e}return a=(s=s.replace(/[T\s:.-]/g,n).replace(/z/i,"")).split(n),this.is24HourFormat()||(r=a[a.length-1].split(" "),a.pop(),a=a.concat(r)),a[0]&&a[0].length&&!isNaN(a[0])||(a[0]="1"),a[0]=parseInt(a[0],10),isNaN(a[0])||(a[0]=""+parseInt(a[0],10)),o.hours=i.hourText(a[0]),a[1]?(a[1]=l(a[1]),a[1]=d(a[1]),o.minutes=a[1]):o.minutes="00",(t=a[2])?(t=l(t),i.hasSeconds()?(t=d(t),o.seconds=t):(function(e){return i.dayPeriods.indexOf(e)>-1}(t)||(t=i.translateDayPeriod("AM")),o.period=t)):(i.hasSeconds()&&(t="00",o.seconds=t),i.is24HourFormat()||(t=i.translateDayPeriod("AM"),o.period=t)),a[3]?(a[3]=l(a[3]),o.period=a[3]):!this.is24HourFormat()&&this.hasSeconds()&&(o.period=this.translateDayPeriod("AM")),o},translateDayPeriod:function(e){return/am|pm|AM|PM/i.test(e)?(this.currentCalendar.dayPeriods||["AM","PM"])[/AM|am/i.test(e)?0:1]:e},setTimeOnField:function(){var e=$("#"+this.hoursId).val()||"",t=$("#"+this.minutesId).val()||"",i=$("#"+this.secondsId).val()||"",s=($("#"+this.periodId).val()||"").toUpperCase(),n=this.getTimeSeparator(),a=""+e+n+t+(this.hasSeconds()?n+i:"");a+=(s=this.is24HourFormat()||""!==s?s:$("#"+this.periodId+"-shdo").val())?" "+this.translateDayPeriod(s):"",this.element.val(a).trigger("change"),this.element.focus()},isOpen:function(){return!(!this.popup||!this.popup.is(":visible"))},openTimePopup:function(){this.setup(),this.element.is(":disabled")||this.element.attr("readonly")||(this.popup&&!this.popup.hasClass("is-hidden")&&this.closeTimePopup(),this.element.addClass("is-active is-open"),"range"===this.settings.mode?(this.buildRangePopup(),this.setupRangeEvents()):(this.buildStandardPopup(),this.setupStandardEvents()),this.element.attr({"aria-expanded":"true"}),this.popup.find("div.dropdown").first().focus())},closeTimePopup:function(){this.trigger.data("tooltip")&&this.trigger.data("tooltip").hide()},onPopupHide:function(){if("standard"===this.settings.mode){var e=$("#"+this.hoursId),t=$("#"+this.minutesId),i=$("#"+this.secondsId),s=$("#"+this.periodId);e&&e.data("dropdown")&&"function"==typeof e.data("dropdown").destroy&&e.data("dropdown").destroy(),t&&t.data("dropdown")&&"function"==typeof t.data("dropdown").destroy&&t.data("dropdown").destroy(),this.hasSeconds()&&i&&i.data("dropdown")&&"function"==typeof i.data("dropdown").destroy&&i.data("dropdown").destroy(),this.hasDayPeriods()&&s&&s.data("dropdown")&&"function"==typeof s.data("dropdown").destroy&&s.data("dropdown").destroy(),this.popup.off("click.timepicker touchend.timepicker touchcancel.timepicker keydown.timepicker")}this.element.attr({"aria-expanded":"false"}),this.trigger.off("hide.timepicker show.timepicker"),this.trigger.data("tooltip").destroy(),this.trigger.data("tooltip",void 0),$("#timepicker-popup").remove(),this.element.removeClass("is-active is-open")},toggleTimePopup:function(){this.isOpen()?this.closeTimePopup():this.openTimePopup()},value:function(e){var t=this.element.val();if(!e||!1===e)return t;var i=this.currentCalendar.dateFormat.timeSeparator,s=new RegExp(i,"g"),n=(t=t.replace(s,"")).split(" ");return n[0].length<4&&(t="0"+n[0]+(n[1]?n[1]:"")),t},enable:function(){this.element.removeAttr("disabled readonly").closest(".field").removeClass("is-disabled")},readonly:function(){this.enable(),this.element.attr("readonly","readonly")},disable:function(){this.enable(),this.element.attr("disabled","disabled").closest(".field").addClass("is-disabled")},isDisabled:function(){return this.element.prop("disabled")},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},teardown:function(){this.trigger.off("keydown.timepicker"),this.element.off("focus.timepicker blur.timepicker keydown.timepicker"),this.popup&&this.closeTimePopup(),this.trigger.remove();var e=this.element.data("mask");return e&&"function"==typeof e.destroy&&e.destroy(),$.removeData(this.element[0],"validate"),$.removeData(this.element[0],"validationEvents"),this.element.removeAttr("data-validate").removeData("validate validationEvents"),this.label.find(".audible").remove(),$("#timepicker-popup").remove(),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"timepicker")},handleEvents:function(){var e=this;return this.trigger.off("click.timepicker").on("click.timepicker",function(){e.toggleTimePopup()}),this.handleKeys(),this.handleBlur(),this}},$.fn.timepicker=function(e){return this.each(function(){var t=$.data(this,"timepicker");t?t.updated(e):t=$.data(this,"timepicker",new qt(this,e))})};var Vt=new function(){var e=this;this.ValidationTypes=[],this.ValidationTypes.error={type:"error",titleMessageID:"Error",pagingMessageID:"ErrorOnPage",errorsForm:!0},this.ValidationTypes.alert={type:"alert",titleMessageID:"Alert",pagingMessageID:"AlertOnPage",errorsForm:!1},this.ValidationTypes.success={type:"success",titleMessageID:"Success",pagingMessageID:"SuccessOnPage",errorsForm:!1},this.ValidationTypes.confirm=this.ValidationTypes.success,this.ValidationTypes.info={type:"info",titleMessageID:"Info",pagingMessageID:"InfoOnPage",errorsForm:!1},this.ValidationTypes.icon={type:"icon",titleMessageID:"Icon",pagingMessageID:"IconOnPage",errorsForm:!1,icon:"user-profile"},this.rules={required:{isNotEmpty:function(e,t){return!(!("placeholder"in document.createElement("input"))&&t&&(e===t.attr("placeholder")||e===k.translate("Required")))&&("string"==typeof e?(e=$.trim(e.replace(/<\/?[^>]*>/g,"")),0!==$.trim(e).length):"number"==typeof e?!isNaN(e):$.isArray(e)?e.length>0:!!e)},isRadioChecked:function(e){var t=e.attr("name");return t&&t.length&&$('input[name="'+t+'"]:radio:checked').length},check:function(e,t){return this.message=k.translate("Required"),!(!$(t).is(".datepicker")||!$("#monthview-popup").is(":visible"))||(t.is(":radio")?this.isRadioChecked(t):this.isNotEmpty(e,t))},message:"Required",type:"error",id:"required"},date:{check:function(e,t){if(this.message=k.translate("InvalidDate"),e instanceof Date)return e&&e.getTime&&!isNaN(e.getTime());var i=e.indexOf(":")>-1?k.calendar().dateFormat.datetime:k.calendar().dateFormat.short;t&&t.data("datepicker")&&(i=t.data("datepicker").pattern);var s=!("MMMM"===i||"MMM"===i||"MM"===i||"MMMM d"===i||"yyyy"===i);return!(void 0===k.parseDate(e,i,s)&&""!==e)},message:"Invalid Date",type:"error",id:"date"},availableDate:{check:function(t,i){this.message=k.translate("UnavailableDate");var s=!0;if(""===t)return s;if(!e.rules.date.check(t,i))return s=!1,this.message="",s;var n=i.data("datepicker"),a=n?n.settings:{},r=Object.keys(a).length>0,o=void 0,l=void 0,d=void 0,c=void 0,h=t;if("string"==typeof h){var u="locale"!==a.dateFormat?a.dateFormat:k.calendar().dateFormat.short;a.showTime&&(u+=" "+(a.timeFormat||k.calendar().timeFormat)),h=k.parseDate(h,u)}var p=a.useUTC?k.dateToUTC(h):h;if(p instanceof Array)return s;if(p&&r)for(d=a.useUTC?k.dateToUTC(new Date(a.disable.minDate)).setHours(0,0,0,0):new Date(a.disable.minDate).setHours(0,0,0,0),c=a.useUTC?k.dateToUTC(new Date(a.disable.maxDate)).setHours(0,0,0,0):new Date(a.disable.maxDate).setHours(0,0,0,0),-1!==a.disable.dayOfWeek.indexOf(p.getDay())&&(s=!1),((p=p.setHours(0,0,0,0))<=d||p>=c)&&(s=!1),a.disable.dates.length&&"string"==typeof a.disable.dates&&(a.disable.dates=[a.disable.dates]),o=0,l=a.disable.dates.length;o<l;o++)if(p===(a.useUTC?k.dateToUTC(a.disable.dates[o]):new Date(a.disable.dates[o])).setHours(0,0,0,0)){s=!1;break}return r&&(s=!!(s&&!a.disable.isEnable||!s&&a.disable.isEnable)),s},message:"Unavailable Date",type:"error",id:"availableDate"},rangeDate:{check:function(t,i){var s=this;this.message=k.translate("rangeDate");var n=!0,a=i.data("datepicker");if(a){var r=a.settings,o=t.split(r.range.separator),l=function(t,a){i.val(a),s.message=e.rules[t].message+" ("+a+")",e.rules[t].check(a,i)||(n=!1)};2===o.length&&(l("date",o[0]),n&&l("date",o[1]),n&&l("availableDate",o[0]),n&&l("availableDate",o[1]))}return i.val(t),n},message:"Range Dates",type:"error",id:"rangeDate"},email:{check:function(e){return this.message=k.translate("EmailValidation"),!e.length||/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,16}(?:\.[a-z]{2})?)$/i.test(e)},message:"EmailValidation",type:"error",id:"email"},enableSubmit:{check:function(t,i){var s=i.closest(".signin").find('button[type="submit"]');return t.length&&(e.rules.email.check(t)||e.rules.passwordConfirm.check(t,i))?s.enable():s.disable(),!0},message:"",type:"error",id:"enableSubmit"},emailPositive:{check:function(t,i){if($.trim(t).length&&!i.is("[readonly]")){e.rules.emailPositive.positive=!0,this.message=k.translate("EmailValidation");var s=e.rules.email.check(t,i);return s&&(this.message=""),s}return e.rules.emailPositive.positive=!1,!0},message:"EmailValidation",type:"error",id:"emailPositive"},passwordReq:{check:function(e){return this.message=k.translate("PasswordValidation"),!e.length||e.match(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{10,}$/)},message:"PasswordValidation",type:"error",id:"passwordReq"},passwordConfirm:{check:function(t,i){this.message=k.translate("PasswordConfirmValidation");var s=$('input[type="password"]:not('+i.attr("id")+")",i.closest(".signin")).eq(0).val(),n=t===s&&e.rules.passwordReq.check(s);return!t.length||n},message:"PasswordConfirmValidation",type:"error",id:"passwordConfirm"},time:{check:function(e,t){e=e.replace(/ /g,""),this.message=k.translate("InvalidTime");var i=t&&t.data("timepicker"),s=i?t.data("timepicker").settings:{},n=((s&&s.timeFormat?s.timeFormat:k.calendar().timeFormat).match("HH")||[]).length>0,a=n?24:12,r=e.indexOf(k.calendar().dateFormat.timeSeparator),o=0,l=0,d=0,c=void 0;if(""===e)return!0;if(o=parseInt(e.substring(0,r),10),l=parseInt(e.substring(r+1,r+3),10),i&&(o=(c=i.getTimeFromField()).hours,l=c.minutes,i.hasSeconds()&&(d=c.seconds)),o.toString().length<1||isNaN(o)||parseInt(o,10)<0||parseInt(o,10)>a)return!1;if(l.toString().length<1||isNaN(l)||parseInt(l,10)<0||parseInt(l,10)>59)return!1;if(d.toString().length<1||isNaN(d)||parseInt(d,10)<0||parseInt(d,10)>59)return!1;if(!n){if(parseInt(o,10)<1)return!1;var h=new RegExp(k.calendar().dayPeriods[0],"i"),u=new RegExp(k.calendar().dayPeriods[1],"i");if(0===(e.match(h)||e.match(u)||[]).length)return!1}return!0},message:"Invalid Time",type:"error",id:"time"},test:{check:function(e){return"1"===e},message:"Value is not valid (test).",type:"error",id:"test"}}},Wt={title:"(Title)",message:"(Content)",position:"top right",audibleOnly:!1,progressBar:!0,timeout:6e3,allowLink:!1,draggable:!1,savePosition:!1};function jt(e,t){this.element=$(e),this.settings=m.mergeSettings(e,t,Wt),this.init()}jt.prototype={init:function(){this.show()},show:function(){var e=this,t=e.settings,i=parseFloat(y.convertDelayToFPS(t.timeout)),n=t.allowLink?s.stripTags(t.message,"<a>"):s.stripHTML(t.message),a=!1,r=100,o=$("#toast-container"),l=$('\n      <div class="toast">\n        <span class="toast-title">'+s.stripHTML(t.title)+'</span>\n        <span class="toast-message">'+n+"</span>\n      </div>"),d=$('\n      <button type="button" class="btn-icon btn-close" title="'+k.translate("Close")+'" aria-hidden="true">\n        '+$.createIcon("close")+'\n        <span class="audible">'+k.translate("Close")+"</span>\n      </button>\n    "),c=$('<div class="toast-progress"></div>');o.length||(o=$('<div id="toast-container" class="toast-container" aria-relevant="additions" aria-live="polite"></div>').appendTo("body")),o.removeClass("toast-top-left toast-top-right toast-bottom-right toast-bottom-left").addClass("toast-"+t.position.replace(" ","-")),t.timeout=t.audibleOnly?100:t.timeout,t.progressBar&&l.append(c);var h=new B({duration:y.convertDelayToFPS(t.timeout),timeoutCallback:function(){e.remove(l)},updateCallback:function(e){r=(e.duration-e.elapsedTime)/i*100,k.isRTL()&&(r=100-r),t.progressBar&&(c[0].style.width=r+"%")}});F.register(h),o.append(l),l.addClass(t.audibleOnly?"audible":"effect-scale"),l.append(d),e.createDraggable(l,o),$(document).on("keydown.toast keyup.toast",function(e){(e=e||window.event).ctrlKey&&e.altKey&&80===e.keyCode&&(a="keydown"===e.type,h[a?"pause":"resume"]())}),l.on("mousedown.toast touchstart.toast mouseup.toast touchend.toast",function(e){a=!!/mousedown|touchstart/i.test(e.type),h[a?"pause":"resume"]()}),d.on("click.toast",function(){h.destroy(),e.remove(l)})},createDraggable:function(e,t){var i=this;if(this.settings.draggable&&e[0]&&t[0]){var s=l.features.touch,n=t.parent();t.css({top:"",left:"",right:""});var a=t[0].getBoundingClientRect(),r=this.restorePosition(),o=a;r&&((o={top:r.top,left:r.left,width:e.outerWidth(),height:e.outerHeight()}).right=o.left+o.width,o.bottom=o.top+o.height,this.isPosInViewport(o)||(o=a));var d={top:o.top+"px",left:o.left+"px"};t.is(".toast-bottom-right, .toast-top-right")&&(d.right="auto"),t.css(d),t.addClass("is-draggable");e.off("mousedown.toast touchstart.toast").on("mousedown.toast touchstart.toast",function(e){s||e.preventDefault(),$(e.target).is("a, .btn-close")||t.drag({containment:"document"}).off("dragstart.toast").on("dragstart.toast",function(){e.stopImmediatePropagation(),t.attr("aria-grabbed","true"),n.attr("aria-dropeffect","move")}).off("dragend.toast").on("dragend.toast",function(){t.removeAttr("aria-grabbed"),n.removeAttr("aria-dropeffect"),i.savePosition({left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))});var e=t.data("drag");e&&"function"==typeof e.destroy&&e.destroy()})});var c=function(e){var t=e.dragApi,i=e.x,s=e.y,n=t.getElementsFromPoint(i,s)[0];return!$(n).closest(".toast").length},h=function(e){var t=$.Event("keyup");$.extend(t,{ctrlKey:!0,altKey:!0,keyCode:80}),e.trigger(t)},u=$(document);u.off("mouseup.toast").on("mouseup.toast",function(e){if(1===$("#toast-container .toast").length){var i=t.data("drag");if(i&&"function"==typeof i.getElementsFromPoint){var s={dragApi:i,x:e.pageX,y:e.pageY};c(s)&&h(u)}}}).off("touchend.toast").on("touchend.toast",function(e){if(1===$("#toast-container .toast").length){var i=t.data("drag");if(i&&"function"==typeof i.getElementsFromPoint){var s=e.originalEvent;if(s.targetTouches.length>1)return;var n=s.changedTouches[0],a={dragApi:i,x:n.pageX,y:n.pageY};c(a)&&h(u)}}})}},savePosition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.settings.savePosition&&this.canUseLocalStorage()&&!$.isEmptyObject(e)&&(localStorage[this.uniqueId("usersettings-position")]=JSON.stringify(e),this.element.triggerHandler("settingschanged",[e]))},restorePosition:function(){if(!this.settings.savePosition||!this.canUseLocalStorage())return null;var e=localStorage[this.uniqueId("usersettings-position")];return e?JSON.parse(e):null},canUseLocalStorage:function(){try{if(localStorage.getItem)return!0}catch(e){return!1}return!1},uniqueId:function(e){return e=null==e?"":e,("toast-"+window.location.pathname.split("/").pop().replace(/\.xhtml|\.shtml|\.html|\.htm|\.aspx|\.asp|\.jspx|\.jsp|\.php/g,"").replace(/[^-\w]+/g,"").replace(/\./g,"-").replace(/ /g,"-").replace(/%20/g,"-")+"-"+e).replace(/--/g,"-").replace(/-$/g,"")},isPosInViewport:function(e){return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},unbind:function(e){return e.closest(".toast-container").off("dragstart.toast dragend.toast"),e.off("mousedown.toast mouseup.toast touchstart.toast touchend.toast"),e.find(".btn-close").off("click.toast"),this},remove:function(e){var t=this,i=function(){e.remove(),!$("#toast-container .toast").length&&t.destroy()};if(this.unbind(e),this.settings.audibleOnly)i();else{e.addClass("effect-scale-hide");var s=new B({duration:20,updateCallback:function(){},timeoutCallback:function(){i()}});F.register(s)}},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,Wt)),this.show()},destroy:function(){var e=this,t=$("#toast-container");t[0]&&[].slice.call(t[0].querySelectorAll(".toast")).forEach(function(t){e.settings.audibleOnly=!0,e.remove($(t))});$(document).off("keydown.toast keyup.toast mouseup.toast touchend.toast"),t.remove(),$.removeData(this.element[0],"toast")}},$.fn.toast=function(e){return this.each(function(){var t=$.data(this,"toast");t?t.updated(e):t=$.data(this,"toast",new jt(this,e))})};var Gt={inline:!0,message:"",type:"error",showTooltip:!1,isHelpMessage:!1};function Ut(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Gt),this.init()}Ut.prototype={init:function(){this.fields="input, textarea, select, div[data-validate], div[data-validation]",this.isPlaceholderSupport=!!("placeholder"in document.createElement("input")),this.inputs=this.element.find(this.fields),this.element.is(this.fields)&&(this.inputs=$().add(this.element)),this.timeout=null,this.attachEvents()},extractEvents:function(e){if(e.indexOf("{")>-1&&(e=JSON.parse(e.replace(/'/g,'"'))),"object"===(void 0===e?"undefined":u(e))){var t="";for(var i in e)-1===t.indexOf(e[i])&&(t+=e[i]+" ");e=t=t.split(" ").join(".validate ")}return e},filterValidations:function(e,t){var i=[];if(!e)return[];if(e.indexOf("{")>-1&&(e=JSON.parse(e.replace(/'/g,'"'))),"object"===(void 0===e?"undefined":u(e)))for(var s in e)t&&e[s].indexOf(t)>-1&&i.push(s);return i},setErrorIconOpacity:function(e){if(e.is(":text")&&e.is('[data-error-type="tooltip"]')){var t=this.calculateTextWidth(e.val()),i=e.outerWidth()-35;e.closest(".field, .field-short").find(".icon-error")[t>i?"addClass":"removeClass"]("lower-opacity")}},calculateTextWidth:function(e,t){this.canvas=this.canvas||(this.canvas=document.createElement("canvas"));var i=this.canvas.getContext("2d");return i.font=t||"14px arial",i.measureText(e).width},attachEvents:function(){var e=this,t="[data-validate],[data-validation]";this.inputs.each(function(){var e=$(this),t=e.attr("data-validate")||e.attr("data-validation");t&&t.indexOf("required")>-1&&e.addClass("required")}),this.inputs.filter("input, textarea, div").filter(t).not("input[type=checkbox], input[type=file]").each(function(){var t=$(this),i=t.attr("data-validation-events"),s=e.extractEvents(i||"blur.validate change.validate keyup.validate");s.indexOf("enter.validate")>-1&&t.off("keypress.enter.validate").on("keypress.enter.validate",function(t){var i=$(this);13===t.which&&e.validate(i,!0,t)}),t.off(s).on(s,function(i){if("keyup"===i.type){if(9===i.keyCode)return;e.setErrorIconOpacity(t)}var s=$(this),n=s.data("handleEvent"+[i.type||""]);s.is("[readonly]")&&!s.parent().is(".field-fileupload")||n&&n.type===i.type&&"validate"===i.handleObj.namespace&&!s.closest(".modal:visible").length||(s.data("handleEvent"+[i.type||""],i.handleObj),setTimeout(function(){s.closest(".modal-engaged").length&&!s.closest(".modal-body").length||e.validate(t,!0,i)},300))})}),this.inputs.filter("input[type=checkbox]").filter(t).off("click.validate").on("click.validate",function(t){e.validate($(this),!0,t)}),this.inputs.filter(":radio").off("click.validate").on("click.validate",function(t){var i=$(this).parent().find(".radio").first();e.validate(i,!0,t)});var i=this.inputs.filter("select").filter(t);if(i.length&&(i.off("change.validate listopened.validate listclosed.validate").on("change.validate",function(t){e.validate($(this),!0,t)}).on("listopened.validate",function(){var e=$(this),t=e.data("tooltip");e.next(".dropdown-wrapper").next(".error-message").hide(),t&&document.activeElement===e.data("dropdown").searchInput[0]&&t.hide(),$("#validation-tooltip").hide()}).on("listclosed.validate",function(){var e=$(this),t=e.data("tooltip"),i=e.data("dropdown");l.features.touch&&(i.pseudoElem.focus(),setTimeout(function(){i.pseudoElem.blur()},100)),i&&i.wrapper&&(t=i.wrapper.find(".icon-error").data("tooltip")),e.next(".dropdown-wrapper").next(".error-message").show(),t&&document.activeElement!==e.data("dropdown").searchInput[0]&&t.show()}),i.filter(function(){return void 0!==$(this).data("dropdown")}).each(function(){$(this).data("dropdown").pseudoElem.off("blur.validate").on("blur.validate",function(t){var i=$(this).closest(".field, .field-short").find("select");e.validate(i,!0,t)})})),this.element.is("form")&&this.element.attr("data-validate-on")){this.element.off("submit.validate").on("submit.validate",function t(i){i.stopPropagation(),i.preventDefault(),e.validateForm(function(i){e.element.off("submit.validate"),e.element.triggerHandler("validated",i),e.element.data("isValid",i),e.element.on("submit.validate",t)})})}},validateForm:function(e){var t,i=this,s=[];i.inputs=this.element.find(i.fields),i.inputs.each(function(e){var t=$(this);if(t.attr("data-validate")){if("true"===t.attr("data-disable-validation")||t.hasClass("disable-validation"))return;for(var n=i.validate(t,!1,e),a=0;a<n.length;a++)s.push(n[a])}}),(t=$).when.apply(t,s).then(function(){e(!0)},function(){e(!1)})},setPrimaryBtn:function(e,t){var i=e.find("[data-validate]:visible, select[data-validate], :checkbox[data-validate]"),s=!0;i.length>0&&i.each(function(){var e=$(this);if(!(e.closest(".datagrid-filter-wrapper").length>0)){var t=null!==e[0].offsetParent;e.is(".required")&&(t&&e.is(".editor")&&!e.html()&&(s=!1),!t&&!e.is("select, :checkbox")||e.val()||e.is(".editor")||(s=!1)),!t&&!e.is("select, :checkbox")||e.isValid()||(s=!1)}}),s?t.removeAttr("disabled"):t.attr("disabled","disabled")},value:function(e){return e.is("input[type=checkbox]")?e.prop("checked"):e.is("div")?e[0].innerHTML:e.val()},getTypes:function(e,t){var i=this.filterValidations(e.attr("data-validation-events"),t.type),s=void 0;return s=e.is("input.dropdown")&&e.prev().prev("select").attr("data-validate")?e.prev().prev("select").attr("data-validate").split(" "):e.is("input.dropdown")&&e.prev().prev("select").attr("data-validation")?e.prev().prev("select").attr("data-validation").split(" "):e.attr("data-validation")?e.attr("data-validation").split(" "):e.attr("data-validate")?e.attr("data-validate").split(" "):[],i.length>0&&(s=s.filter(function(e){return-1!==i.indexOf(e)})),"keyup"===t.type&&(s=s.filter(function(e){return"date"!==e&&"time"!==e})),s},setIconOnParent:function(e,t){var i=$.createIcon({classes:["icon-"+t],icon:t}),s=e.closest(".tab-panel, .expandable-pane"),n=s.attr("id"),a=e.closest(".tab-container, .tab-panel-container, .expandable-area"),r=void 0,o=void 0,l=void 0;if(a.is(".tab-panel-container")&&(a=a.prev(".tab-container")),a.is(".tab-container"))(r=$('.tab-list a[href="#'+n+'"]',a).closest(".tab")).length?$(".count",r).length&&(r=$(".count",r)):(n=$('a[href="#'+n+'"]',".popupmenu").closest(".popupmenu").attr("id"),r=$('.tab-list .tab[aria-controls="'+n+'"]',a),o=n);else{if(!a.is(".expandable-area"))return;r=$('.expandable-header[aria-controls="'+n+'"] .title',a)}o&&o.length&&(l=s.add($($(o).attr("href"))),$('a[role="menuitem"]',"#"+o).each(function(){l=l.add($($(this).attr("href")))}));var d=$('a[href="#'+s.attr("id")+'"]',"#"+n);s&&$("."+t,s).length||l&&$("."+t,l).length?($("."+t,s).length||(d.removeClass("is-"+t),$(".icon-"+t,d).remove()),$("."+t,s).length&&$("."+t,l).length&&!$(".icon-"+t,d).length&&d.addClass("is-"+t).append(i),$(".icon-"+t,r).length||r.addClass("is-"+t).append(i)):((r=r.add(d)).removeClass("is-"+t),$(".icon-"+t,r).remove())},validate:function(e,t,i){if(e.data("handleEvent"+[i.type||""],null),"true"===e.attr("data-disable-validation")||e.hasClass("disable-validation")||e.is(":disabled"))return[];var s,n=this,a=n.getTypes(e,i)||[],r=void 0,o=void 0,l=[],d=[],c=void 0,h=void 0,u=n.value(e),p=e.attr("placeholder");function g(t,i,s,a){!1===(r=Vt.rules[s]).positive&&n.removePositive(e),h=Vt.ValidationTypes[r.type]||Vt.ValidationTypes.error;var o="tooltip"!==e.attr("data-"+h.type+"-type");if(t)0===$.grep(d,function(e){return e===h.type}).length?(a.resolve(),r.positive&&(n.addMessage(e,r,o,i),n.removeMessage(e,r,!0),a.resolve(),n.addPositive(e))):h.errorsForm||a.resolve();else{if(!n.isPlaceholderSupport&&u===p&&r.message!==k.translate("Required"))return;n.addMessage(e,r,o,i),d.push(r.type),h.errorsForm?a.reject():a.resolve()}n.setIconOnParent(e,r.type);var l=n.getField(e).data(h.type+"message");t&&l&&l.filter(function(e){return e.id===r.id||r.message}).length>0&&n.removeMessage(e,r,!0);var c=e.closest(".modal").find(".btn-modal-primary").not(".no-validation");c.length&&n.setPrimaryBtn(e.closest(".modal"),c);var g=e.closest("#calendar-popup").find(".btn-modal-primary").not(".no-validation");g.length&&n.setPrimaryBtn(e.closest("#calendar-popup"),g),"error"===r.type&&e.closest("form").triggerHandler("aftervalidate",{field:e,rule:r,isValid:t})}for(c=0,s=a.length;c<s;c++)r=Vt.rules[a[c]],o=$.Deferred(),r&&(r.async?r.check(u,e,g,o):g(r.check(u,e),t,a[c],o),l.push(o));return l},getField:function(e){return e.is("select")&&void 0!==e.data("dropdown")&&(e=e.data("dropdown").pseudoElem),e},hasError:function(e){return this.getField(e).hasClass("error")},addMessage:function(e,t,i,s,n){if(!(""===t.message||e.is(".dropdown, .multiselect")&&$("#dropdown-list").is(":visible"))){n=n||!1;var a=this.getField(e),r=a.data(t.type+"message"),o=Vt.ValidationTypes[t.type]||Vt.ValidationTypes.error;if(n||a.addClass("icon"===t.type?"custom-icon":t.type),!(r&&r===t.message||r&&r.filter(function(e){return(e.id||e.message)===(t.id||t.message)&&e.message===t.message}).length>0)){var l=t.message;if(r){for(var d=0;d<r.length;d++)l="• "+r[d].message;l+="<br>• "+t.message}r||(r=[]),e.closest(".field, .field-short").find('[data-rule-id="'+(t.id||t.message)+'"]').remove(),(e.hasClass("dropdown")||e.hasClass("multiselect"))&&e.parent().find('.dropdown-wrapper > [data-rule-id="'+(t.id||t.message)+'"]').off("click.validate").remove(),(r=r.filter(function(e){return e.id!==t.id})).push({id:t.id,message:t.message,type:t.type}),a.data(o.type+"message",r),void 0!==$.fn.toast&&$("body").toast({title:k.translate(o.titleMessageID),audibleOnly:!0,message:l}),i?(e.data("isValid",!1),this.showInlineMessage(e,t,n)):this.showTooltipMessage(e,l,o.type,s)}}},showIcon:function(e,t){var i=this.getField(e).addClass("icon"===t?"custom-icon":t),s=$.createIconElement({classes:["icon-"+t],icon:t}),n=i.closest(".field, .field-short"),a=e.parent();return 0===n.find("svg.icon-"+t).length?(a.is(".editor-container")&&e.parent().addClass("is-error"),1===e.parent(":not(.editor-container)").find(".btn-actions").length?a.find(".btn-actions").before(s):1===a.find(".data-description").length?a.find(".data-description").before(s):1===a.find(".field-info").length?a.find(".field-info").before(s):e.is("textarea")?e.after(s):e.is(".dropdown, .multiselect")?a.find(".dropdown-wrapper").append(s):e.is(".spinbox")?a.append(s):(e.is(".lookup"),a.append(s)),$(".icon-success",n).remove()):s=n.find("svg.icon-error"),s},showTooltipMessage:function(e,t,i,s){if(!e.is(":radio")){var n=this.showIcon(e,i),a=e;if(e.is(".dropdown, .multiselect")&&void 0!==e.data("dropdown")){var r=e.data("dropdown").pseudoElem;a=r,r.addClass("icon"===i?"custom-icon":i)}e.closest(".field, .field-short").find(".formatter-toolbar").addClass("icon"===i?"custom-icon":i);var o=n.data("tooltip");o?o.content=t:(n.tooltip({content:t,placement:"bottom",placementOpts:{callback:function(e){var t=a[0].getBoundingClientRect(),i=o.tooltip[0].getBoundingClientRect(),s=$("html").is('[dir="rtl"]'),n=e.x,r=0;return s?i.left<t.left&&(r+=t.left-i.left):i.right>t.right&&(r+=-1*(i.right-t.right)),e.setCoordinate("x",n+r),e.nudges||(e.nudges={}),e.nudges.x=r,e}},trigger:"focus",isError:!0,tooltipElement:"#validation-tooltip"}),o=n.data("tooltip")),e.on("focus.validate",function(){o&&o.show()}).on("blur.validate",function(){o&&o.hide()}),o&&e.attr("data-error-type","tooltip"),this.setErrorIconOpacity(e),s&&o&&o.show()}},toggleRadioMessage:function(e,t,i,s,n){var a=void 0,r=void 0,o=e.attr("name");o&&o.length&&(a=$(':radio[name="'+o+'"], :radio[name="'+o+'"] + label'),r=e.parent().is(".inline")?$(':radio[name="'+o+'"]:last').parent():$(':radio[name="'+o+'"]:last + label'),n?(a.addClass("icon"===i?"custom-icon":i),$(s).addClass("radio-group-"+i).insertAfter(r)):(a.removeClass(i),r.next(".radio-group-"+i).remove()))},showInlineMessage:function(e,t,i){i=i||!1;var s=this.getField(e),n=Vt.ValidationTypes[t.type]||Vt.ValidationTypes.error;t.icon=t.icon||n.icon;var a=void 0;a="icon"===t.type?'<div class="custom-icon-message" data-rule-id="'+(t.id||t.message)+'">\n          '+$.createIcon({classes:["icon-custom"],icon:t.icon})+'\n          <pre class="audible">\n            '+k.translate(n.titleMessageID)+'\n          </pre>\n          <p class="message-text">'+t.message+"</p>\n        </div>":'<div class="'+n.type+'-message" data-rule-id="'+(t.id||t.message)+'">\n          '+$.createIcon({classes:["icon-"+n.type],icon:n.type})+'\n          <pre class="audible">\n            '+k.translate(n.titleMessageID)+'\n          </pre>\n          <p class="message-text">'+t.message+"</p>\n        </div>",i||s.addClass("icon"===t.type?"custom-icon":t.type),e.is(":radio")?this.toggleRadioMessage(e,t.message,n.type,a,!0):(s.closest(".field, .field-short").find(".formatter-toolbar").addClass("icon"===n.type?"custom-icon":n.type),s.closest(".field, .field-short").append(a),s.closest(".field, .field-short").find(".colorpicker-container").addClass("icon"===n.type?"custom-icon":n.type)),e.is(".spinbox")&&s.closest(".spinbox-wrapper").addClass("icon"===n.type?"custom-icon":n.type),"error"===n.type&&e.parent().find(".icon-success").remove(),e.triggerHandler(n.type,{field:e,message:t.message}),e.closest("form").triggerHandler(n.type,{field:e,message:t.message})},addPositive:function(e){var t=$.createIcon({icon:"success",classes:"icon-success"});$(".icon-success",e.parent(".field, .field-short")).length||e.parent(".field, .field-short").append(t)},removeMessage:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.getField(e),n=s.data(t.type+"message"),a=t.id||t.message;if(t&&("error"!==t.type||n)&&0!==n.filter(function(e){return e.id===a}).length){var r=n.filter(function(e){return e.id!==a}),o=0===r.length;if(o?s.removeData(t.type+"message"):s.data(t.type+"message",r),e.closest(".field, .field-short").find('[data-rule-id="'+(t.id||t.message)+'"]').remove(),(e.hasClass("dropdown")||e.hasClass("multiselect"))&&e.parent().find('.dropdown-wrapper > [data-rule-id="'+(t.id||t.message)+'"]').off("click.validate").remove(),o&&"error"===t.type&&i&&(e.triggerHandler("valid",{field:e,message:""}),e.closest("form").triggerHandler("valid",{field:e,message:""})),o&&(e.removeClass(t.type+" custom-icon").data("isValid",!0),(e.hasClass("dropdown")||e.hasClass("multiselect"))&&(e.next().next().removeClass(t.type+" custom-icon"),e.next().find("div.dropdown").removeClass(t.type+" custom-icon")),e.is(":radio")&&this.toggleRadioMessage(e,"",t.type,"",!1),e.hasClass("spinbox")&&e.closest(".spinbox-wrapper").removeClass(t.type+" custom-icon"),e.hasClass("colorpicker")&&e.parent(".colorpicker-container").removeClass(t.type),e.closest(".field-fileupload").length>0&&e.closest(".field-fileupload").find("input."+t.type).removeClass(t.type),"tooltip"===e.attr("data-"+t.type+"-type"))){var l=e.closest(".field, .field-short").find(".icon-error").data("tooltip");l&&l.destroy(),this.inputs&&this.inputs.filter("input, textarea").off("focus.validate"),e.parent().find(".dropdown-wrapper > .icon-"+t.type).off("click.validate").remove(),e.parent().find(".icon-"+t.type).remove(),e.next(".icon-"+t.type).off("click.validate").remove(),e.parent(".field, .field-short").find(".icon-"+t.type).remove(),e.next(".inforCheckboxLabel").next(".icon-"+t.type).remove()}}},removePositive:function(e){$(".icon-success",e.parent(".field, .field-short")).remove()},resetForm:function(e){var t=e.find("input, select, textarea");t.removeClass("error"),e.find(".error").removeClass("error"),e.find(".icon-error").remove(),e.find(".icon-success").remove(),e.find(".error-message").remove(),t.removeClass("alert"),e.find(".alert").removeClass("alert"),e.find(".icon-alert").remove(),e.find(".alert-message").remove(),t.removeClass("info"),e.find(".info").removeClass("info"),e.find(".icon-info").remove(),e.find(".info-message").remove(),setTimeout(function(){$("#validation-errors").addClass("is-hidden")},300),t.data("isDirty",!1).removeClass("isDirty"),e.find(".isDirty").removeClass("isDirty"),e.is("form")&&e[0].reset();var i=$.fn.validation.ValidationTypes;Object.keys(i).forEach(function(e){t.removeData(e+"message")})},isFormValid:function(e){if($(e).find(".error-message").length>0)return!1;for(var t=$(e).find('[data-validate*="required"]'),i=0;i<t.length;i++){var s=$(t[i]),n=this.value(s);if((s.is(":visible")||s.is("select"))&&!n)return!1}return!0},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings))}};var _t={type:"error",inline:!0};$.fn.validation=Vt,$.fn.getMessage=function(e){e||(e={type:"error"});var t=e.type+"message",i=$.fn.getField($(this)).data(t),s="";if(i){if(1===i.length)return i[0].message;for(var n=0;n<i.length;n++)s+="• "+i[n].message}return s},$.fn.getMessages=function(e){e||(e={type:"error"});var t=e.type+"message",i=$.fn.getField($(this)).data(t);return i||(i=[]),i},$.fn.getField=function(e){return e.is("select")&&void 0!==e.data("dropdown")&&(e=e.data("dropdown").pseudoElem),e},$.fn.getErrorMessage=function(e){return S("$.fn.getMessage","$.fn.getErrorMessage"),e=m.extend({},e,_t),$(this).getMessage(e)},$.fn.scrollIntoView=function(e,t){"boolean"!=typeof e&&(e=void 0);var i=new Ut(this,t).getField($(this));i[0].scrollIntoView(e),i.focus()},$.fn.addMessage=function(e){return this.each(function(){var t=$.data(this,"Validator");t||(t=$.data(this,"Validator",new Ut(this,e)));var i={message:e.message,type:e.type,triggerEvents:e.triggerEvents,icon:e.icon,id:e.id||e.message};t.addMessage($(this),i,e.inline,e.showTooltip,e.isAlert)})},$.fn.addError=function(e){S("$.fn.addMessage","$.fn.addError");var t=!0;return"boolean"==typeof e.inline&&!1===e.inline&&(t=!1),(e=m.extend({},e,_t)).inline=t,this.each(function(){$(this).addMessage(e)})},$.fn.removeMessage=function(e){return e||(e={type:"error"}),this.each(function(){var t=$.data(this,"Validator");t||(t=$.data(this,"Validator",new Ut(this,e)));var i=$(this),s=e.type+"message",n=$.fn.getField(i).data(s);if(n){for(var a=0;a<n.length;a++)t.removeMessage(i,n[a],e.triggerEvents);t.setIconOnParent(i,e.type),$.removeData(this,"Validator")}})},$.fn.removeError=function(e){return S("$.fn.removeMessage","$.fn.removeError"),e=m.extend({},e,_t),this.each(function(){return $(this).removeMessage(e)})},$.fn.validate=function(e,t){var i="string"==typeof e;return this.each(function(){var s=$.data(this,"validate");if(s&&"string"!=typeof s){if(i)return void("function"==typeof s[e]&&s[e](t));s.updated(e)}else s=$.data(this,"validate",new Ut(this,e))})},$.fn.isValid=function(){var e=$(this).data("isValid");return null==e||e},$.fn.validateField=function(){var e=$(this),t=Soho.components.Validator.prototype;t&&t.validate&&t.validate(e,!1,0)},$.fn.resetForm=function(){Soho.components.Validator.prototype.resetForm(this)};var Kt={showTime:!1,useCurrentTime:!1,timeFormat:void 0,minuteInterval:void 0,secondInterval:void 0,mode:void 0,roundToInterval:void 0,dateFormat:"locale",placeholder:!1,firstDayOfWeek:null,disable:{dates:[],minDate:"",maxDate:"",dayOfWeek:[],isEnable:!1,restrictMonths:!1},showLegend:!1,showMonthYearPicker:!0,hideDays:!1,yearsAhead:5,yearsBack:4,legend:[{name:"Public Holiday",color:"#76B051",dates:[]},{name:"Weekends",color:"#EFA836",dayOfWeek:[]}],range:{useRange:!1,start:"",end:"",separator:" - ",minDays:0,maxDays:0,selectForward:!1,selectBackward:!1,includeDisabled:!1},calendarName:null,locale:"",useUTC:!1,autoSize:!1,hideButtons:!1};function Yt(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Kt),this.init()}Yt.prototype={init:function(){this.build(),this.handleEvents()},build:function(){this.element.is(":disabled")&&this.element.closest(".field").addClass("is-disabled"),this.element.attr("autocomplete","off"),this.trigger=$.createIconElement("calendar").insertAfter(this.element),this.element.hasClass("hidden")&&this.trigger.addClass("hidden"),this.setLocale(),this.addAria(),this.setCurrentCalendar(),this.setSize()},setLocale:function(){var e=this;this.locale=k.currentLocale,this.settings.locale&&k.getLocale(this.settings.locale).done(function(t){e.locale=k.cultures[t],e.setCurrentCalendar()})},setCurrentCalendar:function(){this.currentCalendar=k.calendar(this.locale.name,this.settings.calendarName),this.isIslamic="islamic-umalqura"===this.currentCalendar.name,this.isRTL="right-to-left"===this.locale.direction,this.conversions=this.currentCalendar.conversions,this.isFullMonth=this.settings.dateFormat.indexOf("MMMM")>-1,this.setFormat(),this.mask()},setSize:function(){if(this.settings.autoSize){var e=this.element[0];e.classList.add("input-auto"),e.style.width=w.textWidth(e.value,16)+45+"px"}},addAria:function(){this.label=$('label[for="'+this.element.attr("id")+'"]'),this.label.append('<span class="audible">'+k.translate("PressDown",this.locale.name)+"</span>")},handleKeys:function(e){var t=this,i=this.settings;if(e.is("#monthview-popup"))return e.off("keydown.datepicker").on("keydown.datepicker",".monthview-table, .monthview-monthyear-pane",function(e){var i=!1,s=e.keyCode||e.charCode||0;return 9===s&&(t.containFocus(e),i=!0),27===s&&(t.closeCalendar(),t.element.focus(),e.stopImmediatePropagation(),i=!0),84===s&&(t.closeCalendar(),t.element.focus(),i=!0),!i||(e.stopPropagation(),e.preventDefault(),!1)}),void e.off("keydown.datepicker-tab").on("keydown.datepicker-tab","td, input, div.dropdown, button",function(e){return 9!==(e.keyCode||e.charCode||0)||(i.range.useRange&&$(e.target).is(".next")?t.calendarAPI.days.find("td:visible:last").attr("tabindex",0).focus():t.containFocus(e),e.stopPropagation(),e.preventDefault(),!1)});e.off("keydown.datepicker").on("keydown.datepicker",function(e){var i=!1,s=e.keyCode||e.charCode||0;return 40!==s||t.isOpen()||(i=!0,t.openCalendar(),setTimeout(function(){t.setFocusAfterOpen()},200)),84===s&&(i=!0,t.setToday()),!i||(e.stopPropagation(),e.preventDefault(),!1)})},containFocus:function(e){var t=e.shiftKey,i=this.popup.find(":focusable"),s=$(e.currentTarget);(s.is(".monthview-monthyear-pane, #btn-monthyear-pane")||s.closest(".is-monthyear.is-monthonly").length>0)&&(i=this.popup.find(":focusable").not("td").not(".picklist-item a").add(".picklist-item.is-selected a:visible, .picklist-item.up a:visible, .picklist-item.down a:visible"));var n=i.index($(":focus"));n=t?n-1<0?i.length-1:n-1:n+1>=i.length?0:n+1,i.eq(n).focus()},setFormat:function(){var e=this.settings,t="object"===(void 0===k?"undefined":u(k))&&this.currentCalendar.dateFormat?this.currentCalendar.dateFormat:null,i="object"===(void 0===k?"undefined":u(k))&&this.currentCalendar.timeFormat?this.currentCalendar.timeFormat:null;"object"===(void 0===k?"undefined":u(k))&&this.settings.calendarName&&(t=k.calendar(this.settings.locale,this.settings.calendarName).dateFormat,i=k.calendar(this.settings.locale,this.settings.calendarName).timeFormat),"object"===(void 0===t?"undefined":u(t))&&void 0!==t.short&&(t=t.short),"locale"===e.dateFormat?(this.pattern=t+(e.showTime?" "+(e.timeFormat||i):""),e.dateFormat=this.pattern):this.pattern=e.dateFormat+(e.showTime&&e.timeFormat?" "+e.timeFormat:""),this.show24Hours=(this.pattern.match("H")||[]).length>0,this.isSeconds=(this.pattern.match("ss")||[]).length>0},mask:function(){this.setFormat();var e=this.settings,t={process:"date",keepCharacterPositions:!0,patternOptions:{format:this.pattern}},i="date availableDate",s={date:"change blur enter",availableDate:"change blur"};e.range.useRange&&(t.process="rangeDate",t.patternOptions.delimeter=e.range.separator,i="rangeDate",s={rangeDate:"change blur"}),t.processOnInitialize=!1,this.isFullMonth?this.pattern=this.settings.dateFormat:void 0===this.element.data("mask")&&this.element.mask(t),this.addedValidation=!1,this.element[0]&&this.element[0].getAttribute&&!this.element[0].getAttribute("data-validate")&&(this.addedValidation=!0,this.element.attr({"data-validate":i,"data-validation-events":JSON.stringify(s)}).validate()),this.setPlaceholder()},setPlaceholder:function(){var e,t=this,i=this.settings,s=this.pattern;!i.placeholder||this.element.attr("placeholder")&&"M / D / YYYY"!==this.element.attr("placeholder")||(i.range.useRange&&(s=i.range.first&&i.range.first.date?(e=i.range.first.date,k.formatDate(e,{pattern:t.pattern,locale:t.locale.name})+i.range.separator+this.pattern):this.pattern+i.range.separator+this.pattern),this.element[0].setAttribute("placeholder",s))},isOpen:function(){return this.popup&&this.popup.is(":visible")&&!this.popup.hasClass("is-hidden")},open:function(){return D(this.openCalendar,this.open).apply(this)},openCalendar:function(){var e=this,t=this,i=this.settings,s={};if(!this.element.is(":disabled")&&!this.element.attr("readonly")||0!==this.element.closest(".monthview").length){$("#validation-tooltip").addClass("is-hidden"),this.element.addClass("is-active is-open").trigger("listopened"),this.timepickerContainer=$('<div class="datepicker-time-container"></div>'),this.footer=$('<div class="popup-footer">\n        <button type="button" class="is-cancel btn-tertiary">\n          '+k.translate("Clear",this.locale.name)+'\n        </button>\n        <button type="button" class="is-today btn-tertiary">\n          '+k.translate("Today",this.locale.name)+'\n        </button>\n        <button type="button" class="is-select btn-primary">\n          '+k.translate("Select",this.locale.name)+"\n        </button>\n      </div>"),i.hideDays&&(this.footer=$('<div class="popup-footer">\n          <button type="button" class="is-cancel btn-tertiary">\n            '+k.translate("Clear",this.locale.name)+'\n          </button>\n          <button type="button" class="is-select-month btn-primary">\n            '+k.translate("Select",this.locale.name)+"\n          </button>\n        </div>")),i.hideButtons&&(this.footer=$("")),i.showTime&&(void 0===i.timeFormat?s.timeFormat=this.pattern.slice(this.pattern.indexOf(" ")).trim():s.timeFormat=i.timeFormat,void 0!==i.minuteInterval&&(s.minuteInterval=i.minuteInterval),void 0!==i.secondInterval&&(s.secondInterval=i.minuteInterval),void 0!==i.mode&&(s.mode=i.mode),void 0!==i.roundToInterval&&(s.roundToInterval=i.roundToInterval)),this.calendarContainer=$('<div class="monthview-container"></div>'),this.setValueFromField(),this.settings.showTime&&(""===this.element.val()&&this.currentDate&&this.currentDate.getDate()&&!this.settings.useCurrentTime&&(this.currentDate.setHours(0),this.currentDate.setMinutes(0),this.currentDate.setSeconds(0)),s.parentElement=this.timepickerContainer,s.locale=this.settings.locale,this.time=this.getTimeString(this.currentDate,this.show24Hours),this.timepicker=this.timepickerContainer.timepicker(s).data("timepicker"),this.timepickerContainer.find(".dropdown").dropdown(),this.timepickerContainer.on("change.datepicker",function(){e.currentDate=e.setTime(e.currentDate),e.setValue(e.currentDate,!0,!0)}),setTimeout(function(){e.timepicker.initValues=e.timepicker.getTimeFromField(e.time),e.timepicker.afterShow(e.timepickerContainer)},1)),this.todayDate=new Date,this.todayMonth=this.todayDate.getMonth(),this.todayYear=this.todayDate.getFullYear(),this.todayDay=this.todayDate.getDate(),this.isIslamic&&(this.todayDateIslamic=this.conversions.fromGregorian(this.todayDate),this.todayYear=this.todayDateIslamic[0],this.todayMonth=this.todayDateIslamic[1],this.todayDay=this.todayDateIslamic[2]),this.settings.month=this.currentMonth,this.settings.year=this.currentYear,this.isIslamic&&(this.settings.activeDateIslamic=this.activeDate instanceof Date?this.conversions.fromGregorian(this.activeDate):this.activeDate),this.settings.onOpenCalendar?(this.settings.activeDate=this.settings.onOpenCalendar(),this.isIslamic&&(this.settings.activeDateIslamic=this.conversions.fromGregorian(this.settings.activeDate))):(this.settings.activeDate=this.currentDate||this.todayDate,this.settings.activeDateIslamic=this.currentIslamicDate||this.todayDateIslamic),this.settings.isPopup=!0,this.settings.headerStyle="simple",this.settings.onSelected=function(i,s){e.currentDate=new Date(s.year,s.month,s.day),t.settings.range.useRange&&t.settings.range.first||(t.insertDate(e.currentDate),s.close&&(t.closeCalendar(),t.element.focus()))},this.calendarAPI=new xt(this.calendarContainer,this.settings),this.calendar=this.calendarAPI.element,i.showTime&&this.calendar.addClass("is-timepicker"),i.hideDays&&(this.calendar.addClass("is-monthyear"),"MMMM"!==i.dateFormat&&"MMM"!==i.dateFormat&&"MM"!==i.dateFormat||this.calendar.addClass("is-monthonly"),"yyyy"===i.dateFormat&&this.calendar.addClass("is-yearonly")),this.calendar.append(i.showTime?this.timepickerContainer:"",this.footer);var n=this.element,a=this.isRTL?"right":"left";this.element.parent().is(".datagrid-cell-wrapper")&&(a="center",n=this.element.next(".icon"));var r={content:this.calendar,placementOpts:{parent:n,parentXAlignment:a,strategies:["flip","nudge","shrink"]},placement:"bottom",popover:!0,trigger:"immediate",extraClass:"monthview-popup",tooltipElement:"#monthview-popup",initializeContent:!1};this.trigger.popover(r).off("show.datepicker").on("show.datepicker",function(){"ios"===l.os.name&&$("head").triggerHandler("disable-zoom"),window.innerHeight<400&&e.popupClosestScrollable&&(e.popup.find(".arrow").hide(),e.popup.css("min-height",e.popupClosestScrollable[0].scrollHeight+2+"px"),e.popupClosestScrollable.css("min-height","375px")),i.range.useRange&&i.range.first&&i.range.first.date&&i.range.second&&i.range.second.date&&e.popup.addClass("is-hidden"),e.settings.hideButtons&&e.popup.addClass("hide-buttons"),e.settings.showMonthYearPicker&&(e.popup.find(".expandable-area").expandablearea({animationSpeed:150,trigger:"btn-monthyear-pane"}),e.popup.find(".btn-monthyear-pane").button())}).off("hide.datepicker").on("hide.datepicker",function(){"ios"===l.os.name&&e.trigger.one("hide",function(){$("head").triggerHandler("enable-zoom")}),e.popupClosestScrollable.add(e.popup).css("min-height",""),e.closeCalendar()}),this.handleKeys($("#monthview-popup")),$(".monthview-footer a",this.calendar).button(),this.popup=$("#monthview-popup"),this.popupClosestScrollable=this.popup.closest(".scrollable"),this.popup.attr("role","dialog"),this.originalDate=this.element.val(),this.calendarAPI.currentDate=this.currentDate,this.calendarAPI.currentIslamicDate=this.currentIslamicDate,this.calendarAPI.validatePrevNext(),this.calendarAPI.days.off("click.datepicker").on("click.datepicker","td",function(){var e=$(this);if(e.hasClass("is-disabled"))t.calendarAPI.activeTabindex(e,!0);else{!i.range.useRange||i.range.first&&!i.range.second||t.calendarAPI.days.find(".is-selected").removeClass("is-selected range").removeAttr("aria-selected"),i.range.useRange||t.calendarAPI.days.find(".is-selected").removeClass("is-selected").removeAttr("aria-selected").removeAttr("tabindex");var s=$(this);s.addClass("is-selected"+(i.range.useRange?" range":"")).attr("aria-selected","true"),t.insertSelectedDate(s),i.range.useRange?t.isFocusAfterClose=!0:(t.closeCalendar(),t.element.focus())}}),this.footer.off("click.datepicker").on("click.datepicker","button",function(e){var s=$(this);if(s.hasClass("is-cancel")&&(t.element.val("").trigger("change").trigger("input"),t.currentDate=null,t.closeCalendar()),s.hasClass("is-cancel-month-pane")&&t.calendarAPI.monthYearPane.data("expandablearea").close(),s.hasClass("is-select-month")||s.hasClass("is-select-month-pane")){var n=parseInt(t.calendarAPI.monthYearPane.find(".is-year .is-selected a").attr("data-year"),10),a=parseInt(t.calendarAPI.monthYearPane.find(".is-month .is-selected a").attr("data-month"),10);t.currentDate=new Date(n,a,1),t.isIslamic&&(t.currentDateIslamic[0]=n,t.currentDateIslamic[1]=a,t.currentDateIslamic[2]=1,t.currentYear=n,t.currentMonth=a,t.currentDay=1,t.currentDate=t.conversions.toGregorian(n,a,1)),i.range.useRange?t.isFocusAfterClose=!1:s.hasClass("is-select-month")&&(t.insertDate(t.isIslamic?t.currentDateIslamic:t.currentDate),t.closeCalendar()),s.hasClass("is-select-month-pane")&&t.calendarAPI.showMonth(a,n)}if(s.hasClass("is-today"))if(i.range.useRange){if(t.setToday(!0),!i.range.second||i.range.second&&!i.range.second.date)return void e.preventDefault()}else t.setToday(),t.closeCalendar();if(s.hasClass("is-select")){var r=t.calendarAPI.setRangeSelByClick();if(1===r)t.closeCalendar();else if(2===r)t.element.trigger("change",[i.range.data]).trigger("input",[i.range.data]),t.closeCalendar();else{if(3===r)return void e.preventDefault();t.insertSelectedDate(),t.closeCalendar()}}t.element.focus(),e.preventDefault(),s.hasClass("is-select-month-pane")&&t.calendarAPI.monthYearPane.data("expandablearea").close()}),setTimeout(function(){t.calendarAPI.validatePrevNext(),t.setFocusAfterOpen()},50)}},insertSelectedDate:function(e){var t=this.calendarAPI.getCellDate(e||this.calendar.find("td.is-selected").last()),i=t.day,s=t.month,n=t.year;this.currentDate=new Date(n,s,i),this.isIslamic&&(this.currentDateIslamic[0]=n,this.currentDateIslamic[1]=s,this.currentDateIslamic[2]=i,this.currentYear=n,this.currentMonth=s,this.currentDay=i,this.currentDate=this.conversions.toGregorian(n,s,i)),this.insertDate(this.isIslamic?this.currentDateIslamic:this.currentDate)},close:function(){return D(this.closeCalendar,this.close).apply(this)},closeCalendar:function(){var e=this.calendarAPI&&this.calendarAPI.days.length?this.calendarAPI.days.find("td.is-selected"):null;this.resetRange({cell:e}),this.settings.showTime&&this.timepickerControl&&this.timepickerControl.isOpen()&&this.timepickerControl.closeTimePopup(),this.popup&&this.popup.length&&this.popup.hide().remove();var t=this.trigger.data("tooltip");t&&t.destroy(),this.calendarAPI&&delete this.calendarAPI.datepickerApi,this.element.hasClass("is-active")&&(this.element.trigger("listclosed"),this.element.removeClass("is-active is-open"))},setFocusAfterOpen:function(){var e=this.settings;this.calendar&&(e.range.useRange&&(e.range.first&&e.range.first.label&&(!e.range.second||e.range.second&&!e.range.second.date)&&this.setRangeFirstPart(e.range.first.date),this.calendarAPI.setRangeSelected(),e.range.second&&e.range.first.date&&e.range.second.date&&this.element.val(this.getRangeValue()),this.popup.removeClass("is-hidden")),this.calendarAPI.activeTabindex(this.calendar.find("td.is-selected"),!0),this.calendarAPI.datepickerApi=this)},setRangeFirstPart:function(e){var t,i=this,s=this.settings,n=function(e){return new Date(e.year,e.month,e.day)},a=this.calendarAPI.days.find("td:visible:first"),r=this.calendarAPI.days.find("td:visible:last"),o=(t=e,k.formatDate(t,{date:"full",locale:i.locale.name})),l=this.calendarAPI.days.find('[aria-label="'+o+'"]'),d=l.closest("tr");this.currentDate=e,s.range.first={date:e,label:o,cell:l,row:d,rowIdx:d.index(),cellIdx:l.index()},s.range.extra={minCell:a,maxCell:r,min:n(this.calendarAPI.getCellDate(a)),max:n(this.calendarAPI.getCellDate(r)),cellLength:d.children("td").length},this.calendarAPI.settings.range.first=s.range.first,this.calendarAPI.settings.range.extra=s.range.extra},insertDate:function(e,t){var i=this.settings,s=e instanceof Array?e[0]:e.getFullYear(),n=e instanceof Array?e[1]:e.getMonth(),a=(e instanceof Array?e[2]:e.getDate()).toString();if(this.calendarAPI.currentMonth===n&&this.calendarAPI.currentYear===s||this.calendarAPI.showMonth(n,s),this.isOpen()){var r=this.calendarAPI.days.find("td:not(.alternate)").filter(function(){return $(this).text().toLowerCase()===a});r.hasClass("is-disabled")?this.calendarAPI.activeTabindex(r,!0):(this.settings.showTime&&(t?(this.time=this.getTimeString(e,this.show24Hours),this.settings.roundToInterval&&($("#timepicker-minutes").val(""),e=this.setTime(e))):e=this.setTime(e)),this.setValue(e,!0),i.range.useRange?this.calendarAPI.days.find(".is-selected").removeAttr("aria-selected").removeAttr("tabindex"):this.calendarAPI.days.find(".is-selected").removeClass("is-selected range").removeAttr("aria-selected").removeAttr("tabindex"),r.addClass("is-selected"+(i.range.useRange?" range":"")).attr({"aria-selected":!0}),this.calendarAPI.activeTabindex(r,!0))}},setValue:function(e,t,i){var s=this.settings;this.currentDate=e,e instanceof Array&&(this.currentIslamicDate=e,this.currentDate=this.conversions.toGregorian(e[0],e[1],e[2])),s.range.useRange?i||this.setRangeToElem(e,!1):this.element.val(k.formatDate(e,{pattern:this.pattern,locale:this.locale.name})),t&&(s.range.useRange?i||this.element.trigger("change",[s.range.data]).trigger("input",[s.range.data]):this.element.trigger("change").trigger("input")),this.setSize()},setRangeToElem:function(e,t){var i=this,s=this.settings,n=function(e){return k.formatDate(e,{pattern:i.pattern,locale:i.locale.name})},a=n(e),r=!1;if(this.isOpen()||t){var o=function(e){return k.formatDate(e,{date:"full",locale:i.locale.name})}(e),l=this.calendarAPI.days.find('[aria-label="'+o+'"]'),d=l.closest("tr");s.range.second&&(s.range.second.date?this.resetRange({cell:l}):(delete s.range.second.date,$.isEmptyObject(s.range.second)&&delete s.range.second));var c={};s.range.first&&(c.date=e.getTime(),c.firstdate=s.range.first.date.getTime(),c.min=this.calendarAPI.getDifferenceToDate(s.range.first.date,s.range.minDays),c.max=this.calendarAPI.getDifferenceToDate(s.range.first.date,s.range.maxDays)),!s.range.first||t?(this.setRangeFirstPart(e),a=this.getRangeValue(),this.setPlaceholder()):!s.range.second&&s.range.selectBackward&&c.date>c.firstdate||s.range.selectForward&&c.date<c.firstdate||s.range.maxDays>0&&c.date>c.max.aftertime||c.date<c.max.beforetime?(this.resetRange({cell:l}),this.setRangeFirstPart(e),a=this.getRangeValue(),this.setPlaceholder()):(r=!0,this.currentDate=e,s.range.minDays>0&&(c.date>c.firstdate&&c.date<c.min.aftertime?e=c.min.after:c.date<c.firstdate&&c.date>c.min.beforetime&&(e=c.min.before),d=(l=this.calendarAPI.days.find('[aria-label="'+o+'"]')).closest("tr")),c.date>c.firstdate?s.range.second={date:e,label:o,cell:l,row:d,rowIdx:d.index(),cellIdx:l.index()}:(s.range.second=s.range.first,s.range.first={date:e,label:o,cell:l,row:d,rowIdx:d.index(),cellIdx:l.index()}),a=this.getRangeValue())}else{r=!0;var h=e||new Date;this.currentMonth=h.getMonth(),this.currentYear=h.getFullYear(),this.currentDay=h.getDate(),this.currentDate=h,s.range.first=s.range.first||{},s.range.second=s.range.second||{},s.range.first.date=h,s.range.second.date=h,a=this.getRangeValue()}this.element.val(a),r?(s.range.data={value:a,dates:this.calendarAPI?this.calendarAPI.getDateRange(s.range.first.date,s.range.second.date):[s.range.first.date],startDate:s.range.first.date,start:n(s.range.first.date),endDate:s.range.second.date,end:n(s.range.second.date)},this.closeCalendar(),this.isFocusAfterClose&&(delete this.isFocusAfterClose,this.element.focus())):s.range.data={value:a,dates:[s.range.first.date],startDate:s.range.first.date,start:n(s.range.first.date)}},resetRange:function(e){e=e||{},this.settings.range.useRange&&(delete this.settings.range.first,delete this.settings.range.second,delete this.settings.range.extra,e.isData&&delete this.settings.range.data,this.calendarAPI&&(delete this.calendarAPI.settings.range.first,delete this.calendarAPI.settings.range.second,delete this.calendarAPI.settings.range.extra,e.isData&&delete this.calendarAPI.settings.range.data),this.calendarAPI&&this.calendarAPI.days.length&&this.calendarAPI.days.find("td").removeClass("range range-next range-prev range-selection end-date is-selected"),e.cell&&e.cell.addClass("is-selected"))},setRangeValueFromField:function(){var e=this,t=function(t){return k.formatDate(t,{pattern:e.pattern,locale:e.locale.name})},i=function(t){return k.parseDate(t,{pattern:e.pattern,locale:e.locale.name},!1)},s=function(e){return e&&"function"==typeof e.getTime?e.getTime():(new Date).getTime()},n=function(e){var t=i(e[0]),n=i(e[1]);return t&&n?(t=s(t))>(n=s(n))?[e[1],e[0]]:[e[0],e[1]]:e},a=this.settings,r={};if(r.value=a.range.value||this.element.val().trim(),r.isEmpty=""===r.value,!r.isEmpty&&r.value.indexOf(a.range.separator)>-1?r.dates=n(r.value.split(a.range.separator)):!r.isEmpty&&r.value.indexOf(a.range.separator.slice(0,-1))>-1&&(r.dates=r.value.split(a.range.separator.slice(0,-1))),!a.range.data&&a.range.start&&a.range.end&&r.isEmpty){var o=void 0;o="string"==typeof a.range.start&&"string"==typeof a.range.end?n([a.range.start,a.range.end]):"string"!=typeof a.range.start&&"string"==typeof a.range.end?n([t(a.range.start),a.range.end]):"string"==typeof a.range.start&&"string"!=typeof a.range.end?n([a.range.start,t(a.range.end)]):n([t(a.range.start),t(a.range.end)]),a.range.start=t(o[0]),a.range.end=t(o[1])}if(a.range.first=a.range.first||{},a.range.second=a.range.second||{},a.range.data&&a.range.data.startDate?a.range.first.date=a.range.data.startDate:a.range.start&&"string"==typeof a.range.start?a.range.first.date=i(a.range.start):r.dates&&(a.range.first.date=i(r.dates[0])),a.range.data&&a.range.data.endDate?a.range.second.date=a.range.data.endDate:a.range.end&&"string"==typeof a.range.end?a.range.second.date=i(a.range.end):r.dates&&(a.range.second.date=i(r.dates[1])),this.calendarAPI&&this.calendarAPI.setRangeSelected(),!r.isEmpty&&(r.isEmpty||a.range.data))return!1;var l=t(a.range.first.date);return l&&this.element.val(l),!0},setValueFromField:function(){var e=this.settings;if(this.setCurrentCalendar(),e.range.useRange&&""===this.element.val().trim()&&this.resetRange({isData:!0}),e.range.useRange&&(""!==this.element.val().trim()||e.range.start&&e.range.end||e.range.data&&e.range.data.startDate&&e.range.data.endDate)&&!this.setRangeValueFromField())this.currentDate&&"function"==typeof this.currentDate.getMonth&&(this.currentMonth=this.currentDate.getMonth(),this.currentYear=this.currentDate.getFullYear(),this.currentDay=this.currentDate.getDate());else{var t=this.element.val(),i=t;if(this.isIslamic&&t){var s=k.parseDate(this.element.val(),{pattern:this.pattern,locale:this.locale.name});i=this.conversions.toGregorian(s[0],s[1],s[2])}this.currentDate=i||new Date,"string"==typeof this.currentDate&&(this.currentDate=k.parseDate(this.currentDate,{pattern:this.pattern,locale:this.locale.name,calendarName:this.settings.calendarName},!1)),void 0===this.currentDate&&(this.currentDate=k.parseDate(i,{pattern:this.pattern,locale:this.locale.name,calendarName:this.settings.calendarName},!1)),this.isIslamic?(this.currentDateIslamic=this.conversions.fromGregorian(this.currentDate),this.currentYear=this.currentDateIslamic[0],this.currentMonth=this.currentDateIslamic[1],this.currentDay=this.currentDateIslamic[2]):(this.currentDate=this.currentDate||new Date,this.currentMonth=this.currentDate.getMonth(),this.currentYear=this.currentDate.getFullYear(),this.currentDay=this.currentDate.getDate());var n=this.pattern,a=!("MMMM d"===n||"yyyy"===n);void 0===k.parseDate(this.element.val().trim(),{pattern:n,locale:this.locale.name,calendarName:this.settings.calendarName},a)||""===this.element.val().trim()||e.range.useRange||this.setValue(k.parseDate(this.element.val().trim(),{pattern:this.pattern,locale:this.locale.name,calendarName:this.settings.calendarName},!1)),e.range.useRange&&e.range.first&&e.range.first.date&&e.range.second&&(e.range.second.date?this.element.val(this.getRangeValue()):this.setRangeToElem(this.currentDate,!0))}},enable:function(){this.element.removeAttr("disabled readonly").closest(".field").removeClass("is-disabled")},disable:function(){this.enable(),this.element.attr("disabled","disabled").closest(".field").addClass("is-disabled")},isDisabled:function(){return this.element.prop("disabled")},readonly:function(){this.enable(),this.element.attr("readonly","readonly")},setToday:function(e){var t=this.settings;if(this.currentDate=new Date,this.settings.useCurrentTime||(this.currentDate.setHours(0,0,0,0),""!==this.element.val()&&(this.timepicker&&this.timepicker.hourSelect&&this.currentDate.setHours(this.timepicker.hourSelect.val()),this.timepicker&&this.timepicker.minuteSelect&&this.currentDate.setMinutes(this.timepicker.minuteSelect.val()),this.timepicker&&this.timepicker.secondSelect&&this.currentDate.setSeconds(this.timepicker.secondSelect.val()))),this.isIslamic){var i=this.conversions.fromGregorian(this.currentDate);this.currentDateIslamic=i}var s=this.isIslamic?this.currentDateIslamic:this.currentDate;if(this.isOpen())if(t.range.useRange)if(!t.range.first||t.range.first&&!t.range.first.date){if(this.calendarAPI.days.find("td:visible").removeClass("is-selected").removeAttr("aria-selected"),this.insertDate(s,!0),e&&this.calendarAPI){var n=this.calendarAPI.dayMap.filter(function(e){return e.elem.is(".is-selected")});n&&n.length&&setTimeout(function(){n[0].elem.focus()},0)}}else t.range.first&&t.range.first.date&&(!t.range.second||t.range.second&&!t.range.second.date)?this.setRangeToElem(s,!1):t.range.first&&t.range.first.date&&t.range.second&&t.range.second.date&&(this.resetRange({isData:!0}),this.insertDate(s,!0));else this.insertDate(s,!0);else{if(t.range.useRange)this.setRangeToElem(this.currentDate);else{var a={pattern:this.pattern,locale:this.locale.name},r=k.formatDate(s,a);this.element.val(r)}t.range.useRange?this.element.trigger("change",[t.range.data]).trigger("input",[t.range.data]):this.element.trigger("change").trigger("input")}},setTime:function(e){var t=this.popup.find(".dropdown.hours").val(),i=this.popup.find(".dropdown.minutes").val(),s=this.isSeconds?this.popup.find(".dropdown.seconds").val():0,n=this.popup.find(".dropdown.period");return t=n.length&&"PM"===n.val()&&t<12?parseInt(t,10)+12:t,t=n.length&&"AM"===n.val()&&12===parseInt(t,10)?0:t,(e=new Date(e)).setHours(t,i,s),e},getTimeString:function(e,t){var i=function(e){return(e<10?"0":"")+e},s=e||new Date,n=s.getHours(),a=i(s.getMinutes()),r=i(s.getSeconds()),o=(n%12||12)+":"+a+(this.isSeconds?":"+r:"")+" "+(n<12?"AM":"PM"),l=n+":"+a+" + "+(this.isSeconds?":"+r:"");return t?l:o},getCurrentDate:function(){return this.currentDate},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Kt)),this.teardown().init()},getRangeValue:function(){var e=this,t=this.settings,i=function(t){return k.formatDate(t,{pattern:e.pattern,locale:e.locale.name})};return t.range.useRange&&t.range.first&&t.range.first.date&&t.range.second&&t.range.second.date?""+(i(t.range.first.date)+t.range.separator+i(t.range.second.date)):t.range.useRange&&t.range.first&&t.range.first.date?t.placeholder?""+(i(t.range.first.date)+t.range.separator+this.pattern):i(t.range.first.date):""},teardown:function(){this.isOpen()&&this.closeCalendar(),this.element.off("blur.datepicker"),this.trigger.remove(),this.element.attr("data-mask",""),this.element.removeAttr("placeholder"),this.calendarAPI&&this.calendarAPI.destroy(),this.calendar&&this.calendar.length&&this.calendar.remove(),this.popup&&this.popup.length&&this.popup.remove();var e=this.element.data("mask");return e&&e.destroy(),this.element.off("keydown.datepicker blur.validate change.validate keyup.validate focus.validate"),this.addedValidation&&this.element.removeAttr("data-validate").removeData("validate validationEvents"),this},destroy:function(){this.closeCalendar(),this.teardown(),this.element[0]&&$.removeData(this.element[0],"datepicker")},handleEvents:function(){var e=this,t=this.settings;if(this.trigger.on("click.datepicker",function(){e.isOpen()?e.closeCalendar():e.openCalendar()}),this.handleKeys(this.element),e.element.on("blur.datepicker",function(){""!==e.element.val().trim()&&e.setValueFromField()}),!this.isOpen()&&t.range.useRange&&!t.range.first){this.setRangeValueFromField();var i=this.getRangeValue();i&&this.element.val(i)}}},$.fn.datepicker=function(e){return this.each(function(){var t=$.data(this,"datepicker");t?t.updated(e):t=$.data(this,"datepicker",new Yt(this,e))})};var Xt={buttons:{editor:["header1","header2","separator","bold","italic","underline","strikethrough","separator","foreColor","backColor","separator","justifyLeft","justifyCenter","justifyRight","separator","quote","orderedlist","unorderedlist","separator","anchor","separator","image","separator","clearFormatting","separator","source"],source:["visual"]},excludeButtons:{editor:["backColor"],source:[]},delay:200,firstHeader:"h3",secondHeader:"h4",placeholder:null,pasteAsPlainText:!1,anchor:{url:"http://www.example.com",class:"hyperlink",target:"NewWindow",isClickable:!1,showIsClickable:!1},image:{url:"https://imgplaceholder.com/250x250/368AC0/ffffff/fa-image"},onLinkClick:null,showHtmlView:!1,preview:!1,useFlexToolbar:!1,useSourceFormatter:!1,formatterTabsize:4};function Jt(e,t){this.settings=m.mergeSettings(e,t,Xt),this.element=$(e),this.init()}Jt.prototype={get toolbarAPI(){var e=void 0;return this.toolbar&&this.toolbar.length&&(e=this.toolbar.data(this.settings.useFlexToolbar?"toolbar-flex":"toolbar")),e},init:function(){var e=this,t=this.settings;return this.isIe="ie"===l.browser.name,this.isIeEdge="edge"===l.browser.name,this.isIe11=this.isIe&&"11"===l.browser.version,this.isMac="Mac OS X"===l.os.name,this.isFirefox="firefox"===l.browser.name,this.textarea=null,this.parentElements=["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],this.id=m.uniqueId(this.element,"editor")+"-id",this.container=this.element.parent(".field, .field-short").addClass("editor-container"),this.previewRendered||!this.element.hasClass("is-preview")&&!this.settings.preview?(t.anchor=$.extend({},Xt.anchor,t.anchor),t.image=$.extend({},Xt.image,t.image),t.anchor.defaultUrl=t.anchor.url,t.anchor.defaultClass=t.anchor.class,t.anchor.defaultTargetText=t.anchor.target,t.anchor.defaultIsClickable=t.anchor.isClickable,t.anchor.targets=t.anchor.targets||{SameWindow:"",NewWindow:"_blank"},$.each(this.settings.anchor.targets,function(t,i){e.settings.anchor.defaultTargetText.toLowerCase()===t.toLowerCase()&&(e.settings.anchor.target=i,e.settings.anchor.defaultTarget=i)}),t.anchor.defaultTarget||(t.anchor.target&&$.trim(t.anchor.target).length?t.anchor.defaultTarget=t.anchor.target:(t.anchor.defaultTargetText=k.translate("SameWindow"),t.anchor.defaultTarget=t.anchor.targets[t.anchor.defaultTargetText])),this.setup(),this.element.hasClass("is-readonly")&&this.readonly(),this.settings.showHtmlView&&this.toggleSource(),this):(this.container[0].classList.add("is-preview"),this.element[0].classList.remove("is-disabled","is-readonly","is-preview"),this.element[0].setAttribute("contenteditable",!1),this.element[0].removeAttribute("aria-multiline"),void this.element[0].removeAttribute("role"))},setup:function(){this.isActive=!0,this.modals={},this.initElements().bindSelect().bindPaste().setPlaceholders().bindWindowActions().setupKeyboardEvents().onPasteTriggered()},initElements:function(){return this.element.attr({contentEditable:!0,"aria-multiline":!0,role:"textbox"}),this.element.attr("data-editor",!0),this.initTextarea(),this.bindParagraphCreation().bindTab(),this.initToolbar().bindButtons().bindModals().bindAnchorPreview(),this},sourceViewActive:function(){return this.element.hasClass("source-view-active")},setPlaceholders:function(){var e=this;return this.element.on("blur.editor",function(){return e.togglePlaceHolder()}).on("keypress.editor",function(){return e.togglePlaceHolder()}),this.togglePlaceHolder(),this},togglePlaceHolder:function(){""===this.element.text().trim()?this.element.addClass("editor-placeholder"):this.element.removeClass("editor-placeholder")},getCurrentElement:function(){return this.sourceViewActive()?this.textarea:this.element},bindParagraphCreation:function(){var e=this;return this.getCurrentElement().on("keyup.editor",function(t){var i=e.getSelectionStart(),s=void 0;i&&i.getAttribute("data-editor")&&0===i.children.length&&document.execCommand("formatBlock",!1,"p"),13===t.which&&("li"===(s=(i=e.getSelectionStart()).tagName.toLowerCase())||e.isListItemChild(i)||(t.shiftKey||document.execCommand("formatBlock",!1,"p"),"a"===s&&document.execCommand("unlink",!1,null)))}),this},bindTab:function(){var e=this;return this.getCurrentElement().on("keydown.editor",function(t){if(9===t.which){var i=e.getSelectionStart().tagName.toLowerCase();"pre"===i&&(t.preventDefault(),document.execCommand("insertHtml",null,"    ")),"li"===i&&(t.preventDefault(),document.execCommand(t.shiftKey?"outdent":"indent",t))}}),this},initToolbar:function(){return this.toolbar?this:(this.createToolbar(),this)},setExcludedButtons:function(){var e,t,i,s=this,n=function(e,t){var i=-1,s=0;return e.filter(function(e,n){var a=!0;return t.indexOf(e)>-1&&"separator"!==e?(s++,a=!1):"separator"===e&&n-s-1===i&&(s=0,a=!1),"separator"===e&&(i=n),a})};return e=s.settings,t=e.buttons,i=e.excludeButtons,s.sourceViewActive()?i&&i.source&&i.source.length?n(t.source,i.source):t.source:i&&i.editor&&i.editor.length?n(t.editor,i.editor):t.editor},createToolbar:function(){var e=[this.settings.useFlexToolbar?"flex-toolbar":"toolbar","editor-toolbar","formatter-toolbar"].join(" "),t="",i="";this.settings.useFlexToolbar&&(t="toolbar-section ",i='<div class="toolbar-section more">\n        <button class="btn-actions">\n          <svg class="icon" focusable="false" aria-hidden="true" role="presentation">\n            <use xlink:href="#icon-more"></use>\n          </svg>\n        </button>\n      </div>');for(var s=this.setExcludedButtons(),n="",a=0,r=s.length;a<r;a+=1){var o=this.buttonTemplate(s[a]);o&&(n+=o)}var l='<div class="'+e+'" id="editor-toolbar-'+this.id+'">\n      <div class="'+t+'buttonset">\n        '+n+"\n      </div>\n      "+i+"\n    </div>";this.element.parent().find(".icon-dirty").length?this.toolbar=$(l).insertBefore(this.element.parent().find(".icon-dirty")):this.toolbar=$(l).insertBefore(this.sourceViewActive()?this.element.prev():this.element);var d=this.toolbar.find('[data-action="foreColor"], [data-action="backColor"]');return d.colorpicker({placeIn:"editor"}),$(".trigger",d).off("click.colorpicker"),this.toolbar[this.settings.useFlexToolbar?"toolbarflex":"toolbar"](),this.toolbar.find("button[title]").tooltip(),this},switchToolbars:function(){this.destroyToolbar(),this.setupTextareaEvents(),this.initToolbar(),this.bindButtons().bindModals().bindAnchorPreview(),this.bindSelect().bindPaste().setupKeyboardEvents(),this.toolbar.find("button").button()},initTextarea:function(){var e=this;return this.textarea&&!this.settings.showHtmlView?this:(this.textarea=this.createTextarea(),this.textarea.text(s.sanitizeHTML(this.element.html().toString())),e.container.on("input.editor keyup.editor",".editor",r(function(){e.textarea.html(s.sanitizeHTML(e.element.html().toString())),e.element.trigger("change")},500)),this.setupTextareaEvents(),this.textarea)},createTextarea:function(){this.sourceView=$("<div></div>").attr({class:"editor-source editable hidden",id:"editor-source-"+this.id}).insertBefore(this.element),$("<ul></ul>").addClass("line-numbers").appendTo(this.sourceView);var e=$('<div class="text-container"></div>').appendTo(this.sourceView),t="source-textarea-"+($('[id^="source-textarea-"]').length+1),i=this.element.prev(".label").addClass("audible").text()+" - HTML Source View";return $('<label class="audible" for="'+t+'">'+i+"</label>").appendTo(e),$('<textarea id="'+t+'" class="editable"></textarea>').appendTo(e)},triggerClick:function(e,t){$('button[data-action="'+t+'"]',this.toolbar).trigger("click.editor")},setupKeyboardEvents:function(){var e=this,t=this,i=this.getCurrentElement(),s={b:66,e:69,h:72,i:73,l:76,bl:55,n:56,q:81,r:82,u:85,h3:51,h4:52,space:32,sv:192};return i.on("keydown.editor",function(t){switch((t=t||window.event).which?s.charCode=t.which:t.keyCode?s.charCode=t.keyCode:s.charCode=!1,t.ctrlKey&&s.charCode){case s.h3:e.triggerClick(t,"append-"+e.settings.firstHeader);break;case s.h4:e.triggerClick(t,"append-"+e.settings.secondHeader);break;case s.b:e.triggerClick(t,"bold"),t.preventDefault();break;case s.e:e.triggerClick(t,"justifyCenter");break;case s.h:e.triggerClick(t,"anchor"),t.preventDefault();break;case s.i:e.triggerClick(t,t.shiftKey?"image":"italic"),t.shiftKey||t.preventDefault();break;case s.bl:t.shiftKey&&e.triggerClick(t,"insertunorderedlist"),t.preventDefault();break;case s.l:t.shiftKey||e.triggerClick(t,"justifyLeft"),t.preventDefault();break;case s.n:t.shiftKey&&e.triggerClick(t,"insertorderedlist");break;case s.q:e.triggerClick(t,"append-blockquote");break;case s.r:e.triggerClick(t,"justifyRight");break;case s.u:e.triggerClick(t,"underline"),t.preventDefault();break;case s.space:e.triggerClick(t,"clearFormatting");break;case s.sv:e.triggerClick(t,i===e.element?"source":"visual")}}),this.element.on("mousedown.editor","a",function(e){var i=$(this).attr("href");!t.isFirefox&&(t.isMac&&e.metaKey||!t.isMac&&e.ctrlKey)&&(window.open(i,"_blank"),e.preventDefault())}),this.element.on("updated.editor",function(){e.updated()}),this},setupTextareaEvents:function(){var e=this;return this.textarea.off(".editor").on("input.editor keyup.editor",function(){e.sourceView.hasClass("hidden")||e.adjustSourceLineNumbers()}).on("focus.editor",function(){e.sourceView.addClass("is-focused")}).on("blur.editor",function(t){e.sourceView.removeClass("is-focused"),e.element.empty().html(s.sanitizeHTML(e.textarea.val())),e.element.data("validate")&&e.element.data("validate").validate(e.element,!0,t)}),this},adjustSourceLineNumbers:function(){var e=this.textarea.parent(),t=parseInt(getComputedStyle(this.textarea[0]).lineHeight,10),i=this.textarea.innerHeight()-this.textarea.height();this.textarea[0].style.height="";var s=this.textarea[0].scrollHeight,n=Math.floor((s-i)/t),a=this.sourceView.find(".line-numbers"),r=a.find("li").length,o="",l=0;if(!this.lineNumbers||n!==this.lineNumbers){if(this.lineNumbers)if(this.lineNumbers<n){for(;l<n-this.lineNumbers;)o+='<li role="presentation"><span>'+(r+l+1)+"</span></li>",l++;a.append(o)}else this.lineNumbers>n&&(l=this.lineNumbers-n,a.find("li").slice(-l).remove());else{for(this.lineNumbers=n;l<this.lineNumbers;)o+='<li role="presentation"><span>'+(l+1)+"</span></li>",l++;a.append(o)}this.lineNumbers=n,e[0].style.width="calc(100% - "+(a.outerWidth()+2)+"px)"}s===this.textarea[0].scrollHeight?this.textarea[0].style.height=a[0].scrollHeight+"px":this.adjustSourceLineNumbers()},wrapTextInTags:function(e,t,i){var s=void 0,n=void 0;switch(i){case"bold":s=["<b>","</b>"];break;case"italic":s=["<i>","</i>"];break;case"underline":s=["<u>","</u>"];break;case"strikethrough":s=["<strike>","</strike>"];break;case"append-blockquote":s=["<blockquote>","</blockquote>"];break;default:s=["",""]}if("anchor"===i){var a=$('<a href="'+e+'">'+t+"</a>");this.settings.anchor.class&&$.trim(this.settings.anchor.class).length&&a.addClass(this.settings.anchor.class),this.settings.anchor.target&&$.trim(this.settings.anchor.target).length&&a.attr("target",this.settings.anchor.target),this.settings.anchor.isClickable?a.attr("contenteditable",!1):a.removeAttr("contenteditable"),n=a[0].outerHTML}else n=s[0]+e+t+s[1];return n},insertTextAreaContent:function(e,t){var i=this.textarea[0],s=i.value,n=void 0,a=void 0,r=void 0,o=void 0;e=e||"",document.selection&&"TEXTAREA"===i.tagName?($(i).focus(),(n=document.selection.createRange()).text=this.wrapTextInTags(e,n.text,t),$(i).focus()):i.selectionStart||"0"===i.selectionStart?(a=i.selectionStart,r=i.selectionEnd,o=i.scrollTop,n=this.wrapTextInTags(e,s.substring(a,r),t),i.value=s.substring(0,a)+n+s.substring(r,s.length),$(i).focus(),i.selectionStart=a+n.length,i.selectionEnd=a+n.length,i.scrollTop=o):(i.value+=this.wrapTextInTags(e,i.value,t),$(i).focus(),i.value=i.value)},buttonTemplate:function(e){var t=this.getButtonLabels(this.settings.buttonLabels);return{bold:'<button type="button" class="btn" title="'+k.translate("ToggleBold")+'" data-action="bold" data-element="b">'+t.bold+"</button>",italic:'<button type="button" class="btn" title="'+k.translate("ToggleItalic")+'" data-action="italic" data-element="i">'+t.italic+"</button>",underline:'<button type="button" class="btn underline" title="'+k.translate("ToggleUnderline")+'" data-action="underline" data-element="u">'+t.underline+"</button>",strikethrough:'<button type="button" class="btn" title="'+k.translate("StrikeThrough")+'" data-action="strikethrough" data-element="strike">'+t.strikethrough+"</button>",foreColor:'<button type="button" class="btn colorpicker-editor-button" title="'+k.translate("TextColor")+'" data-action="foreColor" data-element="foreColor">'+t.foreColor+"</button>",backColor:'<button type="button" class="btn colorpicker-editor-button" title="'+k.translate("BackgroundColor")+'" data-action="backColor" data-element="backColor">'+t.backColor+"</button>",superscript:'<button type="button" class="btn" title="'+k.translate("Superscript")+'" data-action="superscript" data-element="sup">'+t.superscript+"</button>",subscript:'<button type="button" class="btn" title="'+k.translate("Subscript")+'" data-action="subscript" data-element="sub">'+t.subscript+"</button>",separator:'<div class="separator"></div>',anchor:'<button type="button" class="btn" title="'+k.translate("InsertAnchor")+'" data-action="anchor" data-modal="modal-url-'+this.id+'" data-element="a">'+t.anchor+"</button>",image:'<button type="button" class="btn" title="'+k.translate("InsertImage")+'" data-action="image" data-modal="modal-image-'+this.id+'" data-element="img">'+t.image+"</button>",header1:'<button type="button" class="btn" title="'+k.translate("ToggleH3")+'" data-action="append-'+this.settings.firstHeader+'" data-element="'+this.settings.firstHeader+'">'+t.header1+"</button>",header2:'<button type="button" class="btn" title="'+k.translate("ToggleH4")+'" data-action="append-'+this.settings.secondHeader+'" data-element="'+this.settings.secondHeader+'">'+t.header2+"</button>",quote:'<button type="button" class="btn" title="'+k.translate("Blockquote")+'" data-action="append-blockquote" data-element="blockquote">'+t.quote+"</button>",orderedlist:'<button type="button" class="btn" title="'+k.translate("OrderedList")+'" data-action="insertorderedlist" data-element="ol">'+t.orderedlist+"</button>",unorderedlist:'<button type="button" class="btn" title="'+k.translate("UnorderedList")+'" data-action="insertunorderedlist" data-element="ul">'+t.unorderedlist+"</button>",justifyLeft:'<button type="button" class="btn" title="'+k.translate("JustifyLeft")+'" data-action="justifyLeft" >'+t.justifyLeft+"</button>",justifyCenter:'<button type="button" class="btn" title="'+k.translate("JustifyCenter")+'" data-action="justifyCenter">'+t.justifyCenter+"</button>",justifyRight:'<button type="button" class="btn" title="'+k.translate("JustifyRight")+'" data-action="justifyRight" >'+t.justifyRight+"</button>",clearFormatting:'<button type="button" class="btn" title="'+k.translate("ClearFormatting")+'" data-action="clearFormatting" >'+t.clearFormatting+"</button>",source:'<button type="button" class="btn" title="'+k.translate("ViewSource")+'" data-action="source" >'+t.source+"</button>",visual:'<button type="button" class="btn" title="'+k.translate("ViewVisual")+'" data-action="visual" >'+t.visual+"</button>"}[e]||!1},getIcon:function(e,t,i){return'<span class="audible">'+k.translate(e)+"</span>"+$.createIcon({classes:i||"",icon:t})},getButtonLabels:function(e){var t={bold:this.getIcon("Bold","bold"),italic:this.getIcon("Italic","italic"),underline:this.getIcon("Underline","underline"),superscript:'<span aria-hidden="true"><b>x<sup>1</sup></b></span>',subscript:'<span aria-hidden="true"><b>x<sub>1</sub></b></span>',strikethrough:this.getIcon("StrikeThrough","strike-through"),foreColor:this.getIcon("TextColor","fore-color"),backColor:this.getIcon("BackgroundColor","back-color"),anchor:this.getIcon("InsertAnchor","link"),image:this.getIcon("InsertImage","insert-image"),header1:this.getIcon("ToggleH3","h3"),header2:this.getIcon("ToggleH4","h4"),quote:this.getIcon("Blockquote","quote"),orderedlist:this.getIcon("OrderedList","number-list"),unorderedlist:this.getIcon("UnorderedList","bullet-list"),pre:'<span aria-hidden="true"><b>0101</b></span>',indent:'<span aria-hidden="true"><b>&rarr;</b></span>',outdent:'<span aria-hidden="true"><b>&larr;</b></span>',justifyLeft:this.getIcon("JustifyLeft","left-text-align"),justifyCenter:this.getIcon("JustifyCenter","center-text"),justifyRight:this.getIcon("JustifyRight","right-text-align"),clearFormatting:this.getIcon("clearFormatting","clear-formatting"),source:this.getIcon("ViewSource","html","html-icon"),visual:this.getIcon("ViewSource","visual","visual-icon")},i=void 0;if("object"===(void 0===e?"undefined":u(e))&&(i=e),"object"===(void 0===i?"undefined":u(i)))for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);return t},activateButton:function(e){this.toolbar.find('[data-element="'+e+'"]').addClass("is-active")},bindButtons:function(){var e=this;return this.toolbar.on("touchstart.editor click.editor","button",function(t){var i=$(this),s=i.attr("data-action");if(!i.is(".btn-actions"))return t.preventDefault(),e.getCurrentElement().focus(),void 0===e.selection&&e.checkSelection(),e.sourceViewActive()||i.toggleClass("is-active"),s&&e.execAction(s,t),(e.isIe||e.isIeEdge)&&e.getCurrentElement().trigger("change"),!1}),this},bindModals:function(){var e=this;return this.modals={url:this.createURLModal(),image:this.createImageModal()},$('[name="em-target-'+this.id+'"]').dropdown(),$("#modal-url-"+this.id+", #modal-image-"+this.id).modal().on("beforeopen",function(){e.savedSelection=e.saveSelection(),$(this).attr("id")!=="modal-url-"+e.id||e.selectionRange}).off("open").on("open",function(){var t=l.features.touch,i=$(this).attr("id"),s=$("input:first",this),n=$(".modal-buttonset .btn-modal-primary",this);$('[name="em-url-'+e.id+'"]').val(e.settings.anchor.url),$('[name="em-class-'+e.id+'"]').val(e.settings.anchor.class),$('[name="em-target-'+e.id+'"]').val(e.settings.anchor.target).trigger("updated"),$('[name="em-isclickable-'+this.id+'"]').prop("checked",e.settings.anchor.isClickable),setTimeout(function(){t&&i==="modal-image-"+e.id?n.focus():s.focus().select()},10)}).off("close").on("close",function(t,i){if(e.restoreSelection(e.savedSelection),!i)if($(this).attr("id")==="modal-url-"+e.id){var s=$(e.findElementInSelection("a",e.element[0]));s.length?e.updateCurrentLink(s):e.createLink($('[name="em-url-'+e.id+'"]',this))}else e.insertImage($("#image-"+e.id).val())}),this},createURLModal:function(){var e=this,t=this.settings,i=$("#modal-url-"+this.id);if(i.length>0)return i;var s="",n=!0;return $.each(t.anchor.targets,function(t,i){s+='<option value="'+i+'">'+k.translate(t)+"</option>",e.settings.anchor.defaultTargetText.toLowerCase()===t.toLowerCase()&&(n=!1)}),n&&(s+='<option value="'+t.anchor.target+'">'+t.anchor.target+"</option>"),$('<div class="modal editor-modal-url" id="modal-url-'+this.id+'"></div>').html('<div class="modal-content">\n        <div class="modal-header">\n          <h1 class="modal-title">'+k.translate("InsertAnchor")+'</h1>\n        </div>\n        <div class="modal-body">\n          <div class="field">\n            <label for="em-url-'+this.id+'">'+k.translate("Url")+'</label>\n            <input id="em-url-'+this.id+'" name="em-url-'+this.id+'" type="text" value="'+t.anchor.url+'">\n          </div>\n          '+(t.anchor.showIsClickable?'<div class="field">\n            <input type="checkbox" class="checkbox" id="em-isclickable-'+this.id+'" name="em-isclickable-'+this.id+'" checked="'+t.anchor.isClickable+'">\n            <label for="em-isclickable-'+this.id+'" class="checkbox-label"> '+k.translate("Clickable")+"</label>\n          </div>":"")+'\n          <div class="field">\n            <label for="em-class-'+this.id+'">'+k.translate("CssClass")+'</label>\n            <input id="em-class-'+this.id+'" name="em-class-'+this.id+'" type="text" value="'+t.anchor.class+'">\n          </div>\n          <div class="field">\n            <label for="em-target-'+this.id+'" class="label"> '+k.translate("Target")+'</label>\n            <select id="em-target-'+this.id+'" name="em-target-'+this.id+'" class="dropdown">\n              '+s+'\n            </select>\n          </div>\n          <div class="modal-buttonset">\n            <button type="button" class="btn-modal btn-cancel"> '+k.translate("Cancel")+'</button>\n            <button type="button" class="btn-modal-primary"> '+k.translate("Insert")+"</button>\n          </div>\n        </div>\n      </div>").appendTo("body")},createImageModal:function(){var e=$("#modal-image-"+this.id);return e.length>0?e:$('<div class="modal editor-modal-image" id="modal-image-'+this.id+"\"></div>'").html('<div class="modal-content">\n        <div class="modal-header">\n          <h1 class="modal-title">'+k.translate("InsertImage")+'</h1>\n        </div>\n        <div class="modal-body">\n          <div class="field">\n            <label for="image-'+this.id+'">'+k.translate("Url")+'</label>\n            <input id="image-'+this.id+'" name="image-'+this.id+'" type="text" value="'+this.settings.image.url+'">\n          </div>\n          <div class="modal-buttonset">\n            <button type="button" class="btn-modal btn-cancel">\n              '+k.translate("Cancel")+'</button>\n            <button type="button" class="btn-modal-primary">\n              '+k.translate("Insert")+"</button>\n          </div>\n        </div>\n      </div>").appendTo("body")},bindAnchorPreview:function(){this.element.find("a").tooltip({content:function(){return $(this).attr("href")}})},updateCurrentLink:function(e){var t=s.stripTags($('[name="em-url-'+this.id+'"]').val()),i=s.stripTags($('[name="em-class-'+this.id+'"]').val()),n=s.stripTags($('[name="em-target-'+this.id+'"]').val()),a=this.settings.anchor.showIsClickable?$('[name="em-isclickable-'+this.id+'"]').is(":checked"):this.settings.anchor.isClickable;e&&(e[0].setAttribute("href",this.fixLinkFormat(t&&$.trim(t).length?t:this.settings.anchor.defaultUrl)),e[0].setAttribute("class",i&&$.trim(i).length?i:this.settings.anchor.defaultClass),e[0].setAttribute("data-url",(t&&$.trim(t).length?t:this.settings.anchor.defaultUrl).replace("http://",""))),a?e.attr("contenteditable",!1):e.removeAttr("contenteditable"),n&&$.trim(n).length?e.attr("target",n):e.removeAttr("target")},createLink:function(e){var t=this;this.restoreSelection(this.savedSelection);var i=s.stripTags(this.fixLinkFormat(e[0].value));e.val(i),this.settings.anchor.url=e.val(),this.settings.anchor.class=$('[name="em-class-'+this.id+'"]').val(),this.settings.anchor.target=$('[name="em-target-'+this.id+'"]').val(),this.settings.anchor.isClickable=this.settings.anchor.showIsClickable?$('[name="em-isclickable-'+this.id+'"]').is(":checked"):this.settings.anchor.isClickable;var n=$('<a data-url="'+i+'" href="'+i+'">'+i+"</a>");if(this.settings.anchor.class&&$.trim(this.settings.anchor.class).length&&n.addClass(this.settings.anchor.class),this.settings.anchor.target&&$.trim(this.settings.anchor.target).length&&n.attr("target",this.settings.anchor.target),this.settings.anchor.isClickable?n.attr("contenteditable",!1):n.removeAttr("contenteditable"),this.sourceViewActive())this.insertTextAreaContent(e.val(),"anchor");else{var a=void 0,r=void 0,o=void 0,l=void 0,d=void 0;if(!this.selection.isCollapsed||this.isIe11){if(window.getSelection&&(a=window.getSelection()).getRangeAt&&a.rangeCount){""!==(l=""+(r=a.getRangeAt(0))).trim()&&n.html(l);for(var c=(o=r.commonAncestorContainer.children)?o.length:0,h=0;h<c;h++){var u=o[h];u instanceof HTMLImageElement&&(d=u)}d&&n.html(d.outerHTML),r.deleteContents();var p=document.createElement("div");p.innerHTML=n[0].outerHTML;for(var g=document.createDocumentFragment(),f=void 0,m=void 0;f=p.firstChild;)m=g.appendChild(f);r.insertNode(g),m&&((r=r.cloneRange()).setStartAfter(m),r.collapse(!0),a.removeAllRanges(),a.addRange(r))}}else document.execCommand("insertHtml",null,n[0].outerHTML),setTimeout(function(){t.getCurrentElement().focus()},1);this.bindAnchorPreview()}},fixLinkFormat:function(e){return e.match(/^https?:\/\//)?e:"http://"+e},bindSelect:function(){var e=this,t="";return this.selectionHandler=function(){clearTimeout(t),t=setTimeout(function(){e.checkSelection()},e.settings.delay)},this.getCurrentElement().off("mouseup.editor keyup.editor").on("mouseup.editor keyup.editor",this.selectionHandler),this},checkSelection:function(){var e=void 0;if(void 0===this.selection&&this.sourceViewActive())return e=this.textarea.val().substring(this.textarea[0].selectionStart,this.textarea[0].selectionEnd).toString().trim(),void this.hideToolbarActions();e=window.getSelection();var t=this.getSelectionElement();return t?this.checkSelectionElement(e,t):this.hideToolbarActions(),this},getSelectionElement:function(){var e=void 0,t=void 0,i=void 0,s=window.getSelection(),n=function(e){var t=e;try{for(;!t.getAttribute("data-editor");)t=t.parentNode}catch(e){return!1}return t};try{t=(e=s.getRangeAt(0).commonAncestorContainer).parentNode,i=e.getAttribute("data-editor")?e:n(t)}catch(e){i=n(t)}return i},checkSelectionElement:function(e,t){var i=this.sourceViewActive()?this.sourceView[0]:this.element[0];this.selection=e,this.selectionRange=this.selection.getRangeAt(0),i!==t?this.hideToolbarActions():this.setToolbarButtonStates()},setToolbarButtonStates:function(){return this.toolbar.find("button").removeClass("is-active"),this.checkActiveButtons(),this},checkActiveButtons:function(){this.checkButtonState("bold"),this.checkButtonState("italic"),this.checkButtonState("underline"),this.colorpickerButtonState("foreColor"),this.toolbar.find('.buttonset [data-action="backColor"]').length&&this.colorpickerButtonState("backColor");for(var e=this.getSelectedParentElement();void 0!==e.tagName&&-1===this.parentElements.indexOf(e.tagName.toLowerCase)&&(this.activateButton(e.tagName.toLowerCase()),!this.element.is(e));)e=e.parentNode},checkButtonState:function(e){document.queryCommandState&&(document.queryCommandState(e)?this.toolbar.find('[data-action="'+e+'"]').addClass("is-active"):this.toolbar.find('[data-action="'+e+'"]').removeClass("is-active"))},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(){var e=this.selectionRange;return this.rangeSelectsSingleNode(e)?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer},hideToolbarActions:function(){void 0!==this.toolbar&&this.toolbar.removeClass("is-active")},bindPaste:function(){var e=this,t=e.getCurrentElement();return this.pasteWrapper=function(t){var i=void 0;i=t.originalEvent.clipboardData&&t.originalEvent.clipboardData.getData?t.originalEvent.clipboardData.getData("text/plain"):!(!window.clipboardData||!window.clipboardData.getData)&&window.clipboardData.getData("Text");var s=void 0,n=void 0,a="";if(e.sourceViewActive())return this;if(i&&!t.defaultPrevented){for(t.preventDefault(),n=i.split(/[\r\n]/g),s=0;s<n.length;s+=1)""!==n[s]&&(navigator.userAgent.match(/firefox/i)&&0===s?a+="<p>"+e.htmlEntities(n[s])+"</p>":/\.(gif|jpg|jpeg|tiff|png)$/i.test(n[s])?a+='<img src="'+e.htmlEntities(n[s])+'" />':a+="<p>"+e.htmlEntities(n[s])+"</p>");if(document.queryCommandSupported("insertText"))return document.execCommand("insertHTML",!1,a),!1;e.pasteHtmlAtCaret(a)}},this.pasteWrapperHtml=function(t){if(e.sourceViewActive())return this;var i=void 0,s=void 0,n=void 0,a=void 0,r=void 0;if((t.clipboardData||t.originalEvent)&&(t.clipboardData&&t.clipboardData.types?s=t.clipboardData:t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.getData&&(s=t.originalEvent.clipboardData)),s&&s.types)((i=s.types)instanceof DOMStringList&&i.contains("text/html")||i.indexOf&&-1!==i.indexOf("text/html")||e.isIeEdge)&&(n=t.originalEvent.clipboardData.getData("text/html")),i instanceof DOMStringList&&i.contains("text/plain")&&(n=t.originalEvent.clipboardData.getData("text/plain")),"object"===(void 0===i?"undefined":u(i))&&i[0]&&"text/plain"===i[0]&&!i[1]&&(n=t.originalEvent.clipboardData.getData("text/plain"));else for(r=(window.clipboardData?window.clipboardData.getData("Text"):"").split(/[\r\n]/g),n="",a=0;a<r.length;a+=1)""!==r[a]&&(navigator.userAgent.match(/firefox/i)&&0===a?n+="<p>"+e.htmlEntities(r[a])+"</p>":/\.(gif|jpg|jpeg|tiff|png)$/i.test(r[a])?n+='<img src="'+e.htmlEntities(r[a])+'" />':n+="<p>"+e.htmlEntities(r[a])+"</p>");return e.pastedData=e.isIe11?n:e.getCleanedHtml(n),$.when(e.element.triggerHandler("beforepaste",[{pastedData:e.pastedData}])).done(function(){if(e.pastedData&&!t.defaultPrevented){if(e.isIe11||e.isIeEdge||t.preventDefault(),document.queryCommandSupported("insertText"))return document.execCommand("insertHTML",!1,e.pastedData),!1;e.pasteHtmlAtCaret(e.pastedData)}e.element.triggerHandler("afterpaste",[{pastedData:e.pastedData}]),e.pastedData=null}),!!e.isIe11&&void 0},t.on("paste.editor",e.settings.pasteAsPlainText?e.pasteWrapper:e.pasteWrapperHtml),this},pasteHtmlAtCaret:function(e){var t=this,i="x-text-content-templ-x",s=void 0,a=void 0;if(window.getSelection){if((s=window.getSelection()).getRangeAt&&s.rangeCount){(a=s.getRangeAt(0)).deleteContents(),t.isIe11&&(e=i);var r=document.createElement("div");r.innerHTML=e;for(var o=document.createDocumentFragment(),l=void 0,d=void 0;l=r.firstChild;)d=o.appendChild(l);if(a.insertNode(o),d&&((a=a.cloneRange()).setStartAfter(d),a.collapse(!0),s.removeAllRanges(),s.addRange(a)),t.isIe11){for(var c=50,h=$.Deferred(),u=document.createDocumentFragment();t.element[0].childNodes.length>0;)u.appendChild(t.element[0].childNodes[0]);!function t(i,s){--c<0?h.reject():i.childNodes&&i.childNodes.length>0?(e=i.innerHTML,i.innerHTML="",i.appendChild(s),h.resolve()):setTimeout(function(){t(i,s)},5)}(t.element[0],u),$.when(h).done(function(){var s="",a=t.element.find(":contains(+ "+i+")").filter(function(){return this.textContent===i});a.length||(a=t.element.find(":contains(+ "+i+")").filter(function(){return this.textContent.indexOf(i)>-1&&"UL"!==this.tagName})),e=t.getCleanedHtml(e);var r="";/(^(\s+?)?<li)/gi.test(e)?/((\s+?)?<\/li>(\s+?)?$)/gi.test(e)?(a.is("li")||(e="<ul>"+e+"</ul>"),r=e):r=a.is("li")?e+"</li>":(s=e.match(/<\/ul|<\/ol/gi)||[]).length?e:e+"</li></ul>":/((\s+?)?<\/li>(\s+?)?$)/gi.test(e)&&(a.is("li")?r="<li>"+e:((s=e.match(/<ul|<ol/gi)||[]).length?e+=s[s.length-1].replace(/<(ul|ol)/gi,"<$1>"):e="<ul>"+e+"</ul>",r=e)),r&&n.html(a,r,"*"),(s=t.element[0].innerHTML).indexOf(i)>-1&&(s=s.replace(i,e)),t.element[0].innerHTML=t.getCleanedHtml(s)})}}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(e)},getCleanedHtml:function(e){var t=void 0,i=e||"",s=["start","xmlns","xmlns:o","xmlns:w","xmlns:x","xmlns:m","onmouseover","onmouseout","onmouseenter","onmouseleave","onmousemove","onload","onfocus","onblur","onclick","style"];this.isWordFormat(i)&&(i=this.cleanWordHtml(i));for(var n=0,a=s.length;n<a;n++)t=new RegExp(" "+s[n]+'="(.*?)"',"gi"),i=this.stripAttribute(i,s[n],t),t=new RegExp(" "+s[n]+"='(.*?)'","gi"),i=this.stripAttribute(i,s[n],t);return(i=(i=(i=(i=(i=(i=(i=(i=(i=i.replace(/\sng-[a-z-]+/,"")).replace(/<!--(.*?)-->/gm,"")).replace(/\s\s+/g," ").replace(/\s>+/g,">")).replace(/<(ul|ol)(.*?)>/gi,"<$1>")).replace(/<li><\/li>/gi,"")).replace(/<(ul|ol)><\/(ul|ol)>/gi,"")).replace(/<\/?(html|body)(.*?)>/gi,"")).replace(/<head\b[^>]*>(.*?)<\/head>/gi,"")).replace(/<[^/>]+>[\s]*<\/[^>]+>/gi,"")).indexOf("·")>-1&&(i=[(i=[(i=(i=(i=i.replace(/<\/p>/gi,"</li>")).replace(/<p><span><span>·<\/span><\/span>/gi,"<li>")).replace(/<\/li>\s<li>/gi,"</li><li>")).slice(0,i.indexOf("<li>")),"<ul>",i.slice(i.indexOf("<li>"))].join("")).slice(0,i.lastIndexOf("</li>")),"</ul>",i.slice(i.lastIndexOf("</li>"))].join("")),i},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},bindWindowActions:function(){var e=this,t=this.element.closest(".editor-container"),i=this.getCurrentElement(),s=this;this.element.on("mousedown.editor",function(){e.mousedown=!0}).on("focus.editor",function(){e.isFirefox&&!e.mousedown&&e.element===i&&e.setFocus()}).on("DOMNodeInserted",function(e){var t=$(e.target),i=$("<b>helper</b>");"IMG"===e.target.tagName?t.removeAttr("id style srcset"):"SPAN"===e.target.tagName&&(t.before(i),i.after(t.contents()),i.add(t).remove())}),t.on("focus.editor",".editor, .editor-source",function(){var e=$(this);t.addClass("is-active"),setTimeout(function(){e.hasClass("error")&&(t.parent().find(".editor-toolbar").addClass("error"),t.parent().find(".editor-source").addClass("error"))},100)}).on("blur.editor",".editor, .editor-source",function(){t.removeClass("is-active"),t.parent().find(".editor-toolbar").removeClass("error"),t.parent().find(".editor-source").removeClass("error")}),s.settings.onLinkClick&&t.on("click.editorlinks","a",function(t){s.settings.onLinkClick(t,{elem:e,url:t.currentTarget.getAttribute("data-url")}),t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation()});for(var n=this.element.prevAll(".label"),a=0,r=n.length;a<r;a++)n[a].style.cursor="default";return n.on("click.editor",function(){i.focus()}),i.attr("aria-label",n.text()),this},restoreSelection:function(e){var t=window.getSelection();if(e||(e=this.savedSelection),e){t.removeAllRanges();for(var i=0,s=e.length;i<s;i+=1)t.addRange(e[i])}},saveSelection:function(){var e=void 0,t=window.getSelection();if(t.getRangeAt&&t.rangeCount){e=[];for(var i=0,s=t.rangeCount;i<s;i+=1)e.push(t.getRangeAt(i));return e}return null},getSelectionStart:function(){var e=document.getSelection().anchorNode;return e&&3===e.nodeType?e.parentNode:e},getrange:function(){return window.getSelection().getRangeAt(0)},findElementInSelection:function(e,t){var i=void 0,s=void 0,n=void 0,a=this.getrange();if(a){for(i=n=a.commonAncestorContainer||a.parentElement();i!==t;i=i.parentNode)if(i&&i.tagName&&i.tagName.toLowerCase()===e)return i;if(!a.collapsed&&(void 0===a.text||a.text)&&n.getElementsByTagName){i=n.getElementsByTagName(e),s=document.createRange?document.createRange():document.body.createTextRange();for(var r=0,o=i.length;r<o;r++)if(document.createRange){if(s.selectNodeContents(i[r]),a.compareBoundaryPoints(Range.END_TO_START,s)<0&&a.compareBoundaryPoints(Range.START_TO_END,s)>0)return i[r]}else if(s.moveToElementText(i[r]),a.compareEndPoints("StartToEnd",s)<0&&a.compareEndPoints("EndToStart",s)>0)return i[r]}}},restoreLinkSelection:function(){var e=$(this.findElementInSelection("a",this.element[0]));if(this.settings.anchor.url=this.settings.anchor.defaultUrl,this.settings.anchor.class=this.settings.anchor.defaultClass,this.settings.anchor.target=this.settings.anchor.defaultTarget,this.settings.anchor.isClickable=this.settings.anchor.defaultIsClickable,e.length){this.settings.anchor.url=e.attr("href"),this.settings.anchor.class=e.attr("class"),this.settings.anchor.target=e.attr("target");var t=e.attr("contenteditable");!1!==t&&"false"!==t||(this.settings.anchor.isClickable=!0)}},execAction:function(e){if(this.getCurrentElement()===this.element)e.indexOf("append-")>-1?this.execFormatBlock(e.replace("append-","")):"anchor"===e?(this.restoreLinkSelection(),this.modals.url.data("modal").open()):"image"===e?this.modals.image.data("modal").open():"foreColor"===e||"backColor"===e?this.colorpickerActions(e):"clearFormatting"===e?this.clearFormatting():"source"===e||"visual"===e?this.toggleSource():document.execCommand(e,!1,null);else switch(e){case"visual":this.toggleSource();break;case"anchor":this.modals.url.data("modal").open();break;default:this.insertTextAreaContent(null,e)}this.checkSelection()},insertImage:function(e){document.execCommand("insertImage",!1,e)},toggleSource:function(e){var t=this,i=function(e){return"string"==typeof e&&"false"===e.toLowerCase()||"boolean"==typeof e&&!1===e||"number"==typeof e&&0===e};if(this.sourceViewActive()&&!e){var n=this.textarea.val();$.when(this.element.triggerHandler("beforepreviewmode",n)).done(function(e){i(e)||function(e){var i=e||t.textarea.val();t.element.empty().removeClass("source-view-active hidden"),t.sourceView.addClass("hidden").removeClass("is-focused"),t.element.trigger("focus.editor"),t.switchToolbars(),setTimeout(function(){t.element.html(s.sanitizeHTML(i)),i=t.element.html(),t.element.triggerHandler("afterpreviewmode",i)},0)}(e)})}else{var a=this.element.html();$.when(this.element.triggerHandler("beforesourcemode",a)).done(function(e){i(e)||function(e){var i=e||t.element.html().trim().replace(/\s+/g," ").replace(/<br( \/)?>/g,"<br>\n").replace(/<\/p> /g,"</p>\n\n").replace(/<\/blockquote>( )?/g,"</blockquote>\n\n");t.settings.useSourceFormatter&&(i=t.formatHtml(i)),t.textarea.val(i).focus(),t.element.addClass("source-view-active hidden"),t.sourceView.removeClass("hidden"),t.adjustSourceLineNumbers(),t.textarea.focus(),t.switchToolbars(),i=t.textarea.val(),t.element.triggerHandler("aftersourcemode",i)}(e)})}},clearFormatting:function(){var e,t=this,i=this.getSelectionParentElement(),s=i.tagName,n={};i&&s&&(s=s.toLowerCase(),n=function(){for(var e=function(e){return e&&e.style&&""!==e.style.textAlign},s=i,n=e(s),a=9999;!n&&a>0;)a--,n=(s=s?s.parentNode:null)&&s===t.element[0]||e(s);var r={found:s&&s!==i&&s!==t.element[0]};return r.found&&(r.elem=s,r.textAlign=s.style.textAlign),r}(),function(){var e=function(e){var t=[].slice.call(e.querySelectorAll("li"));if(t.length>0){var i=document.createDocumentFragment();t.forEach(function(e){var t=document.createTextNode(e.textContent);i.appendChild(t),i.appendChild(document.createElement("br"))});var s=t[0].parentNode;s.parentNode.insertBefore(i,s.nextSibling),s.parentNode.removeChild(s)}};if("li"===s)e(i.parentNode);else if(/ul|ol/.test(s))e(i);else{var t=i.classList.contains("editor")?i:$(i).closest(".editor").length?i.parentNode:null;t&&[].slice.call(t.querySelectorAll("ul, ol")).forEach(function(t){return e(t)})}}(),function(){var e=function(e){var t=e.parentNode,i=document.createElement("p");i.innerHTML=e.innerHTML,t.replaceChild(i,e)};t.parentElements.indexOf(s)>-1?"p"!==s&&(document.execCommand("removeFormat",!1,null),e(i)):t.parentElements.forEach(function(t){"p"!==t&&[].slice.call(i.querySelectorAll(t)).forEach(function(t){return e(t)})});for(var n=[].slice.call(t.element[0].querySelectorAll("blockquote, pre")),a=function(t,s){var a=!1;!function e(t){for(var s=0,n=t.length;s<n;s++){var r=t[s],o=[].slice.call(r.children);r===i&&(a=!0),o.length&&!a&&e(o)}}([].slice.call(n[t].children)),a&&(document.execCommand("removeFormat",!1,null),e(n[t]))},r=0,o=n.length;r<o;r++)a(r)}(),e=function(e){var t=e.parentNode,i=e.firstChild;t.insertBefore(i,e),t.removeChild(e),t.normalize()},"a"===s?e(i):[].slice.call(i.querySelectorAll("a")).forEach(function(i){(function(e){var i=window.getSelection(),s=!1;if(t.isIe11){var n=i.getRangeAt(0),a=document.createRange();a.selectNode(e);var r=n.compareBoundaryPoints(Range.START_TO_END,a),o=n.compareBoundaryPoints(Range.START_TO_START,a),l=n.compareBoundaryPoints(Range.END_TO_START,a),d=n.compareBoundaryPoints(Range.END_TO_END,a);s=r!==o||l!==d||r!==d}else s=i.containsNode(e,!0);return s})(i)&&e(i)}));var a=i.parentNode;a&&a!==this.element[0]&&[].slice.call(a.querySelectorAll("[align]")).forEach(function(e){return e.removeAttribute("align")});document.execCommand("removeFormat",!1,null),n.found&&(n.elem.style.textAlign=n.textAlign)},getSelectionParentElement:function(){var e=null,t=void 0;return window.getSelection?(t=window.getSelection()).rangeCount&&1!==(e=t.getRangeAt(0).commonAncestorContainer).nodeType&&(e=e.parentNode):(t=document.selection)&&"Control"!==t.type&&(e=t.createRange().parentElement()),e},colorpickerButtonState:function(e){var t=$('[data-action="'+e+'"]',this.toolbar),i=t.data("colorpicker"),s=document.queryCommandValue(e);return i&&(this.isFirefox&&"backColor"===e&&(s=$(window.getSelection().focusNode.parentNode).css("background-color")),"number"==typeof s&&(s=i.decimal2rgb(s)),s=s?i.rgb2hex(s):"",t.attr("data-value",s).find(".icon").css("fill",["transparent","#1a1a1a","#f0f0f0","#ffffff","#313236"].indexOf(s.toLowerCase())>-1?"":s)),{cpBtn:t,cpApi:i,color:s}},colorpickerActions:function(e){var t=this,i=this.colorpickerButtonState(e),s=i.cpBtn,n=i.cpApi;s.one("selected.editor",function(i,n){var a=n;void 0===a||a instanceof $||!a.element||(a=$(n.element));var r=(""+a.data("value")).toLowerCase();if(-1===(r="#"!==r?r:"").indexOf("#")&&(r="#"+r),s.attr("data-value",r).find(".icon").css("fill",r),t.isIe||"foreColor"===e)r?document.execCommand(e,!1,r):document.execCommand("removeFormat",!1,e);else{document.execCommand("fontSize",!1,"2");for(var o=t.getSelectionParentElement().parentNode.getElementsByTagName("font"),l=0,d=o.length;l<d;l++)o[l].hasAttribute("style")&&(o[l].style.backgroundColor="");setTimeout(function(){for(var e=0,t=o.length;e<t;e++)o[e].hasAttribute("size")&&(o[e].style.backgroundColor=r,o[e].removeAttribute("size"))},0)}setTimeout(function(){t.getCurrentElement().focus()},0)}),n.toggleList()},execFormatBlock:function(e){var t=this.getSelectionData(this.selection.anchorNode);if("blockquote"===e&&t.el&&"blockquote"===t.el.parentNode.tagName.toLowerCase())return document.execCommand("outdent",!1,null);if(t.tagName===e&&(e="p"),this.isIe){if("blockquote"===e)return document.execCommand("indent",!1,e);e="<"+e+">"}return document.execCommand("formatBlock",!1,e)},getSelectionData:function(e){var t=void 0;for(e&&e.tagName&&(t=e.tagName.toLowerCase());e&&-1===this.parentElements.indexOf(t);)(e=e.parentNode)&&e.tagName&&(t=e.tagName.toLowerCase());return{el:e,tagName:t}},isListItemChild:function(e){for(var t=e.parentNode,i=t.tagName.toLowerCase();-1===this.parentElements.indexOf(i)&&"div"!==i;){if("li"===i)return!0;if(!(t=t.parentNode)||!t.tagName)return!1;i=t.tagName.toLowerCase()}return!1},destroyToolbar:function(){var e=function(e){return e||$()};this.toolbar=e(this.toolbar),this.element=e(this.element),this.textarea=e(this.textarea);var t=this.toolbar.data("toolbar");t&&t.destroy();for(var i=this.toolbar.find("button"),s=0,n=i.length;s<n;s++){var a=$(i[s]).data("tooltip");a&&"function"==typeof a.destroy&&a.destroy()}for(var r=$('[data-action="foreColor"], [data-action="backColor"]',this.element),o=0,l=r.length;o<l;o++){var d=$(r[o]).data("colorpicker");d&&"function"==typeof d.destroy&&d.destroy()}this.toolbar.off("touchstart.editor click.editor click.editor mousedown.editor"),this.toolbar.remove(),this.toolbar=void 0,this.element.off("mouseup.editor keypress.editor input.editor keyup.editor keydown.editor focus.editor mousedown.editor DOMNodeInserted.editor updated.editor blur.editor paste.editor"),this.textarea.off("mouseup.editor click.editor keyup.editor input.editor focus.editor blur.editor"),this.element.prev(".label").off("click.editor"),this.element.closest(".editor-container").off("focus.editor blur.editor click.editorlinks");var c=this.colorpickerButtonState("foreColor"),h=c.cpBtn;if(h.off("selected.editor"),(h=(c=this.colorpickerButtonState("backColor")).cpBtn).off("selected.editor"),$(window).off("resize.editor"),this.modals)for(var u=0,p=this.modals.length;u<p;u++){var g=$(this.modals[u]),f=g.data("modal");g.off("beforeclose.editor close.editor open.editor beforeopen.editor"),f&&"function"==typeof f.destroy&&f.destroy()}this.modals={},this.element.trigger("destroy.toolbar.editor")},setPreviewMode:function(){var e=this.container[0].classList,t=this.element[0].classList;if(!e.contains("is-preview")){if(!this.isEditable()){var i=["is-disabled","is-readonly","is-preview"];e.remove.apply(e,i),t.remove.apply(t,i)}this.sourceViewActive()&&this.toggleSource(),e.add("is-preview"),t.remove("is-preview"),this.element[0].setAttribute("contenteditable",!1),this.element[0].removeAttribute("aria-multiline"),this.element[0].removeAttribute("role"),[].slice.call(this.element[0].querySelectorAll("a")).forEach(function(e){var t=$(e).data("tooltip");t&&"function"==typeof t.destroy&&t.destroy()})}},destroyPreviewMode:function(){if(this.container[0]){var e=this.container[0].classList;e.contains("is-preview")&&(e.remove("is-preview"),this.previewRendered?(this.element[0].setAttribute("aria-multiline",!0),this.element[0].setAttribute("role","textbox"),this.bindAnchorPreview()):(this.previewRendered=!0,this.init()))}},isPreview:function(){return!!this.container[0]&&this.container[0].classList.contains("is-preview")},isEditable:function(){var e=this,t=!0,i=function(e,t){return e.classList.contains(t)};return["is-disabled","is-readonly","is-preview"].forEach(function(s){(i(e.container[0],s)||i(e.element[0],s))&&(t=!1)}),t},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Xt)),this.teardown().init()},teardown:function(){return this.element.attr("contenteditable","false"),this.element.off("input.editor keyup.editor"),$("html").off("mouseup.editor"),this.destroyToolbar(),this.sourceView&&(this.sourceView.off(".editor"),this.sourceView.remove(),this.sourceView=null),1===$('[data-editor="true"]').length&&$("#modal-url-"+this.id+", #modal-image-"+this.id).remove(),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"editor")},disable:function(){this.destroyPreviewMode(),this.element.addClass("is-disabled").attr("contenteditable","false"),this.container.addClass("is-disabled")},enable:function(){this.destroyPreviewMode(),this.element.removeClass("is-disabled is-readonly").attr("contenteditable","true"),this.container.removeClass("is-disabled is-readonly")},readonly:function(){this.destroyPreviewMode(),this.element.removeClass("is-readonly").attr("contenteditable","false"),this.container.addClass("is-readonly")},editable:function(){this.enable()},preview:function(){this.container[0].classList.contains("is-preview")||this.setPreviewMode()},setFocus:function(){var e="<"===$.trim(this.element.html()).slice(0,1)?$(":first-child",this.element)[0]:this.element[0];window.setTimeout(function(){var t=void 0,i=void 0;window.getSelection&&document.createRange?((i=document.createRange()).selectNodeContents(e),i.collapse(!0),(t=window.getSelection()).removeAllRanges(),t.addRange(i)):document.body.createTextRange&&((i=document.body.createTextRange()).moveToElementText(e),i.collapse(!0),i.select())},1)},onPasteTriggered:function(){!this.isFirefox&&document.addEventListener&&document.addEventListener("paste",function(e){if(void 0!==e.clipboardData){var t=e.clipboardData.items[0];if(0===t.type.indexOf("image")){var i=t.getAsFile(),s=new FileReader;s.onload=function(e){var t=e.target.result;document.execCommand("insertImage",!1,t)},s.readAsDataURL(i)}}},!1)},isWordFormat:function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)},cleanWordHtml:function(e){var t=e;t=(t=(t=(t=(t=(t=t.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/&nbsp;/gi," ")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""})).replace(/(\n|\r| class=(\'|")?Mso[a-zA-Z]+(\'|")?)/g," ");for(var i=["style","script","applet","embed","noframes","noscript"],s=0,n=i.length;s<n;s++){var a=new RegExp("<"+i[s]+".*?"+i[s]+"(.*?)>","gi");t=t.replace(a,"")}return t},stripAttribute:function(e,t,i){return"style"===t?this.stripStyles(e,i):e.replace(i,"")},stripStyles:function(e,t){var i=["color","background","font-weight","font-style","text-decoration","text-align"];return e.replace(t,function(e){for(var t=(e=e.replace(/( style=|("|\'))/gi,"")).split(";"),s="",n=0;n<t.length;n++){var a=t[n].split(":");s+=i.indexOf(a[0])>-1?a[0]+":"+a[1]+";":""}return""!==s?' style="'+s+'"':""})},formatHtml:function(e){e=e.trim();var t=this.settings,i=e.split(/</),s=0,n="";function a(e){var i="",s=e*("number"==typeof t.formatterTabsize?t.formatterTabsize:4);if(e>-1)for(;s--;)i+=" ";return i}for(var r=0,o=i.length;r<o;r++){var l=i[r].split(/>/);2===l.length?("/"===i[r][0]&&s--,n+=a(s),"/"!==i[r][0]&&s++,r>0&&(n+="<"),n+=l[0].trim()+">\n",""!==l[1].trim()&&(n+=a(s)+l[1].trim().replace(/\s+/g," ")+"\n"),l[0].match(/^(area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/)&&s--):n+=a(s)+l[0]+"\n"}return n.trim()},clear:function(){this.element.empty(),this.textarea.empty(),this.sourceView.find(".line-numbers").empty(),this.sourceView.find(".textarea-print").empty()}},$.fn.editor=function(e){return this.each(function(){var t=$.data(this,"editor");t?t.updated(e):t=$.data(this,"editor",new Jt(this,e))})};var Qt={legend:[],legendKey:"",dataset:[],newData:[],templateId:"",mobileView:!1,leafHeight:null,leafWidth:null,beforeExpand:null,paging:!1,renderSubLevel:!1,layout:"horizontal",rootId:null,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function Zt(e,t){this.settings=m.mergeSettings(e,t,Qt),this.element=$(e),this.init()}Zt.prototype={init:function(){var e=this.settings;if(null===this.rootId&&void 0===this.element.attr("id")?this.rootId="hierarchyChart":this.element.attr("id")?this.settings.rootId=this.element.attr("id"):this.rootId="hierarchyChart",e.colorClass=["azure08","turquoise02","amethyst06","slate06","amber06","emerald07","ruby06"],this.handleEvents(),e.paging&&console.warn("\n      Hierarchy,\n      WARNING: Paging setting will be deprecated.\n      Date of Message: 02/12/2019\n      Date of deprecation: 05/15/2019.\n      "),e.mobileView&&console.warn("\n      Hierarchy,\n      WARNING: MobileView setting will be deprecated.\n      Date of Message: 02/12/2019\n      Date of deprecation: 05/15/2019.\n      "),void 0!==e.dataset&&0!==e.dataset.length&&Array.isArray(e.dataset)){if(e.dataset[0]&&e.dataset[0].children&&e.dataset[0].children.length>0||this.isStackedLayout()?this.render(e.dataset[0]):e.dataset&&e.dataset.children.length>0&&this.render(e.dataset),null!==e.leafHeight&&null!==e.leafWidth){var t="'body .hierarchy .leaf,body .hierarchy .sublevel .leaf,body .hierarchy .container .root.leaf { width: "+e.leafWidth+"px;  height: "+e.leafHeight+"px;  }'";$('<style type="text/css" id="hierarchyLeafStyles">'+t+"</style>").appendTo("body")}e.layout&&this.setLayout(e.layout)}else this.element.emptymessage(e.emptyMessage)},setLayout:function(e){switch(this.settings.paging&&(e="paging"),this.settings.mobileView&&(e="mobile-only"),e){case"horizontal":this.element.addClass("layout-is-horizontal");break;case"stacked":this.element.addClass("layout-is-stacked");break;case"paging":this.element.addClass("layout-is-paging");break;case"mobile-only":this.element.addClass("layout-is-mobile-only");break;default:this.element.addClass("layout-is-horizontal")}},handleEvents:function(){var e=this,t=this,i=this.settings;t.element.off("click.hierarchy").on("click.hierarchy",".btn",function(e){if(!t.isStackedLayout()){i.newData.length>0&&(i.newData=[]);var s=$(this).closest(".leaf").attr("id"),n=$("#"+s).data(),a={branch:$(this).closest("li"),leaf:$(this).closest(".leaf"),button:$(this)};n.isExpanded?t.collapse(e,n,a):t.expand(e,n,a)}}),this.element.on("keypress",".leaf",function(e){var i=$(this).attr("id"),s=$("#"+i);13===e.which&&(s.isExpanded?t.collapse(e,s):t.expand(e,s))}),t.element.off("dblclick.hierarchy").on("dblclick.hierarchy",".leaf",function(t){var i=t.currentTarget.id,s={event:t,data:$("#"+i).data()};t.stopImmediatePropagation(),e.element.trigger("dblclick",s)}),t.element.on("mouseup",".leaf, .back button",function(e){var t=$(this),i=$(e.target),s=t.closest(".hierarchy").data("hierarchy"),n=t.data(),a=$(this).attr("id"),r={target:e.target,pageX:e.pageX,pageY:e.pageY},o=i.is("button"),l=!i.hasClass("btn-back"),d=i.is(".btn-back"),c=i.find("use").prop("href"),h=!!c&&"#icon-caret-up"===c.baseVal,u=!!c&&"#icon-caret-down"===c.baseVal,p=!!c&&"#icon-caret-right"===c.baseVal,g=i.hasClass("btn-actions"),f=i.is("a")&&i.parent().parent().is("ul.popupmenu"),m=t.hasClass("ancestor"),v="selected";if(e.stopImmediatePropagation(),(!f||!$(i).parent().data("disabled"))&&($(".is-selected").removeClass("is-selected"),$("#"+a).addClass("is-selected"),o&&h&&l&&(v=m?"back":"collapse"),o&&u&&l&&(v="expand"),d&&(v="back"),g&&(v="actions",s.buildActionsMenu(n,t)),f&&(v="action"),o&&p&&l&&(v="forward"),3===e.which&&(v="rightClick"),s)){var b={id:a,data:n,actionReference:f?i.data("actionReference"):null,targetInfo:r,eventType:v,isForwardEvent:s.isForwardEvent(v),isBackEvent:s.isBackEvent(v),isAddEvent:s.isAddEvent(v),isExpandEvent:s.isExpandEvent(v),isCollapseEvent:s.isCollapseEvent(v),isSelectedEvent:s.isSelectedEvent(v),isActionsEvent:s.isActionsEvent(v),isActionEvent:s.isActionEvent(v),allowLazyLoad:s.allowLazyLoad(n,v)};t.trigger("selected",b)}})},selectLeaf:function(e){var t=$("#"+e);$(".is-selected").removeClass("is-selected"),t.addClass("is-selected");var i={data:t.data(),actionReference:null,isForwardEvent:!1,isBackEvent:!1,isAddEvent:!1,isExpandEvent:!1,isCollapseEvent:!1,isSelectedEvent:!0,isActionsEvent:!1,isActionEvent:!1,allowLazyLoad:!1};t.trigger("selected",i)},updateActions:function(e,t){var i=$(e.targetInfo.target).closest(".leaf"),s=e.data,n=$(i).find(".popupmenu"),a=n.find("li").not(":eq(0)");$(a).each(function(e,t){$(t).remove()}),s.menu.actions=t,n.append(this.getActionMenuItems(s))},buildActionsMenu:function(e,t){var i=$(t).find(".popupmenu"),s=[];void 0!==e.menu&&(i.empty(),e.menu.details&&(i.addClass("has-detail-fields"),s.push('<li><div class="detail-fields">'+e.menu.details.map(function(e){return'<div class="dt-fields-row"><div class="dt-fields-cell">'+e.key+'</div><div class="dt-fields-cell">'+e.value+"</div></div>"}).join("")+"</div></li>")),e.menu.actions&&s.push(this.getActionMenuItems(e)),s.forEach(function(e){i.append(e)}))},getActionMenuItems:function(e){return""+e.menu.actions.map(function(e){return void 0===e.disabled&&(e.disabled=!1),e}).map(function(e){return"\n      <li data-disabled='"+e.disabled+"' class='"+(e.menu?"submenu":"")+"'>\n        <a href='"+e.url+"' data-action-reference='"+JSON.stringify(e.data)+"'>\n          "+e.value+"\n          "+(e.menu?'<svg class="arrow icon-dropdown icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-dropdown"></use></svg>':"")+"\n        </a>\n        "+(e.menu?'<div class="wrapper" role="application" aria-hidden="true">\n          <ul class="popupmenu">\n            '+e.menu.map(function(t){return"\n            <li data-disabled='"+e.disabled+"'>\n              <a href='"+e.url+"' data-action-reference='"+JSON.stringify(e.data)+"'>"+t.value+"</a>\n            </li>"}).join("")+"\n          </ul>\n        </div>":"")+"\n      </li>"}).join("")},isBackEvent:function(e){return"back"===e},isForwardEvent:function(e){return"forward"===e},isAddEvent:function(e){return"add"===e},isExpandEvent:function(e){return"expand"===e},isCollapseEvent:function(e){return"collapse"===e},isSelectedEvent:function(e){return"selected"===e},isActionsEvent:function(e){return"actions"===e},isActionEvent:function(e){return"action"===e},allowLazyLoad:function(e,t){return void 0!==e&&void 0!==t&&(!e.isLoaded&&!e.isLeaf&&"expand"===t)},data:function(e,t,i,s){void 0===s&&(s={});var n=this.settings,a=t.isRootNode?t:t[0],r=[];function o(t,n,a){Object.keys(n).forEach(function(t){"id"===t&&e===n.id&&(n.isLoaded||n.isRootNode||function(e,t){t.insert&&(delete e.isLeaf,e.isExpanded=!0),0!==i.length&&t.insert?e.children=[i]:e.children=i}(n,s),r.push(n))}),n.children&&l(t,n.children)}function l(e,t,i){if(void 0===t.length)o(e,t);else for(var s=0,n=t.length;s<n;s++)o(e,t[s])}return n.newData.length>0&&(n.newData=[]),void 0!==i&&l(this,a),0!==r.length&&$("#"+r[0].id).data(r[0]),r[0]},add:function(e,t,i){var s=this.settings,n=void 0!==t.id?t.id:e,a=$("#"+n),r=a.parent().hasClass("leaf-container")?a.parent().parent():a.parent(),o={},l="sub-level"!==r.parent().attr("class"),d=1===r.children(".sublist").length;if(l?d?o.element=r.children(".sublist"):(o.el=r.append("<ul class='sublist'></ul>"),o.element=$(o.el).find(".sublist")):(o.el=r.children("ul"),o.element=$(o.el)),0===o.element.length&&(o.el=r.append("<ul></ul>"),o.element=$(o.el).find("ul")),!t.isRootNode){for(var c=0,h=i.length;c<h;c++)s.newData.push(i[c]);this.createLeaf(i,o.element)}this.updateState(a,!1,null,"add")},closePopupMenu:function(e){var t=e.find(".btn-actions");0!==t.length&&t.data("popupmenu").close()},expand:function(e,t,i){var s=this.settings,n=i.leaf,a=n.next();this.closePopupMenu(n),a.animateOpen(),this.element.trigger("expanded",[t,s.dataset]),n.hasClass("root")&&(a=a.next("ul")).animateOpen(),n.parent().removeClass("branch-collapsed").addClass("branch-expanded"),this.updateState(n,!1,null,"expand")},collapse:function(e,t,i){var s=this,n=this.settings,a=i.leaf,r=a.next();this.closePopupMenu(a),r.animateClosed().on("animateclosedcomplete",function(){s.element.trigger("collapsed",[t,n.dataset])}),a.hasClass("root")&&(r=r.next("ul")).animateClosed(),a.parent().removeClass("branch-expanded").addClass("branch-collapsed"),this.updateState(a,!1,null,"collapse")},render:function(e){var t=this,i=this.settings,n=i.legend,a=e.children,r=[],o={legend:"<legend><ul></ul></legend>",chart:'<ul class="container"><li class="chart"></li></ul>',toplevel:i.paging?'<ul class="child-nodes"></ul>':'<ul class="top-level"></ul>',sublevel:i.paging?"":'<ul class="sub-level"></ul>'};$("#"+this.settings.rootId).append(o.chart);var l=$("#"+this.settings.rootId+" .chart");if(0!==n.length){$("#"+this.settings.rootId).prepend(o.legend);var d=$("#"+this.settings.rootId+" legend");this.createLegend(d)}if(this.isSingleChildWithChildren()&&$(l).addClass("has-single-child"),this.setColor(e),i.paging&&e.parentDataSet){var c=$('<div class="back"><button type="button" class="btn-icon hide-focus btn-back"><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-caret-left"></use></svg><span>Back</span></button></div>').appendTo(l);setTimeout(function(){return c.next($(".leaf")).addBack($(".back")).wrapAll('<div class="back-container"></div>')}),c.children("button").data(e),$(l).addClass("has-back")}if(e.isMultiRoot){var h='<div class="leaf multiRoot"><div><h2>'+e.multiRootText+"</h2></div></div>";h=s.sanitizeHTML(h),r.push(h),$(r[0]).addClass("root").appendTo(l)}else if(null!==e.ancestorPath&&void 0!==e.ancestorPath){e.ancestorPath.push(e.centeredNode);var u=""+e.ancestorPath.map(function(e){return" "+t.getTemplate(e)+" "}).join("");u=s.sanitizeHTML(u),r.push(u),$(r[0]).addClass("root ancestor").appendTo(l);var p=this.element.find(".leaf.root");p.each(function(i,s){t.updateState(s,!1,e.ancestorPath[i],"add"),i===p.length-1&&$(s).addClass("is-selected")})}else{var g=e.centeredNode,f=void 0;this.isStackedLayout()&&null!==g?f=this.getTemplate(g):this.isStackedLayout()||(f=this.getTemplate(e)),f&&(f=s.sanitizeHTML(f),r.push(f),$(r[0]).addClass("root is-selected").appendTo(l)),g&&null!==g?this.updateState(this.element.find(".leaf.root"),!0,g,void 0):this.updateState(this.element.find(".leaf.root"),!0,e,void 0)}function m(e,t,i){if(null!=t)for(var s=0,n=t.length;s<n;s++){w(e,t[s])}}if(a&&a.length>0)for(var v=0,b=a.length;v<b;v++){var y=e.children[v].children;if(this.isLeaf(a[v])&&!i.paging&&i.renderSubLevel?this.createLeaf(e.children[v],$(o.toplevel)):i.paging?this.createLeaf(e.children[v],$(o.toplevel)):this.createLeaf(e.children[v],$(o.sublevel)),null!=y){m(this,e.children[v].children)}}function w(e,t,i){Object.keys(t).forEach(function(i){if("children"===i){var s=t.id,n=t,a=t.children;return null!=a&&a.length>0&&e.add(s,n,a),m(e,a)}return!0})}var x=(this.element.find(".container").outerWidth()-$(window).width())/2;this.element.scrollLeft(x);var C=this.element.find(".top-level");0===this.element.find(".sub-level").length&&1===C.length&&C.addClass("no-sublevel")},isStackedLayout:function(){return this.settings.layout&&"stacked"===this.settings.layout},isSingleChildWithChildren:function(){if(this.isStackedLayout())return!1;var e=this.settings;if(e.dataset&&e.dataset[0]&&e.dataset[0].children){for(var t=e.dataset[0].children.length,i=0;t--;)e.dataset[0].children[t].isLeaf||i++;return 1===i}return!1},getTemplate:function(e){var t=We.compile("{{#dataset}}"+$("#"+s.stripTags(this.settings.templateId)).html()+"{{/dataset}}",{dataset:e});return setTimeout(function(){var t=$("#btn-"+s.stripTags(e.id));0!==t.length&&t.hideFocus().popupmenu()},1),$(t).prop("outerHTML")},createLegend:function(e){for(var t=this.settings,i=0,s=0,n=t.legend.length;s<n;s++){var a=t.legend[s].label,r=t.colorClass[s];s-1+1==4&&(e.append("<ul></ul>"),i++),e.children("ul").eq(i).append('<li>\n          <span class="key '+r+'"></span>\n          <span>'+a+"</span>\n        </li>")}},createLeaf:function(e,t){var i=this,n=$("#"+i.settings.rootId+" .chart",i.container),a=t.attr("class"),r=void 0!==a?$("#"+i.settings.rootId+" ."+a):t;function o(e){i.setColor(e);var n=i.getTemplate(e),a=i.settings.rootId,o=1===r.length?r:t,l=e.isExpanded||void 0===e.isExpanded?"branch-expanded":"branch-collapsed";if(e.isLeaf&&(l=""),1!==$("#"+a+" #"+e.id).length&&(o.append("<li class="+l+">"+$(n)[0].outerHTML+"</li>"),e.children)){for(var d="",c=0,h=e.children.length;c<h;c++){i.setColor(e.children[c]);var u=i.getTemplate(e.children[c]);e.children.length,d+="<li>"+$(u)[0].outerHTML+"</li>"}(o=$("#"+a+" #"+s.stripTags(e.id)).parent()).append("<ul>"+d+"</ul>");for(var p=e.children.length;p--;){var g=$("#"+a+" #"+s.stripTags(e.children[p].id));i.updateState(g,!1,e.children[p],void 0)}}}if(r.length<1&&("top-level"===a?t.insertAfter(".root"):t.appendTo(n)),e.length)for(var l=0,d=e.length;l<d;l++){e.length;o(e[l]),i.updateState($("#"+i.settings.rootId+" #"+s.stripTags(e[l].id)),!1,e[l],void 0)}else o(e),i.updateState($("#"+i.settings.rootId+" #"+s.stripTags(e.id)),!1,e,void 0)},setColor:function(e){var t=this,i=this.settings;if(this.setRootColor(e),this.isStackedLayout()&&(e.ancestorPath&&null!==e.ancestorPath&&e.ancestorPath.forEach(function(e){t.setRootColor(e)}),e.centeredNode&&null!==e.centeredNode&&this.setRootColor(e.centeredNode)),e.children&&!e.isRootNode)for(var s=0,n=e.children.length;s<n;s++)for(var a=0,r=i.legend.length;a<r;a++)e.children[s][i.legendKey]===i.legend[a].value&&(e.children[s].colorClass=i.colorClass[a])},setRootColor:function(e){for(var t=this.settings,i=0,s=t.legend.length;i<s;i++){if(e[t.legendKey]===t.legend[i].value){e.colorClass=t.colorClass[i];break}""===e[t.legendKey]&&(e.colorClass="default-color")}},isLeaf:function(e){var t=this.settings;return e.isLeaf?e.isLeaf:t.beforeExpand?e.isLeaf:!(e.children&&e.children.length>0)},updateState:function(e,t,i,s){if($.isEmptyObject($(e).data())&&i){var n=void 0===i?{}:i;$(e).data(n)}var a=this.settings,r=$(e).find(".btn"),o=a.paging?"caret-right":"caret-up",l=$(e).data();void 0===l&&void 0!==i&&(l=i),(l.children&&0!==l.children.length||"add"===s)&&(l.isExpanded=!0,l.isLoaded=!0),t&&(l.isRootNode=!0,l.isLoaded=!0),(void 0===l.isExpanded&&l.children||"expand"===s)&&(l.isExpanded=!0),void 0!==l.isExpanded&&"collapse"!==s||(l.isExpanded=!1),l.isExpanded?(r.find("svg.icon").changeIcon(o),r.addClass("btn-expand").removeClass("btn-collapse")):(r.find("svg.icon").changeIcon("caret-down"),r.addClass("btn-collapse").removeClass("btn-expand")),(l.isLeaf||l.isRootNode)&&r.addClass("btn-hidden"),l.isLeaf&&(l.isLoaded=!1,l.isExpanded=!1),("paging"===this.settings.layout||this.settings.paging)&&(l.parentDataSet=a.dataset),$(e).data(l)},reload:function(e){this.destroy(),this.element.hierarchy(e)},unbind:function(){this.element.empty()},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Qt)),this.unbind().init()},destroy:function(){this.unbind(),this.element.removeData("hierarchy")}},$.fn.hierarchy=function(e){return this.each(function(){var t=$.data(this,"hierarchy");t?t.updated(e):t=$.data(this,"hierarchy",new Zt(this,e))})};var ei={dataset:[],dropdownOpts:{},template:"<label>"+k.translate("FieldFilter")+'</label>\n    <select class="dropdown no-init field-filter-dropdown">\n      {{#dataset}}\n        <option\n          {{#value}} value="{{value}}"{{/value}}\n          {{#selected}} selected{{/selected}}\n          {{#disabled}} class="is-disabled" disabled{{/disabled}}\n          {{#icon}} data-icon="{{icon}}"{{/icon}}\n        >{{text}}</option>\n      {{/dataset}}\n    </select>'};function ti(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ei),this.init()}ti.prototype={init:function(){this.render(),this.handleEvents(),this.setFiltered()},render:function(e){var t=this.settings;if(e=e||t.dataset,"object"===(void 0===We?"undefined":u(We))&&e&&t.template){t.template instanceof $?t.template=""+t.template.html():"string"==typeof t.template&&(w.containsHTML(t.template)||(t.template=$("#"+t.template).html()));var i=We.compile(t.template,{dataset:t.dropdownOpts.source?[]:e}),s='<label for="ffdropdown-empty" class="audible">\n          '+k.translate("FieldFilter")+'\n        </label>\n        <select id="ffdropdown-empty" name="ffdropdown-empty" class="dropdown no-init field-filter-dropdown"></select>';e.length>0?this.element.before(i):0===e.length&&this.element.before(i||s);var n=this.element.attr("id")||this.element.attr("name");void 0===n&&(n=m.uniqueId(this.element,"fieldfilter-"),this.element[0].setAttribute("id",n));var a=n+"-ff";this.field=this.element.closest(".field");var r=k.isRTL();t.dropdownOpts=t.dropdownOpts||{},r&&"object"===u(t.dropdownOpts)&&(t.dropdownOpts.placementOpts?t.dropdownOpts.placementOpts.x=this.element.outerWidth():t.dropdownOpts.placementOpts={x:this.element.outerWidth()}),t.dropdownOpts.cssClass=t.dropdownOpts.cssClass?t.dropdownOpts.cssClass+" ffdropdown":"ffdropdown",t.dropdownOpts.noSearch=!0,this.ffdropdown=this.field.find("select.dropdown.field-filter-dropdown"),this.ffdropdown.dropdown(t.dropdownOpts).prev("label").addClass("audible"),this.ffdropdown[0].setAttribute("id",a),this.ffdropdown[0].setAttribute("name",a),this.ffdropdown.prev("label")[0].setAttribute("for",a),this.field.addClass("fieldfilter-wrapper").find("div.dropdown.field-filter-dropdown span").addClass("audible"),this.ddApi=this.ffdropdown.data("dropdown"),this.ddApi&&this.ddApi.icon&&this.ddApi.icon.addClass("ffdropdown-icon")}},setFiltered:function(){if(this.ddApi){var e=this.ddApi.element.find("option:selected");this.filtered=this.getTriggerData(e)}return this},getTriggerData:function(e){var t=this.settings,i=t.dropdownOpts.source&&this.ddApi?this.ddApi.dataset:t.dataset;return{idx:e.index(),item:e,data:i[e.index()]}},getFilterType:function(){return this.setFiltered(),this.filtered},setFilterType:function(e){if(this.ddApi){var t=-1,i=this.settings,s=i.dropdownOpts.source&&this.ddApi?this.ddApi.dataset:i.dataset;if("number"==typeof e&&e>-1&&e<s.length)t=e;else if("string"==typeof e){var n=this.ffdropdown.find('option[value="'+e+'"]');n.length||(n=this.ffdropdown.find("option").filter(function(){return $(this).text()===e})),n.length&&(t=n.index())}-1!==t&&t!==this.ffdropdown[0].selectedIndex&&(this.ffdropdown[0].selectedIndex=t,this.ddApi.updated(),this.ffdropdown.triggerHandler("change"),this.setFiltered(),this.element.triggerHandler("filtered",[this.filtered]))}},handleEvents:function(){var e=this;return this.ffdropdown.on("listopened.fieldfilter",function(){$("#dropdown-list ul").width(e.element.outerWidth()+52)}).on("selected.fieldfilter",function(t,i){var s=e.getTriggerData(i);e.element.triggerHandler("filtered",[s])}),this},readonly:function(){return this.ffdropdown.readonly(),this},enable:function(){return this.ffdropdown.enable(),this},disable:function(){return this.ffdropdown.disable(),this},unbind:function(){return this.ffdropdown.off(".fieldfilter"),this.ddApi&&"function"==typeof this.ddApi.destroy&&this.ddApi.destroy(),this.ffdropdown.add(this.ffdropdown.prev("label")).remove(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element[0],e,ei)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"fieldfilter")}},$.fn.fieldfilter=function(e){return this.each(function(){var t=$.data(this,"fieldfilter");t?t.updated(e):t=$.data(this,"fieldfilter",new ti(this,e))})};var ii={};function si(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ii),this.init(),A("FieldOptions")}si.prototype={init:function(){this.setElements(),this.handleEvents()},setElements:function(){var e=this;this.isFirefox="firefox"===l.browser.name,this.isSafari="safari"===l.browser.name,this.field=this.element.closest(".field, .radio-group"),this.targetElem=this.element;var t=this.field.find("label");return t&&(this.label=t),this.element[0].className.match(/(dropdown|multiselect)/)&&(this.targetElem=this.element.data("dropdown").pseudoElem),this.element[0].className.match(/(fileupload)/)&&(this.targetElem=this.field.find('.fileupload[type="text"]')),this.field.addClass("is-fieldoptions"),this.fieldParent=this.element.closest(".field").parent(),this.trigger=this.field.find(".btn-actions"),this.isFirefox&&this.trigger.length&&(this.trigger[0].contentEditable=!0,this.trigger.on("keydown.fieldoptions",function(e){9!==(e.which||e.keyCode||e.charCode||0)&&(e.preventDefault(),e.stopPropagation())})),setTimeout(function(){e.popupmenuApi=e.trigger.data("popupmenu"),e.popupmenuApi&&(e.popupmenuApi.settings.returnFocus=!1,e.popupmenuApi.settings.offset.y=10)},100),this},handleEvents:function(){var e=this,t=this,i=this.element.data("datepicker"),s=this.element.data("timepicker"),n=this.element.data("dropdown"),a=this.element.data("lookup")||this.element.hasClass("lookup"),r=this.element.is(".checkbox"),o=this.element.is(".fileupload"),d=this.element.is(".searchfield"),c=this.element.is(".colorpicker"),h=this.element.closest(".radio-group").length>0,u=this.element.is(".data")&&this.element.closest(".summary-form").length>0,p=function(e){return $(":focus").is(e)},g=function(t){(t||e.element).addClass("is-focused")},f=function(t){(t||e.element).removeClass("is-focused")},m=function(){t.element.add(t.trigger).add(t.field).add(t.fieldParent).addClass("is-active")},v=function(){t.element.add(t.trigger).add(t.field).add(t.fieldParent).removeClass("is-active")},b=function(t){var r=!p(e.element);return r=!e.trigger.is(t.relatedTarget)&&r,r=!e.trigger.is(".is-open")&&r,r=(!i||!i.isOpen())&&r,r=(!s||!s.isOpen())&&r,r=!$(t.relatedTarget).prev().is(e.element)&&r,r=(!n||!n.isOpen())&&r,r=!(a&&a.modal&&a.modal.isOpen())&&r,r=(!c||!e.element.is(".is-open"))&&r},y=function(t){t.trigger&&t.trigger.off("show.fieldoptions").on("show.fieldoptions",function(){m()}).off("hide.fieldoptions").on("hide.fieldoptions",function(t){b(t)&&(v(),e.element.removeClass("is-open"))})},w=function(){e.trigger.css({top:function(){var t=e.element.height(),i=void 0;if(u){var s=parseInt(e.element.css("line-height"),10);t>s?(e.element.css({"margin-bottom":"","padding-bottom":""}),i=(t-s)/2*-1):(e.element.css({"margin-bottom":"8px","padding-bottom":"12px"}),i=6)}else h&&(i=(t-e.trigger.height())/2*-1);return i}()-1+"px"})};return l.features.touch?(this.field.addClass("visible"),this.trigger.on("beforeopen.fieldoptions",function(t){var a;(a=p(e.element),a=(!i||!i.isOpen())&&a,a=(!s||!s.isOpen())&&a,a=(!n||!n.isOpen())&&a)&&m()}).on("close.fieldoptions",function(e){b(e)&&v()})):(this.field.removeClass("visible"),this.field.on("mouseover.fieldoptions",function(){t.element.prop("disabled")||t.element.closest("is-disabled").length||t.field[0].className.indexOf("visible")<0&&t.field[0].classList.add("visible")}).on("mouseout.fieldoptions",function(){t.field[0].className.indexOf("visible")>-1&&t.field[0].classList.remove("visible")})),n&&setTimeout(function(){var t=e.trigger.data("popupmenu");t&&t.menu.closest(".popupmenu-wrapper").css({"z-index":"4502"})},0),(i||s)&&y(i||s),s&&(s.settings.returnFocus=!1),(a||c)&&(this.field.on("click.fieldoptions",".lookup-wrapper .trigger, .colorpicker-container .trigger",function(){m()}),c&&this.element.on("beforeopen.fieldoptions",function(){m()})),r&&(this.trigger.addClass("is-checkbox"),!l.features.touch&&this.isSafari&&this.field.on("click.fieldoptions",".checkbox-label",function(){m()}).on("mouseout.fieldoptions",".checkbox-label",function(){v()})),o&&(this.element.on("change.fieldoptions",function(){e.targetElem.focus()}),this.field.on("click.fieldoptions",".trigger, .trigger-close",function(){m()})),d&&setTimeout(function(){e.trigger.add(e.trigger.next(".popupmenu")).appendTo(e.element.closest(".searchfield-wrapper"))},0),u&&(w(),this.targetElem.add(this.trigger).on("keydown.fieldoptions",function(e){13===(e.which||e.keyCode||e.charCode||0)&&setTimeout(function(){m()},0)}),this.targetElem.attr("tabindex",0).on("click.fieldoptions",function(){m()}),$(document).on("click.fieldoptions",function(t){$(t.target).is(e.element)||v()}),$("body").on("resize.fieldoptions",function(){w()})),h&&(w(),this.element.on("focusin.fieldoptions",".radio",function(){var t=e.isSafari?200:0;g(),setTimeout(function(){m()},t)}).on("focusout.fieldoptions",".radio",function(){f()}),$("body").on("resize.fieldoptions",function(){w()})),this.targetElem.on("focusin.fieldoptions",function(){m(),h&&e.isSafari&&g()}).on("focusout.fieldoptions",function(t){var i=e.isSafari?200:0;h&&e.isSafari&&f(),setTimeout(function(){b(t)&&v()},i)}),this.trigger.on("focusin.fieldoptions click.fieldoptions",function(){m()}).on("focusout.fieldoptions",function(e){b(e)&&v()}).on("selected.fieldoptions",function(){e.popupmenuApi.settings.returnFocus=!0}).on("close.fieldoptions",function(e){b(e)&&v()}),(this.isSafari||o)&&(h&&this.element.attr("tabindex",0),this.targetElem.on("keydown.fieldoptions",function(t){9!==(t.which||t.keyCode||t.charCode||0)||t.shiftKey||(h?(e.targetElem.find(":checked, .radio:first").not(":disabled").focus(),e.targetElem.find(".radio").off("keydown.fieldoptions").on("keydown.fieldoptions",function(i){9!==(i.which||i.keyCode||i.charCode||0)||t.shiftKey||setTimeout(function(){e.trigger.focus()},0)})):e.trigger.focus(),m(),t.preventDefault(),t.stopPropagation())})),this.element.on("listopened.fieldoptions",function(){m()}).on("listclosed.fieldoptions",function(){v()}),this},enable:function(){return this.trigger.prop("disabled",!1),this},disable:function(){return this.trigger.prop("disabled",!0),this},unbind:function(){return this.field.off(["click.fieldoptions","mouseover.fieldoptions","mouseout.fieldoptions"].join(" ")),this.element.off(["beforeopen.fieldoptions","change.fieldoptions","focusin.fieldoptions","focusout.fieldoptions","listclosed.fieldoptions","listopened.fieldoptions"].join(" ")),this.trigger.off(["beforeopen.fieldoptions","click.fieldoptions","focusin.fieldoptions","focusout.fieldoptions","selected.fieldoptions","close.fieldoptions"].join(" ")),this.targetElem.off(["click.fieldoptions","keydown.fieldoptions"].join(" ")),$("body").off(["resize.fieldoptions"].join(" ")),$(document).off(["click.fieldoptions"].join(" ")),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,ii)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"fieldoptions")}},$.fn.fieldoptions=function(e){return this.each(function(){var t=$.data(this,"fieldoptions");t?t.updated(e):t=$.data(this,"fieldoptions",new si(this,e))})};var ni={};function ai(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ni),this.init()}ai.prototype={init:function(){this.build()},build:function(){var e=this,t=this,i=this.element,s=!i.is("input.fileupload");this.fileInput=s?i.find("input"):i,i.closest(".field").addClass("field-fileupload");var n=i.find("input").attr("name");s||(n=i.attr("id")||i.attr("name"));var a=s?i.find("input").attr("class"):i.attr("class");a=a?" "+a:"";var r=k.translate("FileUpload"),o=$('<label for="'+n+'-filename">'+i.text()+' <span class="audible">'+r+"</span></label>"),d=$('<input readonly id="'+n+'-filename" class="fileupload-background-transparent'+a+'" type="text">'),c='<span class="trigger" tabindex="-1">'+$.createIcon("folder")+"</span>",h='<span class="trigger-close" tabindex="-1">'+$.createIcon("close")+"</span>";if(s)i.before(o,d),this.fileInput.after(h),this.fileInput.after(c);else{var u=i.prev("label");0===u.length&&(u=i.parent().prev("label")),o=$('<label for="'+(i.attr("id")||i.attr("name"))+'-filename">'+u.text()+"</label>"),i.before(o,d),this.fileInput.after(h),this.fileInput.after(c),u.addClass("audible").append('<span class="audible">'+r+"</span>")}var p=this.fileInput.attr("value");p&&p.length>0&&(d.val(p),this.fileInput.attr("value","")),this.textInput=d,this.svg=i.parent().find(".trigger"),this.svgClose=i.parent().find(".trigger-close"),this.textInput.on("keydown.fileupload",function(t){var s=!1;13===t.which||32===t.which?(i.parent().find('[type="file"]').trigger("click"),s=!0):8===t.which&&(l.browser.isIE11()&&t.preventDefault(),e.clearUploadFile(),s=!0),s&&t.stopPropagation()}),this.svg.on("click.fileupload",function(t){e.fileInput.trigger("click"),s&&e.fileInput.data("handleEvent"+[t.type||""],t.handleObj)}),this.svgClose.on("click.fileupload",function(t){e.clearUploadFile(),s&&e.fileInput.data("handleEvent +"+[t.type||""],t.handleObj)}),this.fileInput.is(":disabled")&&this.textInput.prop("disabled",!0),i.hasClass("required")&&(o.addClass("required"),i.removeClass("required")),this.fileInput.attr("data-validate")&&(this.textInput.attr("data-validate",this.fileInput.attr("data-validate")),this.textInput.validate()),this.fileInput.attr("readonly")&&(this.textInput.prop("disabled",!1),this.textInput[0].classList.remove("fileupload-background-transparent"),this.fileInput.attr("disabled","disabled")),this.fileInput.on("change.fileupload",function(){this.files.length>0?(t.textInput.val(this.files[0].name).trigger("change"),t.svgClose.show().addClass("is-visible")):t.clearUploadFile()}),this.fileInput.on("click.fileupload",function(t){var i=e.fileInput.data("handleEvent"+[t.type||""]);i&&i.type===t.type&&"fileupload"===t.handleObj.namespace&&(e.fileInput.data("handleEvent"+[t.type||""],null),t.preventDefault())}),t.fileInput.css({position:"static",left:0}),setTimeout(function(){t.fileInput.css({position:"fixed",left:"-10000px"})},0)},clearUploadFile:function(){var e=this.fileInput.val();this.fileInput.add(this.textInput).val(""),this.svgClose.hide().removeClass("is-visible"),""!==e&&this.fileInput.triggerHandler("change")},unbind:function(){return this.svg.add(this.svgClose).off("click.fileupload"),this.fileInput.off("change.fileupload"),this.textInput.off("keydown.fileupload"),this.element.closest(".field-fileupload").removeClass("field-fileupload").find('>label:first, >[type="text"]:first, .trigger, .trigger-close, .icon-dirty, .msg-dirty').remove(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,ni)),this},destroy:function(){this.unbind(),$.removeData(this.element[0],"fileupload")},disable:function(){this.textInput.prop("disabled",!0),this.fileInput.prop("disabled",!0)},enable:function(){this.textInput.prop("disabled",!1).prop("readonly",!1),this.fileInput.removeAttr("disabled")},readonly:function(){this.textInput.prop("readonly",!0),this.fileInput.prop("disabled",!0),this.textInput.prop("disabled",!1),this.textInput.removeClass("fileupload-background-transparent")}},$.fn.fileupload=function(e){return this.each(function(){var t=$.data(this,"fileupload");t?t.updated(e):t=$.data(this,"fileupload",new ai(this,e))})};var ri={isStandalone:!0,standaloneClass:"standalone",allowedTypes:"*",maxFilesInProcess:99999,maxFileSize:-1,fileName:"myfile",isDisabled:!1,showBrowseButton:!0,send:null,textDropArea:null,textDropAreaWithBrowse:null,textBtnCancel:null,textBtnCloseError:null,textBtnRemove:null,errorAllowedTypes:null,errorMaxFileSize:null,errorMaxFilesInProcess:null};function oi(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ri),this.init()}oi.prototype={init:function(){this.build(),this.handleEvents()},build:function(){var e=this.settings,t=void 0,i=e.isStandalone?e.standaloneClass:"";if(e.textDropArea=e.textDropArea||k.translate("TextDropArea"),e.textDropAreaWithBrowse=e.textDropAreaWithBrowse||k.translate("TextDropAreaWithBrowse"),e.textBtnCancel=e.textBtnCancel||k.translate("TextBtnCancel"),e.textBtnCloseError=e.textBtnCloseError||k.translate("TextBtnCloseError"),e.textBtnRemove=e.textBtnRemove||k.translate("TextBtnRemove"),e.errorAllowedTypes=e.errorAllowedTypes||"<em>"+k.translate("Error")+"</em>: "+k.translate("ErrorAllowedTypes"),e.errorMaxFileSize=e.errorMaxFileSize||"<em>"+k.translate("Error")+"</em>: "+k.translate("ErrorMaxFileSize"),e.errorMaxFilesInProcess=e.errorMaxFilesInProcess||"<em>"+k.translate("Error")+"</em>: "+k.translate("ErrorMaxFilesInProcess"),this.element.is(".is-disabled")&&(e.isDisabled=!0),e.isDisabled&&(i+=" is-disabled"),e.showBrowseButton){var s="",a=m.uniqueId(this.element,"fileupload-adv-"),r=e.allowedTypes.split(/[\s|]+/g),o=e.maxFilesInProcess>1?" multiple":"";if(o+=e.isDisabled?" disabled":"",1===r.length)"*"!==r[0]&&(s="."+r[0]);else for(var l=0,d=r.length;l<d;l++)s+="."+r[l]+(l!==d-1?",":"");t='<div class="fileupload-wrapper '+i+'">\n          <div class="container drop-area">\n            '+$.createIcon("upload")+'\n            <label class="fileupload-adv-browse-lbl">\n              <span>'+e.textDropAreaWithBrowse+'</span>\n              <input type="file" name="'+a+'" accept="'+s+'"'+o+" />\n            </label>\n          </div>\n        </div>"}else t='<div class="fileupload-wrapper '+i+'">\n          <div class="container drop-area">\n            '+$.createIcon("upload")+"\n            <p>"+e.textDropArea+"</p>\n          </div>\n        </div>";n.append(this.element,t,"<div><svg><use><label><span><input>"),this.dropArea=$(".drop-area",this.element)},handleEvents:function(){var e=this,t=this,i=this.settings;if(this.dropArea.on("dragenter.fileuploadadvanced",function(e){t.element.triggerHandler("filesdragenter"),e.stopPropagation(),e.preventDefault(),i.isDisabled||$(this).addClass("hover")}).on("dragover.fileuploadadvanced",function(e){e.stopPropagation(),e.preventDefault()}).on("drop.fileuploadadvanced",function(e){var s=e.originalEvent.dataTransfer.files;e.preventDefault(),i.isDisabled||(t.element.triggerHandler("filesdroped",[s]),$(this).removeClass("hover is-focus"),$("span.msg",this.element).closest(".error").remove(),s.length+$(".progress",this.element).length>i.maxFilesInProcess?t.showError(i.errorMaxFilesInProcess):t.handleFileUpload(s))}),i.showBrowseButton&&!i.isDisabled){var s=this.dropArea.find(".fileupload-adv-browse-lbl"),n=s.find('input[type="file"]');s.click(function(e){$(e.target).is('.hyperlink, input[type="file"]')||e.preventDefault()}),n.hideFocus(),n.on("hidefocusremove.fileuploadadvanced",function(t){t.stopPropagation(),e.dropArea.addClass("is-focus")}).on("hidefocusadd.fileuploadadvanced",function(t){t.stopPropagation(),e.dropArea.removeClass("is-focus")}).on("change.fileuploadadvanced",function(e){e.stopPropagation(),t.handleFileUpload(this.files)})}$(document).on("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced",function(e){e.stopPropagation(),e.preventDefault(),"dragover"===e.type&&t.dropArea.removeClass("hover")})},handleFileUpload:function(e){for(var t=this.settings,i=t.fileName.replace("[]",""),s=0,n=e.length;s<n;s++)if(this.isFileTypeAllowed(e[s].name))if(-1!==t.maxFileSize&&e[s].size>t.maxFileSize)this.showError(t.errorMaxFileSize,e[s]);else{this.element.triggerHandler("beforecreatestatus",[e[s]]);var a=new FormData;a.append(i+"[]",e[s]);var r=this.createStatus(e[s]);r.container.find(".status-icon .action").focus(),this.element.triggerHandler("aftercreatestatus",[e[s]]),"function"==typeof t.send?t.send(a,r):this.sendFileToServer(a,r)}else this.showError(t.errorAllowedTypes,e[s]);t.showBrowseButton&&this.dropArea.find('.fileupload-adv-browse-lbl input[type="file"]').val("")},createStatus:function(e){var t=this,i=this,s=this.settings,n=$('<div class="container">\n        <div class="file-row">\n          <span class="status-icon">\n            <button type="button" class="btn-icon action">\n              '+$.createIcon({icon:"close",classes:["icon-close"]})+"\n              <span>"+s.textBtnCancel+'</span>\n            </button>\n          </span>\n          <span class="description">'+e.name+'</span>\n          <div class="l-pull-right">\n            <span class="size">'+this.formatFileSize(e.size)+'</span>\n          </div>\n        </div>\n        <div class="progress-row">\n          <span class="progress">\n            <span class="progress-bar" data-value="0"></span>\n          </span>\n        </div>\n      </div>'),a=$(".action",n).button(),r=$(".l-pull-right",n),o=$(".progress-bar",n).progress({animationLength:10});this.dropArea.after(n);return{file:e,container:n,setProgress:function(i){t.element.triggerHandler("fileprogress",[{file:e,progress:i}]),o.attr("data-value",i).triggerHandler("updated")},setAbort:function(i){a.on("click.fileuploadadvanced",function(){t.element.triggerHandler("fileaborted",[e]),i.abort(),a.off("click.fileuploadadvanced"),n.remove()})},setCompleted:function(t){n.addClass("completed"),a.after($.createIcon("check")),r.append('<button type="button" class="btn-icon action">\n          '+$.createIcon({classes:["icon-close"],icon:"close"})+"\n          <span>"+s.textBtnRemove+"</span>\n        </button>"),$(".action",r).button().on("click.fileuploadadvanced",function(){$(this).off("click.fileuploadadvanced"),n.remove(),t.remove()}),a.off("click.fileuploadadvanced"),a.add(o.closest(".progress-row")).remove(),i.element.triggerHandler("filecompleteuploading",[e])}}},sendFileToServer:function(e,t){var i={remove:function(){}},s=0,n=parseFloat(t.file.size),a=new $.fn.timer(function(){t.setCompleted(i)},n);$(a.event).on("update",function(e,i){s=Math.ceil(i.counter/n*100),t.setProgress(s)}),t.setAbort({abort:function(){}})},showError:function(e,t){var i=void 0,s=this.settings;i=e===s.errorMaxFilesInProcess?$('<div class="container error">\n          <div class="file-row">\n            <span class="status-icon">\n              <button type="button" class="btn-icon action">\n                '+$.createIcon({classes:["icon-close"],icon:"close"})+"\n                <span>"+s.textBtnCloseError+'</span>\n              </button>\n            </span>\n            <span class="msg">'+e+"</span>\n          </div>\n        </div>"):$('<div class="container error">\n          <div class="file-row">\n            <span class="status-icon">\n              <button type="button" class="btn-icon action">\n                '+$.createIcon({classes:["icon-close"],icon:"close"})+"\n                <span>"+s.textBtnCloseError+'</span>\n              </button>\n            </span>\n            <span class="description">'+t.name+'</span>\n            <div class="l-pull-right">\n              <span class="size">'+this.formatFileSize(t.size)+'</span>\n            </div>\n          </div>\n          <div class="msg">\n            <p>'+e+"</p>\n          </div>\n        </div>"),$(".action",i).button().on("click.fileuploadadvanced",function(){i.remove()}),this.dropArea.after(i)},isFileTypeAllowed:function(e){var t=this.settings.allowedTypes.toLowerCase().split(/[\s|]+/g),i=e.split(".").pop().toLowerCase();return!("*"!==this.settings.allowedTypes&&$.inArray(i,t)<0)},formatFileSize:function(e){var t=1e9,i=1e6,s=1e3;return"number"!=typeof e?"":e>=t?(e/t).toFixed(2)+" GB":e>=i?(e/i).toFixed(2)+" MB":(e/s).toFixed(2)+" KB"},enable:function(){this.settings.isDisabled=!1,this.unbind(),this.element.find(".fileupload-wrapper").removeClass("is-disabled").find('.fileupload-adv-browse-lbl input[type="file"]').removeAttr("disabled"),this.handleEvents()},disable:function(){this.settings.isDisabled=!0,this.unbind(),this.element.find(".fileupload-wrapper").addClass("is-disabled").find('.fileupload-adv-browse-lbl input[type="file"]').attr("disabled","disabled"),this.handleEvents()},unbind:function(){this.dropArea.find('.fileupload-adv-browse-lbl input[type="file"]').off("hidefocusremove.fileuploadadvanced hidefocusadd.fileuploadadvanced change.fileuploadadvanced"),this.dropArea.off("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced"),$(document).off("dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced"),$(".action",this.element).off("click.fileuploadadvanced")},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,ri)),this.unbind().init()},destroy:function(){this.unbind(),$(".fileupload-wrapper",this.element).remove(),$.removeData(this.element[0],"fileuploadadvanced")}},$.fn.fileuploadadvanced=function(e){return this.each(function(){var t=$.data(this,"fileuploadadvanced");t?t.updated(e):t=$.data(this,"fileuploadadvanced",new oi(this,e))})};var li={animate:!0,columns:3,easing:"blockslide",gutterSize:20,widgetWidth:360,widgetHeight:370,timeout:100};function di(e,t){this.settings=m.mergeSettings(e,t,li),this.element=$(e),this.init()}di.prototype={get state(){var e=this.rowsAndCols.length,t=e?this.rowsAndCols[0].length:0,i=this.settings;return-1===this.rowsAndCols[e-1].indexOf(!1)&&(e-=1),{rows:e,cols:t,containerHeight:i.gutterSize+(i.gutterSize+i.widgetHeight)*e,matrix:this.rowsAndCols}},init:function(){this.isTransitionsSupports=this.supportsTransitions(),this.initHeroWidget(),this.handleEvents(),this.resize(this,!1)},initColumns:function(e){e=e||0,this.rowsAndCols[e]=[];for(var t=0,i=this.settings.columns;t<i;t++)this.rowsAndCols[e][t]=!0},initHeroWidget:function(){var e=$(".hero-widget");e.length>1&&(e=e.not(":first").remove()),this.heroWidget=e},initRowsAndCols:function(){this.rowsAndCols=[],this.initColumns()},getAvailability:function(e){for(var t=!1,i={},s=this.rowsAndCols.length,n=0,a=s;n<a&&!t;n++)for(var r=0,o=!0,l=this.rowsAndCols[n].length;r<l&&!t;r++)if(this.rowsAndCols[n][r]&&e.w+r<=l){if(e.w>1&&l>r+1)for(var d=0;d<e.w;d++)if(!this.rowsAndCols[n][r+d]){o=!1;break}if(e.h>1&&s>n+1)for(var c=0;c<e.h;c++)if(!this.rowsAndCols[n+c][r]){o=!1;break}o&&(i.row=n,i.col=r,t=!0)}return Object.getOwnPropertyNames(i).length||(this.initColumns(s),i.row=s,i.col=0),i},fitBlock:function(e,t,i){var s=!0;if(i.x=t,i.y=e,1===i.w&&1===i.h)this.rowsAndCols[e][t]=!1;else if(1!==i.w)for(var n=e,a=i.h+e;n<a;n++)for(var r=t,o=i.w+t;r<o;r++)this.rowsAndCols[n]||this.initColumns(n),this.rowsAndCols[n][r]=!1;else for(var l=e,d=i.h+e;l<d;l++)for(var c=t,h=i.h+t;c<h;c++)this.rowsAndCols[l]||this.initColumns(l),this.rowsAndCols[l][t]=!1;for(var u=0,p=this.rowsAndCols[e].length;u<p;u++)this.rowsAndCols[e][u]&&(s=!1);s&&(this.rowsAndCols[e+1]||this.initColumns(e+1))},setBlocks:function(){var e=this.element.find(".card, .widget");this.blocks=[];for(var t=0,i=e.length;t<i;t++){var s=$(e[t]),n=s.hasClass("double-height")?2:1,a=void 0;a=s.hasClass("quad-width")?4:s.hasClass("triple-width")?3:s.hasClass("double-width")?2:1,this.blocks.push({w:a,h:n,elem:s,text:s.text()})}if(this.settings.columns>1)for(var r=0,o=0,l=0,d=this.blocks.length;r<d;r++)this.blocks[r].w>=this.settings.columns&&r&&l&&this.arrayIndexMove(this.blocks,r,o),(l+=this.blocks[r].w)>=this.settings.columns&&(l=0,o=this.blocks[o].w>=this.settings.columns?o+1:r)},arrayIndexMove:function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},resize:function(e,t){var i=4*e.settings.widgetWidth+3*e.settings.gutterSize,s=3*e.settings.widgetWidth+2*e.settings.gutterSize,n=2*e.settings.widgetWidth+e.settings.gutterSize,a=e.settings.widgetWidth,r=i,o=e.element.outerWidth(),l=o>=i,d=o>=s&&o<=i,c=o>=n&&o<=s,h=o<=n,u=this.element.attr("data-columns"),p=e.element.find("> .content");this.settings.columns=parseInt(u||this.settings.columns,10),l&&4===e.settings.columns&&(e.settings.columns=4,r=i),(d||l&&3===e.settings.columns)&&(e.settings.columns=3,r=s),c&&(e.settings.columns=2,r=n),h&&(e.settings.columns=1,r=a),p.length&&(p[0].style.marginLeft="-"+r/2+"px"),this.setBlocks(),this.initRowsAndCols();for(var g=0,f=e.blocks.length;g<f;g++){var m=e.blocks[g];m.elem.removeClass("to-single to-double to-triple"),m.w>e.settings.columns&&(m.w=e.settings.columns,1===e.settings.columns?m.elem.addClass("to-single"):2===e.settings.columns?m.elem.addClass("to-double"):3===e.settings.columns&&m.elem.addClass("to-triple"));var v=e.getAvailability(m),b=e.settings.widgetWidth+e.settings.gutterSize,y=b*e.settings.columns,w={left:k.isRTL()?y-(b*m.w+b*v.col):b*v.col,top:(e.settings.widgetHeight+e.settings.gutterSize)*v.row};if(t){var x=e.settings.easing;"blockslide"===x?e.isTransitionsSupports?(e.applyCubicBezier(m.elem,[.09,.11,.24,.91]),m.elem[0].style.left=w.left+"px",m.elem[0].style.top=w.top+"px"):m.elem.animate(w,e.settings.timeout):m.elem.animate(w,e.settings.timeout,x)}else m.elem[0].style.left=w.left+"px",m.elem[0].style.top=w.top+"px";e.fitBlock(v.row,v.col,m)}e.element.triggerHandler("resize",[e.settings.columns,e.state])},applyCubicBezier:function(e,t){var i="all .3s cubic-bezier("+t+")";e[0].style["-webkit-transition"]=i,e[0].style["-moz-transition"]=i,e[0].style["-ms-transition"]=i,e[0].style["-o-transition"]=i,e[0].style.transition=i},supportsTransitions:function(){var e=document.createElement("p").style,t="transition";if("string"==typeof e[t])return!0;var i=["Moz","webkit","Webkit","Khtml","O","ms"];t=t.charAt(0).toUpperCase()+t.substr(1);for(var s=0,n=i.length;s<n;s++)if("string"==typeof e[i[s]+t])return!0;return!1},refresh:function(e){e=void 0!==e?e:this.settings.animate,this.resize(this,e)},detachEvents:function(){$("body").off("resize.homepage"),$(".application-menu").off("applicationmenuopen.homepage applicationmenuclose.homepage")},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,li)),this.detachEvents().init()},destroy:function(){this.detachEvents(),$.removeData(this.element[0],"homepage")},handleEvents:function(){var e=this;$("body").on("resize.homepage",function(){e.resize(e,e.settings.animate)}),$(".application-menu").on("applicationmenuopen.homepage applicationmenuclose.homepage",function(){e.resize(e,e.settings.animate)})}},$.fn.homepage=function(e){return this.each(function(){var t=$.data(this,"homepage");t?t.updated(e):t=$.data(this,"homepage",new di(this,e))})};var ci=[".pager-first > .btn-icon",".pager-prev > .btn-icon",".pager-next > .btn-icon",".pager-last > .btn-icon",".pager-no > .btn-icon",".pager-count input",".pager-pagesize button"].join(", "),hi={componentAPI:void 0,type:"list",position:"bottom",activePage:1,hideOnOnePage:!1,source:null,pagesize:15,pagesizes:[15,25,50,75],showPageSizeSelector:!0,smallPageSizeSelector:!1,pageSizeSelectorText:"RecordsPerPage",onPageSizeChange:null,showFirstButton:!0,enableFirstButton:!0,showPreviousButton:!0,enablePreviousButton:!0,showNextButton:!0,enableNextButton:!0,showLastButton:!0,enableLastButton:!0,indeterminate:!1,onFirstPage:null,onPreviousPage:null,onNextPage:null,onLastPage:null,firstPageTooltip:"FirstPage",previousPageTooltip:"PreviousPage",nextPageTooltip:"NextPage",lastPageTooltip:"LastPage",pageSizeMenuSettings:{attachToBody:!1}};function ui(e,t){this.settings=m.mergeSettings(e,t,hi),this.settings.dataset=t.dataset,this.element=$(e),this.init()}ui.prototype={get state(){var e=0,t=1,i=void 0,s=void 0,n=void 0,a=this.settings.indeterminate,r=this.settings.pagesize,o=this.previousOperation,l=this.previousTrigger,d=this.settings.dataset;if(isNaN(this.serverDatasetTotal)){if(d&&d.length){if(e=d.length,this.isFilteredClientside)e=d.filter(function(e){return!e.isFiltered}).length}}else e=this.serverDatasetTotal;return this.grandTotal&&(n=this.grandTotal),t=a?999999999:e<1?1:Math.ceil(e/r),isNaN(this.filteredTotal)||(s=this.filteredTotal,a?t=999999999:i=s<1?1:Math.ceil(s/r)),{activePage:this.activePage,indeterminate:this.settings.indeterminate,grandTotal:n,pagesize:r,pages:t,trigger:l,total:e,type:o,filteredActivePage:this.filteredActivePage,filteredTotal:s,filteredPages:i}},get pagingInfo(){return S("state","pagingInfo"),this.state},get focusableElements(){return m.getArrayFromList(this.pagerBar[0].querySelectorAll(ci))},get numberButtons(){if(!this.isTable){var e=this.pagerBar[0].querySelectorAll("li:not(.pager-prev):not(.pager-next):not(.pager-first):not(.pager-last):not(.pager-pagesize)");return m.getArrayFromList(e)}},get pageSelectorInput(){if(!this.isListView)return this.pagerBar[0].querySelector(".pager-count input")},get pageSizeSelectorButton(){if(this.settings.showPageSizeSelector)return this.pagerBar[0].querySelector(".pager-pagesize button")},get showSmallPageSizeSelector(){return!!this.settings.showPageSizeSelector&&(!0===this.settings.smallPageSizeSelector||this.isListView&&this.element.parents(".list-detail").length)},init:function(){this.setup(),this.createPagerBar(),this.setActivePage(this.settings.activePage,!0),this.handleEvents()},setup:function(){if(this.element.attr("data-pagesize")){var e=Number(this.element.attr("data-pagesize"));isNaN(e)||(this.settings.pagesize=e),this.element.removeAttr("data-pagesize")}if(-1===this.settings.pagesizes.indexOf(this.settings.pagesize)){this.settings.pagesizes.push(this.settings.pagesize),this.settings.pagesizes=this.settings.pagesizes.sort(function(e,t){return e-t})}this.handleDeprecatedSettings();var t=this.element.parents(".card, .widget");return this.element.is("tbody")&&(this.isTable=!0,this.settings.type="table",this.mainContainer=this.element.closest(".datagrid-container"),this.settings.componentAPI||(this.settings.componentAPI=this.mainContainer.data("datagrid")),t.length&&t[0].classList.add("has-datagrid")),this.element.is(".listview")&&(this.isTable=!1,this.isListView=!0,this.mainContainer=this.element,this.settings.componentAPI||(this.settings.componentAPI=this.element.data("listview"))),this},createPagerBar:function(){if(!this.pagerBar&&(this.pagerBar=this.element.prev(".pager-toolbar"),0===this.pagerBar.length&&(this.pagerBar=$('<ul class="pager-toolbar"></ul>')),"standalone"===this.settings.type?(this.pagerBar.addClass("is-standalone"),this.isListView?this.mainContainer.after(this.pagerBar):this.element.append(this.pagerBar)):this.isTable?this.mainContainer.after(this.pagerBar):"bottom"===this.settings.position?this.element.after(this.pagerBar):this.element.before(this.pagerBar),this.isListView&&this.pagerBar.addClass("is-listview"),this.element.closest(".card, .widget").length)){var e=this;["widget","card"].forEach(function(t){var i=e.element.closest("."+t+"-content");if(i.length){var s=i.next("."+t+"-footer");s.length||(s=$('<div class="'+t+'-footer"></div>').insertAfter(i)),e.pagerBar.appendTo(s)}})}},handleDeprecatedSettings:function(){void 0!==this.settings.attachPageSizeMenuToBody&&(S("pageSizeMenuSettings.attachToBody (setting)","attachPageSizeMenuToBody (setting)"),this.settings.pageSizeMenuSettings.attachToBody=this.settings.attachPageSizeMenuToBody,delete this.settings.attachPageSizeMenuToBody)},handleEvents:function(){var e=this;this.pagerBar.on("click.pager",".btn-icon",function(t){var i=t.currentTarget,s=i.parentNode;if(t.preventDefault(),$(this).attr("disabled"))return!1;var a=e.state,r=a.activePage;if(a.filteredTotal&&(r=a.filteredActivePage),n.hasClass(s,"pager-prev"))return e.setActivePage(r-1,!1,"prev"),e.triggerPagingEvents(r),!1;if(n.hasClass(s,"pager-next"))return e.setActivePage((-1===r?1:r)+1,!1,"next"),e.triggerPagingEvents(r),!1;if(n.hasClass(s,"pager-first"))return e.setActivePage(1,!1,"first"),e.triggerPagingEvents(r),!1;if(n.hasClass(s,"pager-last"))return e.setActivePage(e.pageCount(),!1,"last"),e.triggerPagingEvents(r),!1;var o=Number(i.getAttribute("data-page"));return(isNaN(o)||o<1)&&(o=1),e.setActivePage(o,!1,"page"),e.triggerPagingEvents(r),!1}),e.pagerBar.on("keydown.pager",$(e.focusableElements),function(e){var t=(e=e||window.event).which||e.keyCode||e.charCode||!1,i=37===t||40===t,s=39===t||38===t,n=e.target;if("INPUT"===n.nodeName&&(i=40===t,s=38===t),!i&&!s)return!0;var a="INPUT"===n.nodeName?n.parentNode.parentNode:n.parentNode,r=a.nextSibling,o=a.previousSibling,l=null===o,d=null===r;if(e.preventDefault(),i&&!l){var c=o.querySelector("button, input");return c.removeAttribute("tabindex"),n.setAttribute("tabindex","-1"),c.focus(),!1}if(i&&l){var h=a.parentNode.lastChild.querySelector("button, input");return h.removeAttribute("tabindex"),n.setAttribute("tabindex","-1"),h.focus(),!1}if(s&&!d){var u=r.querySelector("button, input");return u.removeAttribute("tabindex"),n.setAttribute("tabindex","-1"),u.focus(),!1}if(s&&d){var p=a.parentNode.firstChild.querySelector("button, input");p.removeAttribute("tabindex"),n.setAttribute("tabindex","-1"),p.focus()}return!1})},reset:function(e,t){this.activePage=this.settings.activePage,this.previousOperation=e,this.previousTrigger=t,this.teardown(),this.init()},showPageSizeSelector:function(e){e="true"===(""+e).toLowerCase(),this.settings.showPageSizeSelector=e,e&&(this.isShowPageSizeSelectorCall=e)},showButton:function(e,t){if(-1!==["first","last","next","previous"].indexOf(e)){var i=".pager-"+e+" .btn-icon";"previous"===e&&(i=".pager-prev .btn-icon");var s=this.pagerBar[0].querySelector(i);t="true"===(""+t).toLowerCase(),this.settings["show"+w.capitalize(e)+"Button"]=t,s&&(t?s.parentNode.classList.remove("hidden"):s.parentNode.classList.add("hidden"))}},enableButton:function(e,t){if(-1!==["first","last","next","previous"].indexOf(e)){var i=".pager-"+e+" .btn-icon";"previous"===e&&(i=".pager-prev .btn-icon");var s=this.pagerBar[0].querySelector(i);t="true"===(""+t).toLowerCase(),this.settings["enable"+w.capitalize(e)+"Button"]=t,s&&(t?(s.disabled=!1,s.parentNode.classList.remove("is-disabled"),$(s).removeAttr("disabled")):(s.disabled=!0,s.parentNode.classList.add("is-disabled"),$(s).attr("disabled","disabled")))}},setActivePage:function(e,t,i){var s="number"==typeof e.searchActivePage||"number"==typeof e.filteredActivePage||"number"==typeof this.filteredActivePage,n=this.filteredActivePage||this.activePage||this.settings.activePage;return"object"===(void 0===e?"undefined":u(e))?n=s?e.filteredActivePage||e.searchActivePage:e.activePage?e.activePage:1:isNaN(e)||(n=e),s?this.filteredActivePage=n:this.activePage=n,this.previousOperation=i,this.render(),void 0===n||0===n||isNaN(n)||n===this.activePage&&!t?this.activePage:(this.settings.componentAPI&&this.settings.componentAPI.saveUserSettings&&this.settings.componentAPI.saveUserSettings(),n)},adjustPageCount:function(e){var t=this.state,i="number"==typeof t.filteredActivePage||"number"==typeof this.filteredActivePage,s=t.pages;return i&&t.filteredPages&&(s=t.filteredPages),(e<1||e>s)&&(e=this.filteredActivePage||this.activePage),e},pageCount:function(e){var t=this.isShowPageSizeSelectorCall;return delete this.isShowPageSizeSelectorCall,void 0===e&&this.settings.indeterminate&&(this._pageCount=this.settings.pagesize),void 0!==e||this.settings.source||t?(void 0!==e&&(this._pageCount=e),this._pageCount=this._pageCount||1,this.settings.indeterminate?999999999:this._pageCount):this._pageCount},renderButtons:function(){var e=this.activePage,t=this.state.pages,i="",s=!1,n=!1,a=!1,r=!1,o=!this.settings.enableFirstButton,l=!this.settings.enablePreviousButton,d=!this.settings.enableNextButton,c=!this.settings.enableLastButton,h=this.settings.indeterminate&&!0===this.firstPage,u=this.settings.indeterminate&&!0===this.lastPage,p=this.settings.dataset&&this.settings.dataset.length;this.state.filteredPages&&(e=this.state.filteredActivePage,t=this.state.filteredPages),this.settings.showFirstButton&&((h||!this.settings.indeterminate&&"standalone"!==this.settings.type&&1===e)&&(o=!0),s=!0),this.settings.showPreviousButton&&((h||!this.settings.indeterminate&&"standalone"!==this.settings.type&&1===e)&&(l=!0),n=!0),this.settings.showNextButton&&((u||!this.settings.indeterminate&&"standalone"!==this.settings.type&&e===t)&&(d=!0),a=!0),this.settings.showLastButton&&((u||!this.settings.indeterminate&&"standalone"!==this.settings.type&&e===t)&&(c=!0),r=!0);var g=[],f=this.settings.showPageSizeSelector?190:0,m=(this.pagerBar.width()-f)/40,v=Math.floor(m);if((n||a)&&(v-=1),(r||s)&&(v-=1),!this.isTable&&"standalone"!==this.settings.type&&p&&v>=t&&(o=!0,c=!0),!this.settings.indeterminate){for(var b=Math.floor(v/2),y=e-b,w=e+b;y<1;)++y,w<t&&++w;for(;w>t;)y>1&&--y,--w;for(var x=y;x<w+1;x++)g.push(x)}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments[2],s=arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o="",l="",d="",c="",h="";return s&&(h=' data-page="'+s+'"'),i&&(c=' title="'+i+'"'),arguments.length>7&&void 0!==arguments[7]&&arguments[7]&&(n+=" hidden"),a&&(n+=" selected",o=' aria-disabled="true"'),r&&(l=" disabled",o=' aria-disabled="true"',d='<div class="disabled-tooltip"'+c+"></div>",s||(c="")),'<li class="'+n+'">\n        <button type="button" class="btn-icon"'+c+h+o+l+">\n          "+d+"<span>"+t+"</span>\n          "+e+"\n        </button>\n      </li>"}if($(this.numberButtons).remove(),s&&(i+=C($.createIcon({icon:"first-page"}),k.translate("FirstPage"),this.settings.firstPageTooltip,null,"pager-first",!1,o,!1)),n&&(i+=C($.createIcon({icon:"previous-page"}),k.translate("PreviousPage"),this.settings.previousPageTooltip,null,"pager-prev",!1,l,!1)),!this.isTable&&p){var T="";g.forEach(function(t){T+=t===(e||1)?C(t,k.translate("PageOn"),null,t,"pager-no",!0,!1,!1):C(t,k.translate("Page"),null,t,"pager-no",!1,!1,!1)}),i+=T}a&&(i+=C($.createIcon({icon:"next-page"}),k.translate("NextPage"),this.settings.nextPageTooltip,null,"pager-next",!1,d,!1)),r&&(i+=C($.createIcon({icon:"last-page"}),k.translate("LastPage"),this.settings.lastPageTooltip,null,"pager-last",!1,c,!1)),this.pagerBar[0].innerHTML=i,r||s||this.settings.showPageSizeSelector?this.pagerBar[0].classList.remove("two-button"):this.pagerBar[0].classList.add("two-button"),this.pagerBar.children("li").find("> .btn-icon").button().tooltip(),this.pagerBar.children("li").find("> .btn-icon[disabled] .disabled-tooltip").tooltip()},renderPageSelectorInput:function(){if(this.isTable&&!this.settings.indeterminate){var e=this.activePage,t=this.state.pages||1;if(this.state.filteredPages&&(e=this.state.filteredActivePage,t=this.state.filteredPages),this.pageSelectorInput)t>1&&this.pagerBar.find(".pager-total-pages").text(t),this.pagerBar.find(".pager-count input").val(e);else{var i=k.translate("PageOf");i=(i=i.replace("{0}",'<input class="new-mask" name="pager-pageno" value="'+e+'" autocomplete="off">')).replace("{1}",'<span class="pager-total-pages">'+t+"</span>"),$('<li class="pager-count"><label>'+i+" </label>").insertAfter(this.pagerBar.find(".pager-prev"))}var s=null,n=(""+t).replace(/\d/g,"#"),a=this,r={pattern:n,mode:"number",processOnInitialize:!1};$(this.pageSelectorInput).mask(r).on("focus",function(){s=parseInt($(this).val(),10)}).on("blur",function(){o($(this)),s=null}).on("keydown",function(e){return 13!==e.which||(o($(this)),e.stopPropagation(),e.preventDefault(),!1)})}function o(e){var t=a.adjustPageCount(parseInt(e.val(),10));if(s!==t){var i=a.activePage;a.state.filteredPages&&(i=a.state.filteredActivePage),e.val(a.setActivePage(t,!1,"page")),a.triggerPagingEvents(i)}else e.val(s)}},renderPageSizeSelectorButton:function(){var e=this;if(this.settings.showPageSizeSelector&&!(this.settings.pagesizes.length<2)){if(!this.pageSizeSelectorButton){var t=$('<li class="pager-pagesize"></li>'),i=$.createIcon({icon:"dropdown"}),s=k.translate(this.settings.pageSizeSelectorText).replace("{0}",this.settings.pagesize),n="",a="<span>"+s+"</span>";this.showSmallPageSizeSelector&&(n=' class="audible"',s=k.translate(this.settings.pageSizeSelectorText).replace("{0}",""),a='<span class="record-count">'+this.settings.pagesize+"</span>\n        <span"+n+">"+s+"</span>");var r=$('<button type="button" class="btn-menu">\n        '+a+"\n        "+i+"\n      </button>").appendTo(t);t.appendTo(this.pagerBar);var o="";this.showSmallPageSizeSelector&&(o='<li class="heading">'+s+"</li>");for(var l=0;l<this.settings.pagesizes.length;l++){var d=this.settings.pagesizes[l];o+='<li class="'+(d===this.settings.pagesize?" is-checked":"")+'"><a href="#">'+d+"</a></li>"}var c=$('<ul class="popupmenu is-selectable">'+o+"</ul>");r.after(c)}var h=$(this.pageSizeSelectorButton),u=m.extend({},{placementOpts:{parent:h,parentXAlignment:k.isRTL()?"left":"right",strategies:["flip"]}},this.settings.pageSizeMenuSettings);h.popupmenu(u),h.on("selected.pager",function(t,i){e.changePageSize(i)})}},render:function(){var e=this.state,t=e.pages;e.filteredPages&&(t=e.filteredPages),this.pageCount(t),this.pageSizeSelectorButton&&this.teardownPageSizeSelector(),this.renderButtons(),this.renderPageSelectorInput(),this.renderPageSizeSelectorButton(),this.renderBar()},renderBar:function(e){var t=(e=e?m.extend({},this.state,e):this.state).activePage;e.filteredActivePage&&(t=e.filteredActivePage),this.settings.showFirstButton||this.showButton("first",!1),this.settings.enableFirstButton||this.enableButton("first",!1),this.settings.showPreviousButton||this.showButton("previous",!1),this.settings.enablePreviousButton||this.enableButton("previous",!1),this.settings.showNextButton||this.showButton("next",!1),this.settings.enableNextButton||this.enableButton("next",!1),this.settings.showLastButton||this.showButton("last",!1),this.settings.enableLastButton||this.enableButton("last",!1),this.settings.showPageSizeSelector&&this.showPageSizeSelector(!0),void 0!==e.firstPage&&(!1===e.firstPage&&(this.enableButton("first",!0),this.enableButton("previous",!0)),!0!==e.firstPage&&1!==t||(this.enableButton("first",!1),this.enableButton("previous",!1))),void 0!==e.lastPage&&(!1===e.lastPage&&(this.enableButton("next",!0),this.enableButton("last",!0)),!0!==e.lastPage&&t!==this.pageCount()||(this.enableButton("next",!1),this.enableButton("last",!1))),this.hidePagerBar(e)&&this.pagerBar[0].classList.add("hidden"),this.initTabIndexes()},initTabIndexes:function(){var e=$(this.focusableElements);e.attr("tabindex","-1"),e.filter(":not([disabled])").first().removeAttr("tabindex")},triggerPagingEvents:function(e){var t=this.state;e||(e=this.state.activePage),"first"===t.type&&(this.settings.onFirstPage&&this.settings.onFirstPage(this,t),this.element.trigger("firstpage",t)),"prev"===t.type&&(this.settings.onPreviousPage&&this.settings.onPreviousPage(this,t),this.element.trigger("previouspage",t)),"next"===t.type&&(this.settings.onNextPage&&this.settings.onNextPage(this,t),this.element.trigger("nextpage",t)),"last"===t.type&&(this.settings.onLastPage&&this.settings.onLastPage(this,t),this.element.trigger("lastpage",t)),"pageinfo"!==t.type&&this.element.trigger("page",t)},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),Array.isArray(e.pagesizes)&&e.pagesizes.length&&(this.settings.pagesizes=e.pagesizes);var t={activePage:this.settings.activePage,indeterminate:this.settings.indeterminate,pagesize:this.settings.pagesize};return this.handleDeprecatedSettings(),this.updatePagingInfo(t),this},changePageSize:function(e){var t=e;t.closest(".popupmenu").find(".is-checked").removeClass("is-checked"),t.parent("li").addClass("is-checked"),this.settings.pagesize=parseInt(t.text(),10),this.settings.componentAPI&&(this.settings.componentAPI.settings.pagesize=this.settings.pagesize),this.setActivePage(1,!0,"first"),this.settings.onPageSizeChange&&this.settings.onPageSizeChange(this,{tag:e,pagesize:this.settings.pagesize,settings:this.settings}),this.element.trigger("pagesizechange",{tag:e,pagesize:this.settings.pagesize,settings:this.settings})},updatePagingInfo:function(e,t){if(e){if(e.pagesize&&(this.settings.pagesize=e.pagesize,this.isTable&&this.settings.componentAPI&&(this.settings.componentAPI.settings.pagesize=e.pagesize)),e.isFilteredClientside?(this.isFilteredClientside=!0,delete this.serverDatasetTotal):this.isFilteredClientside&&delete this.isFilteredClientside,delete this.firstPage,delete this.lastPage,void 0!==e.firstPage&&(this.firstPage=e.firstPage,this.settings.enableFirstButton=!e.firstPage,this.settings.enablePreviousButton=!e.firstPage),void 0!==e.lastPage&&(this.lastPage=e.lastPage,this.settings.enableNextButton=!e.lastPage,this.settings.enableLastButton=!e.lastPage),isNaN(e.grandTotal)||(this.grandTotal=e.grandTotal),this.isFilteredClientside||(this.serverDatasetTotal=e.total),isNaN(e.filteredTotal)?(this.filteredTotal||this.filteredActivePage)&&(delete this.filteredTotal,delete this.filteredActivePage):(this.filteredTotal=e.filteredTotal,this.filteredActivePage=e.searchActivePage||e.filteredActivePage||1),e.type||(e.type="pageinfo"),this.settings.source||this.settings.dataset)return this.setActivePage(e,!1,e.type),void("initial"===e.type||t||this.triggerPagingEvents());this.teardown(),this.render(),this.handleEvents()}},hidePagerBar:function(e){return!!(this.settings.hideOnOnePage&&e.total<=e.pagesize)||!(!0!==e.firstPage||!0!==e.lastPage||!e.hideDisabledPagers)},teardown:function(){this.numberButtons&&this.numberButtons.forEach(function(e){var t=e.querySelector(".btn-icon"),i=$(t).data("button"),s=$(t).data("tooltip");i&&i.destroy(),s&&s.destroy()}),this.pagerBar.off(["click.pager","keydown.pager"].join(" ")),this.pageSelectorInput&&($(this.pageSelectorInput).off(["focus.pager","blur.pager","keydown.pager"].join(" ")),$(this.pageSelectorInput).data("mask").destroy()),this.pageSizeSelectorButton&&($(this.pageSizeSelectorButton).off("selected.pager"),this.teardownPageSizeSelector()),this.pagerBar[0].innerHTML="",delete this.firstPage,delete this.lastPage},teardownPageSizeSelector:function(){var e=$(this.pageSizeSelectorButton).data("popupmenu");if(e&&e.menu){var t=e.menu;e.destroy(),t.remove()}},destroy:function(){this.teardown(),this.pagerBar&&this.pagerBar.remove(),$.removeData(this.element[0],"pager")}},$.fn.pager=function(e){return this.each(function(){var t=$.data(this,"pager");t?t.updated(e):t=$.data(this,"pager",new ui(this,e))})};var pi={dataset:[],template:null,description:null,paging:!1,pagesize:10,searchable:!1,highlight:!0,selectable:"single",selectOnFocus:!0,showCheckboxes:!0,hoverable:!0,emptyMessage:null,source:null,forceToRenderOnEmptyDs:!1,disableItemDeactivation:!1,showPageSizeSelector:!1,listFilterSettings:null,pagerSettings:{showFirstButton:!1,showLastButton:!1},searchTermMinSize:1,initializeContents:!1};function gi(e,t){return this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,pi),this.init(),this}gi.prototype={get pagerAPI(){return this.element.data("pager")},get pagerSettings(){var e={};this.settings.pagerSettings&&(e=this.settings.pagerSettings),e.dataset=this.settings.dataset,e.source=this.settings.source,e.type="list";for(var t=["pagesize","showPageSizeSelector"],i=0;i<t.length;i++)void 0===this.settings[t[i]]||e[t[i]]||(e[t[i]]=this.settings[t[i]]);return e},init:function(){this.setup(),this.handleEvents(),this.refresh(),this.selectedItems=[],this.lastSelectedItem=0,this.isSelectedAll=!1,this.sortInit("listview","click.listview","data-sortlist"),this.handleResize()},setup:function(){var e=this,t=this.element.closest(".card, .widget"),i=this.element.attr("data-selectable"),s=this.element.attr("data-select-onfocus");if(this.element.attr("data-pagesize")){var n=Number(this.element.attr("data-pagesize"));isNaN(n)||(this.settings.pagesize=n),this.element.removeAttr("data-pagesize")}if(!this.settings.dataset.length&&this.element.is("ul")&&this.element.children("li").length){var a=this.element.children("li");this.settings.template||(this.settings.template="{{#dataset}}<li>{{text}}</li>{{/dataset}}"),a.each(function(t,i){e.settings.dataset.push({text:$(i).text()})}),a.remove()}if(this.settings.dataset&&"string"==typeof this.settings.dataset){var r=window[this.settings.dataset];r&&r.length&&(this.settings.dataset=r)}i&&i.length&&(this.settings.selectable=i),s&&s.length&&(this.settings.selectOnFocus=JSON.parse(s)),this.actionButton=t.find(".btn-actions"),this.actionButton.length>0&&(this.actionButton.data("popupmenu")||this.actionButton.popupmenu()),this.element.attr({tabindex:"-1","x-ms-format-detection":"none"}),(this.element.is(".paginated")||!0===this.settings.paging)&&this.element.pager(this.pagerSettings);var o=this.element.parent(".card-content, .widget-content");if(o[0]&&(o[0].style.overflow="hidden"),this.settings.searchable){this.searchfield=this.element.parent().find(".searchfield, .autocomplete"),this.searchfield.length;var l={filterMode:"contains"};"object"===u(this.settings.listFilterSettings)&&(l=m.extend({},l,this.settings.listFilterSettings)),this.listfilter=new Ve(l)}this.settings.emptyMessage&&(this.emptyMessageContainer=$("<div>").emptymessage(this.settings.emptyMessage))},getTotals:function(e){var t={count:e.length},i=void 0;if(e[0]){for(i in e[0])t[i]=0;for(var s=0;s<e.length;s++)for(i in e[s])t[i]+=parseFloat(e[s][i]);return t}},render:function(e,t){var i=this,s="function"==typeof this.settings.source,a={},r=e,o=0,l=r?r.length:0,d=this.settings.pagesize,c=e.length;if((t&&(d=t.pagesize||d,c=t.filteredTotal||c),!s&&this.pagerAPI&&(this.renderPager(t,!0),t=this.pagerAPI.state),c>d)&&(this.filteredDataset?t.filteredPages:t.pages)>1){var h=t.activePage>0?t.activePage-1:0;this.filteredDataset&&(h=t.filteredActivePage-1),o=t.pagesize*h,l=t.pagesize*(h+1),r=e.slice(o,l)}if("object"===(void 0===We?"undefined":u(We))&&r&&this.settings.template){this.settings.template instanceof $?this.settings.template=""+this.settings.template.html():"string"==typeof this.settings.template&&(w.containsHTML(this.settings.template)||(this.settings.template=$("#"+this.settings.template).html())),this.settings.template.indexOf("{{#totals}}")>-1&&(a=this.getTotals(e));var p=We.compile(this.settings.template,{dataset:r,totals:a});r.length>0||this.settings.forceToRenderOnEmptyDs?this.element.html(p):i.emptyMessageContainer?(this.element.empty(),n.append(this.element,this.emptyMessageContainer[0].outerHTML,"<div><svg><use><span><b>")):0===r.length&&this.element.html(p||"<ul></ul>")}var g=this.element.closest(".card, .widget");$("ul",this.element).attr({role:"listbox","aria-label":this.settings.description||g.find(".card-title, .widget-title").text()||"List"});var f=this.element.find("li, tbody > tr").first(),m=this.element.find("li, tr"),v="multiple"===this.settings.selectable||"mixed"===this.settings.selectable;this.focusItem=f.attr("tabindex",0),this.settings.selectable||1!==f.find("a").length||f.removeAttr("tabindex");var b=m.length>r.length;m.each(function(e){var t=$(this);if(t.attr("role","option"),v){i.element.addClass("is-multiselect");var s=i.element.prevAll(".toolbar");s.length&&s.data("toolbar")&&s.data("toolbar").toggleMoreMenu(),i.settings.showCheckboxes&&0===t.children(".listview-selection-checkbox").length&&t.prepend('<label class="listview-selection-checkbox l-vertical-center inline inline-checkbox">\n              <input tabindex="-1" type="checkbox" class="checkbox">\n              <span class="label-text" role="presentation">\n                <span class="audible">'+k.translate("Checkbox")+" "+k.translate("NotSelected")+".</span>\n              </span>\n            </label>")}if(b){var n=o+e;if(n<i.settings.dataset.length){var a=i.settings.dataset[n];t.css("display",void 0===a.isFiltered||a.isFiltered?"":"none")}}else t.css("display","");t.attr({"aria-posinset":o+e+1,"aria-setsize":c}),t.hasClass("is-disabled")&&t.attr("aria-disabled","true"),i.settings.highlight&&i.searchTerm&&t.highlight(i.searchTerm)}),i.settings.initializeContents&&this.element.find("ul").initialize(),this.element.trigger("rendered",[r]),this.element.off("updated.listview").on("updated.listview",function(e,t){i.updated(t)})},renderPager:function(e,t){this.pagerAPI&&this.pagerAPI.updatePagingInfo(e,t)},getPageableElements:function(){var e=this.element.children();return e.is("ul")&&(e=e.children()),e},refresh:function(e,t){this.loadData(e,t),this.list&&this.render(this.list.data)},loadData:function(e,t,i){var s=!1,n=this;if(e=e||this.settings.dataset,this.filteredDataset&&(e=this.filteredDataset),t||(this.pagerAPI?(e.length!==this.pagerAPI.settings.dataset.length&&this.pagerAPI.updated({dataset:e}),t=this.pagerAPI.state):t={activePage:1}),this.filteredDataset?t.filteredTotal=e.length:t.total=e.length,Array.isArray(e)){var a=this.settings.source;if("string"!=typeof e||0!==e.indexOf("http")&&0!==e.indexOf("/")||(a=e,s=!0),!a&&!s||this.filteredDataset||i)this.render(e,t);else switch(void 0===a?"undefined":u(a)){case"function":a(t,r);break;case"string":return void(0!==a.indexOf("http")&&0!==a.indexOf("/")||$.getJSON(a,r));default:this.settings.dataset=a,e=a,this.render(a,t)}}function r(t,i){n.settings.dataset=t,e=t;var s=n.pagerAPI?n.pagerAPI.activePage:1;"string"==typeof i&&(i={activePage:s,pagesize:n.settings.pagesize,total:e.length,type:i}),n.pagerAPI&&(n.renderPager(i,!0),i=n.pagerAPI.state),n.render(e,i)}},toggleAll:function(){this[this.isSelectedAll?"deselectItemsBetweenIndexes":"selectItemsBetweenIndexes"]([0,$("li, tbody tr",this.element).length-1]),this.isSelectedAll=!this.isSelectedAll},selectItemsBetweenIndexes:function(e){this.clearSelection(),e.sort(function(e,t){return e-t});for(var t=e[0];t<=e[1];t++){var i=$("li, tbody tr",this.element).eq(t);i.is(".is-disabled, .is-selected")||this.select(i)}},deselectItemsBetweenIndexes:function(e){e.sort(function(e,t){return e-t});for(var t=e[0];t<=e[1];t++){var i=$("li, tbody tr",this.element).eq(t);!i.is(".is-disabled")&&i.is(".is-selected")&&this.select(i)}},clearSelection:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},handleResize:function(){var e=$("li .listview-heading, tr .listview-heading",this.element),t=e.eq(1),i=t.width();t.length&&i&&(e[0].style.width=i+"px"),this.pagerAPI&&this.pagerAPI.render()},handleSearch:function(e,t){this.filter(t)},filter:function(e){if(e){var t=(e=$(e)).val().trim(),i={searchActivePage:1};if(t){if(t.length<this.settings.searchTermMinSize)this.resetSearch();else if(this.searchTerm!==t){this.searchTerm=t,this.element.unhighlight(),this.settings.dataset.forEach(function(e){e.isFiltered=!1});var s=this.listfilter.filter(this.settings.dataset,this.searchTerm);s.length||(s=[]),i.filteredTotal=s.length,i.searchActivePage=1,s.forEach(function(e){e.isFiltered=!0}),this.filteredDataset=s,this.loadData(null,i),this.element.trigger("filtered",{elem:this.element,filteredResults:s,term:this.searchTerm})}}else{if(!this.searchTerm)return;this.resetSearch()}}},resetSearch:function(){this.element.unhighlight(),this.settings.dataset.forEach(function(e){delete e.isFiltered}),this.filteredDataset&&delete this.filteredDataset,this.searchTerm&&delete this.searchTerm;var e={activePage:1,filteredTotal:void 0,searchActivePage:void 0};this.refresh(null,e)},focus:function(e){e.is(":hidden")||e.is(".is-disabled")||(this.focusItem&&this.focusItem.removeAttr("tabindex"),this.focusItem=e.attr("tabindex",0).focus(),this.settings.selectable||1!==e.find("a").length||(e.find("a").focus(),e.removeAttr("tabindex")),this.settings.selectOnFocus&&"multiple"!==this.settings.selectable&&"mixed"!==this.settings.selectable&&this.select(e))},remove:function(e){"number"==typeof e&&(e=$(this.element.children()[0]).children().eq(e)),e.is(".is-selected")&&this.select(e,!0),e.remove()},clear:function(){$(this.element.children()[0]).empty()},removeAllSelected:function(){var e=this;$.each(this.selectedItems,function(t,i){e.remove(i)})},clearAllSelected:function(){var e=this;$.each(this.selectedItems,function(t,i){e.select(i)})},sortInit:function(e,t,i){i&&""!==$.trim(i)&&$("["+i+"]").each(function(){var s=$(this),n=$.fn.parseOptions(s,i);s.on(t,function(t){$(n.list).data(e).setSortColumn(n),t.preventDefault()})})},setSortColumn:function(e){var t=e.orderBy||this.list.sort.field,i=e.order;if(this.list.data||t){i=i?"desc"===i:!(this.list.sort&&this.list.sort[t]&&this.list.sort[t].reverse),(e.reloadApi||e.reloadApiNoSort)&&this.loadData(),e.reloadApiNoSort&&(t=this.list.sort.field,i=this.list.sort[t].reverse);var s=this.sortFunction(t,i);this.list.data.sort(s),this.render(this.list.data),this.list.sort={field:t},this.list.sort[t]={reverse:i},this.element.trigger("sorted",[this.element,this.list.sort])}},sortFunction:function(e,t,i){i||(i=function(e){return"string"==typeof(e=null==e?"":e)&&(e=e.toUpperCase(),isNaN(parseFloat(e))||(e=parseFloat(e))),e});var s=i?function(t){return i(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,i){return e=s(e),i=s(i),t*((e>i)-(i>e))}},deselect:function(e){"number"==typeof e&&(e=$(this.element.children()[0]).children().eq(e)),e.is(".is-selected")&&this.select(e)},unselect:function(e){return D(this.deselect,this.unselect).apply(this,[e])},select:function(e,t){var i,s=this,n="mixed"===s.settings.selectable;if(s.selectedItems=[],"number"==typeof e&&(e=$(this.element.children()[0]).children().eq(e)),i=e.hasClass("is-selected"),e.is('[tabindex="0"]')||(this.focusItem&&this.focusItem.removeAttr("tabindex"),e.attr("tabindex",0)),!1!==this.settings.selectable&&"false"!==this.settings.selectable){if("multiple"!==this.settings.selectable&&"mixed"!==this.settings.selectable&&(e.parent().children().removeAttr("aria-selected"),e.parent().find(".is-selected").removeClass("is-selected"),s.selectedItems[0]=$(this)),i?(s.selectedItems=[],e.removeClass("is-selected hide-selected-color")):this.settings.selectable&&(e.addClass("is-selected"+(n?" hide-selected-color":"")),s.lastSelectedItem=e.index()),e.parent().find(".is-selected").each(function(e){s.selectedItems[e]=$(this)}),e.find(".listview-selection-checkbox input").prop("checked",!i),"multiple"===this.settings.selectable||"mixed"===this.settings.selectable){var a=i?"NotSelected":"Selected";e.attr("aria-selected",!i),e.find(".label-text .audible").text(k.translate("Checkbox")+" "+a+".")}if(!t){for(var r=i?"unselected":"selected",o=[],l=0;l<this.selectedItems.length;l++){var d=this.selectedItems[l][0].getAttribute("aria-posinset");o.push(this.settings.dataset[d-1])}this.element.triggerHandler(r,{selectedItems:this.selectedItems,elem:e,selectedData:o}),"unselected"===r&&this.element.triggerHandler("deselected",{selectedItems:this.selectedItems,elem:e,selectedData:o})}var c=this.element.closest(".card, .widget");c.length||(c=this.element.parent());var h=c.find(".listview-toolbar, .contextual-toolbar"),u=h.data("toolbar");if(s.selectedItems.length>0){u&&u.toggleMoreMenu(),h.one("animateopencomplete",function(){s.element.addClass("is-toolbar-open"),h.trigger("recalculate-buttons").removeClass("is-hidden")}),h[0]&&(h[0].style.display="block"),h.animateOpen({distance:40});var p=h.find(".title, .selection-count");p&&p.length||(p=$('<div class="title selection-count"></div>'),h.prepend(p)),p.text(s.selectedItems.length+" "+(k?k.translate("Selected"):"Selected"))}else h.addClass("is-hidden").one("animateclosedcomplete",function(e){e.stopPropagation(),this.style.display="none",s.element.removeClass("is-toolbar-open")}).animateClosed()}},toggleItemActivation:function(e){e.hasClass("is-activated")?this.settings.disableItemDeactivation||this.deactivateItem(e):this.activateItem(e)},activateItem:function(e){var t="number"==typeof e?e:e.index(),i=this.element.find("li.is-activated");"number"==typeof e&&(e=this.element.find("ul").children().eq(e)),this.deactivateItem(i),!1!==this.element.triggerHandler("beforeactivate",[{index:t,elem:e,data:this.settings.dataset[t]}])&&(e.addClass("is-activated"),this.element.triggerHandler("itemactivated",[{index:t,elem:e,data:this.settings.dataset[t]}]))},activatedItem:function(){var e=this.element.find("li.is-activated"),t=e.index();return{index:t,elem:e,data:this.settings.dataset[t]}},deactivateItem:function(e){"number"==typeof e&&(e=this.element.find("ul").children().eq(e)),void 0===e&&(e=this.element.find("li.is-activated")),e.removeClass("is-activated");var t=e.index();t<0||this.element.triggerHandler("itemdeactivated",[{index:t,elem:e,data:this.settings.dataset[t]}])},getSelected:function(){return this.element.find(".is-selected")},updateSearch:function(){if(this.settings.searchable&&this.filteredDataset){delete this.filteredDataset,this.searchTerm&&delete this.searchTerm;var e=this.searchfield.data("searchfield");e&&e.xButton&&e.xButton.trigger("click")}},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset)),this.updateSearch(),this.refresh(e&&e.dataset?e.dataset:null),this},disable:function(){this.element.addClass("is-disabled")},enable:function(){this.element.removeClass("is-disabled")},teardown:function(){return $("body").off("resize.listview"),this.element.prev(".listview-header").off("click.listview"),this.searchfield&&this.searchfield.off(["contents-checked.searchable-listview","cleared.searchable-listview"].join(" ")),this.element.off("change.selectable-listview",".listview-checkbox input"),this.element.off("contextmenu.listview dblclick.listview","li, tr"),this.element.off("click.listview","li, tr, input[checkbox]"),this.element.off("keydown.listview","li, tr, a"),this.element.off("focus.listview","li, tbody tr"),this.element.off("focus.listview click.listview touchend.listview keydown.listview change.selectable-listview afterpaging.listview updated.listview").empty(),this.filteredDataset&&delete this.filteredDataset,this.searchTerm&&delete this.searchTerm,this},destroy:function(){this.teardown(),this.element.removeData("listview")},handleEvents:function(){var e=this,t=!1,i=!1,s="multiple"===e.settings.selectable||"mixed"===e.settings.selectable;if(this.element.off("focus.listview","li, tbody tr").on("focus.listview","li, tbody tr",function(s){var n=$(this);if(!(s.originalEvent&&s.originalEvent.target&&$(s.originalEvent.target).is(".icon-favorite"))){if(n.is(":first-child")&&n.hasClass("is-disabled")){var a=$.Event("keydown.listview");a.keyCode=40,t=!0,n.trigger(a)}t||n.hasClass("is-disabled")||!e.settings.selectOnFocus||"multiple"===e.settings.selectable||"mixed"===e.settings.selectable||(e.select(n),t=!0,i=!0)}}),this.element.off("keydown.listview","li, tr, a").on("keydown.listview","li, tr, a",function(t){var i=$(this),n=i.is("a")?i.closest("li"):$(this),a=n.is("a")?n.closest("ul"):n.parent(),r=t.keyCode||t.charCode||0,o=t.metaKey;if(0===n.index()&&38===t.keyCode)return!1;if((40===r||38===r)&&!o){var l=40===t.keyCode?n.nextAll(":not(.is-disabled):visible:first"):n.prevAll(":not(.is-disabled):visible:first");l.length&&($(t.target).is(n)||t.shiftKey||i.is("a"))&&e.focus(l),t.preventDefault(),t.stopPropagation()}if(35===r||40===r&&o){var d=a.children().last();return e.focus(d),t.stopPropagation(),!1}if(36===r||38===r&&o){var c=a.children().first();return e.focus(c),t.stopPropagation(),!1}return 32===r&&$(t.target).is(n)&&(s&&t.shiftKey?e.selectItemsBetweenIndexes([e.lastSelectedItem,n.index()]):e.select(n),t.preventDefault()),s&&(t.ctrlKey||t.metaKey)&&65===r&&(e.toggleAll(),e.focus(n),t.preventDefault()),!0}),this.settings.selectable){this.element.addClass("is-selectable");var n=$(this.element).closest(".list-detail, .builder");this.element.off("click.listview","li, tr, input[checkbox]").on("click.listview","li, tr, input[checkbox]",function(a){var r=$(this),o=$(a.target).closest(".listview-selection-checkbox").length>0,l="mixed"===e.settings.selectable,d=$(a.target);d.hasClass("icon-favorite")||d.hasClass("hyperlink")||(i||r.hasClass("is-disabled")||l&&!o||(t=!0,s&&a.shiftKey?(e.selectItemsBetweenIndexes([e.lastSelectedItem,r.index()]),a.preventDefault()):e.select(r),r.focus()),r.hasClass("is-disabled")||!l||o||(r.focus(),e.toggleItemActivation(r)),n.length>0&&$(window).outerWidth()<767&&!r.hasClass("is-disabled")&&!o&&e.element.trigger("drilldown",[r]),i=!1,a.preventDefault(),a.stopPropagation(),e.element.trigger("click",[{elem:r,data:e.settings.dataset[r.attr("aria-posinset")-1],index:r.index(),originalEvent:a}]))}),this.element.off("dblclick.listview","li, tr").on("dblclick.listview","li, tr",function(t){var i=$(this);return t.preventDefault(),t.stopPropagation(),e.element.trigger("dblclick",[{elem:$(this),data:e.settings.dataset[i.attr("aria-posinset")-1],index:i.index(),originalEvent:t}]),!1}),this.element.off("contextmenu.listview","li, tr").on("contextmenu.listview","li, tr",function(t){var i=$(this);return t.preventDefault(),t.stopPropagation(),e.element.trigger("contextmenu",[{elem:$(this),data:e.settings.dataset[i.attr("aria-posinset")-1],index:i.index(),originalEvent:t}]),!1})}this.settings.hoverable&&"false"!==this.settings.hoverable||(this.element.removeClass("is-selectable"),this.element.addClass("disable-hover")),this.settings.selectable&&"false"!==this.settings.selectable||(this.element.removeClass("is-selectable"),this.element.addClass("disable-hover")),"multiple"!==this.settings.selectable&&"mixed"!==this.settings.selectable||this.element.off("change.selectable-listview",".listview-checkbox input").on("change.selectable-listview",".listview-checkbox input",function(e){$(this).parent().trigger("click"),e.stopPropagation()}),this.settings.searchable&&this.searchfield.off("contents-checked.searchable-listview").on("contents-checked.searchable-listview",function(t){e.handleSearch(t,$(this))}).off("cleared.searchable-listview").on("cleared.searchable-listview",function(){e.resetSearch(),e.element.trigger("filtered",{elem:e.element,filteredResults:[],term:""})}),this.pagerAPI&&this.element.off("page.listview").on("page.listview",function(t,i){e.handlePageChange(i)}).off("pagesizechange.listview").on("pagesizechange.listview",function(t,i){e.handlePageSizeChange(i)}),$("body").off("resize.listview").on("resize.listview",function(t){e.handleResize(t)}),e.element.prev(".listview-header").off("click.listview").on("click.listview",function(){var t=$(this).find(".plus-minus");t.hasClass("active")?(t.removeClass("active"),e.element.animateClosed()):(t.addClass("active"),e.element.animateOpen())})},handlePageSizeChange:function(e){e.activePage=1,this.loadData(void 0,e)},handlePageChange:function(e){this.loadData(void 0,e)}},$.fn.listview=function(e){var t=$(this),i=t.attr("data-dataset"),s=t.attr("data-tmpl"),n=m.parseOptions(this)||{};n.dataset=n.dataset||i,n.template=n.template||s,window[n.dataset]&&(n.dataset=window[n.dataset]),n.template&&n.template.length&&(n.template=$("#"+n.template).html());var a=m.extend({},e,n);return this.each(function(){var e=$.data(this,"listview");e?e.updated(a):e=$.data(this,"listview",new gi(this,a))})};var fi={dataset:[],handle:".handle",btnAdd:"add",btnEdit:"edit",btnDelete:"delete",btnGoUp:"goup",btnGoDown:"godown",template:'<ul data-handle=".handle">{{#dataset}}{{#text}}<li{{#value}} data-value="{{value}}"{{/value}}{{#selected}} selected="selected"{{/selected}}{{#disabled}} class="is-disabled"{{/disabled}}><span class="handle" focusable="false" aria-hidden="true" role="presentation">&#8286;</span><div class="item-content"><p>{{text}}</p></div></li>{{/text}}{{/dataset}}</ul>',templateNewItem:'<li data-value="{{text}}" role="option"><span class="handle" focusable="false" aria-hidden="true" role="presentation">&#8286;</span><div class="item-content"><p>{{text}}</p></div></li>',templateItemContent:"<p>{{text}}</p>"};function mi(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,fi),t&&t.dataset&&(this.settings.dataset=t.dataset),this.init()}mi.prototype={init:function(){var e=this;this.loadListview().initDataset().setElements().handleEvents(),setTimeout(function(){e.setSelected()},0)},loadListview:function(){var e=this.settings,t=$(".listview",this.element);return!e.dataset.length&&t.length&&$("li",t).length?this.listApi=t.listview({selectable:"single"}).data("listview"):t.length&&(this.listApi=t.listview({dataset:e.dataset,template:e.template,selectable:"single"}).data("listview")),this},initDataset:function(){var e=this.settings,t=$(".listview li",this.element);this.dataset=[];for(var i=0,s=t.length;i<s;i++){var n=void 0,a=$(t[i]);e.dataset?(n=JSON.parse(JSON.stringify(e.dataset[i]))).node=a:n=this.extractNodeData(a),this.dataset.push(n)}return this},extractNodeData:function(e){var t={node:e,text:$.trim($(".item-content",e).text())},i=e.attr("data-value");return void 0!==i&&(t.value=i),t},setElements:function(){var e=this,t=this.settings,i=function(t){return e.isjQuery(t)?t:"string"==typeof t?$('[data-action="'+t+'"]',e.element):null};return t.btnAdd=i(t.btnAdd),t.btnGoUp=i(t.btnGoUp),t.btnGoDown=i(t.btnGoDown),t.btnEdit=i(t.btnEdit),t.btnDelete=i(t.btnDelete),this.topButtons=t.btnAdd.add(t.btnGoUp).add(t.btnGoDown).add(t.btnEdit).add(t.btnDelete),this.topButtons.tooltip(),this.ul=$(".listview ul",this.element),this.arrangeApi=this.ul.arrange({handle:t.handle,placeholder:t.templateNewItem}).data("arrange"),this},handleEvents:function(){var e=this,t=void 0,i=this,s=i.settings,n=function(e,t){e.off("click.listbuilder").on("click.listbuilder",function(){i[t]()})};return n(s.btnAdd,"addItem"),n(s.btnGoUp,"moveItemUp"),n(s.btnGoDown,"moveItemDown"),n(s.btnEdit,"editItem"),n(s.btnDelete,"deleteItem"),this.arrangeApi.element.on("beforearrange.listbuilder",function(t,i){var n=e.getDataByNode(i.start),a=s.templateItemContent.replace(/{{text}}/g,n.data.text);e.arrangeApi.placeholders.attr("data-value",n.data.text).find(".item-content").html(a)}).on("arrangeupdate.listbuilder",function(i,s){e.updateAttributes(),e.arrayIndexMove(e.dataset,s.startIndex,s.endIndex),(t=e.getDataByNode(s.end)).indexBeforeMove=s.startIndex,e.element.triggerHandler("arrangeupdate",[t])}),$("li:not(.is-disabled) "+this.arrangeApi.handle,this.ul).on("mousedown.listbuilder touchstart.listbuilder",function(){var e=$(this);e.is(".is-selected")||e.trigger("click")}),$(".listview",this.element).off("selected.listbuilder").on("selected.listbuilder",function(i,s){t=e.getDataByNode(s.elem[0]),e.element.triggerHandler("selected",[t])}),this.updatedEventsStr="arrangeupdate.listbuilder aftergoup.listbuilder aftergodown.listbuilder exiteditmode.listbuilder",this.element.off(this.updatedEventsStr).on(this.updatedEventsStr,function(t,i){e.element.triggerHandler("updated",[i])}),this},addItem:function(){var e=this,t=this.settings;$.when(this.element.triggerHandler("beforeadd")).done(function(){var i=void 0,s=void 0,n=0,a=e.listApi.selectedItems[0],r=t.templateNewItem.replace(/{{text}}/g,k.translate("NewItem"));a&&a.length>0?(n=(s=e.getDataByNode(a)).index+1,$(r).insertAfter(a),i=$("li",e.ul).eq(n)):(e.ul.prepend(r),i=$("li:first-child",e.ul)),e.dataset.push(e.extractNodeData(i)),e.arrayIndexMove(e.dataset,e.dataset.length-1,n),e.updateAttributes(),i.trigger("click"),e.arrangeApi.updated(),e.editItem(!0),s={index:n,data:e.dataset[n]},e.element.triggerHandler("afteradd",[s])})},moveItemUp:function(){var e=this,t=e.listApi.selectedItems[0];if(t&&t.length>0){var i=e.getDataByNode(t);void 0!==i.index&&i.index>0&&$.when(e.element.triggerHandler("beforegoup",[i])).done(function(){var s=t.prev();t.insertBefore(s),e.updateAttributes(),e.arrayIndexMove(e.dataset,i.index,i.index-1),i.indexBeforeMove=i.index,i.index--,e.element.triggerHandler("aftergoup",[i])})}},moveItemDown:function(){var e=this,t=e.listApi.selectedItems[0];if(t&&t.length>0){var i=e.getDataByNode(t);void 0!==i.index&&i.index<e.dataset.length-1&&$.when(e.element.triggerHandler("beforegodown",[i])).done(function(){var s=t.next();t.insertAfter(s),e.updateAttributes(),e.arrayIndexMove(e.dataset,i.index,i.index+1),i.indexBeforeMove=i.index,i.index++,e.element.triggerHandler("aftergodown",[i])})}},editItem:function(e){var t=this.listApi.selectedItems[0];t&&t.length>0&&(t.is(".is-editing")?this.commitEdit(t,e):this.makeEditable(t,e))},makeEditable:function(e,t){var i=this,n=i.getDataByNode(e),a=$(".item-content",e);void 0!==n.index&&n.index<i.dataset.length&&$.when(i.element.triggerHandler("beforeedit",[n])).done(function(){var r=s.escapeHTML((a.text().trim()||"").toString()),o=$('<input name="edit-input" class="edit-input" type="text" value="'+r+'" />');e.addClass("is-editing"),a.html(o),setTimeout(function(){o.focus().select()},0),o.on("click.listbuilder",function(){return!1}).on("blur.listbuilder",function(){return i.commitEdit(e,t)}).on("keypress.listbuilder",function(s){13===(s.keyCode||s.charCode||0)&&(i.commitEdit(e,t),e.focus())}),i.element.triggerHandler("entereditmode",[n])})},commitEdit:function(e,t){var i=this.settings,n=this.getDataByNode(e),a=$(".item-content",e),r=$(".edit-input",a);r.val(s.escapeHTML((r.val()||"").toString())),t&&(n.data.value=r.val()),n.data.text=r.val(),r.off("click.listbuilder blur.listbuilder keypress.listbuilder"),a.html(i.templateItemContent.replace(/{{text}}/g,r.val())),e.removeClass("is-editing"),this.element.triggerHandler("exiteditmode",[n])},deleteItem:function(){var e=this,t=e.listApi.selectedItems[0];if(t&&t.length>0){var i=e.getDataByNode(t);void 0!==i.index&&$.when(e.element.triggerHandler("beforedelete",[i])).done(function(){e.listApi.removeAllSelected(),e.updateAttributes(),e.dataset.splice(i.index,1),e.element.triggerHandler("afterdelete",[i])})}},getDataByNode:function(e){for(var t={},i=0,s=this.dataset.length;i<s;i++){var n=this.dataset[i];if($(n.node).is(e)){t={index:i,data:n};break}}return t},arrayIndexMove:function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},isjQuery:function(e){return e&&(e instanceof jQuery||e.constructor.prototype.jquery)},moveCursorToEnd:function(e){setTimeout(function(){if("number"==typeof e.selectionStart)e.selectionEnd=e.value.length,e.selectionStart=e.value.length;else if(void 0!==e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}},100)},updateAttributes:function(){for(var e=$("li",this.ul),t=0,i=e.length;t<i;t++)$(e[t]).attr({"aria-posinset":t+1,"aria-setsize":i})},updateDataset:function(e){var t=this,i=$("li",this.ul),s=$(".listview",this.element).data("listview");s.deselectItemsBetweenIndexes([0,i.length-1]),this.settings.dataset=e,s.loadData(this.settings.dataset),this.initDataset().setElements().handleEvents(),setTimeout(function(){t.setSelected()},0)},setSelected:function(){for(var e=$("li[selected]",this.ul),t=0,i=e.length;t<i;t++){var s=$(e[t]);s.removeAttr("selected"),s.is(".is-selected")||s.trigger("click")}return this},select:function(e){var t=this.getListItem(e);t&&!t.is(".is-selected")&&t.trigger("click")},unselect:function(e){var t=this.getListItem(e);t&&t.is(".is-selected")&&t.trigger("click")},getListItem:function(e){var t=$();if(this.isElement(e)&&$.contains(this.ul,e))t=this.isjQuery(e)?e:$(e);else{var i=parseInt(e,10),s=$("li",this.ul);!isNaN(i)&&i>-1&&i<s.length?t=s.eq(i):"first"===(""+e).toLowerCase()?t=s.first():"last"===(""+e).toLowerCase()&&(t=s.last())}return t.length<1?null:t.length>1?t.eq(0):t},isElement:function(e){return this.isjQuery(e)&&e.get(0)instanceof Element||e instanceof Element},enable:function(){this.element.removeClass("is-disabled").find(".toolbar .buttonset button").removeAttr("disabled").end().find(".toolbar .buttonset button[data-original-disabled]").attr("disabled","disabled").removeAttr("data-original-disabled"),this.ul.find("li").removeClass("is-disabled").end().find("li[data-original-disabled]").addClass("is-disabled").removeAttr("data-original-disabled")},disable:function(){this.element.addClass("is-disabled").find(".toolbar .buttonset button[disabled]").attr("data-original-disabled","disabled").end().find(".toolbar .buttonset button").attr("disabled","disabled"),this.ul.find("li.is-disabled").attr("data-original-disabled","is-disabled").end().find("li").addClass("is-disabled")},unbind:function(){if(this.element.off(this.updatedEventsStr),$(".listview",this.element).off("selected.listbuilder"),$("li "+this.arrangeApi.handle,this.ul).off("mousedown.listbuilder touchstart.listbuilder"),this.arrangeApi.element.off("beforearrange.listbuilder arrangeupdate.listbuilder").destroy(),this.topButtons.off("click.listbuilder"),this.topButtons)for(var e=0,t=this.topButtons.length;e<t;e++){var i=$(this.topButtons[e]).data("tooltip");i&&"function"==typeof i.destroy&&i.destroy()}return this.listApi&&"function"==typeof this.listApi.destroy&&this.listApi.destroy(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,fi)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"listbuilder")}},$.fn.listbuilder=function(e){return this.each(function(){var t=$.data(this,"listbuilder");t?t.updated(e):t=$.data(this,"listbuilder",new mi(this,e))})};var vi="modal",bi={trigger:"click",buttons:null,isAlert:!1,content:null,cssClass:null,autoFocus:!0,id:null,frameHeight:180,frameWidth:46,beforeShow:null,useFlexToolbar:!1,showCloseBtn:!1,maxWidth:null};function yi(e,t){this.settings=m.mergeSettings(e,t,bi),this.element=$(e),this.init(),this.reStructure()}yi.prototype={get isCAP(){return this.element.is(".contextual-action-panel")},get capAPI(){var e=void 0;return this.trigger&&this.trigger.length?e=this.trigger.data("contextualactionpanel"):this.mainContent.is("body")&&(e=this.mainContent.data("contextualactionpanel")),e},get isAttachedToBody(){return this.trigger.length&&this.trigger.is("body")},get visible(){return this.element.is(".is-visible")},get isOnTop(){var e=0,t=this.element;return $(".modal.is-visible").each(function(){e<this.style.zIndex&&(e=this.style.zIndex)}),e===t[0].style.zIndex},init:function(){var e=this;return this.id=this.element.attr("id")||parseInt($(".modal").length,10)+1,this.namespace=vi+"-"+this.id,this.settings.title=s.stripTags(this.settings.title,"<div><span><a><small><img><svg><i><b><use><br><strong><em>"),this.trigger=$('[data-modal="'+this.element.attr("id")+'"]'),this.element.is("body")&&(this.trigger=this.element),this.overlay||(this.overlay=$('<div class="overlay"></div>')),this.oldActive=this.trigger,"click"!==this.settings.trigger||this.isAttachedToBody||this.trigger.on("click."+e.namespace,function(t){$(t.currentTarget).is(e.trigger)&&e.open()}),"immediate"===this.settings.trigger&&setTimeout(function(){e.open()},1),e.isCancelled=!1,this.settings.content?(this.settings.trigger=this.settings.content instanceof jQuery?this.settings.trigger:"immediate",this.appendContent(),void setTimeout(function(){e.open()},1)):this.settings.beforeShow?(this.settings.trigger=this.settings.content instanceof jQuery?this.settings.trigger:"immediate",this.appendContent(),void this.callSource()):(e.addButtons(this.settings.buttons),this.element.appendTo("body"),void(this.element[0].style.display="none"))},appendContent:function(){var e=this,t=!1;if(this.element=$('<div class="modal"><div class="modal-content" style="max-width: '+(this.settings.maxWidth?this.settings.maxWidth:"")+'px"><div class="modal-header"><h1 class="modal-title">'+this.settings.title+'</h1></div><div class="modal-body-wrapper"><div class="modal-body"></div></div></div></div>'),this.settings.showCloseBtn){var i=$('\n        <button type="button" class="btn-icon btn-close" title="'+k.translate("Close")+'" aria-hidden="true">\n          '+$.createIcon("close")+'\n          <span class="audible">'+k.translate("Close")+"</span>\n        </button>\n      ");this.element.find(".modal-content").append(i),i.on("click."+this.namespace,function(){return e.close()}).tooltip()}this.settings.id&&this.element.attr("id",this.settings.id),$(this.settings.content).is(".modal")?(this.element=$(this.settings.content),t=this.element.parent().hasClass("modal-wrapper")):this.settings.content&&this.settings.content.length>0&&(this.settings.content instanceof jQuery&&this.settings.content.parent().is(".modal-body")?(t=!0,this.element=this.settings.content.closest(".modal")):this.element.find(".modal-body").append(this.settings.content),this.settings.content instanceof jQuery&&!this.settings.beforeShow&&(this.settings.content.removeClass("hidden is-hidden"),this.settings.content.show())),this.settings.beforeShow&&(this.busyIndicator=$('<div class="overlay busy"></div><div class="busy-indicator-container blocked-ui" aria-live="polite" role="status"><div class="busy-indicator active"><div class="bar one"></div><div class="bar two"></div><div class="bar three"></div><div class="bar four"></div><div class="bar five"></div></div><span>Loading...</span></div>'),$("body").append(this.busyIndicator)),t||this.element.appendTo("body"),this.settings.cssClass&&this.element.addClass(this.settings.cssClass),this.settings.title&&this.element.find(".modal-title").text(this.settings.title),t||this.addButtons(this.settings.buttons),m.fixSVGIcons(this.element)},reStructure:function(){var e=$(".modal-body",this.element),t=$("hr:first-child",e),i=$(".modal-buttonset",this.element);e&&e.length&&!e.parent().hasClass("modal-body-wrapper")&&e.wrap('<div class="modal-body-wrapper"></div>'),t&&t.length&&!t.parent().hasClass("modal-content")&&t.insertAfter(this.element.find(".modal-header")),i&&i.length&&!i.parent().hasClass("modal-content")&&i.insertAfter(this.element.find(".modal-body-wrapper"))},disableSubmit:function(){var e=this.element,t=e.find(".modal-buttonset button").filter(".btn-modal-primary").not(".no-validation"),i=e.find("select.dropdown[data-validate]"),s=e.find("[data-validate]:visible");if(i.each(function(){$(this).next(".dropdown-wrapper").is(":visible")&&(s=s.add(this))}),s.length>0){t.removeAttr("disabled");var n=!0;s.each(function(){var e=$(this);if(!(e.closest(".datagrid-filter-wrapper").length>0)){var i=e.is(".dropdown")&&e.next(".dropdown-wrapper").is(":visible")||null!==e[0].offsetParent;e.is(".required")?i&&!e.val()&&(n=!1):(e.validateField(),i&&!e.isValid()&&(n=!1)),i&&e.is(".error")&&(n=!1),n&&t.removeAttr("disabled")}}),n||t.is(":disabled")||t.attr("disabled","true")}},addButtons:function(e){var t=this,i=this.element.find(".modal-body").parent(),s=this.element.find(".flex-toolbar"),n=100,a=!1,r=void 0;if(this.modalButtons=e,!e){var o=this.element.find(".modal-buttonset button");n=100/o.length;for(var l=0,d=o.length;l<d;l++)o[l].style.width=n+"%";return o.button(),void o.not("[data-ng-click], [ng-click], [onclick], :submit").on("click."+t.namespace,function(e){$(e.target).is(".btn-cancel")&&(t.isCancelled=!0),t.close()})}this.isCAP?(a=!0,r=this.element.find(".buttonset")):(r=this.element.find(".modal-buttonset")).length||(r=$('<div class="modal-buttonset"></div>').insertAfter(i)),n=100/e.length,e&&r.empty();for(var c=function(i,o){var l=$('<button type="button">\n        <span></span>\n      </button>'),d=l.find("span");d.text(i.text),l.attr("type",i.type||"button"),"separator"===i.cssClass&&(l=$('<div class="separator"></div>')),i.cssClass?l.attr("class",i.cssClass):i.isDefault?l.addClass("btn-modal-primary"):l.addClass("btn-modal"),i.audible&&d.addClass("audible"),void 0===i.validate||i.validate||l.addClass("no-validation");for(var c={},h=["id","name","text"],u=0;u<h.length;u++)i[h[u]]&&(c[h[u]]=i[h[u]]);if("input"===i.type){var p=$('<label class="audible" for="filter">'+i.text+"</label>"),g=$('<input class="searchfield">').attr(c);return s.length?s.find(".toolbar-section.search").append(p,g):r.append(p,g),void g.searchfield(i.searchfieldSettings)}i.icon&&"#"===i.icon.charAt(0)&&$.createIconElement({classes:["#icon-close"===i.icon?"icon-close":""],icon:i.icon.substr("#icon-".length)}).prependTo(l),l[0].setAttribute("id",i.id||m.uniqueId(t.element,"button","modal"));var f=e[o].click;l.on("click."+t.namespace,function(e){f?f.apply(t.element[0],[e,t]):t.close()}),a||(l[0].style.width=n+"%"),l.button(),(t.settings.useFlexToolbar||t.settings.centerTitle)&&i.align?("left"===i.align&&s.find(".toolbar-section").eq(0).append(l),"center"===i.align&&s.find(".toolbar-section").eq(1).find("h2").append(l),"right"===i.align&&s.find(".toolbar-section").eq(2).append(l)):r.append(l)},h=0;h<e.length;h++)c(e[h],h)},sizeInner:function(){var e=this.element.find(".detailed-message"),t=$(window).height()-e.offset().top-150;e[0].style.maxHeight=t+"px",e[0].style.overflow="auto",e[0].style.width=e.width()+"px"},callSource:function(){if("function"==typeof this.settings.beforeShow){var e=this;this.settings.beforeShow(function(t){return!1!==t&&($("#modal-busyindicator").trigger("complete.busyindicator"),!0===t?(e.busyIndicator&&(e.busyIndicator.remove(),delete e.busyIndicator),!0):(t instanceof jQuery||(t=$(t)),e.open(!0),e.element.find(".modal-body").empty(),e.element.find(".modal-body").append(t),t.show(),!0))},{})}},open:function(e){var t,i=this;if($("#validation-errors, #tooltip, #validation-tooltip").addClass("is-hidden"),this.busyIndicator&&(this.busyIndicator.remove(),delete this.busyIndicator),this.trigger&&0!==this.trigger.length||(this.oldActive=$(":focus")),this.element.next().is(".overlay")||this.element.after(this.overlay),this.element&&!this.element.parent().hasClass("modal-wrapper")&&this.element.wrap('<div class="modal-page-container"><div class="modal-wrapper"></div>'),this.root=this.element.closest(".modal-page-container"),1===this.element.find(".detailed-message").length&&($("body").on("resize."+this.namespace,function(){i.sizeInner()}),this.sizeInner()),t=this.element.triggerHandler("beforeopen",[this]),$("body").triggerHandler("beforeopen",[this]),this.isCancelled=!1,!1===t)return this.overlay.remove(),void(this.root[0].style.display="none");if(e||(this.callSource(),!this.settings.beforeShow)){var s=this,n=$(".modal"),a=n.length-1;if(n.each(function(e){var t=$(this);if(this.style.zIndex=(1020+(e+1)).toString(),t.data("modal")&&t.data("modal").overlay&&(t.data("modal").overlay[0].style.zIndex=(1020+e).toString()),!t.data("modal")){var i=t.closest(".modal-page-container").next(".overlay");i&&i[0]&&(i[0].style.zIndex=(1020+e).toString())}if(e===a){var n={element:parseInt(s.element[0].style.zIndex,10),overlay:parseInt(s.overlay[0].style.zIndex,10)};n.overlay||(s.overlay[0].style.zIndex=n.element-1)}}),$("body > *").not(this.element).not(".modal, .overlay, .modal-page-container").attr("aria-hidden","true"),this.settings.isAlert)this.element.attr("aria-labelledby","message-title"),this.element.attr("aria-describedby","message-text");else{var r=this.element.find("h1:first"),o=r.attr("id");o||(o=(this.element.attr("id")?this.element.attr("id"):"h1")+"-title",r.attr("id",o));var l=this.element.find(".modal-body"),d=(this.element.attr("id")?this.element.attr("id"):"message")+"-text";this.element.attr("aria-labelledby",o),this.element.find(".toolbar .title").length?(this.element.find(".toolbar .title").attr("id",d),this.element.attr("aria-describedby",d)):(l.attr("id",d),this.element.attr("aria-describedby",d))}this.mainContent=$("body").children(".scrollable-container"),this.mainContent.length||(this.mainContent=$("body")),this.removeNoScroll=!this.mainContent.hasClass("no-scroll"),this.mainContent.addClass("no-scroll"),$("body").on("resize."+this.namespace,function(){i.resize()}),this.root[0].style.display="",this.element[0].style.display="",setTimeout(function(){i.resize(),i.element.addClass("is-visible").attr("role",i.settings.isAlert?"alertdialog":"dialog"),i.root.removeAttr("aria-hidden"),i.overlay.attr("aria-hidden","true"),i.element.attr("aria-modal","true")},1),$("body").addClass("modal-engaged"),$(this.element).on("keypress."+this.namespace,function(e){var t=$(e.target);t.is(".editor, .searchfield, textarea, :button")||t.closest(".tab-list").length||$("#dropdown-list").length||13===e.which&&i.isOnTop&&!t.closest("form").find(":submit").length&&i.element.find(".btn-modal-primary:enabled").length&&(e.stopPropagation(),e.preventDefault(),(!t.hasClass("fileupload")&&!$(t).is(":input")||t.hasClass("colorpicker"))&&i.element.find(".btn-modal-primary:enabled").trigger("click"))}),$(".skip-link").on("focus."+this.namespace,function(e){e.preventDefault(),i.element.find(":focusable").first().focus()}),this.element.find(".paginated").on("afterpaging."+this.namespace,function(){i.resize()}),setTimeout(function(){i.disableSubmit()},10),this.element.find("[data-validate]").removeClass("disable-validation"),setTimeout(function(){!function(e){var t=e.element.find(":focusable").not(".modal-header .searchfield").first();if(e.keepFocus(),e.element.trigger("open",[e]),0===t.length&&(t=e.element.find(".btn-modal-primary")),1===t.length&&t.is(".btn-modal")&&(t=e.element.find(".btn-modal-primary")),1===t.length&&t.is("button")&&!t.is(":disabled")&&t.addClass("hide-focus"),e.settings.autoFocus){var i=void 0,s=void 0;if(t.is(".tab:not(.is-selected) a")&&(i=(s=t.closest(".tab-container")).find(".is-selected")).length)return t=i,void s.data("tabs").select(i.children("a").attr("href"));t.focus()}}(i)},200),setTimeout(function(){i.element.trigger("afteropen")},300)}},resize:function(){var e=.9*$(window).height()-this.settings.frameHeight,t=1*$(window).width()-this.settings.frameWidth,i=this.element.find(".modal-body-wrapper");if(i.length&&(i[0].style.maxHeight=e+"px",i[0].style.maxWidth=t+"px"),this.element.hasClass("lookup-modal")){var s=this.element.find(".datagrid-body"),n=this.element.find(".pager-toolbar"),a=s.closest(".datagrid-container");e=e-(a.prev().is(".toolbar")?130:67)-(a.next().is(".pager-toolbar")?35:0),s[0].style.maxHeight=e+(n.length?-15:0)+"px",s[0].style.maxWidth=t+"px"}var r=this.element.find(".toolbar");r.length&&r.triggerHandler("recalculate-buttons")},isOpen:function(){return S("visible","isOpen"),this.visible},keepFocus:function(){var e=this;$(document).off("keydown."+e.namespace).on("keydown."+e.namespace,function(t){if(27===(t.which||t.keyCode)){var i=$(".modal.is-visible");if(e.isCancelled=!0,i.length>1){i.not(":last").on("beforeclose."+e.namespace,function(){return!1}),i.on("afterclose."+e.namespace,function(){i.off("beforeclose."+e.namespace)});var s=i.last().data("modal");s&&s.close&&s.close()}else e.close()}});var t=":focusable, [contenteditable], iframe",i=e.element.find(t),s=i.first(),n=i.last();this.changeObserver=new MutationObserver(function(){i=e.element.find(t),s=i.first(),n=i.last()}),this.changeObserver.observe(e.element[0],{childList:!0,subtree:!0}),$(e.element).off("keypress."+e.namespace+" keydown."+e.namespace).on("keypress."+e.namespace+" keydown."+e.namespace,function(e){if(9===(e.which||e.keyCode)){var t=$(e.target);!e.shiftKey&&t.is(n)?(e.preventDefault(),i.first().removeClass("hide-focus").focus()):e.shiftKey&&t.is(s)&&(e.preventDefault(),i.last().removeClass("hide-focus").focus())}})},close:function(e){if(!this.visible)return!0;this.changeObserver&&(this.changeObserver.disconnect(),delete this.changeObserver);var t=this.element.triggerHandler("beforeclose"),i=this,s=this.element.find("[data-validate]");return this.root=this.element.closest(".modal-page-container"),s.addClass("disable-validation"),!1!==t&&(this.mainContent&&this.removeNoScroll&&this.mainContent.removeClass("no-scroll"),$("body").off("resize."+this.namespace),this.element.off("keypress."+this.namespace+" keydown."+this.namespace),this.element.removeClass("is-visible"),this.overlay.attr("aria-hidden","true"),this.root&&this.root.attr("aria-hidden","true"),$(".modal-page-container").length<=1&&($("body").removeClass("modal-engaged"),$("body > *").not(this.element.closest(".modal-page-container")).removeAttr("aria-hidden"),$(".overlay").remove()),i.element.trigger("close",i.isCancelled),this.oldActive&&$(this.oldActive).is("a:visible, button:visible, input:visible, textarea:visible")?(this.oldActive.focus(),this.oldActive=null):this.trigger.parents(".toolbar, .formatter-toolbar").length<1&&this.trigger.focus(),$("#validation-errors, #tooltip, #validation-tooltip").addClass("is-hidden"),$(".skip-link").off("focus."+this.namespace),setTimeout(function(){i.overlay.remove(),i.root[0].style.display="none",i.element.trigger("afterclose"),("immediate"===i.settings.trigger||e)&&(!i.isCAP||i.isCAP&&!i.capAPI)&&i.destroy()},300),!1)},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),"immediate"===this.settings.trigger&&this.open(),this},destroy:function(){var e=this,t=this.element.trigger("beforedestroy");function i(){e.trigger.off("click."+e.namespace),e.element.off("keypress."+e.namespace+" keydown."+e.namespace+" beforeclose."+e.namespace+" afterclose."+e.namespace),e.element.find("button, .btn-close").off("click."+e.namespace),e.element.find(".paginated").off("afterpaging."+e.namespace),$(".skip-link").off("focus."+e.namespace),$("body").off("resize."+e.namespace),$(document).off("keydown."+e.namespace),e.modalButtons&&e.element.find("button").off("click."+e.namespace),1===e.element.find(".detailed-message").length&&$("body").off("resize."+e.namespace),e.isCAP&&e.capAPI&&e.capAPI.teardown(),e.trigger.off("click."+e.namespace),e.root&&e.root.length?e.root.remove():e.element.closest(".modal-page-container").remove(),e.element[0].removeAttribute("data-modal"),$.removeData(e.element[0],vi),e.isCAP&&e.capAPI&&e.capAPI.destroy(),setTimeout(function(){var t=null,i=e.element?e.element.data(vi):null;i?t=e.element[0]:(i=e.trigger?e.trigger.data(vi):null)&&(t=e.trigger[0]),t&&i&&i.overlay&&(i.overlay.remove(),$.removeData(t,vi))},310)}this.changeObserver&&(this.changeObserver.disconnect(),delete this.changeObserver),t&&(this.visible?(this.element.one("afterclose."+e.namespace,function(){i()}),this.close(!0)):i())}};var wi={title:"Message Title",status:"",message:"Message Summary",width:"auto",buttons:null,cssClass:null,returnFocus:null,allowedTags:"<a><b><br><br/><del><em><i><ins><mark><small><strong><sub><sup>",audibleLabel:""};function xi(e,t){this.element=$(e),this.settings=m.mergeSettings(e,t,wi),this.init()}xi.prototype={init:function(){var e=this,t=void 0,i=this.settings.allowedTags,n=!0;this.settings.allowedTags.length>0||(n=!1),this.message=$('<div class="modal message"></div>'),this.messageContent=$('<div class="modal-content"></div>'),this.title=$('<h1 class="modal-title" id="message-title">'+(n?s.stripTags(this.settings.title,i):s.stripHTML(this.settings.title))+"</h1>").appendTo(this.messageContent).wrap('<div class="modal-header"></div>'),this.content=$('<div class="modal-body"><p class="message" id="message-text">'+(n?s.stripTags(this.settings.message,i):s.stripHTML(this.settings.message))+"</p></div>").appendTo(this.messageContent),""!==this.settings.audibleLabel&&this.title.prepend('<span class="audible">'+k.translate(this.settings.audibleLabel)+"</span>"),this.element.is("body")||(t=this.element,this.content.empty().append(t.show())),this.message.append(this.messageContent).appendTo("body"),this.message.modal({trigger:"immediate",buttons:this.settings.buttons,resizable:this.settings.resizable,close:this.settings.close,isAlert:!0}),"auto"!==this.settings.width&&(this.content.closest(".modal")[0].style.maxWidth="none",this.content.closest(".modal")[0].style.width=this.settings.width+(/(px|%)/i.test(""+this.settings.width)?"":"px")),this.settings.cssClass&&this.message.addClass(this.settings.cssClass),this.message.on("beforeclose.message",function(){return e.element.triggerHandler("beforeclose")}).on("beforeopen.message",function(){return e.element.triggerHandler("beforeopen")}).on("open.message",function(){e.element.trigger("open")}).on("afterclose.message",function(){e.destroy(),e.settings.returnFocus&&e.settings.returnFocus.focus(),$(document).off("keypress.message keydown.message")}),$(document).on("keypress.message keydown.message",function(t){27===(t.which||t.keyCode)&&setTimeout(function(){var t=e.message.data("modal");void 0!==t&&t.close()},0)}),"error"===this.settings.status?this.title.addClass("has-status is-error").prepend($.createIconElement("error")):"alert"===this.settings.status?this.title.addClass("has-status is-alert").prepend($.createIconElement("alert")):"success"===this.settings.status?this.title.addClass("has-status is-success").prepend($.createIconElement("success")):this.title.removeClass("has-status is-error is-alert is-success").find("svg").remove()},destroy:function(){var e=this.message.data("modal");void 0!==e&&e.destroy(),this.message.off("beforeclose.message beforeopen.message open.message afterclose.message").remove()}},$.fn.message=function(e){return this.each(function(){return new xi(this,e)})},$.fn.modal=function(e){return this.each(function(){var t=$.data(this,vi),i=$(this);if(i.is(".modal")||(t=i.closest(".modal").data(vi)),t&&e)return t.updated(e),void("function"==typeof t[e]&&t[e]());t&&!e||(t=$.data(this,vi,new yi(this,e)))})},$.fn.monthview=function(e){return this.each(function(){var t=$.data(this,"monthview");t?t.updated(e):t=$.data(this,"monthview",new xt(this,e))})};var Ci={closeOnSelect:!1,empty:!0,filterMode:"contains",maxSelected:void 0,moveSelected:"all",multiple:!0,showEmptyGroupHeaders:!1,showSelectAll:!1,source:void 0};function ki(e,t){this.settings=m.mergeSettings(e,t,Ci),this.element=$(e),this.init()}ki.prototype={init:function(){this.build()},build:function(){return this.element.dropdown(this.settings),this.dropdown=this.element.data("dropdown"),this},enable:function(){this.dropdown.enable()},disable:function(){this.dropdown.disable()},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.build()},destroy:function(){this.dropdown.destroy(),this.element.off(),$.removeData(this.element[0],"multiselect")}},$.fn.multiselect=function(e){return this.each(function(){var t=$.data(this,"multiselect");t?t.updated(e):t=$.data(this,"multiselect",new ki(this,e))})};var $i={message:"Hi! Im a notification message.",type:"alert",parent:".header",link:"#",linkText:"Click here to view."};function Ti(e,t){this.settings=m.mergeSettings(e,t,$i),this.element=$(e),this.init()}Ti.prototype={init:function(){return this.build().handleEvents()},build:function(){this.notificationEl=document.createElement("div"),this.notificationEl.classList.add("notification"),this.notificationEl.classList.add(this.settings.type);var e='\n      <svg class="icon notification-icon icon-'+this.settings.type+'" focusable="false" aria-hidden="true" role="presentation">\n        <use xlink:href="#icon-'+this.settings.type+'"></use>\n      </svg>',t='<p class="notification-text">'+this.settings.message;this.settings.linkText&&(t+='<a class="notification-link" href="'+this.settings.link+'">'+this.settings.linkText+"</a>"),t+="</p>";var i='\n      <button type="text" class="notification-close">\n        <svg class="icon" focusable="false" aria-hidden="true" role="presentation">\n          <use xlink:href="#icon-close"></use>\n        </svg>\n        <span class="audible">'+k.translate("Close")+"</span>\n      </button>";this.notificationEl.innerHTML=e.concat(t,i);var s=document.querySelector(this.settings.parent);return s.parentNode.insertBefore(this.notificationEl,s.nextSibling),$(this.notificationEl).animateOpen(),this},handleEvents:function(){var e=this;return this.element.off("updated.notification").on("updated.notification",function(){e.updated()}),$(this.notificationEl).off("click.notification").on("click.notification",".notification-close",function(){e.destroy()}),this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,$i)),this.teardown().init()},teardown:function(){return this.element.off("updated.notification"),this.element.off("click.notification",".notification-close"),this},destroy:function(){this.notificationEl&&this.notificationEl.parentNode&&this.notificationEl.parentNode.removeChild(this.notificationEl),this.teardown(),$.removeData(this.element[0],"notification")}},$.fn.notification=function(e){return this.each(function(){$.data(this,"notification",new Ti(this,e))})};var Si={};function Ai(e,t){this.settings=m.mergeSettings(e,t,Si),this.element=$(e),this.init()}Ai.prototype={init:function(){var e=this;this.update(),this.element.off("updated.progress").on("updated.progress",function(t){t.stopPropagation(),e.update()})},updateAria:function(e){this.element.attr({role:"progressbar","aria-valuenow":e,"aria-valuemax":"100"});var t=this.element.parent();t.data("tooltip")?t.data("tooltip").content=e+"%":(t[0].setAttribute("title",e+"%"),t.tooltip())},unbind:function(){this.element.off("updated.progress")},update:function(e){var t=this.element.attr("data-value");e&&(t=e,this.element.attr("data-value",e)),this.element[0].style.width=t+"%",this.updateAria(t)},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Si)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"progress")}},$.fn.progress=function(e){return this.each(function(){var t=$.data(this,"progress");t?t.updated(e):t=$.data(this,"progress",new Ai(this,e))})};var Di={keepOpen:!1,trigger:void 0};function Ii(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Di),this.init(),S("Popover","Popdown")}Ii.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){var e=this;function t(t){return!!t&&("string"==typeof t&&(t.match("#")&&0===t.indexOf("#")||(t="#"+t),t=$(t)),!!t.length&&(e.popdown=t,!0))}return this.popdown=$(),this.trigger=this.element,(this.settings.trigger instanceof $||n.isElement(this.settings.trigger))&&(this.trigger=$(this.settings.trigger)),this.trigger.is(".dropdown, .multiselect")&&(this.trigger=$("#"+this.element.attr("id")+"-shdo")),t(this.trigger.attr("data-popdown"))||t(this.trigger.next(".popdown")),this.id=this.popdown.attr("id"),this.id||(this.id="popdown-"+$("body").find(".popdown").index(this.popdown),this.popdown.attr("id",this.id)),this},build:function(){this.popdown.addClass("popdown").removeClass("hidden"),this.popdown.children(".popdown-contents").length||this.popdown.children().wrap('<div class="popdown-contents"></div>'),this.arrow=$('<div class="arrow"></div>').prependTo(this.popdown),this.place();var e=this.trigger.attr("aria-expanded");return e&&void 0!==e||this.trigger.attr("aria-expanded",""),"true"===e&&this.open(),this.trigger&&this.trigger[0].setAttribute("aria-controls",this.id),this},handleEvents:function(){var e=this;return this.trigger.on("click.popdown",function(){e.toggle()}).on("updated.popdown",function(){e.updated()}),this},hasValidTriggerSetting:function(){return this.settings.trigger instanceof $||n.isElement(this.settings.trigger)},hasFocus:function(e){var t=e||document.activeElement;if(this.trigger.is(t))return!0;if(this.popdown[0].contains(t))return!0;var i=this.popdown[0].querySelectorAll(".dropdown, .multiselect"),s=!1;return i.forEach(function(e){var i=$(e).data("dropdown");i&&i.list&&i.list.length&&i.list[0].contains(t)&&(s=!0)}),s},isOpen:function(){return"true"===this.trigger.attr("aria-expanded")},open:function(){if(!this.isAnimating){var e=this;this.isAnimating=!0,this.trigger.attr("aria-expanded","true"),this.position(),this.popdown.addClass("visible"),setTimeout(function(){$("body").on("resize.popdown",function(){e.hasFocus()||e.close()}),e.settings.keepOpen||$(document).on("click.popdown",t).on("focusin.popdown",t),e.isAnimating=!1},400)}function t(t){e.hasFocus(t.target)||e.close()}},close:function(){if(!this.isAnimating){var e=this;this.isAnimating=!0,this.trigger.attr("aria-expanded","false"),this.popdown.removeClass("visible"),$("body").off("resize.popdown"),$(document).off("click.popdown focusin.popdown"),setTimeout(function(){e.popdown[0].style.display="none",e.isAnimating=!1},400)}},toggle:function(){this.isOpen()?this.close():this.open()},place:function(){this.scrollparent=$("body"),this.popdown.detach().appendTo(this.scrollparent)},position:function(){var e={offset:{left:0,top:0},scrollDistance:{left:0,top:0}},t=window.innerHeight+$(document).scrollTop(),i=window.innerWidth-2+$(document).scrollLeft();this.popdown.removeAttr("style"),this.arrow.removeAttr("style"),this.scrollparent.length&&(e.offset=this.scrollparent.offset(),e.scrollDistance.top=this.scrollparent.scrollTop(),e.scrollDistance.left=this.scrollparent.scrollLeft(),t-=e.offset.top+e.scrollDistance.top,i-=e.offset.left+e.scrollDistance.left);var s=!1,n=!1,a=this.trigger,r=a.offset(),o=0,l=0,d=void 0;this.popdown.addClass("bottom"),this.popdown[0].style.left=r.left+"px",this.popdown[0].style.top=r.top+a.outerHeight(!0)+11+"px",this.arrow[0].style.left=a.outerWidth(!0)/2+"px",this.arrow[0].style.top="-11px",(d=this.popdown.offset()).left<0&&(s=!0,o=0-d.left);var c=d.left+this.popdown.outerWidth(!0);if(c>i&&(s=!0,o=c-i+(k.isRTL()?20:0)),s){this.popdown[0].style.left=d.left+-1*o+"px";var h=this.popdown[0].getBoundingClientRect(),u=a[0].getBoundingClientRect(),p=h.right-u.right+10;this.arrow[0].style.left="auto",this.arrow[0].style.right=p+"px",d=this.popdown.offset()}d.top<0&&(n=!0,l=0-d.top);var g=d.top+this.popdown.outerHeight(!0);g>t&&(n=!0,l=g-t),n&&(this.arrow[0].style.display="none",this.popdown[0].style.top=d.top+-1*l+"px",this.arrow[0].style.top=parseInt(this.arrow[0].style.top,10)- -1*l+"px",d=this.popdown.offset()),(d.top<0||d.top+this.popdown.outerHeight(!0)>t)&&(this.popdown[0].style.top=0,g=(d=this.popdown.offset()).top+this.popdown.outerHeight(!0),this.popdown[0].style.height=parseInt(this.popdown[0].style.height,10)-(g-t)+"px")},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.hasValidTriggerSetting()&&(this.trigger=$(this.settings.trigger)),this},teardown:function(){return this.isOpen()&&this.close(),this.trigger.off("updated.popdown click.popdown").removeAttr("aria-controls").removeAttr("aria-expanded"),this.originalParent&&this.originalParent.length&&this.popdown.detach().appendTo(this.originalParent),this.arrow.remove(),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"popdown")}},$.fn.popdown=function(e){return this.each(function(){var t=$.data(this,"popdown");t?t.updated(e):t=$.data(this,"popdown",new Ii(this,e))})};var Ei={};function Li(e,t){this.settings=m.mergeSettings(e,t,Ei),this.element=$(e),this.init()}Li.prototype={init:function(){this.handleEvents(),this.allInputs=this.element.find("input"),this.readonly()},handleEvents:function(){for(var e=this,t=$("input",this.element),i=function(i,s){$(t[i]).on("change.rating",function(){e.element.hasClass("is-readonly")||e.val(i+1)})},s=0,n=t.length;s<n;s++)i(s)},fillStar:function(e,t){$(e).addClass("is-filled").removeClass("is-half").next(t).find("svg").changeIcon("star-filled")},emptyStar:function(e,t){$(e).removeClass("is-filled").removeClass("is-half").next(t).find("svg").changeIcon("star-outlined")},halfStar:function(e,t){$(e).addClass("is-half").removeClass("is-filled").next(t).find("svg").changeIcon("star-half")},val:function(e){if(0===arguments.length||""===e||isNaN(e)||-1===y.sign(e))return this.currentValue;this.currentValue=parseFloat(e,10);for(var t=Math.floor(this.currentValue),i=0,s=this.allInputs.length;i<s;i++){var n=$(this.allInputs[i]),a=n.parent().is(".inline")?"svg":"label";e%1!=0&&t===i?this.halfStar(n,a):i<e?this.fillStar(n,a):this.emptyStar(n,a),i+1===t&&n.prop("checked",!0)}return t<=0&&e>0&&$(this.allInputs[0]).prop("checked",!0),this.currentValue},readonly:function(){var e=$(this.element);e.hasClass("is-readonly")&&e.find("input").attr("disabled","")},enable:function(){$(this.element).removeClass("is-readonly").find("input").removeAttr("disabled")},unbind:function(){return this.element.find("input").off("change.rating"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Ei)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"rating")}},$.fn.rating=function(e){return this.each(function(){var t=$.data(this,"rating");t?t.updated(e):t=$.data(this,"rating",new Li(this,e))})};var Pi={};function Mi(e,t){this.settings=m.mergeSettings(e,t,Pi),this.element=$(e),this.init()}Mi.prototype={init:function(){this.handleKeys()},isCapslock:function(e){var t=!1,i=!1;return(e=e||window.event).which?t=e.which:e.keyCode&&(t=e.keyCode),e.shiftKey?i=e.shiftKey:e.modifiers&&(i=!!(4&e.modifiers)),!!(t>=97&&t<=122&&i)||t>=65&&t<=90&&!i},unbind:function(){return $("body").off("keypress.signin blur.signin change.signin"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Pi)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"signin")},handleKeys:function(){var e=this,t=$.createIconElement({classes:"icon-capslock",icon:"capslock"});document.msCapsLockWarningOff=!0,this.element.on("keypress.signin",'[type="password"]',function(i){var s=$(this),n=s.parent(".field"),a=$(".icon-capslock",n);e.isCapslock(i)&&!s.hasClass("error")?a.length||(n.append(t),$("body").toast({audibleOnly:!0,message:k.translate("CapsLockOn")})):a.remove()}).on("blur.signin change.signin",'[type="password"]',function(){var e=$(this),i=e.closest(".field"),s=$(".icon-capslock",i);setTimeout(function(){s&&s.length&&(e.hasClass("error")?s.remove():i.append(t))},150)})}},$.fn.signin=function(e){return this.each(function(){var t=$.data(this,"signin");t?t.updated(e):t=$.data(this,"signin",new Mi(this,e))})};var Bi={value:[50],min:0,max:100,range:!1,step:void 0,ticks:[],tooltipContent:void 0,persistTooltip:!1};function Ri(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Bi),this.init()}function Fi(e){return e%1==0}function Oi(e,t){return t&&!isNaN(t)&&0!==t||(t=1),Math.round(e/t)*t}function Ni(e,t){var i=e[0],s=e[1],n=t[0],a=t[1];return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))}Ri.prototype={init:function(){return this.buildSettings().addMarkup().bindEvents()},buildSettings:function(){var e=this;this.element.is(":disabled")&&this.element.closest(".field").addClass("is-disabled"),this.settings||(this.settings={}),this.settings.value=void 0!==this.element.attr("value")?this.element.attr("value"):this.settings.value,this.settings.min=void 0!==this.element.attr("min")?parseInt(this.element.attr("min"),10):this.settings.min,this.settings.max=void 0!==this.element.attr("max")?parseInt(this.element.attr("max"),10):this.settings.max,this.settings.range=void 0!==this.element.attr("data-range")?"true"===this.element.attr("data-range"):this.settings.range,this.settings.step=isNaN(this.element.attr("step"))?this.settings.step:Number(this.element.attr("step")),""===this.settings.value&&(this.settings.value=this.settings.min);var t=void 0;if(void 0!==this.element.attr("data-ticks")){try{t=JSON.parse(e.element.attr("data-ticks"))}catch(e){t=[]}$.isArray(t)&&(this.settings.ticks=t)}var i="true"===this.element.attr("data-tooltip-persist")||!0===this.element.attr("data-tooltip-persist");if(this.settings.persistTooltip=void 0!==this.element.attr("data-tooltip-persist")?i:this.settings.persistTooltip,this.settings.tooltip=this.settings.tooltipContent,void 0!==this.element.attr("data-tooltip-content"))try{e.settings.tooltip=JSON.parse(e.element.attr("data-tooltip-content"))}catch(t){e.settings.tooltip=["",""]}if("string"==typeof this.settings.tooltip)if(-1===this.settings.tooltip.indexOf(","))this.settings.tooltip=[this.settings.tooltip,""];else{var s=this.settings.tooltip.split(",");this.settings.tooltip=[s[0]],this.settings.tooltip.push(s[1]?s[1]:"")}this.settings.tooltip&&1===this.settings.tooltip.length&&this.settings.tooltip.push(""),this.ticks=[];var n={value:this.settings.min,description:e.getModifiedTextValue(this.settings.min)},a={value:this.settings.max,description:e.getModifiedTextValue(this.settings.max)};if(this.settings.ticks){var r=e.settings.ticks||[];if($.isArray(r)&&r.length>0){var o=r.filter(function(t){return t.value===e.settings.min}),l=r.filter(function(t){return t.value===e.settings.max});o.length>0&&(n.description=o[0].description,n.color=o[0].color,r=$.grep(r,function(e){return e!==o[0]})),l.length>0&&(a.description=l[0].description,a.color=l[0].color,r=$.grep(r,function(e){return e!==l[0]}))}e.ticks.push(n);for(var d=0;d<r.length;d++){var c={};void 0!==r[d].value&&(c.value=r[d].value,c.description=void 0!==r[d].description?r[d].description:"",c.color=r[d].color,e.ticks.push(c))}e.ticks.push(a)}else this.ticks.push(n,a);if($.isArray(this.settings.value))this.settings.value[0]=isNaN(this.settings.value[0])?(this.settings.min+this.settings.max)/2:parseInt(this.settings.value[0],10);else if("number"==typeof this.settings.value)this.settings.value=[this.settings.value];else if(-1===this.settings.value.indexOf(","))this.settings.value=[isNaN(this.settings.value)?(this.settings.min+this.settings.max)/2:parseInt(this.settings.value,10)];else{var h=this.settings.value.split(",");h[0]=isNaN(h[0])?this.settings.min:parseInt(h[0],10),h[1]=isNaN(h[1])?this.settings.max:parseInt(h[1],10),this.settings.value=h}return this.settings.range&&!this.settings.value[1]&&this.settings.value.push(this.settings.max),this},addMarkup:function(){var e=this,t=!1;if("INPUT"!==e.element[0].tagName)throw new Error('Element with ID "'+e.element.id+"\" cannot invoke a slider;  it's not an Input element.");e.originalElement={type:e.element.attr("type")},e.element.attr("type","hidden"),e.wrapper=$('<div class="slider-wrapper"></div>').attr("id",e.element.attr("id")+"-slider").insertAfter(e.element),e.hitarea=$('<div class="slider-hit-area"></div>').appendTo(e.wrapper),e.range=$('<div class="slider-range"></div>').appendTo(e.wrapper),this.element.hasClass("vertical")&&(this.wrapper.addClass("vertical"),t=!0),this.isRtlHorizontal=k.isRTL()&&!t,this.isRtlVertical=k.isRTL()&&t;var i=this.element.attr("style");i&&(i.match(/min-height/)&&(this.wrapper[0].style.minHeight=this.element[0].style.minHeight,i=i.replace("min-height","")),i.match(/height/)&&(this.wrapper[0].style.height=this.element[0].style.height),i.match(/min-width/)&&(this.wrapper[0].style.minWidth=this.element[0].style.minWidth,i=i.replace("min-width","")),i.match(/width/)&&(this.wrapper[0].style.width=this.element[0].style.width)),e.handles=[];var s=e.element.prev("label").text(),n=$('<div class="slider-handle'+(e.settings.range?" lower":"")+'" tabindex="0"></div>').attr("aria-label",(e.settings.range?k.translate("SliderMinimumHandle"):k.translate("SliderHandle"))+" "+s);if(e.handles.push(n),e.settings.range){var a=$('<div class="slider-handle higher" tabindex="0"></div>').attr("aria-label",k.translate("SliderMaximumHandle")+" "+s);e.handles.push(a)}return $.each(e.handles,function(i,s){s.attr({role:"slider","aria-orientation":t?"vertical":"horizontal","aria-valuemin":e.settings.min,"aria-valuemax":e.settings.max}).hideFocus(),s.appendTo(e.wrapper)}),e.ticks.forEach(function(i){!function(i){var s="calc("+(e.isRtlHorizontal?100-e.convertValueToPercentage(i.value):e.convertValueToPercentage(i.value))+"% - 4px)";i.element=$('<div class="tick" data-value="'+i.value+'"></div>'),i.label=$('<span class="label">'+i.description+"</span>"),i.element[0].style[t?"bottom":"left"]=s,i.element.append(i.label),e.wrapper.append(i.element),t||(i.label[0].style.left=-(i.label.outerWidth()/2-i.element.width()/2)+"px")}(i)}),e.value(e.settings.value),e.updateRange(),$.each(e.handles,function(i,s){e.settings.tooltip&&(s.tooltip({content:function(){return""+e.getModifiedTextValue(Math.floor(e.value()[i]))},placement:t?"right":"bottom",trigger:"focus",keepOpen:e.settings.persistTooltip}),s.removeAttr("aria-describedby"))}),!0===this.element.prop("readonly")?this.readonly():!0===this.element.prop("disabled")&&this.disable(),e},handleRangeClick:function(e){if(e.preventDefault(),!this.isDisabled()){var t=this,i=this.wrapper.hasClass("vertical"),s="click"!==e.originalEvent.type?e.originalEvent.changedTouches[0].pageX:e.pageX,n="click"!==e.originalEvent.type?e.originalEvent.changedTouches[0].pageY:e.pageY,a=s-t.wrapper.offset().left-$(document).scrollLeft(),r=n-t.wrapper.offset().top-$(document).scrollTop(),o=[a,r],l=[t.handles[0].offset().left+t.handles[0].width()/2-t.wrapper.offset().left-$(document).scrollLeft(),t.handles[0].offset().top+t.handles[0].height()/2-t.wrapper.offset().top-$(document).scrollTop()],d=t.value(),c=Ni(o,l),h=d[0],u=t.handles[0];u.addClass("hide-focus");var p=function(){if(i){var e=t.wrapper.height();return(e-r)/e*100}return a/t.wrapper.width()*100}(),g=t.convertPercentageToValue(p);t.handles[1]&&c>Ni(o,[t.handles[1].offset().left+t.handles[1].width()/2-t.wrapper.offset().left-$(document).scrollLeft(),t.handles[1].offset().top+t.handles[1].height()/2-t.wrapper.offset().top-$(document).scrollTop()])?(t.value([void 0,g]),u=t.handles[1],h=d[1]):t.value([g]),t.checkHandleDifference(u,h,g);var f=t.settings.step?t.settings.step:0;g<h?t.decreaseValue(e,u,g,f):t.increaseValue(e,u,g,f),t.settings.tooltip||u.focus()}},activateHandle:function(e){e.addClass("is-active")},deactivateHandle:function(e){e.removeClass("is-active")},enableHandleDrag:function(e){if(!this.isDisabled()){var t=this,i={containment:"parent",axis:this.isVertical()?"y":"x",clone:!1};e.drag(i).on("drag.slider",function(e,i){!function(e,i,s){if(!t.isDisabled()){var n=function(){if(t.isVertical()){var e=t.wrapper.height()-i.outerHeight();return(e-s.top)/e*100}return s.left/(t.wrapper.width()-i.outerWidth())*100}(),a=t.convertPercentageToValue(n);if(t.settings.range){var r=t.value();i.hasClass("higher")&&a<=r[0]&&(a=r[0]),i.hasClass("lower")&&a>=r[1]&&(a=r[1])}t.settings.step&&(a=Math.round(a/t.settings.step)*t.settings.step),e.defaultPrevented||(t.value(i.hasClass("higher")?[void 0,a]:[a]),t.updateRange(),t.updateTooltip(i),t.element.trigger("sliding",i,a))}}(e,$(e.currentTarget),i)}).on("dragstart",function(){$(this).addClass("is-dragging"),t.range.addClass("is-dragging"),t.element.trigger("slidestart",e)}).on("dragend",function(){$(this).removeClass("is-dragging"),t.range.removeClass("is-dragging"),t.element.trigger("slidestop",e)})}},disableHandleDrag:function(e){e.off("drag.slider dragstart dragend"),this.range.removeClass("is-dragging"),e.removeClass("is-dragging");var t=e.data("drag");t&&t.destroy()},convertValueToPercentage:function(e){return(e-this.settings.min)/(this.settings.max-this.settings.min)*100},convertPercentageToValue:function(e){var t=e/100*(this.settings.max-this.settings.min)+this.settings.min;return this.isRtlHorizontal?this.settings.max-t+this.settings.min:t},getIncrement:function(){var e=.1*(this.settings.max-this.settings.min);return void 0!==this.settings.step&&e<=this.settings.step&&(e=this.settings.step),e},handleKeys:function(e,t){if(!t.isDisabled()){var i=e.which,s=$(e.currentTarget);switch(s.removeClass("hide-focus"),i){case 33:t.increaseValue(e,s,void 0,this.getIncrement());break;case 34:t.decreaseValue(e,s,void 0,this.getIncrement());break;case 35:t.increaseValue(e,s,this.settings.max);break;case 36:t.decreaseValue(e,s,this.settings.min);break;case 38:case 39:t.isRtlHorizontal&&39===i?t.decreaseValue(e,s):t.increaseValue(e,s);break;case 37:case 40:t.isRtlHorizontal&&37===i?t.increaseValue(e,s):t.decreaseValue(e,s)}}},increaseValue:function(e,t,i,s){e.preventDefault(),clearTimeout(t.data("animationTimeout"));var n=this.value().slice(0),a=void 0!==s?s:void 0!==this.settings.step?this.settings.step:1,r=void 0,o=void 0,l=void 0;if(t.hasClass("higher"))l=(o=(r=void 0!==i?i:n[1])+(a=Fi(r)?a:isNaN(r%a)?0:r%a)<this.settings.max?r+a:this.settings.max)%a?o:Oi(o,a),this.value([void 0,l]);else{r=void 0!==i?i:n[0];var d=void 0===n[1]?this.settings.max:n[1];l=(o=r+(a=Fi(r)?a:isNaN(r%a)?0:a-r%a)<d?r+a:d)%a?o:Oi(o,a),this.value([l])}this.checkHandleDifference(t,r,l),this.updateRange(),this.updateTooltip(t)},decreaseValue:function(e,t,i,s){e.preventDefault(),clearTimeout(t.data("animationTimeout"));var n=this.value(),a=void 0!==s?s:void 0!==this.settings.step?this.settings.step:1,r=void 0,o=void 0,l=void 0;if(t.hasClass("higher")){r=void 0!==i?i:n[1];var d=void 0===n[0]?this.settings.min:n[0];l=(o=r-(a=Fi(r)?a:isNaN(r%a)?0:a-r%a)>d?r-a:d)%a?o:Oi(o,a),this.value([void 0,l])}else l=(o=(r=void 0!==i?i:n[0])-(a=Fi(r)?a:isNaN(r%a)?0:r%a)>this.settings.min?r-a:this.settings.min)%a?o:Oi(o,a),this.value([l]);this.checkHandleDifference(t,r,l),this.updateRange(),this.updateTooltip(t)},updateRange:function(){for(var e=this,t=this.value(),i=[],s=this.getColorClosestToValue(),n=e.wrapper.hasClass("vertical"),a=0;a<this.ticks.length;a++){(this.settings.range?t[0]<this.ticks[a].value&&this.ticks[a].value<=t[1]:this.ticks[a].value<=t[0])?(this.ticks[a].element.addClass("complete"),s&&(this.ticks[a].element[0].style.backgroundColor=s,this.ticks[a].element.addClass("inherit"))):(this.ticks[a].element.removeClass("complete"),s&&(this.ticks[a].element[0].style.backgroundColor="",this.ticks[a].element.removeClass("inherit")))}s&&(this.range[0].style.backgroundColor=s,$.each(this.handles,function(e,t){t[0].style.backgroundColor=s,t[0].style.borderColor=s})),$.each(e.ticks,function(t){e.ticks[t].label[0].style.color=""}),i[0]=this.convertValueToPercentage(t[0]),void 0!==t[1]&&(i[1]=this.convertValueToPercentage(t[1]));var r=n?["bottom","top"]:e.isRtlHorizontal?["right","left"]:["left","right"],o={};function l(e,t){var i=n?r[1]:r[0],s=n?100-t:t;e.css(i,"calc("+s+"% - "+e.outerWidth()/2+"px)")}this.handles[1]?(o[r[0]]=i[0]+"%",o[r[1]]=100-i[1]+"%"):(o[r[0]]="0%",o[r[1]]=100-i[0]+"%"),this.range.css(o),this.handles[0].hasClass("is-animated")&&this.handles[0].data("animationTimeout",setTimeout(function(){e.handles[0].removeClass("is-animated").trigger("slide-animation-end"),e.range.removeClass("is-animated")},201)),l(this.handles[0],i[0]),this.handles[1]&&(this.handles[1].hasClass("is-animated")&&this.handles[1].data("animationTimeout",setTimeout(function(){e.handles[1].removeClass("is-animated").trigger("slide-animation-end"),e.range.removeClass("is-animated")},201)),l(this.handles[1],i[1]),this.handles[0].attr("aria-valuemax",t[1]),this.handles[1].attr("aria-valuemin",t[0]))},checkHandleDifference:function(e,t,i){if(!$("html").hasClass("ie9")){var s=this.convertValueToPercentage(t),n=this.convertValueToPercentage(i);Math.abs(s-n)>3&&(e.addClass("is-animated"),this.range.addClass("is-animated"))}},updateTooltip:function(e){if(this.settings.tooltip){if(!e){var t=this.handles[0].data("tooltip"),i=void 0;return this.handles[1]&&(i=this.handles[1].data("tooltip")),t.hide(),void(i&&i.hide())}var s=e.data("tooltip");e.hasClass("is-animated")?(s.hide(),e.one("slide-animation-end",function(){n()})):n()}function n(){s.position(),e.focus()}},getColorClosestToValue:function(){for(var e={light:{default:"#000000","very-poor":"#a13030",poor:"#d66221",adequate:"#f2bc41",good:"#9cce7c","very-good":"#76b051",superior:"#488421"},dark:{default:"#ffffff","very-poor":"#a13030",poor:"#d66221",adequate:"#f2bc41",good:"#9cce7c","very-good":"#76b051",superior:"#488421"},contrast:{default:"#000000","very-poor":"#a13030",poor:"#d66221",adequate:"#e4882b",good:"#76b051","very-good":"#56932e",superior:"#397514"}}[H.currentTheme.id.split("-")[2]],t=this.value()[0],i=void 0,s=void 0,n=0;n<this.ticks.length;n++)(s=this.ticks[n].color)&&t>=this.ticks[n].value&&(i=s,i=s.indexOf("#")>-1?s:e[s]||e.default);return i},value:function(e,t){var i=this;return void 0===e&&void 0===t?i._value:(e&&$.isArray(e)&&(void 0!==e[1]&&(t=e[1]),e=e[0]),void 0===e&&$.isArray(i._value)&&void 0!==i._value[0]&&(e=i._value[0]),void 0===t&&$.isArray(i._value)&&void 0!==i._value[1]&&(t=i._value[1]),i._value=[e,t],i.element.val(void 0!==t?i._value:i._value[0]),$.each(i.handles,function(e,t){var s=i._value[e],n=i.getModifiedTextValue(s);$.each(i.ticks,function(e,t){t.value===s&&(n=t.description)}),t.attr({"aria-valuenow":i._value[e],"aria-valuetext":n})}),i.element.trigger("change"),i._value)},getModifiedTextValue:function(e){return this.settings.tooltip?this.settings.tooltip[0]+e+this.settings.tooltip[1]:e},enable:function(){this.element.prop("disabled",!1),this.element.prop("readonly",!1),this.wrapper.removeClass("is-readonly"),this.wrapper.removeClass("is-disabled");var e=this;return $.each(this.handles,function(t,i){e.enableHandleDrag(i)}),this},disable:function(){this.element.prop("disabled",!0),this.element.prop("readonly",!1),this.wrapper.removeClass("is-readonly"),this.wrapper.addClass("is-disabled");var e=this;return $.each(this.handles,function(t,i){e.disableHandleDrag(i)}),this},readonly:function(){var e=this;return this.element.prop("disabled",!0),this.element.prop("readonly",!0),this.wrapper.removeClass("is-disabled"),this.wrapper.addClass("is-readonly"),$.each(this.handles,function(t,i){e.disableHandleDrag(i)}),this},isDisabled:function(){return this.element.prop("disabled")},isVertical:function(){return this.wrapper.hasClass("vertical")},setValue:function(e,t){var i=this.value();this.checkHandleDifference(this.handles[0],i[0],e),this.handles[1]&&this.checkHandleDifference(this.handles[1],i[1],t);var s=this.value(e,t);return this.updateRange(),this.updateTooltip(),s},refresh:function(e,t){return D(this.setValue,this.refresh).apply(this,[e,t])},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.element.removeAttr("value"),this.teardown().init()},teardown:function(){var e=this;return $.each(e.handles,function(t,i){e.disableHandleDrag(i),i.off("mousedown.slider click.slider blur.slider keydown.slider keyup.slider")}),this.wrapper.off("click.slider touchend.slider touchcancel.slider").remove(),this.element.attr("type",s.ensureAlphaNumeric(this.originalElement.type)),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"slider")},bindEvents:function(){var e=this;return $.each(e.handles,function(t,i){i.on("mousedown.slider",function(){e.isDisabled()||$(this).focus()}).on("click.slider",function(e){e.preventDefault()}).on("keydown.slider",function(t){e.activateHandle(i),e.handleKeys(t,e)}).on("keyup.slider blur.slider",function(){e.deactivateHandle(i)}),e.enableHandleDrag(i)}),e.wrapper.on("click.slider touchend.slider touchcancel.slider",function(t){e.handleRangeClick(t)}),e.element.on("updated.slider",function(){e.updated()}),e}},$.fn.slider=function(e){return this.each(function(){var t=$.data(this,"slider");t?t.updated(e):t=$.data(this,"slider",new Ri(this,e))})};function zi(e,t){this.element=$(e),this.settings=m.mergeSettings(e,t),this.init()}zi.prototype={init:function(){return this.build().handleEvents()},build:function(){return this.viewport=this.element.find("meta[name=viewport]"),this.body=$("body"),this},handleEvents:function(){var e=this;return this.element.on("updated.zoom",function(){e.updated()}).on("enable-zoom",function(){e.enableZoom()}).on("disable-zoom",function(){e.disableZoom()}),"ios"!==l.os.name?this:(this.body.on("touchstart.zoomdisabler","input, label",function(){e.noZoomTimeout||e.disableZoom()}).on("touchend.zoomdisabler","input, label",function(){e.noZoomTimeout&&(clearTimeout(e.noZoomTimeout),e.noZoomTimeout=null),e.noZoomTimeout=setTimeout(function(){e.noZoomTimeout=null,e.enableZoom()},600)}),this)},enableZoom:function(){this.viewport[0].setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=1")},disableZoom:function(){this.viewport[0].setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=0")},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},teardown:function(){return this.element.off("updated.zoom enable-zoom disable-zoom"),this.body.off("touchstart.zoomdisabler touchend.zoomdisabler"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"zoom")}},$.fn.zoom=function(e){return this.each(function(){var t=$.data(this,"zoom");t?t.updated(e):t=$.data(this,"zoom",new zi(this,e))})};var Hi={autocorrectOnBlur:!1,min:-2147483647,max:2147483647,step:null,validateOnInput:!0};function qi(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Hi),this.init()}qi.prototype={get isTouch(){return l.features.touch},init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=this.element.parent().is(".inline"),this.isWrapped=this.element.parent().is(".spinbox-wrapper"),this.setInitialValue().addMarkup().bindEvents().setWidth()},setWidth:function(){var e=this.element[0].style;return e.width&&(this.element.parent()[0].style.width=parseInt(e.width,10)+2*this.element.parent().find(".down").outerWidth()+"px"),this},setInitialValue:function(){var e=this.checkForNumeric(this.element.val());return this.element.val(e),this.element.attr("data-trackdirty")&&this.element.data("original",e),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&this.element.attr("pattern","\\d*"),this.element.attr("max")?this.settings.max=this.element.attr("max"):this.settings.max&&this.element.attr("max",this.settings.max),this.element.attr("step")?this.settings.max=this.element.attr("step"):this.settings.step&&this.element.attr("step",this.settings.step),this.element.attr("min")?this.settings.max=this.element.attr("min"):this.settings.min&&this.element.attr("min",this.settings.min),this},addMarkup:function(){if(this.isInlineLabel)this.inlineLabel.addClass("spinbox-wrapper");else if(!this.isWrapped){if(this.element.is(".field-options")){var e=this.element.closest(".field").find(".btn-actions");this.element.add(e).add(e.next(".popupmenu")).wrapAll('<span class="spinbox-wrapper"></span>')}else this.element.wrap('<span class="spinbox-wrapper"></span>')}this.isWrapped&&(this.buttons={down:this.element.parent().find(".down").button(),up:this.element.parent().find(".up").button()},this.isTouch&&(this.buttons.down.attr("aria-hidden","true"),this.buttons.up.attr("aria-hidden","true"))),this.buttons||(this.buttons={down:$("<span "+(this.isTouch?"":'aria-hidden="true"')+' class="spinbox-control down">-</span>').insertBefore(this.element).button(),up:$("<span "+(this.isTouch?"":'aria-hidden="true"')+' class="spinbox-control up">+</span>').insertAfter(this.element).button()});var t=this.element.attr("min"),i=this.element.attr("max"),s=this.element.attr("data-mask"),n="",a={role:"spinbutton"},r=0;if(t||i||s||(i="9999999"),(t||i)&&!s){var o="",l=t||"",d=i||"",c=l.length>d.length?l:d;for(r=0;r<=c.length;)o+="#",r++;-1===l.indexOf("-")&&-1===d.indexOf("-")||(o="-"+o.substring(0,o.length-1)),a["data-mask"]=o,s=o}var h=s.length;for(r=0;r<=h;)n+="9",r++;return-1===s.indexOf("-")?(a.min=t||0,a.max=i||n):(a.min=t||n,a.max=i||n.substring(0,n.length-1)),this.element.attr("data-mask-mode")&&"number"===this.element.attr("data-mask-mode")||(a["data-mask-mode"]="number"),this.element.data("mask")&&"object"===u(this.element.data("mask"))&&this.element.data("mask").destroy(),a["aria-valuemin"]=t||0,a["aria-valuemax"]=i||0,this.element.attr(a),this.updateAria(this.element.val()),this.element.mask(),this.isDisabled()&&this.disable(),this.element.attr("readonly")&&this.readonly(),this},enableLongPress:function(e,t){t.addButtonStyle(e),t.longPressInterval=setInterval(function(){$(e.currentTarget).is(":hover")&&t.handleClick(e)},250)},disableLongPress:function(e,t){t.removeButtonStyle(e),clearInterval(t.longPressInterval),t.longPressInterval=null},handleClick:function(e){(e.preventDefault(),this.isDisabled()||1!==e.which||this.isReadonly())||($(e.currentTarget).hasClass("up")?this.increaseValue():this.decreaseValue(),this.safeFocus())},handleKeyDown:function(e,t){var i=e.which;if(-1!==$.inArray(i,[35,36,37,38,39,40])&&!this.isReadonly())switch(i){case 35:t.element.attr("min")&&t.element.val(t.element.attr("min"));break;case 36:t.element.attr("max")&&t.element.val(t.element.attr("max"));break;case 38:t.addButtonStyle(t.buttons.up),t.increaseValue();break;case 40:t.addButtonStyle(t.buttons.down),t.decreaseValue()}},handleKeyPress:function(e,t){var i=e.which;if(!(i<48||i>57&&i<96||i>105))return this.handleInput(e,t)},handleInput:function(e,t){if(!t.isDisabled()&&!this.isReadonly()&&!this.settings.autocorrectOnBlur)return this.correctValue(e)},handleKeyup:function(e,t){if(!t.isDisabled()&&!this.isReadonly()){var i=e.which;switch(i){case 38:case 39:k.isRTL()&&39===i?t.removeButtonStyle(t.buttons.down):t.removeButtonStyle(t.buttons.up);break;case 37:case 40:k.isRTL()&&39===i?t.removeButtonStyle(t.buttons.up):t.removeButtonStyle(t.buttons.down)}t.updateAria(t.element.val())}},handleAfterPaste:function(e){var t=Number(e.element.attr("min")),i=Number(e.element.attr("max")),s=Number(e.element.val());s<t&&(s=t),s>i&&(s=i),e.updateVal(s)},correctValue:function(e){var t=Number(this.element.val()),i=this.element.attr("min"),s=this.element.attr("max");return t<i?(e&&e.preventDefault(),this.updateVal(i)):t>s?(e&&e.preventDefault(),this.updateVal(s)):void 0},increaseValue:function(){var e=this.element.attr("max"),t=this.checkForNumeric(this.element.val())+Number(this.element.attr("step")||1);return e&&t>e?this.updateVal(e):this.updateVal(t)},decreaseValue:function(){var e=this.element.attr("min"),t=this.checkForNumeric(this.element.val())-Number(this.element.attr("step")||1);return e&&t<e?this.updateVal(e):this.updateVal(t)},updateVal:function(e){this.element.val(e).trigger("change"),this.updateAria(e)},checkForNumeric:function(e){return""===e?e:$.isNumeric(e)?Number(e):(e=parseInt(e,10),$.isNumeric(e)?Number(e):0)},updateAria:function(e){var t=this.element.attr("min"),i=this.element.attr("max");e=this.checkForNumeric(e),this.element[0].setAttribute("aria-valuenow",e||"0"),this.element[0].setAttribute("autocomplete","off"),this.setIsDisabled(this.buttons.up,""!==e&&i&&e>=i?"disable":"enable"),this.setIsDisabled(this.buttons.down,""!==e&&t&&e<=t?"disable":"enable")},addButtonStyle:function(e){if(!this.isDisabled()&&!this.isReadonly()){var t=e;e.currentTarget&&(t=$(e.currentTarget)),t.addClass("is-active")}},removeButtonStyle:function(e){if(!this.isDisabled()&&!this.isReadonly()){var t=e;e.currentTarget&&(t=$(e.currentTarget)),t.removeClass("is-active")}},safeFocus:function(){var e="ios"===l.os.name||"android"===l.os.name;e&&$("head").triggerHandler("disable-zoom"),this.element.focus(),e&&$("head").triggerHandler("enable-zoom")},enable:function(){this.element.prop("disabled",!1),this.element.parent(".spinbox-wrapper").removeClass("is-disabled is-readonly")},disable:function(){this.element.prop("disabled",!0),this.element.parent(".spinbox-wrapper").addClass("is-disabled")},readonly:function(){this.element.prop("readonly",!0),this.element.parent(".spinbox-wrapper").addClass("is-readonly")},isReadonly:function(){return this.element.prop("readonly")},isDisabled:function(){return this.element.prop("disabled")},setIsDisabled:function(e,t){e[(t=void 0===t||!(!t||"enable"===t))?"addClass":"removeClass"]("is-disabled")},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this},destroy:function(){var e=this.element.data("mask");for(var t in e&&"function"==typeof e.destroy&&e.destroy(),this.buttons){var i=$(t).data("button");i&&i.destroy()}this.buttons.up.off("click.spinbox mousedown.spinbox"),this.buttons.up.remove(),this.buttons.down.off("click.spinbox mousedown.spinbox"),this.buttons.down.remove(),this.element.off("focus.spinbox blur.spinbox keydown.spinbox keyup.spinbox"),this.element.unwrap(),$.removeData(this.element[0],"spinbox")},bindEvents:function(){var e=this,t=!1;return this.element.on("focus.spinbox",function(){e.element.parent(".spinbox-wrapper").addClass("is-focused")}).on("blur.spinbox",function(){e.element.parent(".spinbox-wrapper").removeClass("is-focused"),e.settings.autocorrectOnBlur&&e.correctValue()}).on("keydown.spinbox",function(t){e.handleKeyDown(t,e)}).on("input.spinbox",function(t){e.handleInput(t,e)}).on("keyup.spinbox",function(t){e.handleKeyup(t,e)}).on("afterpaste.mask",function(){e.handleAfterPaste(e)}),this.buttons.up.add(this.buttons.down[0]).on("touchstart.spinbox mousedown.spinbox",function(i){if(1===i.which){if(t||e.handleClick(i),e.isTouch)return;t=!0,e.enableLongPress(i,e),$(document).one("mouseup",function(){e.disableLongPress(i,e),t=!1,e.safeFocus()})}}),this}},$.fn.spinbox=function(e){return this.each(function(){var t=$.data(this,"spinbox");t?t.updated(e):t=$.data(this,"spinbox",new qi(this,e))})};var Vi={axis:"x",side:"left",resize:"immediate",containment:null,save:!0,maxWidth:{left:"auto",right:"auto"}};function Wi(e,t){this.settings=m.mergeSettings(e,t,Vi),this.element=$(e),this.init()}Wi.prototype={init:function(){return this.build().handleEvents()},build:function(){var e=this,t=this.settings,i=this.element,s=i.parent(),n="x"===t.axis?"left":"top",a=s.is(".content")?s.parent():s,r=s.width(),o=void 0;if(setTimeout(function(){o=s.height()},0),this.docBody=$("body"),this.isSplitterRightSide=i.is(".splitter-right")||"x"===t.axis&&"right"===t.side,this.isSplitterHorizontal=i.is(".splitter-horizontal")||"y"===t.axis,t.uniqueId=m.uniqueId(this.element,"splitter"),this.isSplitterRightSide){var l=a.prev();if(l.is(".main")?(this.leftSide=l,r=a.parent().outerWidth()-r):(this.leftSide=a,i.addClass("splitter-right")),a.addClass("is-right-side").next().addClass("flex-grow-shrink is-right-side").parent().addClass("splitter-container"),t.collapseButton){var d=0;$('<button type="button" class="splitter-btn" id="splitter-collapse-btn"><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-double-chevron"></use></svg></button>').appendTo(i),i[0].offsetLeft>10&&$("#splitter-collapse-btn").addClass("rotate"),$("#splitter-collapse-btn").click(function(){d<=0?i[0].offsetLeft<=10?(e.splitTo(299,o),$(this).addClass("rotate")):(d=i[0].offsetLeft,e.splitTo(0,o),$(this).removeClass("rotate")):i[0].offsetLeft>10?(d=i[0].offsetLeft,e.splitTo(0,o),$(this).removeClass("rotate")):(e.splitTo(d,o),$(this).addClass("rotate"),d=0)})}}else this.isSplitterHorizontal?(this.topPanel=i.prev(),r=this.topPanel.height(),s.addClass("splitter-container is-horizontal"),i.next().addClass("flex-grow-shrink"),i.addClass("splitter-horizontal")):(this.rightSide=a,this.leftSide=a.prev().parent(),a.prev().addClass("flex-grow-shrink").parent().addClass("splitter-container"));return localStorage&&t.save&&!isNaN(parseInt(localStorage[t.uniqueId],10))&&(r=localStorage[t.uniqueId]),r=parseInt(r,10),this.isSplitterHorizontal?i[0].style.top=r+"px":i[0].style.top=0,this.splitTo(r,o),r<=10&&$("#splitter-collapse-btn").removeClass("rotate"),this.documentWidth=0,this.element.drag({axis:t.axis,containment:t.containment||"x"===t.axis?"document":"parent",containmentOffset:{left:20,top:0}}).on("dragstart.splitter",function(){var t=$("iframe");if(e.documentWidth=$(document).width(),t.length>0)for(var i=0,s=t.length;i<s;i++){var n=$(t[i]),a=parseInt(getComputedStyle(n.parent()[0]).width,10)-40+"px",r=$('<div class="overlay splitter-overlay"></div>');r.css("width",a),n.before(r)}}).on("dragend.splitter",function(i,s){$(".overlay").remove(),t.collapseButton&&(s[n]<=10?$("#splitter-collapse-btn").removeClass("rotate"):$("#splitter-collapse-btn").addClass("rotate")),"end"===t.resize&&e.splitTo(s[n],o)}).on("drag.splitter",function(i,s){return!(s.left<=0)&&("immediate"===t.resize&&e.splitTo(s[n],o),!0)}),"y"===t.axis&&this.element.addClass("splitter-horizontal"),this.element.attr({"aria-dropeffect":"move",tabindex:"0","aria-grabbed":"false"}),this},toggleSelection:function(){this.element.toggleClass("is-dragging")},resizeTop:function(e,t,i){(t>i||t<0)&&(t=parseInt(i,10)/2),this.topPanel[0].style.height=t+"px"},resizeLeft:function(e,t){var i=this.leftSide.outerWidth()-t;this.rightSide[0].style.width=i+"px",e[0].style.left=""},resizeRight:function(e,t){this.leftSide[0].style.width=t+"px",e[0].style.left=t-1+"px"},splitTo:function(e,t){var i=this.settings,s=this.element;this.isSplitterRightSide?(e>i.maxWidth.right&&(e=i.maxWidth.right),this.resizeRight(s,e)):this.isSplitterHorizontal?this.resizeTop(s,e,t):(e>i.maxWidth.left&&(e=i.maxWidth.left),this.resizeLeft(s,e)),this.element.trigger("split",[e]),this.docBody.triggerHandler("resize",[this]),localStorage&&(localStorage[this.settings.uniqueId]=e),this.split=e,this.parentHeight=t},unbind:function(){return this.element.off("updated.splitter"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Vi)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"splitter")},handleEvents:function(){var e=this;return this.element.on("updated.splitter",function(){e.updated()}).on("keydown.splitter",function(t){32===t.which&&(e.toggleSelection(),t.preventDefault()),37===t.which&&e.splitTo(e.split-15,e.parentHeight),39===t.which&&e.splitTo(e.split+15,e.parentHeight)}),this}},$.fn.splitter=function(e){return this.each(function(){var t=$.data(this,"splitter");t?t.updated(e):t=$.data(this,"splitter",new Wi(this,e))})};var ji={searchable:!1,available:null,selected:null,additional:null,availableClass:".available",selectedClass:".selected",additionalClass:".full-access",availableBtn:".btn-moveto-selected",selectedBtnLeft:".btn-moveto-left",selectedBtnRight:".btn-moveto-right",additionalBtn:".btn-moveto-selected",draggable:{available:!0,selected:!0,additional:!0},template:'<ul data-swap-handle=".handle">{{#dataset}}{{#text}}<li data-id="{{id}}"{{#value}} data-value="{{value}}"{{/value}}{{#selected}} selected="selected"{{/selected}}{{#disabled}} class="is-disabled"{{/disabled}}><span class="handle" focusable="false" aria-hidden="true" role="presentation">&#8286;</span><div class="swaplist-item-content"><p>{{text}}</p></div></li>{{/text}}{{/dataset}}</ul>'};function Gi(e,t){this.settings=m.mergeSettings(e,t,ji),this.element=$(e),this.init()}Gi.prototype={init:function(){var e=this,t=this.settings;t.draggable=$.extend(!0,ji.draggable,t.draggable),this.isTouch=l.features.touch,this.isAdditional=$(t.additionalClass+" .listview",this.element).length>0,this.isTouch&&this.element.addClass("is-touch"),this.loadListview(),this.initDataset(),this.setElements(),this.isMultiSelectClass(),setTimeout(function(){e.makeDraggable(),e.handleEvents(),e.initSelected(t.availableClass),e.initSelected(t.additionalClass)},0)},loadListview:function(){for(var e=this.settings,t=[{dataset:e.available,class:e.availableClass,draggable:e.draggable.available},{dataset:e.selected,class:e.selectedClass,draggable:e.draggable.selected},{dataset:e.additional,class:e.additionalClass,draggable:e.draggable.additional}],i=0,s=t.length;i<s;i++){var n=t[i],a=$(n.class+" .listview",this.element),r=a.data("listview"),o={dataset:n.dataset||[],selectable:"multiple",showCheckboxes:!1};(!0===e.searchable||"true"===e.searchable)&&$(n.class+" .searchfield",this.element).length>0&&(o.searchable=!0),!n.dataset&&a.length&&$("li",a).length?a.listview(o):a.length&&(r&&r.destroy(),-1===e.template.indexOf('data-id="{{id}}"')&&(e.template=e.template.replace("<li",'<li data-id="{{id}}"')),o.template=e.template,o.dataset=n.dataset||[],o.dataset.forEach(function(e){/string|number/.test(u(e.id))&&""!==e.id||(e.id="sw"+(Date.now().toString(36)+Math.round(Math.random()*Math.pow(36,12)).toString(36).substr(2,5)).toLowerCase())}),0===o.dataset.length&&(o.forceToRenderOnEmptyDs=!0),a.listview(o)),n.draggable||$("ul",a).addClass("is-not-droppable")}},setElements:function(){var e=this.settings,t="";this.offset=null,this.containers=$(e.availableClass+","+e.selectedClass+","+e.additionalClass,this.element),this.actionButtons=$(e.availableBtn+","+e.additionalBtn+","+e.selectedBtnLeft+","+e.selectedBtnRight,this.element),this.selectedButtons=$(e.selectedBtnLeft+","+e.selectedBtnRight,this.element),this.tabButtonsStr=e.availableBtn+", "+e.additionalBtn+", "+(this.selectedButtons.length>1?e.selectedBtnRight:e.selectedBtnLeft),this.dragElements="ul:not(.is-not-droppable), ul:not(.is-not-droppable) li:not(.is-disabled)",this.dragStart="dragstart.swaplist touchstart.swaplist gesturestart.swaplist",this.dragEnterWhileDragging="dragenter.swaplist",this.dragOverWhileDragging="dragover.swaplist touchmove.swaplist gesturechange.swaplist",this.dragEnd="dragend.swaplist touchend.swaplist touchcancel.swaplist gestureend.swaplist",this.selections={items:[],owner:null,related:null,droptarget:null,isInSelection:null,isHandle:null,placeholder:null,placeholderTouch:null,dragged:null,draggedIndex:null},e.numOfSelectionsClass="num-of-selections",e.itemContentClass="swaplist-item-content",e.itemContentTempl=$('<div><p><span class="'+e.numOfSelectionsClass+'">###</span> '+(k?k.translate("ItemsSelected"):" Items Selected ")+"</p><div/>"),e.draggable.available||(t=e.availableClass+" "+e.availableBtn+","+e.selectedBtnLeft,$(t,this.element).prop("disabled",!0)),e.draggable.selected||(t=e.selectedBtnLeft+","+e.selectedBtnRight,e.draggable.available||(t+=","+e.additionalClass+" "+e.additionalBtn),this.isAdditional&&e.draggable.additional||(t+=","+e.availableClass+" "+e.availableBtn),$(t,this.element).prop("disabled",!0),$(e.additionalClass+" "+e.additionalBtn,this.element).addClass("is-rotate")),e.draggable.additional||$(e.additionalClass+" "+e.additionalBtn+","+e.selectedBtnRight,this.element).prop("disabled",!0)},isMultiSelectClass:function(){for(var e=this.settings,t=[e.availableClass,e.selectedClass,e.additionalClass],i=0,s=t.length;i<s;i++){var n=$(t[i]+" .listview",this.element);$("li",n).length||n.addClass("is-multiselect")}},initSelected:function(e){if((e=this.isjQuery(e)?e:$(e,this.element)).length){for(var t=$(".listview",e).data("listview"),i=$("li[selected]",e),s=0,n=i.length;s<n;s++){var a=$(i[s]);a.removeAttr("selected"),t.select(a)}this.moveElements(e,this.settings.selectedClass)}},moveElements:function(e,t){if(null!==t){e="string"!=typeof e?e:$(e,this.element),t="string"!=typeof t?t:$(t,this.element);var i=$(".listview",e).data("listview");if(this.clearSelections(),this.selections.owner=e,this.selections.droptarget=t,this.isTouch){if(i.selectedItems)for(var s=0,n=i.selectedItems.length;s<n;s++)this.selections.items[s]=i.selectedItems[s].closest("li")}else this.selections.items=i.selectedItems;if(this.setSelectionsItems(this.selections.owner),this.unselectElements(i),this.selections.items.length){this.selections.move={items:this.selections.itemsData,from:this.getContainer(this.selections.itemsData)};var a=this.element.triggerHandler("beforeswap",[this.selections.move]);if("boolean"==typeof a&&!a||"string"==typeof a&&"false"===a.toLowerCase())return;var r=$("ul",t),o=$("li",r).length,l=this.selections.items.length+o;if(this.selections.items)for(var d=0,c=this.selections.items.length;d<c;d++){var h=$(this.selections.items[d]);h.attr({"aria-posinset":o+d+1,"aria-setsize":l}).find("mark.highlight").contents().unwrap(),r.append(h)}this.afterUpdate($(".listview",t).data("listview"))}}},getContainer:function(e){var t=this.settings;if("object"===u(e[0])&&e[0].node){var i=e[0].node.closest(".card"),s="";return i.is(t.availableClass)?s=t.availableClass:i.is(t.selectedClass)?s=t.selectedClass:i.is(t.additionalClass)&&(s=t.additionalClass),{container:i,class:s}}return null},unselectElements:function(e){if(e.selectedItems)for(var t=0,i=e.selectedItems.length;t<i;t++)e.select($(e.selectedItems[t]));e&&e.element&&e.element.find("li").attr("aria-selected",!1).removeClass("is-selected")},isDragAndDropSupports:function(){var e=document.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},isMatchMediaSupports:function(){return void 0!==window.matchMedia||void 0!==window.msMatchMedia},viewport:function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},isMaxWidth:function(e){return this.isMatchMediaSupports()&&window.matchMedia("(max-width: "+e+"px)").matches||this.viewport().width<=e},makeDraggable:function(){var e=this,t=$("ul",this.element);this.isDragAndDropSupports&&(this.handle=t.first().attr("data-swap-handle"),this.handle=$(this.handle,t).length>0?this.handle:null,$(this.handle,t).addClass("draggable").off("mousedown.swaplist touchstart.swaplist").on("mousedown.swaplist touchstart.swaplist",function(){e.selections.isHandle=!0}).off("mouseup.swaplist touchend.swaplist").on("mouseup.swaplist touchend.swaplist",function(){e.selections.isHandle=!1}),this.targets=t.attr({"aria-dropeffect":"none"}),this.items=$("li:not(.is-disabled)",this.element).not("a[href], img").off("selectstart.swaplist").on("selectstart.swaplist",function(){return this.dragDrop&&this.dragDrop(),!1}).end().attr({draggable:!0}).addClass(this.handle?"":"draggable"))},getElementByTouchInList:function(e,t,i){for(var s=!1,n=$(e),a=0,r=n.length;a<r;a++){var o=$(n[a]),l=o.offset();t<=l.left||t>=l.left+o.outerWidth()||i<=l.top||i>=l.top+o.outerHeight()||(s=o)}return s},draggTouchElement:function(e,t){var i=e.originalEvent.changedTouches[0];t[0].style.top=i.pageY-this.offset.y+"px",t[0].style.left=i.pageX-this.offset.x+"px"},hasModifier:function(e){return e.ctrlKey||e.metaKey||e.shiftKey},addDropeffects:function(){if(this.targets)for(var e=0,t=this.targets.length;e<t;e++)$(this.targets[e]).attr({"aria-dropeffect":"move",tabindex:0});if(this.selections&&this.selections.items)for(var i=0,s=this.selections.items.length;i<s;i++)$(this.selections.items[i]).attr({"aria-grabbed":!0,tabindex:0})},clearDropeffects:function(){if(this.targets.attr({"aria-dropeffect":"none"}).removeAttr("tabindex"),this.selections&&this.selections.items)for(var e=0,t=this.selections.items.length;e<t;e++){var i=$(this.selections.items[e]);i.removeAttr("aria-grabbed"+(i.is(":focus")?"":" tabindex"))}},clearSelections:function(){this.selections.items=[],this.selections.itemsData=[],this.selections.owner=null,this.selections.related=null,this.selections.droptarget=null,this.selections.isInSelection=null,this.selections.dragged=null,this.selections.placeholder=null,this.selections.placeholderTouch=null,$("ul, li",this.element).removeClass("over"),$("#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder").remove()},setSelectionsItems:function(e){e=this.isjQuery(e)?e:$(e,this.element);for(var t=$(".listview li",e),i=this.getDataList(e),s=0,n=t.length;s<n;s++)$(t[s]).is(".is-selected")&&this.selections.itemsData.push(i[s])},initDataset:function(){var e=this.settings,t=[{type:"available",dataset:e.available,class:e.availableClass},{type:"selected",dataset:e.selected,class:e.selectedClass},{type:"additional",dataset:e.additional,class:e.additionalClass}];this.dataset={available:[],selected:[]},this.isAdditional&&(this.dataset.additional=[]);for(var i=0,s=t.length;i<s;i++)for(var n=t[i],a=$(n.class+" .listview li",this.element),r=0,o=a.length;r<o;r++){var l=void 0,d=void 0,c=$(a[r]);n.dataset?delete(l=JSON.parse(JSON.stringify(n.dataset[r]))).selected:(l={text:$.trim($(".swaplist-item-content",c).text())},(d=c.attr("data-value"))&&(l.value=d)),this.dataset[n.type]&&(l.node=c,this.dataset[n.type].push(l))}},getDataList:function(e){var t=this.settings,i=this.dataset;return(e=this.isjQuery(e)?e:$(e,this.element)).is(t.additionalClass)?i.additional:e.is(t.selectedClass)?i.selected:e.is(t.availableClass)?i.available:[]},arrayIndexMove:function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},syncDataset:function(e,t){for(var i=$(".listview li",t),s=e.find(".listview").data("listview"),n=t.find(".listview").data("listview"),a=this.getDataList(e),r=this.getDataList(t),o=function(e,t){if(e&&t){var i={owner:e.getAttribute("data-id"),item:t.getAttribute("data-id")};return void 0!==i.owner&&void 0!==i.item&&i.owner===i.item}return!1},l=0,d=this.selections.items.length;l<d;l++)for(var c=this.selections.items[l],h=0,u=i.length;h<u;h++)if($(i[h]).is(c))for(var p=0,g=a.length;p<g;p++){var f=a[p];if(o(f.node[0],c[0])){r.push(f),a.splice(p,1),this.arrayIndexMove(r,r.length-1,h);break}}s.updated({dataset:a}),n.updated({dataset:r}),this.makeDraggable()},isjQuery:function(e){return e&&(e instanceof jQuery||e.constructor.prototype.jquery)},updateAttributes:function(e){for(var t=$("li",e),i=0,s=t.length;i<s;i++)$(t[i]).attr({"aria-posinset":i+1,"aria-setsize":s})},afterUpdate:function(e){var t=this.selections.droptarget.find("li:focus").index(),i=".card."+this.selections.droptarget[0].classList[1]+" li";e&&(this.selections.placeholder&&(e.select(this.selections.placeholder),this.selections.placeholder.focus()),this.unselectElements(e),this.syncDataset(this.selections.owner,this.selections.droptarget),this.updateAttributes($(".listview",this.selections.owner)),this.updateAttributes($(".listview",this.selections.droptarget)),this.selections.items.length&&(this.selections.move=$.extend(!0,this.selections.move,{to:this.getContainer(this.selections.itemsData)}),this.element.triggerHandler("swapupdate",[this.selections.move]))),this.selections.items.forEach(function(e){e.show()}),this.clearDropeffects(),this.clearSelections(),this.items.removeClass("is-dragging is-dragging-touch"),t>=0&&this.element.find(i).eq(t).focus()},getItems:function(e){return e=this.isjQuery(e)?e:$(e,this.element),this.getDataList(e)},getAvailable:function(){return this.getDataList(this.settings.availableClass)},getSelected:function(){return this.getDataList(this.settings.selectedClass)},getAdditional:function(){return this.getDataList(this.settings.additionalClass)},draggedMakeSelected:function(e,t){var i=!1;if(!this.selections.isInSelection){if(e.selectedItems)for(var s=0,n=e.selectedItems.length;s<n;s++)if(t.is(e.selectedItems[s]))return i=!0,!1;i||(e.select(t),this.selections.isInSelection=!0)}return!0},updateDataset:function(e){for(var t=this.settings,i=[{type:"available",dataset:e.available,class:t.availableClass},{type:"selected",dataset:e.selected,class:t.selectedClass},{type:"additional",dataset:e.additional,class:t.additionalClass}],s=0,n=i.length;s<n;s++){var a=i[s],r=$(a.class+" .listview",this.element),o=r.data("listview");o&&(o.deselectItemsBetweenIndexes([0,$("li",r).length-1]),t[a.type]=a.dataset||[],o.loadData(t[a.type]))}this.initDataset(),this.makeDraggable(),this.initSelected(t.availableClass),this.initSelected(t.additionalClass)},unbind:function(){return this.actionButtons.off("click.swaplist"),this.containers.off("keydown.swaplist",".listview"),this.selectedButtons.off("keydown.swaplist"),this.element.off("keydown.swaplist",this.tabButtonsStr),this.element.off(this.dragStart+" "+this.dragEnterWhileDragging+" "+this.dragOverWhileDragging+" "+this.dragEnd,this.dragElements),$("#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder").remove(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,ji)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"swaplist")},handleEvents:function(){var e=this,t=e.settings,i=e.selections;e.actionButtons.off("click.swaplist").on("click.swaplist",function(){var i=$(this),s=i.closest(".card"),n=null;s.is(t.availableClass)?(n=t.draggable.selected?t.selectedClass:e.isAdditional&&t.draggable.additional?t.additionalClass:null,e.moveElements(t.availableClass,n)):s.is(t.additionalClass)?(n=t.draggable.selected?t.selectedClass:t.draggable.available?t.availableClass:null,e.moveElements(t.additionalClass,n)):s.is(t.selectedClass)&&(i.is(t.selectedBtnLeft)?e.moveElements(t.selectedClass,t.availableClass):i.is(t.selectedBtnRight)&&e.moveElements(t.selectedClass,t.additionalClass))}),e.containers.on("keydown.swaplist",".listview",function(i){var s=$(this).closest(e.containers);77===(i=i||window.event).keyCode&&e.hasModifier(i)&&(!s.is(t.selectedClass)||s.is(t.selectedClass)&&1===e.selectedButtons.length?s.find(e.actionButtons).trigger("click.swaplist"):e.selectedButtons.first().focus(),i.preventDefault())}),e.selectedButtons.on("keydown.swaplist",function(t){var i=$(this),s=void 0,n=void 0;13!==(t=t||window.event).keyCode&&32!==t.keyCode||(i.trigger("click.swaplist"),t.preventDefault()),(37===t.keyCode||39===t.keyCode)&&e.selectedButtons.length>1&&(s=e.selectedButtons.index(this),n=37===t.keyCode?s>0?s-1:e.selectedButtons.length-1:s<e.selectedButtons.length-1?s+1:0,e.selectedButtons[n].focus())}),e.element.on("keydown.swaplist",e.tabButtonsStr,function(e){var t=$(this);if(9===(e.keyCode||e.which)&&!e.shiftKey){var i=t.closest(".card")[0],s=[].slice.call(i.querySelectorAll("li[tabindex]")),n=s.length,a=!1;if(n&&s.forEach(function(e){-1!==parseInt(e.getAttribute("tabindex"),10)&&(a=!0)}),!a){var r=i.querySelector("li");r&&r.setAttribute("tabindex",0)}}}),e.containers.on("filtered.swaplist",".listview",function(){e.makeDraggable()}),e.element.on("mousedown.swaplist",e.dragElements,function(t){e.handle&&$(t.target).closest("li").attr({draggable:$(t.target).is(".draggable")});t.stopPropagation()}).on(e.dragStart,e.dragElements,function(s){if(s.stopImmediatePropagation(),!e.handle||i.isHandle){var n=void 0,a=void 0,r=$(s.target).closest("li"),o=$(".listview",r.closest(".card")).data("listview");if(o){e.isTouch||e.draggedMakeSelected(o,r),e.clearSelections(),i.owner=r.closest(".card"),i.dragged=r,i.draggedIndex=r.index(),i.placeholder=r.clone(!0),i.placeholder.attr("id","sl-placeholder"),e.setSelectionsItems(i.owner),i.items=o.selectedItems,e.selections.move={items:e.selections.itemsData,from:e.getContainer(e.selections.itemsData)};var l=e.element.triggerHandler("beforeswap",[e.selections.move]);if("boolean"==typeof l&&!l||"string"==typeof l&&"false"===l.toLowerCase())i.dragged=null;else{if($("."+t.numOfSelectionsClass,t.itemContentTempl).html(i.items.length),e.addDropeffects(),e.isTouch){n=r[0].getBoundingClientRect(),a=s.originalEvent.changedTouches[0],e.offset={x:a.pageX-n.left,y:a.pageY-n.top};for(var d=0,c=e.containers.length;d<c;d++)e.containers[d].style.zIndex="1";i.placeholderTouch=i.dragged.clone(!0),i.items.length>1&&!$("#sl-placeholder-touch2").length&&i.dragged.clone().addClass("is-dragging-touch").attr("id","sl-placeholder-touch2").insertBefore(i.dragged).hide(),i.placeholderTouch.attr("id","sl-placeholder-touch").removeClass("is-selected").hide(),(e.element.is(".one-third")&&e.isMaxWidth(766)?e.element.parent():e.element).prepend('<ul id="sl-placeholder-container"></ul>'),$("#sl-placeholder-container").append(i.placeholderTouch),$("#sl-placeholder-container")[0].style.width=i.owner.width()+"px",$("#sl-placeholder-touch")[0].style.width=i.owner.width()+"px",e.draggTouchElement(s,i.placeholderTouch)}else i.dragged.addClass("is-dragging"),s.originalEvent.dataTransfer.setData("text",""),i.items.length>1&&$("."+t.itemContentClass,i.dragged).html(t.itemContentTempl.html());s.stopPropagation()}}}else s.stopPropagation()}).on(e.dragEnterWhileDragging,e.dragElements,function(t){i.dragged&&(e.element.triggerHandler("draggingswap",[i.move]),i.related=t.target,$("ul, li",e.element).removeClass("over"),$(t.target).closest("ul, li").addClass("over"),i.droptarget=$(i.related).closest(".card"),$('[aria-grabbed="true"]',e.element).not(i.dragged).slideUp(),t.stopPropagation())}).on(e.dragOverWhileDragging,e.dragElements,function(s){if(i.dragged){var n=void 0,a=$(this),r=$(".listview",i.dragged.closest(".card")).data("listview");if(e.isTouch){if(e.handle&&!i.isHandle)return;i.isInSelection||(e.draggedMakeSelected(r,i.dragged),i.items=r.selectedItems,$("."+t.numOfSelectionsClass,t.itemContentTempl).html(i.items.length)),n=s.originalEvent.touches[0],a=e.getElementByTouchInList($("ul, li",e.element),n.pageX,n.pageY)||a,i.dragged.addClass("is-dragging"),i.placeholderTouch.addClass("is-dragging is-dragging-touch"),i.placeholderTouch.show(),$('[aria-grabbed="true"]',e.element).not(i.dragged).not(i.placeholderTouch).not("#sl-placeholder-touch2").slideUp(),i.items.length>1&&($("."+t.itemContentClass,i.placeholderTouch.add("#sl-placeholder-touch2")).html(t.itemContentTempl.html()),$("#sl-placeholder-touch2").show(),i.dragged.hide()),e.draggTouchElement(s,i.placeholderTouch),e.element.triggerHandler("draggingswap",[i.move]),i.related=a,$("ul, li",this.element).removeClass("over"),a.closest("ul, li").addClass("over"),i.droptarget=i.related.closest(".card")}s.preventDefault(),s.stopPropagation()}}).on(e.dragEnd,e.dragElements,function(s){if(i.dragged){var n=$(i.related).closest("li"),a=$("ul",i.droptarget),r=$("li",a).length,o=i.items.length+r;if(e.unselectElements($(".listview",i.owner).data("listview")),$.each(i.items,function(e,t){if((t=$(t)).find("mark.highlight").contents().unwrap(),r&&!$(i.related).is("ul")){var s=n.index()<i.draggedIndex,l=s?t:$(i.items[i.items.length-1-e]),d=n.index()+(s?e+1:e+2);t.attr({"aria-posinset":d,"aria-setsize":o}),n[s?"before":"after"](l)}else t.attr({"aria-posinset":r+e+1,"aria-setsize":o}),a.append(t);t.focus()}),i.items.length>1&&($("."+t.itemContentClass,i.dragged).html($("."+t.itemContentClass,i.placeholder).html()),e.isTouch&&i.dragged.show()),e.isTouch)for(var l=0,d=e.containers.length;l<d;l++)e.containers[l].style.zIndex="";e.makeDraggable(),i.isHandle=null,$('[aria-grabbed="true"]',e.element).show(),e.afterUpdate($(".listview",i.droptarget).data("listview")),s.preventDefault(),s.stopPropagation()}})}},$.fn.swaplist=function(e){return this.each(function(){var t=$.data(this,"swaplist");t?t.updated(e):t=$.data(this,"swaplist",new Gi(this,e))})};var Ui={scrollActionTarget:".js-scroll-target",classToAdd:"scrolled-down"};function _i(e,t){this.settings=m.mergeSettings(e,t,Ui),this.element=$(e),this.init()}_i.prototype={init:function(){this.handleEvents()},unbind:function(){var e=this.settings;return this.element.off("scroll.scrollaction"),e&&$(e.scrollActionTarget).removeClass(e.classToAdd),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Ui)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"scrollaction")},handleEvents:function(){var e=this,t=this.settings;this.lastScrollTop=0,this.element.on("scroll.scrollaction",function(){var i=e.element.scrollTop();i>e.lastScrollTop?$(t.scrollActionTarget).addClass(t.classToAdd):$(t.scrollActionTarget).removeClass(t.classToAdd),e.lastScrollTop=i})}},$.fn.scrollaction=function(e){return this.each(function(){var t=$.data(this,"scrollaction");t?t.updated(e):t=$.data(this,"scrollaction",new _i(this,e))})};var Ki={steps:null,completed:null,inProgress:null,iconType:null,completedText:null,extraText:"",completedColor:null,allCompletedColor:null,inProgressColor:null};function Yi(e,t){return this.init(e,t)}Yi.prototype={init:function(e,t){if(!this.element&&e instanceof HTMLElement&&(this.element=$(e)),"object"===(void 0===t?"undefined":u(t))||void 0===this.settings){var i=this.settings||Ki;this.settings=m.mergeSettings(this.element[0],t,i)}return this.render()},render:function(){var e=$('<div class="step-chart-steps"></div>'),t='\n      <svg class="icon {icon-name}" focusable="false" aria-hidden="true" role="presentation">\n        <use xlink:href="#icon-success"></use>\n      </svg>\n    ',i=null===this.settings.completed&&null===this.settings.steps;if(i&&(this.settings.completed=0,this.settings.steps=1),this.element.attr("data-options")&&(this.settings=m.parseSettings(this.element)),this.element.children().length>0)return this;for(var s=0;s<this.settings.steps;s++){var n=$('<div class="step-chart-step"></div>');s<this.settings.completed&&(n.addClass("is-complete"),this.settings.completedColor&&n.css("background-color",this.settings.completedColor)),s===this.settings.inProgress-1&&(n.addClass("is-inprogress"),this.settings.inProgressColor&&n.css("background-color",this.settings.inProgressColor)),e.append(n)}var a=this.settings.completedText||k.translate("StepsCompleted");a=(a=a.replace("{0}",this.settings.completed)).replace("{1}",this.settings.steps),i&&(a=k?k.translate("NoData"):"No Data Available");var r=$('<span class="step-chart-label">'+a+"</span>");if(this.settings.steps===this.settings.completed&&(e.addClass("is-complete"),r.append(t.replace("{icon-name}","icon-success"))),this.settings.iconType&&r.append(t.replace("{icon-name}",this.settings.iconType)),this.settings.extraText){var o=this.settings.extraText;o=(o=(o="{1} Days Overdue"===(o="{0} Days Remaining"===o?k.translate("DaysRemaining"):o)?k.translate("DaysOverdue"):o).replace("{0}",this.settings.steps-this.settings.completed)).replace("{1}",this.settings.completed),r.append('<span class="step-chart-label-small">'+o+"</span>")}return this.element.append(r,e),this.settings.steps===this.settings.completed&&this.settings.allCompletedColor&&(e.find(".step-chart-step").css("background-color",this.settings.allCompletedColor),r.find(".icon").attr("style","fill: "+this.settings.allCompletedColor+"!important")),this},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),this.element.empty(),this.render()},destroy:function(){return this.element.empty(),this.settings=null,$.removeData(this.element[0],"stepchart"),this}},$.fn.stepchart=function(e){return this.each(function(){var t=$.data(this,"stepchart");t?t.updated(e):(t=$.data(this,"stepchart",new Yi(this,e))).destroy=function(){this.teardown(),$.removeData(this,"stepchart")}})};var Xi=["horizontal","vertical","module-tabs","header-tabs"],Ji={addTabButton:!1,addTabButtonCallback:null,appMenuTrigger:!1,appMenuTriggerText:void 0,ajaxOptions:null,beforeActivate:void 0,containerElement:null,changeTabOnHashChange:!1,hashChangeCallback:null,lazyLoad:!0,moduleTabsTooltips:!1,source:null,sourceArguments:{},tabCounts:!1,verticalResponsive:!1};function Qi(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Ji),this.init()}Qi.prototype={init:function(){return this.setup().build().setupEvents()},setup:function(){return this.tabsIndex=$(".tab-container").index(this.element),this},build:function(){var e=this,t=this,i=void 0,s=!1;(i=this.element.next(".tab-panel-container")).length||(i=this.element.children(".tab-panel-container"),this.isVerticalTabs()||(s=!0));var n=$("body > .page-container, .application-menu + .page-container");this.element.closest(".header").length>0&&n.length&&(i=n),this.element.next(".application-menu").length&&(i=this.element.next().next(".page-container"),s=!1),this.settings.containerElement&&$(this.settings.containerElement).length&&(i=$(this.settings.containerElement),s=!1),i&&i.length||(i=$('<div class="tab-panel-container"></div>'),s=!0),i[0].classList.contains("tab-panel-container")||i[0].classList.add("tab-panel-container"),s&&i.insertAfter(this.element),this.container=i;var a=this.element.children(".tab-list-container");!a.length&&this.isScrollableTabs()&&(a=$('<div class="tab-list-container"></div>').prependTo(this.element)),a.length&&(this.tablistContainer=a);var r=!0,o=this.element.closest(".header");Xi.forEach(function(t,i){e.element.hasClass(Xi[i])&&(r=!1)}),r&&(o.length?t.element.addClass("header-tabs"):t.element.addClass("horizontal")),t.settings.tabCounts&&t.element.addClass("has-counts"),this.tablist=this.element.children(".tab-list"),this.tablist.length||(this.tablistContainer&&(this.tablist=this.tablistContainer.children(".tab-list")),this.tablist.length||(this.tablist=$('<ul class="tab-list"></ul>'),this.tablistContainer?this.tablist.appendTo(this.tablistContainer):this.tablist.appendTo(this.element))),this.tablistContainer&&(this.tablist.parent().is(this.tablistContainer)||this.tablistContainer.append(this.tablist),this.tablistContainer.on("mousewheel.tabs",function(e){e.deltaY&&(this.scrollLeft+=e.deltaY)})),t.tablist.attr({class:"tab-list",role:"tablist","aria-multiselectable":"false"}),this.checkResponsive(!1),this.renderHelperMarkup(),t.anchors=t.tablist.children("li:not(.separator)").children("a"),t.anchors.each(function(){var e=$(this);e.attr({role:"tab","aria-expanded":"false","aria-selected":"false",tabindex:"-1"}).parent().attr("role","presentation").addClass("tab"),e.parent().hasClass("dismissible")&&!e.parent().children(".icon").length&&$.createIconElement({icon:"close",classes:"icon close"}).insertAfter(e);var i=e.nextAll("ul").first();i.length>0&&(i.addClass("dropdown-tab"),e.parent().addClass("has-popupmenu").popupmenu({menu:i,trigger:"click",attachToBody:!0}),e.removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected"),e.parent().children(".icon.icon-more").length||$.createIconElement({classes:"icon-more",icon:"dropdown"}).insertAfter(e));t.settings.tabCounts&&0===$(this).find(".count").length&&$(this).prepend('<span class="count">0 </span>'),t.settings.moduleTabsTooltips&&e.on("beforeshow.toolbar",function(){return"yes"===e.data("cutoffTitle")}).tooltip({content:""+e.text().trim()})}),t.panels=$(),t.anchors.each(function(){var e=$(this),i=e.parent(),s=i.data("popupmenu"),n=void 0,a=e.attr("href");if("#"===a.substr(0,1)){if("#/"===a.substr(0,2)&&(a=a.replace("#/","#")),void 0!==a&&"#"!==a){if(n=$(a),i.is(":not(.has-popupmenu)")&&!n.length)return;e.data("panel-link",n),n.data("tab-link",e),t.panels=t.panels.add(n)}s&&s.menu.children("li").each(function(){var e=$(this),i=e.children("a"),s=i.attr("href"),n=$(s);if(i.data("panel-link",n),n.data("tab-link",i),t.panels=t.panels.add(n),t.anchors=t.anchors.add(i),e.hasClass("dismissible")){var a=e.children(".icon");a.length||(a=$.createIconElement({icon:"close",classes:"icon close"})),a.detach().appendTo(i)}}).on("click.popupmenu",".icon",function(e){var i=$(this),s=i.closest("li");s.is(".dismissible")&&i.is(".icon")&&(e.preventDefault(),e.stopPropagation(),t.closeDismissibleTab(s.children("a").attr("href")))})}}),t.panels.addClass("tab-panel").attr({role:"tabpanel"}).find("h3:first").attr("tabindex","0"),t.panels.appendTo(t.container);var l=":not(.separator):not(.is-disabled):not(.is-hidden)",d=this.tablist.children("li"+l),c=this.tablist.children("li.is-selected"+l),h=c.children("a"),u=void 0,p=void 0;return t.nestedTabControls=t.panels.find(".tab-container"),d.length&&(this.settings.changeTabOnHashChange&&(u=window.location.hash)&&u.length&&(p=d.find('a[href="'+u+'"]')).length&&(h=(c=p.first().parent()).children("a")),c.length||(h=(c=d.not(".add-tab-button, .application-menu-trigger").first()).children("a")),c.length&&this.activate(h.attr("href"),h)),this.isModuleTabs()&&this.element.children(".toolbar").length&&this.element.addClass("has-toolbar"),this.setOverflow(),this.positionFocusState(h),this.hasAnimatedBar()&&(this.animatedBar.addClass("no-transition"),this.focusBar(void 0,function(){setTimeout(function(){e.animatedBar.removeClass("no-transition")},0)})),this.tablistContainer&&(this.tablistContainer.on("scroll.tabs",function(){e.renderEdgeFading()}),this.renderEdgeFading()),this},renderHelperMarkup:function(){var e=this.tablistContainer||this.tablist;this.isModuleTabs()&&(e=this.tablist),this.focusState=this.element.find(".tab-focus-indicator"),this.focusState.length||(this.focusState=$('<div class="tab-focus-indicator" role="presentation"></div>').insertBefore(this.tablist)),this.hasAnimatedBar()?(this.animatedBar=this.element.find(".animated-bar"),this.animatedBar.length||(this.animatedBar=$('<div class="animated-bar" role="presentation"></div>')),this.animatedBar.insertBefore(this.tablist)):this.animatedBar&&this.animatedBar.length&&(this.animatedBar.off().removeData().remove(),this.animatedBar=void 0),this.moreButton||(this.moreButton=$()),this.isVerticalTabs()?this.moreButton.length&&(this.moreButton.off().removeData().remove(),this.moreButton=$()):(this.moreButton.length||(this.moreButton=e.next(".tab-more")),this.moreButton.length||(this.moreButton=$("<div>").attr({class:"tab-more"}),this.moreButton.append($('<span class="more-text">').text(k.translate("More"))),this.moreButton.append($.createIconElement({classes:"icon-more",icon:"dropdown"}))),e.after(this.moreButton));var t=this.tablist.find(".application-menu-trigger");return!0===this.settings.appMenuTrigger?this.isModuleTabs()?t.length||(t=$('\n            <li class="tab application-menu-trigger">\n              <a href="#">\n                <span class="icon app-header">\n                  <span class="one"></span>\n                  <span class="two"></span>\n                  <span class="three"></span>\n                </span>\n                <span>'+(this.settings.appMenuTriggerText||k.translate("AppMenuTriggerText"))+"</span>\n              </a>\n            </li>\n          "),this.tablist.prepend(t)):this.isVerticalTabs()&&t.length&&t.off().removeData().remove():t.length&&(this.isVerticalTabs()?t.off().removeData().remove():this.tablist.prepend(t)),this.settings.addTabButton?this.addTabButton&&this.addTabButton.length||(this.addTabButton=$('\n          <div class="add-tab-button" tabindex="0" role="button">\n            <span aria-hidden="true" role="presentation">+</span>\n            <span class="audible">'+k.translate("AddNewTab")+"</span>\n          </div>\n        "),this.addTabButton.insertAfter(this.moreButton),this.element.addClass("has-add-button")):this.addTabButton&&this.addTabButton.length&&(this.addTabButton.off().removeData().remove(),this.addTabButton=void 0,this.element.removeClass("has-add-button")),this},setupEvents:function(){var e=this,t=this,i=t.element.closest(".modal");return i.length&&i.on("afteropen.tabs",function(){t.hasAnimatedBar()&&t.focusBar()}),this.tablist.on("mousedown.tabs","> li",function(e){if(t.handleAddFocusData(e,$(this)),$(e.target).hasClass("close")&&$(e.target).parent().hasClass("has-popupmenu")){var i=$(this).data("popupmenu").menu,s=[];$.each(i[0].children,function(e,t){s.push(t.children[0].href)}),t.closeDismissibleTabs(s)}return 3!==e.which&&t.handleTabClick(e,$(this))}).on("click.tabs","a",function(e){var t=$(e.currentTarget);!0!==this.wasTapped?("touchend"===e.type&&(this.wasTapped=!0),"#"===t.attr("href").substr(0,1)&&e.preventDefault()):this.wasTapped=!1}).on("click.tabs",".icon",function(e){var i=$(this);if(!i.is("[disabled]")&&!i.parent().hasClass("is-disabled")){var s=$(i).parent();s.hasClass("dismissible")&&(e.preventDefault(),e.stopPropagation(),t.closeDismissibleTab(s.children("a").attr("href")))}}).on("focus.tabs","a",function(e){return t.handleTabFocus(e,$(this))}).on("blur.tabs","a",function(){$(this).parent().removeClass("is-focused")}).on("keydown.tabs","a",function(t){return e.handleTabKeyDown(t)}),t.tablist.find("li").filter(".has-popupmenu").each(function(e,i){var s=$(i),n=s.children("a");function a(e){e.altKey&&s.is(".dismissible")&&t.closeDismissibleTab(n.attr("href"))}s.data("popupmenu").menu.on("keydown.popupmenu","a",function(e){switch(e.which){case 27:s.addClass("is-selected"),n.focus();break;case 8:case 46:a(e)}}),s.on("selected.tabs",function(e,i){var s=$(this),a=$(i).attr("href");return!!t.activate(a,$(i))&&(t.positionFocusState(n),t.hasAnimatedBar()&&t.focusBar(s),n.focus(),t.scrollTabList(s),s.addClass("is-selected"),!1)})}),t.tablist.find("li").filter(".dismissible").each(function(e,i){$(i).children("a").on("keydown.tabs",function(e){t.handleDismissibleTabKeydown(e)})}),this.setupHelperMarkupEvents(),this.panels.on("keydown.tabs",function(e){t.handlePanelKeydown(e)}),this.element.on("focusout.tabs",function(){var e=!$.contains(t.element[0],document.activeElement),i=0===t.tablist.children(".has-popupmenu.is-open").length;e&&i&&!t.moreButton.is(".is-selected, .popup-is-open")&&t.hideFocusState()}).on("updated.tabs",function(e,i){t.updated(i)}).on("activated.tabs",function(e){e.stopPropagation()}).on("add.tabs",function(e,i,s,n){t.add(i,s,n)}).on("remove.tabs",function(e,i){t.remove(i)}),$("body").on("resize.tabs"+this.tabsIndex,function(){t.handleResize()}),t.handleResize(!0),$(".tab-panel input").on("error.tabs, valid.tabs",function(){var e=$(".tab.is-selected");t.focusBar(e)}),this},setupHelperMarkupEvents:function(){var e=this;this.moreButton.on("click.tabs",function(t){e.handleMoreButtonClick(t)}).on("keydown.tabs",function(t){e.handleMoreButtonKeydown(t)}).on("focus.tabs",function(t){e.handleMoreButtonFocus(t)}).on("mousedown.tabs",function(t){e.handleAddFocusData(t,$(this))}),this.settings.addTabButton&&this.addTabButton.on("click.tabs",function(){e.handleAddButton()}).on("keydown.tabs",function(t){e.handleAddButtonKeydown(t)}).on("focus.tabs",function(t){e.handleAddButtonFocus(t)})},removeHelperMarkupEvents:function(){return this.moreButton&&this.moreButton.length&&this.moreButton.off("click.tabs keydown.tabs focus.tabs mousedown.tabs"),this.addTabButton&&this.addTabButton.length&&this.addTabButton.off("click.tabs keydown.tabs focus.tabs"),this},handleAddFocusData:function(e,t){var i=t;return i.is(".is-disabled")?(e.preventDefault(),!1):(i.is(this.moreButton)||(i=i.children("a")),this.hideFocusState(),i.data("focused-by-click",!0),!0)},handleTabClick:function(e,t){if(this.element.is(".is-disabled")||t&&(t.is(".is-disabled")||t.is(".separator")))return e.stopPropagation(),e.preventDefault(),!1;if(!this.handleAppMenuTabKeydown(e))return!0;var i=t.children("a");if(i.data("focused-by-click",!0),this.popupmenu&&this.popupmenu.element.hasClass("is-open")&&this.popupmenu.close(),t.is(".has-popupmenu"))return this.positionFocusState(i),!0;var s=i.attr("href");return t.is(".add-tab-button")&&(t=(i=this.handleAddButton()).parent(),s=i.attr("href"),this.element.trigger("tab-added",[i])),2===e.which?(t.is(".dismissible")&&$(e.target).is(".close")&&this.closeDismissibleTab(s),e.preventDefault(),!0):!this.activate(s,i)||(this.changeHash(s),this.focusState.removeClass("is-visible"),i.focus(),this.isScrollableTabs()&&this.scrollTabList(t),this.focusBar(t),this.positionFocusState(i),!0!==this.settings.lazyLoad||!this.isURL(s))},handleMoreButtonClick:function(e){return this.element.is(".is-disabled")||this.moreButton.is(".is-disabled")?(e.preventDefault(),e.stopPropagation(),!1):(this.moreButton.data("focused-by-click",!0),this.hasMoreButton()||e.stopPropagation(),this.moreButton.hasClass("popup-is-open")?(this.popupmenu.close(),this.moreButton.removeClass("popup-is-open")):this.buildPopupMenu(),this.hideFocusState(),!0)},handleTabFocus:function(e,t){if(this.element.is(".is-disabled"))return e.preventDefault(),!1;var i=t.parent(),s=t.data("focused-by-click"),n=void 0===s||s&&!1===s;return $.removeData(t[0],"focused-by-click"),this.isTabOverflowed(i)?(this.buildPopupMenu(t.attr("href")),this.moreButton.addClass("is-focused"),this.positionFocusState(this.moreButton)):(i.addClass("is-focused"),this.positionFocusState(t,n)),!0},handleMoreButtonFocus:function(e){if(this.element.is(".is-disabled"))e.preventDefault();else{var t=this.moreButton.data("focused-by-click"),i=t&&!1===t;$.removeData(this.moreButton[0],"focused-by-click"),this.focusState.removeClass("is-visible"),this.positionFocusState(this.moreButton,i)}},handleTabKeyDown:function(e){if(this.element.is(".is-disabled"))return e.preventDefault(),!1;if(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey&&8!==e.which)return!0;var t=this,i=[8,13,32];function s(){return $.inArray(e.which,i)>-1}if(e.which<32&&!s()||e.which>46)return!0;if(s()&&!this.handleAppMenuTabKeydown(e))return!0;function n(i){e.preventDefault(),setTimeout(function(){t.buildPopupMenu(i)},0)}var a=":not(.separator):not(.is-disabled):not(:hidden)",r=$(e.currentTarget).parent(),o=r.children("a"),l=void 0,d=t.tablist.children("li"+a),c=k.isRTL();function h(){for(var e=d.index(r)-1;e>-1&&!l;){if(d.eq(e).is(a))return d.eq(e);e-=1}if(t.settings.addTabButton)return t.addTabButton;var i=t.tablist.children("li"+a).last();return t.hasMoreButton()&&t.isScrollableTabs()&&n(i.find("a").attr("href")),i}function u(){for(var e=d.index(r)+1;e<d.length&&!l;){if(d.eq(e).is(a))return d.eq(e);e++}var i=t.tablist.children("li"+a).first();return t.hasMoreButton()&&t.isScrollableTabs()?(n(i.find("a").attr("href")),i):t.settings.addTabButton?t.addTabButton:i}function p(){if(r.hasClass("has-popupmenu"))r.data("popupmenu").open();else{var e=o.attr("href");r.is(".add-tab-button")&&(o=t.handleAddButton(),r=o.parent(),e=o.attr("href"),t.element.trigger("tab-added",[o])),t.activate(e)&&(t.changeHash(e),t.focusBar(r),(o.attr("ng-click")||o.attr("data-ng-click"))&&o.click(),o[0].focus(),t.hideFocusState(),t.handleOutboundLink(e))}}switch(e.which){case 8:return e.altKey&&r.is(".dismissible")&&(e.preventDefault(),t.closeDismissibleTab(o.attr("href"))),!0;case 13:case 32:return p(),!1;case 38:l=h(),e.preventDefault();break;case 37:l=c?u():h(),e.preventDefault();break;case 40:l=u(),e.preventDefault();break;case 39:l=c?h():u(),e.preventDefault()}if(l){var g=l.is(".add-tab-button"),f=g?l:l.children("a");if(this.isTabOverflowed(l))return n(l.children("a").attr("href"));g?t.addTabButton.focus():f.focus(),this.isScrollableTabs()&&this.scrollTabList(f),t.positionFocusState(f,!0)}return!0},handleDismissibleTabKeydown:function(e){var t=e.which,i=$(e.target);if(i.is("a")&&(i=i.parent()),e.altKey&&46===t){if(i.children("a").is("[disabled]")||i.hasClass("is-disabled"))return;e.preventDefault(),this.closeDismissibleTab(i.children("a").attr("href"))}},handleAppMenuTabKeydown:function(e){var t=$(e.target);if(!t.parent().is(".application-menu-trigger")&&!t.is(".application-menu-trigger"))return!0;var i=$("#application-menu");return!!i.length&&(e.preventDefault(),this.hideFocusState(),i.hasClass("is-open")?(i.trigger("close-applicationmenu"),!1):(i.trigger("open-applicationmenu"),!1))},handleMoreButtonKeydown:function(e){if(this.element.is(".is-disabled"))return e.preventDefault(),!1;var t=this,i=k.isRTL();function s(){e.preventDefault(),t.buildPopupMenu(t.tablist.find(".is-selected").children("a").attr("href")),t.positionFocusState(t.moreButton,!0)}function n(){e.preventDefault(),t.findLastVisibleTab()}switch(e.which){case 37:if(i){s();break}n();break;case 38:n();break;case 13:case 32:e.preventDefault();break;case 39:if(i){n();break}s();break;case 40:s()}return!0},handlePanelKeydown:function(e){var t=e.which,i=$(e.target),s=this.anchors.filter("#"+i.attr("id"));return this.anchors.filter("#"+i.attr("id")).parent().is(".dismissible")&&e.altKey&&46===t?(e.preventDefault(),this.closeDismissibleTab(s.attr("href"))):e.ctrlKey&&38===t&&$.contains(document.activeElement,i[0])?(e.preventDefault(),this.activate(s.attr("href"),s)):void 0},handleAddButton:function(){var e=this,t=this.settings.addTabButtonCallback;if(t&&"function"==typeof t){var i=t();return this.anchors.filter('[href="#'+i+'"]')}var s,n=this.tablist.children().index(this.addTabButton),a=(e.idCounter="number"==typeof e.idCounter?e.idCounter:-1,e.idCounter++,"new-tab-"+e.idCounter),r={name:((s=a.toString().split("-")).forEach(function(e,t){s[t]=e.charAt(0).toUpperCase()+e.slice(1)}),s.join(" ")),content:"&nbsp;",isDismissible:!0};n<0&&(n=this.tablist.find("li:not(.separator)").length);var o=this.element.triggerHandler("before-tab-added",[a,r,n]);return o?(o.newId&&o.newId.length&&"string"==typeof o.newId&&(a=o.newId),o.settings&&"object"===u(o.settings)&&(r=o.settings),isNaN(o.newIndex)||(n=o.newIndex),this.add(a,r,n),this.anchors.filter('[href="#'+a+'"]')):(this.add(a,r,n),this.anchors.filter('[href="#'+a+'"]'))},handleAddButtonKeydown:function(e){if(this.element.is(".is-disabled"))return e.preventDefault(),!1;var t=e.which;if([13,32,37,38,39,40].indexOf(t)<0)return!1;var i=this,s=k.isRTL(),n=void 0,a="li:not(.separator):not(.is-disabled):not(:hidden)";function r(){e.preventDefault(),n=i.tablist.find(a).last(),i.isTabOverflowed(n)&&(i.buildPopupMenu(n.children("a").attr("href")),i.positionFocusState(i.moreButton,!0))}function o(){n=i.tablist.find(a).first()}switch(t){case 37:if(s){o();break}r();break;case 38:r();break;case 13:case 32:return e.preventDefault(),this.handleAddButton();case 39:if(s){r();break}o();break;case 40:o()}return n.children("a").focus(),!0},handleAddButtonFocus:function(){this.tablist.find("li:not(.separator)").add(this.moreButton).removeClass("is-focused"),this.addTabButton.addClass("is-focused"),this.positionFocusState(this.addTabButton,!0)},handleResize:function(e){e||this.checkResponsive(!0),this.setOverflow();var t=this.tablist.find(".is-selected");(!t.length||this.moreButton.is(".is-selected")||this.isTabOverflowed(t))&&(t=this.moreButton),t.length?(this.focusBar(t),this.positionFocusState(t)):(this.defocusBar(),this.hideFocusState()),this.handleVerticalTabResize(),this.renderVisiblePanel(),this.renderEdgeFading()},checkResponsive:function(e){var t=this,i=t.element[0].classList;function s(){t.removeHelperMarkupEvents(),t.renderHelperMarkup(),t.setupHelperMarkupEvents()}function n(){i.contains("is-in-responsive-mode")&&(i.add("vertical"),i.remove("is-in-responsive-mode"),i.remove("header-tabs"),i.remove("alternate"),e&&s())}this.isResponsiveVerticalTabs()&&a.isBelow("phone-to-tablet")?i.contains("is-in-responsive-mode")||(i.add("is-in-responsive-mode"),i.add("header-tabs"),i.add("alternate"),i.remove("vertical"),e&&s()):n()},handleVerticalTabResize:function(){if(this.isVerticalTabs()&&this.isNested()&&!this.isNestedInLayoutTabs()&&!this.isHidden()){var e=window.getComputedStyle(this.element[0]),t=e.getPropertyValue("height")+e.getPropertyValue("margin-top")+e.getPropertyValue("margin-bottom");this.tablist[0].style.height=t}},handleOutboundLink:function(e,t){"#"!==e.charAt(0)&&("/"!==e.charAt(0)||t&&!1!==t||(e=window.location.origin+e),window.location=e)},hasAnimatedBar:function(){return!this.isModuleTabs()&&!this.isVerticalTabs()},hasMoreButton:function(){return this.element[0].classList.contains("has-more-button")},isInResponsiveMode:function(){return this.element[0].classList.contains("is-in-responsive-mode")},isModuleTabs:function(){return this.element.hasClass("module-tabs")},isVerticalTabs:function(){return this.element.hasClass("vertical")},isResponsiveVerticalTabs:function(){return!0===this.settings.verticalResponsive},isHeaderTabs:function(){return this.element.hasClass("header-tabs")},isScrollableTabs:function(){return!this.isModuleTabs()&&!this.isVerticalTabs()},isHidden:function(){return this.element.is(":hidden")},isNested:function(){return this.element.closest(".tab-panel").length},isActive:function(e){return!(!e||!e.length||1===e.length&&e.indexOf("#")<1)&&this.getPanel(e)[0].classList.contains("can-show")},isNestedInLayoutTabs:function(){var e=this.element.closest(".module-tabs").length,t=this.element.closest(".header-tabs").length,i=this.element.closest(".tab-panel-container").length;return e>0||t>0||i>0},isTab:function(e){return e instanceof jQuery&&e.length&&e.is("li.tab")},isAnchor:function(e){return e instanceof jQuery&&e.length&&e.is("a")},getAnchor:function(e){return this.isAnchor(e)?e:(-1===e.indexOf("#")&&"/"!==e.charAt(0)&&(e="#"+e),this.anchors.filter('[href="'+e+'"]'))},getPanel:function(e){return this.isTab(e)&&(e=e.children("a")),this.isAnchor(e)&&(e=e.attr("href")),e&&""!==e&&"#"!==e?("#/"===e.substr(0,2)&&(e=e.replace("#/","#")),this.panels.filter('[id="'+e.replace(/#/g,"")+'"]')):$()},getMenuItem:function(e){return this.isAnchor(e)&&(e=e.attr("href")),-1===e.indexOf("#")&&(e="#"+e),this.moreMenu.children().children().filter('[data-href="'+e+'"]').parent()},getPreviousTab:function(e){for(var t=this.getTab(null,e),i="li:not(.separator):not(:hidden):not(.is-disabled)",s=this.tablist.find(i),n=s.index(t),a=s.eq(0===n?1:n-1);a.length&&!a.is(i);)a=s.eq(s.index(a)-1);if(a.is(".has-popupmenu")){var r=a.data("popupmenu");r&&(a=r.menu.children("li").first())}return a},activateAdjacentTab:function(e,t){var i=this.doGetTab(e,t);"string"==typeof e&&(t=e),i.is(".is-selected")?i.prevAll("li.tab").not(".hidden").not(".is-disabled").length>0?this.select($(i.prevAll("li.tab").not(".hidden").not(".is-disabled")[0]).find("a")[0].hash,!0):i.nextAll("li.tab").not(".hidden").length>0&&this.select($(i.nextAll("li.tab").not(".hidden").not(".is-disabled")[0]).find("a")[0].hash,!0):this.select($(this.element.find("li.tab.is-selected")[0]).find("a")[0].hash,!0)},activatePreviousTab:function(e,t){var i=this.getTab(null,e);if(t&&t instanceof jQuery||(t=this.getPreviousTab(e)),!t.length)return this.hideFocusState(),this.defocusBar(),t;var s=t.children("a");if(i.is(".is-selected")){if(!this.activate(s.attr("href"),s))return t;s.focus()}return this.positionFocusState(s),this.focusBar(t),t},isURL:function(e){return!(!e||0===e.indexOf("#"))},activate:function(e,t){var i=this;if(i.isURL(e))return this.callSource(e,t,!0);for(var s=i.getAnchor(e),n=s.parent(),a=i.getPanel(e),r=a[0],o=i.anchors.parents().filter(".is-selected"),l=void 0,d=void 0,c=void 0,h=0;h<i.panels.length;h++)i.panels[h].classList.contains("is-visible")&&(l=$(i.panels[h]));if(l||(l=i.panels),!i.element.trigger("beforeactivated",[s]))return!1;function u(t){if(a.length<1){if(i.settings.source)return i.callSource(e,s),!0}else{l[0].classList.remove("can-show"),l[0].classList.remove("is-visible"),l.closeChildren(),i.element.trigger("activated",[s]),r.classList.add("can-show"),i.renderVisiblePanel(),r.offsetHeight;var h=new B({duration:y.convertDelayToFPS(150),timeoutCallback:function(){i.element.trigger("afteractivated",[s])}});F.register(h),r.classList.add("is-visible")}i.updateAria(s),o.add(i.moreButton).removeClass("is-selected"),n[0]&&n[0].classList.contains("tab")&&(d=n,c=n);var u=n.parents(".popupmenu"),p=void 0;u.length&&(p=u.data("trigger")).length&&(d=p,c=p),i.isTabOverflowed(c)&&(c=i.moreButton,d=i.moreButton),i.focusBar(c),d&&d.addClass("is-selected");var g=a.find(".toolbar");return g.length&&g.each(function(){var e=$(this).data("toolbar");e&&"function"==typeof e.handleResize&&e.handleResize()}),m.fixSVGIcons(a[0]),t||!1}return this.settings.beforeActivate&&"function"==typeof this.settings.beforeActivate?this.settings.beforeActivate(o,n,u):u(!0)},renderEdgeFading:function(){if(this.isScrollableTabs()&&this.tablistContainer){var e=k.isRTL(),t=this.tablistContainer[0],i=t.scrollLeft,s=t.scrollWidth,n=parseInt(window.getComputedStyle(t).getPropertyValue("width"),10);e?(this.element[0].classList[i>0?"add":"remove"]("scrolled-left"),this.element[0].classList[s-i<=n?"remove":"add"]("scrolled-right")):(this.element[0].classList[i>0?"add":"remove"]("scrolled-right"),this.element[0].classList[s-i<=n?"remove":"add"]("scrolled-left"))}},callSource:function(e,t,i){var n=this;if((null==i||!1===i)&&!this.settings.source)return!1;if(!0!==this.settings.lazyLoad)return!1;var a=u(this.settings.source),r=function(a){if(null!=a){if(a=s.sanitizeHTML(a),i){var r=n.element[0].id||"",o=m.uniqueId(t,"tab",r);e="#"+o,t[0].setAttribute("href",e)}n.createTabPanel(e,a,!0),n.activate(e),n.element.triggerHandler("complete"),n.element.trigger("requestend",[e,a])}};function o(e,t){var i=$.extend({dataType:"html"},t,{url:e}),s=$.ajax(i);return s.done(r),s}if(this.container.triggerHandler("start"),this.container.trigger("requeststart"),i)return o(e,this.ajaxOptions);if("function"===a)return this.settings.source(r,e,this.settings.sourceArguments);if("string"===a){var l=e.replace(/#/g,""),d=this.settings.source.toString();if(!(d.indexOf(l)>-1)){var c="tab="+l,h=d.indexOf("?"),p=d.indexOf("#"),g=d.length;h<0?(c="?"+c,p>-1&&(g=p+1)):(c+="&",g=h+1),d=w.splice(d,g,0,c)}return o(d,this.ajaxOptions)}return!1},renderVisiblePanel:function(){this.resizeNestedTabs()},changeHash:function(e){if(this.settings.changeTabOnHashChange){e||(e=""),e.replace(/#/g,"");var t=this.settings.hashChangeCallback;t&&"function"==typeof t?t(e):window.location.hash=e,this.element.triggerHandler("hash-change",[e])}},updateAria:function(e){e&&(this.anchors.attr({"aria-selected":"false","aria-expanded":"false",tabindex:"-1"}),this.moreButton.attr({tabindex:"-1"}),e.length&&this.element.is(":not(.is-disabled)")&&(e.parent().removeClass("is-selected"),this.isTabOverflowed(e.parent())?this.moreButton.attr({tabindex:"0"}):e.attr({"aria-selected":"true","aria-expanded":"true",tabindex:"0"}).parent().addClass("is-selected")))},resizeNestedTabs:function(){this.nestedTabControls.each(function(e,t){var i=$(t).data("tabs");i&&i.handleResize&&"function"==typeof i.handleResize&&i.handleResize(!0)})},add:function(e,t,i){if(!e)return this;t||(t={});var n=0===this.tablist.find("li").not(".application-menu-trigger, .add-tab-button").length;function a(e){switch(void 0===e?"undefined":u(e)){case"string":if(null!==e.match(/#/g)){var t=$(e);e=t.length?t:e}}return e}e=""+e.replace(/#/g,""),t.name=t.name?t.name.toString():"&nbsp;",t.isDismissible=!!t.isDismissible&&!0===t.isDismissible,t.isDropdown=!!t.isDropdown&&!0===t.isDropdown,t.content&&(t.content=a(t.content)),t.dropdown&&(t.dropdown=a(t.dropdown));var r=$('<li role="presentation" class="tab"></li>'),o=$('<a href="#'+e+'" role="tab" aria-expanded="false" aria-selected="false" tabindex="-1">'+s.escapeHTML(t.name)+"</a>"),l=this.createTabPanel(e,t.content);if(r.html(o),t.isDismissible&&(r.addClass("dismissible"),r.append($.createIconElement({icon:"close",classes:"close icon"}))),this.settings.tabCounts&&o.prepend('<span class="count">0 </span>'),t.dropdown,function(e,t){var i=void 0,s=e.tablist.children("li"),n=s.not(".application-menu-trigger, .add-tab-button"),a=s.length-1;if(!s.length)return r.appendTo(e.tablist),void l.appendTo(e.container);var o=s.filter(".add-tab-button"),d=s.filter(".application-menu-trigger");(null==t||isNaN(t))&&(t=s.length),s.length>n.length&&(t>s.length-1&&o&&o.length&&(t-=1),function(e){return e<=0}(t)&&d&&d.length&&(t+=1));var c=s.eq(t).length>0;a=c?t:a,i="insertAfter",c&&(i="insertBefore"),r[i](s.eq(a)),l.appendTo(e.container)}(this,i),this.panels=$(this.panels.add(l)),this.anchors=$(this.anchors.add(o)),o.data("panel-link",l),l.data("tab-link",o),this.settings.moduleTabsTooltips&&o.on("beforeshow.toolbar",function(){return"yes"===o.data("cutoffTitle")}).tooltip({content:""+o.text().trim()}),this.isModuleTabs()&&this.adjustModuleTabs(),this.setOverflow(),n){if(this.positionFocusState(o),this.focusBar(r),!this.activate(o.attr("href")))return this;o.focus()}return t.doActivate&&this.activate(o.attr("href")),this},remove:function(e,t){var i=this,s=this.doGetTab(null,e);if(!s||!s.length)return!1;var n=s.children("a"),a=this.getPanel(e),r=a&&a.length,o=this.tablist.children("li").index(s),l=".application-menu-trigger, .separator, .is-disabled, :hidden",d=s.prev();if(!t&&!1===this.element.triggerHandler("beforeclose",[s]))return!1;var c=!1;s.hasClass("is-selected")?c=!0:d=$(this.tablist.children("li").not(l).filter(".is-selected")),r&&(this.panels=$(this.panels.not(a))),this.anchors=$(this.anchors.not(n)),this.settings.moduleTabsTooltips&&n.off("beforeshow.toolbar").data("tooltip").destroy();var h=s.data("popupmenu");s.hasClass("has-popupmenu")&&h&&(h.menu.children("li").each(function(){i.remove($(this).children("a").attr("href"))}),h.destroy());var u=s.closest(".dropdown-tab"),p=u.data("trigger");s.find(".icon").off().removeData().remove(),s.off(),n.off(),s.removeData().remove(),r&&a.removeData().remove();var g,f=n.data("moremenu-link");f&&(f.parent().off().removeData().remove(),n.removeData()),(g=u).length&&0===g.children("li:not(.separator)").length&&(d=this.getPreviousTab(p),setTimeout(function(){i.remove(p)},1)),p&&p.length&&p.data("popupmenu").close(),this.isModuleTabs()&&this.adjustModuleTabs(),this.setOverflow(),this.element.trigger("close",[s]);for(var m=o-1;m>-1;)m=-1,d.is(l)&&(d=this.tablist.children("li").not(l)[0],m-=1);if(d.length||(d=this.tablist.children("li").not(l).first()),!d.length)return this.hideFocusState(),this.defocusBar(),this.element.trigger("afterclose",[s]),this;var v=d.children("a"),b=v;return this.positionFocusState(v),c&&(d.is(".has-popupmenu")&&d.data("popupmenu")&&(b=d.data("popupmenu").menu.children().first().children("a")),!this.activate(b.attr("href")))?this:(this.focusBar(d),v.focus(),this.element.trigger("afterclose",[s]),this)},createTabPanel:function(e,t,i){e=e.replace(/#/g,"");var a=$('<div id="'+s.stripTags(e)+'" class="tab-panel" role="tabpanel"></div>');return t instanceof $&&(t=t[0]),n.html(a[0],t||"","*"),!0===i&&this.container.append(a),this.panels=$(this.panels.add(a)),a},checkPopupMenuItems:function(e){function t(e){if(!e||!e.menu)return $();var t=e.menu.children("li");return t.length?t:(e.destroy(),$())}if(e.is(".has-popupmenu"))return t(e.data("popupmenu"));var i=e.closest(".dropdown-tab");return i.length?t(i.data("popupmenu")):$()},getTab:function(e,t){var i,s=this,n=$();return t instanceof $&&t.length>0?t.is("a")?t.parent():t:e?(i=$(e.currentTarget)).is(".tab")?i:i.closest(".tab").length?i.closest(".tab").first():null:t?function(e){if(!e||""===e||"#"===e)return null;-1===e.indexOf("#")&&(e="#"+e);var t=s.anchors.filter('[href="'+e+'"]');return t.length?t.parent():null}(t):n},doGetTab:function(e,t){return(e||t)&&(!e||e instanceof $.Event||"string"==typeof e)?e?"string"!=typeof e?this.getTab(e):this.getTab(null,e):this.getTab(null,t):$()},hide:function(e,t){var i=this.doGetTab(e,t);return this.activateAdjacentTab(e,t),i.addClass("hidden"),this.select($(this.element.find("li.tab.is-selected")[0]).find("a")[0].hash),this.focusBar(),this.positionFocusState(),this},show:function(e,t){return this.doGetTab(e,t).removeClass("hidden"),this.select($(this.element.find("li.tab.is-selected")[0]).find("a")[0].hash),this.focusBar(),this.positionFocusState(),this},disableTab:function(e,t){var i=this.doGetTab(e,t);return this.activateAdjacentTab(e,t),i.addClass("is-disabled"),this.focusBar(),this.positionFocusState(),this},enableTab:function(e,t){return this.doGetTab(e,t).removeClass("is-disabled"),this.focusBar(),this.positionFocusState(),this},rename:function(e,t,i){if(e&&"string"==typeof e&&(i=t,t=e),i){var s=this.doGetTab(e,t),n=this.settings.tabCounts,a=this.settings.moduleTabsTooltips,r=s.children("a"),o=void 0;n&&(o=r.find(".count").clone()),r.text(i.toString()),n&&r.prepend(o),a&&r.data("tooltip").setContent(i.trim());var l=this.tablist.children("li").length<2?s:void 0;this.positionFocusState(l),this.focusBar(l)}},updateCount:function(e,t,i){if(e&&"string"==typeof e&&(i=t,t=e),this.settings.tabCounts&&i){var s=this.doGetTab(e,t);s.children("a").find(".count").text(i.toString()+" ");var n=this.tablist.children("li").length<2?s:void 0;this.positionFocusState(n),this.focusBar(n)}},getActiveTab:function(){var e=this.panels.filter(":visible");return this.anchors.filter('[href="#'+e.first().attr("id")+'"]')},getVisibleTabs:function(){var e=this,t=$();return this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)").each(function(){var i=$(this);e.isTabOverflowed(i)||(t=t.add(i))}),t},getOverflowTabs:function(){var e=this,t=$();return this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)").each(function(){var i=$(this);e.isTabOverflowed(i)&&(t=t.add(i))}),t},setOverflow:function(){var e=this,t=this.element[0],i=this.tablist[0],s=this.hasMoreButton(),n=this.isScrollableTabs();function a(){e.isModuleTabs()&&e.adjustModuleTabs()}a();var r=void 0,o=void 0,l=void 0;n?l=this.tablistContainer[0].scrollWidth>this.tablistContainer[0].offsetWidth:(r=window.getComputedStyle(i,null),o=parseInt(r.getPropertyValue("height"),10)+1,l=i.scrollHeight>o),l?s||(t.classList.add("has-more-button"),a()):s&&(t.classList.remove("has-more-button"),a()),this.adjustSpilloverNumber()},adjustModuleTabs:function(){var e=this,t=this.tablist.find("li:not(.separator):not(.application-menu-trigger):not(:hidden)"),i=this.tablist.find(".application-menu-trigger"),s=i.length>0,n=this.tablist.outerWidth(),a=120,r=s?i.outerWidth():0;if(t.children("a").removeAttr("style"),t.removeAttr("style").each(function(){var i=$(this);e.isTabOverflowed(i)&&(t=t.not(i))}),!t.length)return a=n-r+101,void(this.moreButton[0].style.width=a+"px");var o=window.getComputedStyle(t.eq(0).children()[0]),d=parseInt(o.paddingLeft,10)+parseInt(o.paddingRight,10);this.moreButton[0].hasAttribute("style")&&this.moreButton[0].removeAttribute("style"),(a=(n-r)/t.length-1)<120&&(a=120);for(var c=void 0,h="no",u=1===this.element.closest(".side-by-side").length,p=0;p<t.length;p++){(c=t.eq(p).children("a"))[0].style.width="",!0===this.settings.moduleTabsTooltips&&(h="no",parseInt(window.getComputedStyle(t[p]).width,10)>a-d&&(h="yes"),c.data("cutoffTitle",h));var g=0;"ios"===l.os.name&&l.devicespecs.isMobile&&u&&(g=25),t[p].style.width=a-g+"px",c[0].style.width=a-g+"px"}this.adjustSpilloverNumber()},adjustSpilloverNumber:function(){var e=this.moreButton.find(".more-text"),t=this.tablist.find("li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)"),i=this.getOverflowTabs();t.length<=i.length?e.text(""+k.translate("Tabs")):e.text(""+k.translate("More"));var s=this.moreButton.find(".count");s.length||(s=$('<span class="count"></span>'),this.moreButton.children("span").first().prepend(s)),s.text(i.length+" ")},select:function(e,t){var i=e.replace(/#/g,""),s=this.getAnchor(i);this.positionFocusState(void 0,!1),this.focusBar(s.parent()),this.activate(s.attr("href"))&&(this.changeHash(i),t||s.focus())},buildPopupMenu:function(e){var t=this;t.popupmenu&&(t.popupmenu.destroy(),$("#tab-container-popupmenu").off("focus.popupmenu").removeData().remove(),$(document).off("keydown.popupmenu"));var i=$("#tab-container-popupmenu"),s="";this.isScrollableTabs()&&(s=" is-selectable"),0===i.length?i=$('<ul id="tab-container-popupmenu" class="tab-list-spillover'+s+'">').appendTo("body"):i.html("");var n=t.tablist.children("li"),a=k.isRTL();function r(e){var s=$(e),n=s.children("a");if(!s.is(":hidden")&&(t.isScrollableTabs()||t.isTabOverflowed(s)))if(s.is(".separator"))s.clone().appendTo(i);else{var a=s.clone(),r=a.children("a");if(a[0].classList.remove("tab"),a[0].classList.contains("is-selected")&&(a[0].classList.remove("is-selected"),t.isScrollableTabs()&&a[0].classList.add("is-checked")),a[0].removeAttribute("style"),a.children(".icon").off().appendTo(r),a.appendTo(i),s.data("moremenu-link",r),r.find(".icon-more").removeData().remove(),r.data("original-tab",n),r.onclick=void 0,s.is(".has-popupmenu")){var o=$("#"+e.getAttribute("aria-controls")),l=o.clone(),d=l.children("li");l[0].classList.remove("has-popupmenu"),d.each(function(e){var t=$(this).children("a"),i=o.children("li").eq(e).children("a");t.data("original-tab",i),i.data("moremenu-link",t)}),l.insertAfter(r)}}}for(var o=0;o<n.length;o++)r(n[o]);t.tablist.children("li:not(.separator)").removeClass("is-focused");var l=1;this.isScrollableTabs()||(l=3),t.moreButton.popupmenu({autoFocus:!1,attachToBody:!0,menu:"tab-container-popupmenu",trigger:"immediate",offset:{x:l}}),t.moreButton.addClass("popup-is-open"),t.popupmenu=t.moreButton.data("popupmenu"),t.positionFocusState(t.moreButton),t.moreButton.on("close.tabs",function(){$(this).off("close.tabs selected.tabs"),t.moreButton.removeClass("popup-is-open"),t.positionFocusState(void 0),t.focusBar()}).on("selected.tabs",function(e,i){var s=i.attr("href"),n=s.substr(1,s.length),a=t.doGetTab(n)||$(),r=a?a.children("a"):$(),o=i.data("original-tab").parent();o.is(".add-tab-button")&&(o=(r=t.handleAddButton()).parent(),s=r.attr("href"),t.element.trigger("tab-added",[r])),t.activate(s),a.length&&r.length&&"function"==typeof r[0].onclick&&r[0].onclick.apply(r[0]),t.moreButton.focus(),t.scrollTabList(a)});var d=t.popupmenu.menu;function c(e){var i=$(this),s=i.closest("li");if(s.is(".dismissible")&&i.is(".close")){if(e.preventDefault(),e.stopPropagation(),s.is(".dismissible")&&s.is(".has-popupmenu")&&s.is(".submenu")){var n=s.find(".wrapper").children().children(),a=[];$.each(n,function(e,t){a.push(t.children[0].href)}),t.closeDismissibleTabs(a)}else t.closeDismissibleTab(s.children("a").attr("href"));t.popupmenu.close()}}d.on("destroy.popupmenu",function(){d.off(),t.hideFocusState(),$("#tab-container-popupmenu").removeData().remove()}).on("touchend.popupmenu touchcancel.popupmenu",".icon",c).on("click.popupmenu",".icon",c),e?t.popupmenu.highlight(d.find('a[href="'+e+'"]')):t.tablist.children(".is-selected").length>0?t.popupmenu.highlight(d.find('a[href="'+t.tablist.children(".is-selected").children("a").attr("href")+'"]')):t.popupmenu.highlight(d.find("li:first-child > a")),$(document).bindFirst("keydown.popupmenu",function(e){var i=e.which,s=$(e.target);function n(){return this===document.activeElement}var r=void 0;switch(i){case 8:case 46:e.altKey&&s.parent().is(".dismissible")&&t.closeDismissibleTab(s.attr("href"));break;case 37:r=a?40:38,s.is("a")&&(s.parent().is(":not(:first-child)")&&e.preventDefault(),$(document).trigger({type:"keydown.popupmenu",which:r}));break;case 38:d.find("li:first-child > a").filter(n).length>0&&(e.preventDefault(),$(document).off(e),t.popupmenu.close(),t.findLastVisibleTab());break;case 39:r=a?38:40,s.is("a")&&!s.parent(".submenu").length&&$(document).trigger({type:"keydown.popupmenu",which:r});break;case 40:!function(){var i=d.find("li:last-child > a");if(i.filter(n).length>0&&i.parent().is(":not(.submenu)")){if(e.preventDefault(),$(document).off(e),t.popupmenu.close(),t.settings.addTabButton)return void t.addTabButton.focus();t.focusFirstVisibleTab()}}()}})},isTabOverflowed:function(e){if(this.isVerticalTabs()||this.isScrollableTabs())return!1;this.tablist.scrollTop()>0&&this.tablist.scrollTop(0);var t=Math.round(e[0].getBoundingClientRect().top),i=Math.round(this.tablist[0].getBoundingClientRect().top+1);return this.isModuleTabs()&&(i+=1),t>i},findLastVisibleTab:function(){var e=this.tablist.children("li:not(.separator):not(.hidden):not(.is-disabled)"),t=e.first();if(this.isScrollableTabs())return e.last().find("a").focus();for(;!this.isTabOverflowed(t);)t=e.eq(e.index(t)+1);return e.eq(e.index(t)-1).find("a").focus()},focusFirstVisibleTab:function(){this.tablist.children("li:not(.separator):not(.hidden):not(.is-disabled)").eq(0).find("a").focus()},focusBar:function(e,t){if(this.hasAnimatedBar()&&e instanceof $&&e.length){var i=this,s=e,n=this.tablistContainer,a=k.isRTL(),r=void 0,o=void 0,l=void 0;if(this.animatedBar.removeClass("no-transition"),s&&void 0!==s&&s.length&&i.anchors.length){var d=window.getComputedStyle(s[0],null),c=parseInt(d.getPropertyValue("padding-right"),10)||0,h=parseInt(d.getPropertyValue("width"),10)||0;s.is(".tab")&&(l=window.getComputedStyle(s.children("a")[0]),c+=parseInt(l.getPropertyValue("padding-right"),10)||0);var u,p,g=a?c+s.position().left+s.outerWidth(!0):s.position().left;clearTimeout(i.animationTimeout),this.animatedBar.addClass("visible"),u=t,p=i.animatedBar[0].style,o=n[0].scrollLeft,r=n[0].scrollWidth,a?p.right=r+c-(g+o)+"px":p.left=g+o+"px",p.width=h+"px",u&&"function"==typeof u&&u()}else this.animatedBar.removeClass("visible")}},defocusBar:function(){if(this.hasAnimatedBar()){var e=this,t=k.isRTL()?0:e.animatedBar.position().left+e.animatedBar.outerWidth()/2;clearTimeout(e.animationTimeout),this.animatedBar[0].style.left=t+"px",this.animatedBar[0].style.width=0,this.animationTimeout=setTimeout(function(){e.animatedBar&&e.animatedBar.length&&e.animatedBar.removeClass("visible").removeAttr("style")},350)}},scrollTabList:function(e){if(this.tablistContainer&&e&&e instanceof $&&e.length){var t=n.getDimensions(e[0]),i=n.getDimensions(this.tablistContainer[0]),s=void 0,a=t.left,r=t.right;a<i.left+40&&(s=-1*Math.round(Math.abs(i.left-a))-40),r>i.right-40&&(s=Math.round(Math.abs(r-i.right))+40),0===s&&(s=void 0),this.tablistContainer.smoothScroll(s,250)}},hideFocusState:function(){this.focusState.removeClass("is-visible")},positionFocusState:function(e,t){if(void 0!==e?e=$(e):this.moreButton.hasClass("is-selected")?e=this.moreButton:this.tablist.children(".is-selected").length>0&&(e=this.tablist.children(".is-selected").children("a")),!e||void 0===e||!e.length||e.is(this.moreButton)&&this.isScrollableTabs())this.focusState.removeClass("is-visible");else{e.is("a")&&(e=e.parent()),e.is(".add-tab-button, .tab-more")?this.focusState.parent().is(this.element)||this.focusState.prependTo(this.element):this.focusState.parent().is(this.tablistContainer)||this.focusState.prependTo(this.tablistContainer);var i=this.focusState[0],s=n.getDimensions(e[0]),a=e[0].classList,r=!this.isHeaderTabs()||this.isHeaderTabs()&&this.element[0].classList.contains("alternate"),o=this.isVerticalTabs(),l=k.isRTL(),d=o?0:this.moreButton.outerWidth(!0),c=this.element,h=this.tablistContainer,u=h&&this.focusState.parent().is(h);s=function(t,i,s){var n=i[0].getBoundingClientRect(),a=void 0,c=void 0,h=void 0,p=void 0;if(t.top-=n.top,o&&(t.top+=i[0].scrollTop),l?t.right=n.right-t.right:t.left-=n.left,s){if(p=s?s[0].scrollLeft:0,h=s?s[0].scrollWidth:0,l&&!o){var g=t.left;r?(c=parseInt(window.getComputedStyle(e[0]).marginLeft,10),t.left=h-c-t.right+p,t.right=h-c-g+p):(t.left=h-(t.right+p+d+32),t.right=h-(g+p+d+32))}else t.left+=p,t.right+=p;u&&(a=parseInt(window.getComputedStyle(i[0])["padding"+(l?"Right":"Left")],10),t.left+=l?a:-1*a,t.right+=l?a:-1*a)}return r&&!o&&(t.height-=1),t}(s,c,h);var p="";Object.keys(s).forEach(function(e){p.length&&(p+=" "),p+=e+": "+s[e]+"px;"}),i.style.cssText=p;var g=a.contains("is-selected")?"add":"remove";i.classList[g]("is-selected");var f=!0===t?"add":"remove";i.classList[f]("is-visible")}},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},disableOtherTabs:function(){return this.disable(!0)},disable:function(e){e||this.element.prop("disabled",!0).addClass("is-disabled"),this.disabledElems||(this.disabledElems=[]);var t=this,i=this.tablist.children("li:not(.separator)");e&&(i=i.filter(":not(.application-menu-trigger)")),i.each(function(){var i=$(this),s=i.children("a");if(!(e&&t.isActive(s.attr("href"))||((i.is(".is-disabled")||!0===s.prop("disabled"))&&t.disabledElems.push({elem:i,originalTabindex:i.attr("tabindex"),originalDisabled:s.prop("disabled")}),i.addClass("is-disabled"),s.prop("disabled",!0),i.is(".application-menu-trigger")||i.is(".add-tab-button")))){var n=$(s.attr("href"));n.addClass("is-disabled"),n.find("*").each(function(){var e=$(this);e.is("input.dropdown, input.multiselect")||(("-1"===e.attr("tabindex")||e.attr("disabled"))&&t.disabledElems.push({elem:e,originalTabindex:e.attr("tabindex"),originalDisabled:e.prop("disabled")}),e.disable())})}}),this.moreButton.addClass("is-disabled"),this.isModuleTabs()&&!e&&this.element.children(".toolbar").disable(),this.updateAria($())},enable:function(){this.element.prop("disabled",!1).removeClass("is-disabled");var e=this;this.tablist.children("li:not(.separator)").each(function(){var t=$(this),i=t.children("a");if(t.removeClass("is-disabled"),i.prop("disabled",!1),!t.is(".application-menu-trigger")&&!t.is(".add-tab-button")){var s=$(i.attr("href"));s.removeClass("is-disabled"),s.find("*").each(function(){var e=$(this);e.enable&&"function"==typeof e.enable&&e.enable()}),$.each(e.disabledElems,function(e,t){var i=t.elem.is(".tab")?t.elem.children("a"):t.elem;t.elem.disable&&"function"==typeof t.elem.disable&&t.elem.disable(),t.elem.is("li")?t.elem.addClass("is-disabled"):t.elem.is("input.dropdown, input.multiselect")||(t.elem.attr("tabindex",t.originalTabindex),i.prop("disabled",t.originalDisabled))})}}),this.moreButton.removeClass("is-disabled"),this.isModuleTabs()&&this.element.children(".toolbar").enable(),this.disabledElems=[],this.updateAria(this.tablist.find(".is-selected > a"))},closeDismissibleTab:function(e){return this.remove(e)},closeDismissibleTabs:function(e){var t=this;e.forEach(function(e){var i=e.match(/#.*/);return t.remove(i[0])})},teardown:function(){this.panels.removeAttr("style"),this.tablist.off().removeAttr("role").removeAttr("aria-multiselectable");var e=this.tablist.children("li");if(e.off().removeAttr("role").removeClass("is-selected"),e.filter(".has-popupmenu").each(function(){var e=$(this).data("popupmenu");e&&(e.menu.children("li:not(.separator)").each(function(){var e=$(this).children("a"),t=e.data("panel-link");$.removeData(e[0],"panel-link"),t&&t.length&&$.removeData(t[0],"tab-link")}),e.destroy())}),this.panels.off(),this.anchors.off().removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabindex"),this.settings.moduleTabsTooltips&&this.anchors.each(function(){var e=$(this).data("tooltip");e&&"function"==typeof e.destroy&&e.destroy()}),this.element.off("focusout.tabs updated.tabs activated.tabs"),$("body").off("resize.tabs"+this.tabsIndex),this.tabsIndex=void 0,this.moreButton.data("popupmenu")){var t=this.moreButton.data("popupmenu");t.menu.find("li:not(.separator)").each(function(){var e=$(this).children("a");e.data("original-tab")&&$.removeData(e[0],"original-tab")}),t.destroy()}return this.removeHelperMarkupEvents(),this.tablistContainer&&this.tablistContainer.off("mousewheel.tabs"),this.focusState.removeData().remove(),this.focusState=void 0,this.hasAnimatedBar()&&(this.animatedBar.removeData().remove(),this.animatedBar=void 0),$(".tab-panel input").off("error.tabs valid.tabs"),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"tabs")}},$.fn.tabs=function(e){return this.each(function(){var t=$.data(this,"tabs");t?t.updated(e):t=$.data(this,"tabs",new Qi(this,e))})},$.fn.verticaltabs=$.fn.tabs;var Zi={};function es(e,t){this.settings=m.mergeSettings(e,t,Zi),this.element=$(e),this.init()}es.prototype={init:function(){this.element.hideFocus(),this.handleEvents()},remove:function(e,t){var i=(t=t instanceof jQuery?t:$(t)).parent();this.element.triggerHandler("beforetagremove",{event:e,element:t}),t.remove(),i.triggerHandler("aftertagremove",{event:e})},unbind:function(){return this.element.off("keydown.tag"),$(".dismissable-btn, .dismissible-btn",this.element).off("click.tag").remove(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Zi)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"tag")},handleEvents:function(){var e=this,t=this,i=$('<span class="dismissible-btn">\n        '+$.createIcon("close")+'\n        <span class="audible"> '+k.translate("Close")+"</span>\n      </span>");t.element.is(".is-dismissable, .is-dismissible")&&(t.element.append(i),i.on("click.tag",function(t){e.remove(t,e.element)}),this.element.on("keydown.tag",function(e){8===(e||window.event).keyCode&&t.remove(e,this)}))}},$.fn.tag=function(e){return this.each(function(){var t=$.data(this,"tag");t?t.updated(e):t=$.data(this,"tag",new es(this,e))})};var ts={autoGrow:!1,autoGrowAnimate:!0,autoGrowAnimateSpeed:200,autoGrowMaxHeight:null,characterCounter:!0,maxLength:null,printable:!0,charRemainingText:null,charMaxText:null};function is(e,t){this.settings=m.mergeSettings(e,t,ts),this.element=$(e),this.init()}is.prototype={init:function(){this.isChrome=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),this.isSafari=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Android"),this.element.addClass(this.element.is(".textarea-xs")?"input-xs":this.element.is(".textarea-sm")?"input-sm":this.element.is(".textarea-lg")?"input-lg":""),this.settings.characterCounter&&this.getMaxLength()&&(this.counter=$('<span class="textarea-wordcount">Chars Left..</span>').insertAfter(this.element)),this.settings.printable&&(this.printarea=$('<span class="textarea-print"></span>').insertBefore(this.element)),this.element.hasClass("autogrow")&&(this.settings.autoGrow=!0),this.settings.autoGrow&&this.element.length&&(this.element.css("overflow","hidden"),this.handleResize(this)),this.handleEvents(),this.updateCounter()},isSelected:function(e){return"number"==typeof e.selectionStart?0===e.selectionStart&&e.selectionEnd===e.value.length:void 0!==document.selection&&document.selection.createRange().text===e.value},isPrintable:function(e,t){return t?e>64&&e<91||e>=33&&e<=38||e>=40&&e<=43||126===e||58===e||60===e||e>=123&&e<=125||94===e||95===e||e>=62&&e<=64:13===e||e>=48&&e<=57||e>=97&&e<=122||59===e||61===e||e>=44&&e<=47||96===e||e>=91&&e<=93||39===e},handleResize:function(e,t){var i=e.element.val(),n=e.element.innerHeight(),a=e.element.get(0).scrollHeight,r=e.element.data("autogrow-start-height")||0,o=e.settings.autoGrowMaxHeight||0,l=void 0;if(o>0&&o<a){if(a=o,e.element.css("overflow",""),n===a)return}else e.element.css("overflow","hidden");if(n<a)e.scrollTop=0,e.settings.autoGrowAnimate&&a!==o?e.element.stop().animate({height:a},e.settings.autoGrowAnimateSpeed):e.element.innerHeight(a);else if(!t||8===t.which||46===t.which||t.ctrlKey&&88===t.which)if(n>r){l=e.element.clone().addClass("clone").css({position:"absolute",zIndex:-10,height:""}).val(s.sanitizeHTML(i)),e.element.after(l);do{a=l[0].scrollHeight-1,l.innerHeight(a)}while(a===l[0].scrollHeight);a++,l.remove(),a<r&&(a=r),n>a&&e.settings.autoGrowAnimate?e.element.stop().animate({height:a},e.settings.autoGrowAnimateSpeed):e.element.innerHeight(a)}else e.element.innerHeight(r)},countLinebreaks:function(e){return(e.match(/\n/g)||[]).length},updateCounter:function(){var e=this.element.val(),t=this.isChrome||this.isSafari,i=e.length+(t?this.countLinebreaks(e):0),s=this.getMaxLength(),n=parseInt(s,10)-i,a=(this.settings.charRemainingText?this.settings.charRemainingText:"CharactersLeft"===k.translate("CharactersLeft")?"Characters Left":k.translate("CharactersLeft")).replace("{0}",n.toString());this.counter&&(i>=s?(a=this.settings.charMaxText?this.settings.charMaxText.replace("{0}",s):k.translate("CharactersMax")+s,this.counter.text(a),this.counter.removeClass("almost-empty")):(this.counter.text(a),n<10?this.counter.addClass("almost-empty"):this.counter.removeClass("almost-empty"))),this.printarea.text(this.element.val())},enable:function(){this.element.prop("disabled",!1).prop("readonly",!1)},disable:function(){this.element.prop("disabled",!0)},isDisabled:function(){return this.element.prop("disabled")},readonly:function(){this.element.prop("readonly",!0)},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.destroy(),this.init()},getMaxLength:function(){return this.settings.maxLength?this.settings.maxLength:this.element.attr("maxlength")?parseInt(this.element.attr("maxlength"),10):void 0},destroy:function(){this.printarea&&this.printarea.length&&this.printarea.remove(),this.counter&&this.counter.length&&this.counter.remove(),this.element.off("keyup.textarea, focus.textarea, updated.dropdown, keypress.textarea, blur.textarea")},handleEvents:function(){var e=this;this.element.on("keyup.textarea",function(t){var i=e.element.val(),s=e.isChrome||e.isSafari,n=i.length+(s?e.countLinebreaks(i):0),a=e.getMaxLength();return e.updateCounter(),n>=a?(t.preventDefault(),!1):(e.settings.autoGrow&&e.handleResize(e,t),!0)}).on("focus.textarea",function(){e.counter&&e.counter.addClass("focus")}).on("updated.dropdown",function(){e.updated()}).on("keypress.textarea",function(t){var i=e.element.val(),s=e.isChrome||e.isSafari,n=i.length+(s?e.countLinebreaks(i):0),a=e.getMaxLength();[97,99,118,120].indexOf(t.which)>-1&&(t.metaKey||t.ctrlKey)?e.updateCounter():e.isPrintable(t.which,t.shiftKey)&&n>=a&&!e.isSelected(this)&&t.preventDefault()}).on("blur.textarea",function(){e.updateCounter(),e.counter&&e.counter.removeClass("focus")})}},$.fn.textarea=function(e){return this.each(function(){var t=$.data(this,"textarea");t?t.updated(e):t=$.data(this,"textarea",new is(this,e))})};var ss={rightAligned:!1,maxVisibleButtons:3,resizeContainers:!0,favorButtonset:!0,moreMenuSettings:void 0,noSearchfieldReinvoke:!1};function ns(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ss),this.init()}ns.prototype={init:function(){return this.setup().build().handleEvents()},setup:function(){return this.settings.maxVisibleButtons<=0&&(this.settings.maxVisibleButtons=ss.maxVisibleButtons),this},build:function(){var e=this;if(this.element.attr("role","toolbar"),this.settings.resizeContainers&&this.element.is(":not(:hidden)")&&this.element[0].classList.add("do-resize"),this.buildAriaLabel(),this.id||(this.id=parseInt($(".toolbar, .formatter-toolbar").index(this.element),10)),this.title=this.element.children(".title"),this.title.length?(this.element[0].classList.add("has-title"),this.cutoffTitle=!1,this.title.on("beforeshow.toolbar",function(){return e.cutoffTitle}).tooltip({content:""+this.title.text().trim()})):this.element[0].classList.remove("has-title"),this.buttonset=this.element.children(".buttonset"),this.buttonset.length||(this.buttonset=$('<div class="buttonset"></div>'),this.title.length?this.buttonset.insertAfter(this.title):this.buttonset.prependTo(this.element)),this.element[this.settings.rightAligned?"addClass":"removeClass"]("right-aligned"),this.more=this.element.find(".btn-actions"),0===this.more.length&&!this.element.hasClass("no-actions-button")){var t=this.element.find(".more");t.length||(t=$('<div class="more"></div>').appendTo(this.element)),this.more=$('<button class="btn-actions" type="button"></button>').html($.createIcon({icon:"more"})+'<span class="audible">'+k.translate("MoreActions")+"</span>").attr("title",k.translate("More")).appendTo(t)}(this.buttonsetItems=this.buttonset.children("button").add(this.buttonset.find("input")),this.items=this.buttonsetItems.add(this.title.children("button")).add(this.more),this.items.filter('button, input[type="button"], [class^="btn"]').each(function(){$(this).data("button")||$(this).button(),!$(this).data("tooltip")&&$(this).attr("title")&&$(this).tooltip()}),this.settings.noSearchfieldReinvoke)||this.items.filter(".searchfield, .toolbar-searchfield-wrapper, .searchfield-wrapper").each(function(e,t){var i=$(t);if(i.is(".toolbar-searchfield-wrapper, .searchfield-wrapper")&&(i=i.children(".searchfield")),!i.data("searchfield")){var s=$.extend({},m.parseSettings(i[0]));i.searchfield(s)}});var i=this.more.data("popupmenu"),s=this.more.attr("aria-controls");i?this.moreMenu=i.menu:(this.moreMenu=$("#"+s),this.moreMenu.length||(this.moreMenu=this.more.next(".popupmenu, .popupmenu-wrapper")),this.moreMenu.length||(this.moreMenu=$('<ul id="popupmenu-toolbar-'+this.id+'" class="popupmenu"></ul>').insertAfter(this.more)),this.moreMenu.is(".popupmenu-wrapper")&&(this.moreMenu=this.moreMenu.children(".popupmenu")));var n=[];this.items.not(this.more).not(".ignore-in-menu").filter(function(){return $(this).parent(".buttonset, .inline").length}).each(function(){n.push(e.buildMoreActionsMenuItem($(this)))}),n.reverse(),$.each(n,function(t,i){""!==i.text()&&i.prependTo(e.moreMenu)}),this.defaultMenuItems=this.moreMenu.children("li:not(.separator)"),this.hasDefaultMenuItems=this.defaultMenuItems.length>0;var a=m.extend({},this.settings.moreMenuSettings,{trigger:"click",menu:this.moreMenu},this.hasDefaultMenuItems?{predefined:this.defaultMenuItems}:{});i?this.more.on("beforeopen.toolbar",function(){e.refreshMoreActionsMenu(e.moreMenu)}).triggerHandler("updated",[a]):this.more.popupmenu(a).on("beforeopen.toolbar",function(){e.refreshMoreActionsMenu(e.moreMenu)}),function(){e.items.attr("tabindex","-1");var t=e.items.filter(".is-selected");if(t.length)return e.activeButton=t.first().attr("tabindex","0"),void e.items.not(e.activeButton).removeClass("is-selected");t=e.items.filter(":visible:not(:disabled)").first().attr("tabindex","0"),e.activeButton=t,e.element.is(":hidden, .is-hidden")?e.activeButton=e.items.filter(":not(:disabled)").first().attr("tabindex","0"):e.isItemOverflowed(t)&&(t.attr("tabindex","-1"),e.activeButton=e.more.addClass("is-selected").attr("tabindex","0"))}(),this.adjustMenuItemVisibility(),this.handleResize(),this.element.triggerHandler("rendered");var r=this.buttonset.find(".searchfield-wrapper, .toolbar-searchfield-wrapper");return r.length&&r.trigger("reanimate"),this},buildMoreActionsMenuItem:function(e){var t=void 0;if(!0===e.data("skipit"))return e.data("skipit",void 0),t;var i=e.data("action-button-link");i&&i.length?t=i.parent():(t=$("<li></li>"),i=$('<a href="#"></a>').appendTo(t),e.data("action-button-link",i),i.data("original-button",e)),e.hasClass("hidden")&&t.addClass("hidden"),e.is(":disabled")?(t.addClass("is-disabled"),i.prop("disabled",!0)):(t.removeClass("is-disabled"),i.prop("disabled",!1)),i.text(this.getItemText(e));var s=$.getBaseURL("#icon-dropdown"),n=e.children(".icon").filter(function(){var e=$(this).getIconName();return e&&e!==s&&-1===e.indexOf("dropdown")});n&&n.length&&(i.html("<span>"+i.text()+"</span>"),n.clone().detach().prependTo(i));var a=t.find("b");if(a.length&&(this.moreMenu.addClass("has-icons"),a.detach().prependTo(t)),e.is(".btn-menu")){e.data("popupmenu")?i.children(".icon.arrow").length||i.append($.createIcon({classes:"icon arrow icon-dropdown",icon:"dropdown"})):e.popupmenu();var r=e.data("popupmenu").menu;!function e(i,s,n){var a=i.children("li"),r=s.attr("id");s.children("li").each(function(t,i){var s=$(i),n=a.eq(t),r=s.children("a"),o=n.children("a"),l=s.attr("id"),d=r.attr("id");l&&s.removeAttr("id").attr("data-original-menu-item",l),d&&r.removeAttr("id").attr("data-original-menu-anchor",d),o.data("action-button-link",r),r.data("original-button",o);var c=n.children(".wrapper").children(".popupmenu"),h=s.children(".wrapper").children(".popupmenu");c.length&&h.length&&e(c,h,s)}),s.removeAttr("id").attr("data-original-menu",r),n.addClass("submenu");var o=void 0;n.is(t)&&((o=n.children(".wrapper"))&&o.length||(o=$('<div class="wrapper"></div>')),o.html(s),n.append(o))}(r,r.clone(),t)}return e.is("[data-popdown]")&&e.popdown(),t},refreshMoreActionsMenu:function(e){var t=this;$("li > a",e).each(function(){var e=$(this),i=e.parent(),s=e.data("originalButton"),n=t.getItemText(s),a=void 0;s&&(e.find("span").length?e.find("span").text(n.trim()):e.text(n.trim()),s.isHiddenAtBreakpoint()||s.parent().isHiddenAtBreakpoint()?i.addClass("hidden"):i.removeClass("hidden"),s.parent().is(".is-disabled")||s.is(":disabled")?(i.addClass("is-disabled"),e.prop("disabled",!0),e.attr("tabindex","-1")):(i.removeClass("is-disabled"),e.prop("disabled",!1)),s.is("a")&&(s.parent("li").is(".is-checked")?i.addClass("is-checked"):i.removeClass("is-checked")),s.is(".btn-menu")&&(a=e.parent().find(".popupmenu").first(),t.refreshMoreActionsMenu(a)))})},getItemText:function(e){if(!e)return"";var t=e.find("span").first(),i=e.attr("title"),n=e.data("tooltip"),a=n&&"string"==typeof n.content?n.content:void 0,r=void 0;return r=""!==i&&void 0!==i?i:a||(t.length?t.text():e.text()),s.stripHTML(r)},handleEvents:function(){var e=this;return this.items.on("keydown.toolbar",function(t){e.handleKeys(t)}).on("click.toolbar",function(t){e.handleClick(t)}),this.items.filter(".btn-menu, .btn-actions").on("close.toolbar",function(){var t=$(this),i=void 0;t.is(".is-overflowed")?(i=e.getLastVisibleButton())&&i.length&&i[0].focus():document.activeElement&&"INPUT"===document.activeElement.tagName||(t&&t.focus(),e.buttonset.scrollTop(0))}),this.items.not(this.more).on("selected.toolbar",function(t,i){t.stopPropagation(),e.handleSelected(t,i)}),this.more.on("keydown.toolbar",function(t){e.handleKeys(t)}).on("beforeopen.toolbar",function(){e.adjustMenuItemVisibility()}).on("selected.toolbar",function(t,i){t.stopPropagation(),e.handleSelected(t,i)}),this.more.on("show-submenu.toolbar",function(t,i){e.handleTransferToMenuButtonItem(t,i)}),this.element.on("updated.toolbar",function(t,i){t.stopPropagation(),e.updated(i)}).on("recalculate-buttons.toolbar",function(t,i){e.handleResize(i)}).on("scrollup.toolbar",function(){var t=e.element.parents(".tab-container.module-tabs");t.length&&t.scrollTop(0)}),$("body").on("resize.toolbar-"+this.id,function(){e.handleResize()}),this.handleResize(),this},handleTransferToMenuButtonItem:function(e,t){var i=t.children("a").data("original-button");if(i){var s=i.data("popupmenu");s&&"function"==typeof s.settings.beforeOpen&&(s.callSource(e),this.buildMoreActionsMenuItem(i))}},handleSelected:function(e,t){var i=t.data("original-button"),s=void 0,n=void 0,a=void 0,r=void 0;if(t.parent().is(".hidden, .is-disabled")||t.is("[readonly], [disabled]"))e.preventDefault();else{if(i&&i.length>0){if(s=i.listEvents(),n=this.element.listEvents(),this.setActiveButton(i),i.is("[data-popdown]")&&(r=i.data("popdown"),this.isItemOverflowed(i)&&(r.settings.trigger=this.more,r.updated())),i.attr("ng-click")||i.attr("data-ng-click"))return void i.trigger("click");for(var o=["click","touchend","touchcancel"],l=0;l<o.length;l++){var d=o[l];if(n&&n[d]&&n[d].delegateCount>0){var c=this.element,h=$.Event(d);return h.target=c.find(i)[0],void c.trigger(h)}if(s&&s[d]||i[0]["on"+d])return void i.trigger(d)}return r=(a=i.parents(".popupmenu")).data("trigger"),a.length&&r instanceof $&&r.length?void r.triggerHandler("selected",[i]):void this.triggerSelect(i)}this.triggerSelect(t)}},handleClick:function(e){return this.setActiveButton($(e.currentTarget)),this.triggerSelect($(e.currentTarget)),!1},handleKeys:function(e){var t=e.which,i=$(e.target),s=i.is(".btn-actions"),n=k.isRTL();(37===t&&i.is(":not(input)")||38===t&&i.is(":not(input.is-open)"))&&(e.preventDefault(),s?this.setActiveButton(n?this.getFirstVisibleButton():this.getLastVisibleButton()):this.navigate(n?1:-1)),(39===t&&i.is(":not(input)")||40===t&&i.is(":not(input.is-open)"))&&(e.preventDefault(),s?this.setActiveButton(n?this.getLastVisibleButton():this.getFirstVisibleButton()):this.navigate(n?-1:1))},handleResize:function(e){if(this.settings.resizeContainers){var t=e?e.title:void 0,i=e?e.buttonset:void 0;this.sizeContainers(t,i)}for(var s=this.getButtonsetButtons(),n=0;n<s.length;n++)s[n].removeClass("is-overflowed");this.element.is(":not(:hidden)")&&(this.adjustMenuItemVisibility(),this.toggleMoreMenu())},sizeContainers:function(e,t){var i=this.element[0],s=this.title[0],n=this.buttonset[0],a=this.more[0];if(this.title&&this.title.length){if(this.element.is(":hidden"))return n.style.width="",s.style.width="",void i.classList.remove("do-resize");n.style.width="",s.style.width="",i.classList.contains("do-resize")||i.classList.add("do-resize");var r=$(i).getHiddenSize(),o=$(n).getHiddenSize(),l=$(s).getHiddenSize(),d=$(a).getHiddenSize(),c=parseInt(r.padding.left,10)+parseInt(r.padding.right,10);isNaN(d.width)&&(d.width=50),(isNaN(o.width)||o.width<0)&&(o.width=0);var h=this,u=void 0!==e&&!isNaN(e),p=void 0!==t&&!isNaN(t),g=void 0;this.cutoffTitle=!1;var f=u?parseInt(e,10):!0===h.settings.favorButtonset?r.width-(c+(p?parseInt(t,10):o.width)+d.width):l.scrollWidth,m=p?parseInt(t,10):!0===h.settings.favorButtonset?o.width:r.width-(c+(u?parseInt(e,10):l.scrollWidth)+d.width);if(this.settings.favorButtonset)return f<74&&(this.cutoffTitle=!0,g=Math.abs(f-74),f=74,m-=g),n.style.width=v(m+2),s.style.width=v(f-2),s.textContent&&f<w.textWidth(s.textContent.trim())&&(this.cutoffTitle=!0),void(f>w.textWidth($(s).find("h1").text().trim())&&(this.cutoffTitle=!1));m<0&&(this.cutoffTitle=!0,g=Math.abs(m-0),m=0,f-=g),s.style.width=v(f+2),n.style.width=v(m-2)}function v(e){return e+"px"}},navigate:function(e){var t=this.items.filter(":visible:not(:disabled)"),i=t.index(this.activeButton)+e,s=void 0;i>=0&&i<t.length&&(s=t.eq(i)),i>=t.length&&(s=t.first()),-1===i&&(s=t.last()),this.isItemOverflowed(s)&&(s=this.more),this.setActiveButton(s)},getLastVisibleButton:function(){for(var e=$(this.items.get().reverse()).not(this.more),t=void 0,i=0,s=void 0;!t&&i<e.length;){if(s=$(e[i]),!this.isItemOverflowed(s)){t=s;break}i++}for(t&&0!==t.length||(t=e.first());t.length&&t.is(".separator, *:disabled, *:hidden");)t=t.prev();return t},getFirstVisibleButton:function(){for(var e=0,t=this.items,i=t.eq(e);i.is(".separator, *:disabled, *:hidden");)e++,i=t.eq(e);return i},setActiveButton:function(e,t){if(e[0]!==this.activeButton[0]){var i=this;this.items.add(this.more).attr("tabindex","-1").removeClass("is-selected"),this.activeButton=function(){if(e.is("a"))return s();var t=i.more.data("tooltip");return e[0]===i.more[0]?(t&&t.tooltip.is(":not(.hidden)")&&t.hide(),s()):i.isItemOverflowed(e)&&!e.is(".searchfield")?s():e}(),this.activeButton.addClass("is-selected").attr("tabindex","0"),!t&&this.activeButton[0]&&(this.activeButton[0].focus(),this.element.triggerHandler("navigate",[this.activeButton]))}function s(){return i.moreButtonIsDisabled()||!i.element.hasClass("has-more-button")?i.getLastVisibleButton():i.more}},triggerSelect:function(e){var t=$(e);t.is(this.more)||t.is(".btn-menu, li.submenu")||this.element.triggerHandler("selected",[t])},getButtonsetButtons:function(){for(var e=[],t=this.buttonsetItems,i=void 0,s=0;s<t.length;s++)void 0!==(i=t.eq(s)).data("action-button-link")&&i.is(":not(.searchfield)")&&e.push(i);return e},getVisibleButtons:function(e){var t,i=this,s=[],n=[];e&&Array.isArray(e)||(e=this.getButtonsetButtons());for(var a=0;a<e.length;a++)e[a][0].classList.remove("is-overflowed");for(var r=0;r<e.length;r++)t=e[r],i.isItemOverflowed(t)?s.push(t):n.push(t);return{visible:n,hidden:s}},adjustMenuItemVisibility:function(e){var t="removeClass";function i(e,i){var s=e[0],n=e.data("action-button-link").parent()[0],a=e.isHiddenAtBreakpoint();if(i)return n.classList.add("hidden"),void s.classList.remove("is-overflowed");a||n.classList.remove("hidden"),s.classList.add("is-overflowed"),e.find(".icon").length&&(t="addClass")}e||(e=this.getVisibleButtons());for(var s=0;s<e.visible.length;s++)i(e.visible[s],!0);for(s=0;s<e.hidden.length;s++)i(e.hidden[s],!1);var n=0;this.moreMenu.find(".icon").each(function(){$(this).parent().parent().hasClass("hidden")||$(this).hasClass("icon-dropdown")||n++}),n>0&&(t="addClass"),this.moreMenu[t]("has-icons")},isItemOverflowed:function(e){if(this.moreButtonIsDisabled())return!1;if(!e||0===e.length)return!0;var t=this.buttonsetItems.filter(":not(.hidden)").index(e),i=this.settings.maxVisibleButtons;if(this.moreButtonIsVisible()&&(i-=1),this.title.length&&t>=i)return!0;this.buttonset.scrollTop()>0&&this.buttonset.scrollTop(0),e instanceof $&&e.length&&(e=e[0]);var s=e.classList,n=window.getComputedStyle(e);if(s.contains("btn-actions"))return!0;if(s.contains("searchfield"))return!1;if("none"===n.display)return!0;var a=k.isRTL(),r=e.getBoundingClientRect(),o=this.buttonset[0].getBoundingClientRect(),l=a?r.left<=o.left:r.right>=o.right;return!0===r.bottom>=o.bottom||!0===l},moreButtonIsDisabled:function(){return this.element[0].classList.contains("no-actions-button")},hasNoMoreButton:function(){return D(this.moreButtonIsDisabled,this.hasNoMoreButton).apply(this)},moreButtonIsVisible:function(){return this.element[0].classList.contains("has-more-button")},toggleMoreMenu:function(){if(!this.moreButtonIsDisabled()){var e="removeClass";this.moreMenu.children("li:not(.separator)").not(".hidden").length>0&&(e="addClass"),this.element[e]("has-more-button");var t=this.more.data("popupmenu");if("removeClass"===e){if(!t)return;t.close();var i=t.menu.find("li:not(.separator)").children("a"),s=!1;if(i.add(this.more).each(function(){document.activeElement===this&&(s=!0)}),s){var n=this.getLastVisibleButton()[0];n&&n.focus()}}}},buildAriaLabel:function(){if(!this.element.attr("aria-label")){var e=1===this.element.closest(".header").length,t=this.element.attr("id")||"",i=this.element.children(".title"),s=this.element.prev("label"),n=this.element.prev(".label"),a=e?$("header.header").find("h1").text():i.length?i.filter("div").text():s.length?s.text():n.length?n.text():t+" "+k.translate("Toolbar");this.element.attr("aria-label",a.replace(/\s+/g," ").trim())}},updated:function(e){this.settings.noSearchfieldReinvoke&&(this.keepSearchfield=!0),e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown().init()},enable:function(){this.element.prop("disabled",!1),this.items.prop("disabled",!1),this.more.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0),this.items.prop("disabled",!0),this.more.prop("disabled",!0).data("popupmenu").close()},teardown:function(){var e=this;$("body").off("resize.toolbar-"+this.id);var t=this.moreMenu.children("li");if(t.each(function(){e.teardownMoreActionsMenuItem($(this),!0)}),t.not(this.defaultMenuItems).remove(),delete this.defaultMenuItems,delete this.hasDefaultMenuItems,this.items.each(function(e,t){var i=$(t).data("tooltip");i&&i.destroy();var s=$(t).data("button");s&&s.destroy(),t.classList.remove("is-overflowed"),t.removeAttribute("tabindex")}),this.items.off(["keydown.toolbar","click.toolbar","focus.toolbar","blur.toolbar","close.toolbar","selected.toolbar"].join(" ")),delete this.items,this.title&&this.title.length){var i=this.title.off("beforeshow.toolbar").data("tooltip");i&&i.destroy(),this.title[0].style.width="",delete this.cutoffTitle,delete this.title}if(this.buttonsetItems&&delete this.buttonsetItems,this.buttonset.children(".searchfield-wrapper").length)if(this.settings.noSearchfieldReinvoke&&this.keepSearchfield)this.keepSearchfield&&delete this.keepSearchfield;else{var s=this.buttonset.children(".searchfield-wrapper").children(".searchfield");s.data("searchfield")&&s.data("searchfield").destroy()}return this.buttonset&&this.buttonset.length&&(this.buttonset[0].style.width="",delete this.buttonset),this.moreMenu&&delete this.moreMenu,this.more.length&&void 0!==this.more.data("popupmenu")&&(this.more.off(["keydown.toolbar","beforeopen.toolbar","selected.toolbar","show-submenu.toolbar"].join(" ")),this.more.data("popupmenu").destroy(),delete this.more),this.activeButton&&delete this.activeButton,this.element.off(["updated.toolbar","recalculate-buttons.toolbar","scrollup.toolbar"].join(" ")),this.element[0].classList.remove("do-resize"),this.element.removeAttr("role").removeAttr("aria-label"),this},teardownMoreActionsMenuItem:function(e,t){var i=this,s=$(e),n=s.children("a"),a=n.data("original-button");n.off("mousedown.toolbar click.toolbar touchend.toolbar touchcancel.toolbar");var r=s.find(".icon");r.length&&r.remove();var o=void 0;s.is(".submenu")&&(o=s.children(".wrapper").children(".popupmenu")).children("li").each(function(){i.teardownMoreActionsMenuItem($(this),!0)}),a&&a.length&&($.removeData(n[0],"original-button"),$.removeData(a[0],"action-button-link"),n.remove(),o&&o.off().parent(".wrapper").off().remove(),t&&s.remove())},destroy:function(){this.teardown(),$.removeData(this.element[0],"toolbar")}},$.fn.toolbar=function(e){return this.each(function(){var t=$.data(this,"toolbar");t?t.updated(e):t=$.data(this,"toolbar",new ns(this,e))})};var as=[{type:"button",selector:'button:not(.btn-menu):not(.btn-actions):not(.colorpicker-editor-button), input[type="button"]:not(.btn-menu):not(.btn-actions):not(.colorpicker-editor-button)',filter:function(e){return!$(e).parents(".searchfield-wrapper, .toolbar-searchfield-wrapper").length}},{type:"menubutton",selector:".btn-menu"},{type:"actionbutton",selector:".btn-actions"},{type:"colorpicker",selector:".colorpicker-editor-button"},{type:"hyperlink",selector:"a[href]",filter:function(e){if("A"!==e.nodeName)throw new Error("Unspecified error occured");return $(e).parents(".popupmenu").length<1}},{type:"checkbox",selector:'input[type="checkbox"]'},{type:"radio",selector:'input[type="radio"]'},{type:"searchfield",selector:".searchfield"},{type:"toolbarsearchfield",selector:".toolbarsearchfield"}],rs={actionbutton:"popupmenu",colorpicker:"colorpicker",menubutton:"popupmenu",hyperlink:"hyperlink",searchfield:"searchfield",toolbarsearchfield:"searchfield"},os={disabled:!1,readOnly:!1,hidden:!1,componentSettings:void 0};function ls(e,t){this.element=e,this.settings=m.mergeSettings(this.element,t,os),this.init()}ls.prototype={type:void 0,init:function(){this.type=function(e){var t=!1;if(as.forEach(function(i){$(e).is(i.selector)&&("function"!=typeof i.filter||i.filter(e))&&(t=i.type)}),!t)throw new Error("Element "+e+" is not a valid Toolbar Item Type.");return t}(this.element),this.section=this.element.parentElement,this.toolbar=this.section.parentElement,this.trueSelected=!1},get focusable(){return!0!==this.disabled&&("searchfield"===this.type||("actionbutton"!==this.type||!0!==this.hasNoOverflowedItems)&&(!0!==this.overflowed&&this.visible))},get focused(){return 0===this.element.tabIndex},set focused(e){this.element.tabIndex=e?0:-1},get selected(){return this.trueSelected},set selected(e){if(e)return this.trueSelected=!0,this.element.classList.add("is-selected"),this.triggerSelectedEvent(),void(this.selectedAnchor&&delete this.selectedAnchor);this.trueSelected=!1,this.element.classList.remove("is-selected")},get componentAPI(){var e=$(this.element),t=rs[this.type];if(t)return e.data(t)},get toolbarAPI(){return this.settings.toolbarAPI?this.settings.toolbarAPI:$(this.toolbar).data("toolbar-flex")},triggerSelectedEvent:function(){if(!(["colorpicker","searchfield","toolbarsearchfield"].indexOf(this.type)>-1)){var e=[this];["menubutton","actionbutton"].indexOf(this.type)>-1&&this.selectedAnchor&&e.push(this.selectedAnchor),$(this.element).trigger("selected",e)}},show:function(){this.visible=!0},hide:function(){this.visible=!1},set visible(e){var t="searchfield"===this.type||"toolbarsearchfield"===this.type;if(e)return t&&this.element.parentNode.classList.remove("hidden"),void this.element.classList.remove("hidden");t&&this.element.parentNode.classList.add("hidden"),this.element.classList.add("hidden")},get visible(){return-1===this.element.className.indexOf("hidden")},enable:function(){this.disabled=!1,this.hasReadOnly&&(this.readOnly=!1)},get disabled(){return this.element.disabled},set disabled(e){if(e)return this.element.disabled=!0,this.element.setAttribute("aria-disabled",!0),void(this.element.readOnly=!1);this.element.disabled=!1,this.element.removeAttribute("aria-disabled")},get hasReadOnly(){return"readOnly"in this.element},get readOnly(){return!!this.hasReadOnly&&this.element.readOnly},set readOnly(e){if(this.hasReadOnly)return e?(this.disabled=!1,this.element.disabled=!1,void(this.element.readOnly=!0)):void(this.element.readOnly=!1)},get overflowed(){var e=l.rtl,t=this.element.getBoundingClientRect(),i=this.section.getBoundingClientRect();return e?t.left<i.left:t.right>i.right},set hasNoOverflowedItems(e){if("actionbutton"===this.type&&this.componentAPI){var t=this.componentAPI.toData({noMenuWrap:!0}).length-this.predefinedItems.length<1;if(e&&t)return this.element.classList.add("no-overflowed-items"),this.trueHasNoOverflowedItems=!0,void(this.focused&&(this.toolbarAPI.focusedItem=this,this.toolbarAPI.navigate(-1,void 0,!0)));this.trueHasNoOverflowedItems=!1,this.element.classList.remove("no-overflowed-items")}},get hasNoOverflowedItems(){return!this.componentAPI||this.trueHasNoOverflowedItems},handleEvents:function(){var e=this,t=this,i=$(this.element);["menubutton","actionbutton","colorpicker"].indexOf(this.type)>-1&&i.on("selected.toolbarflexitem",function(i,s){if(!e.selectedAnchor){if(i.stopPropagation(),"actionbutton"===e.type){var n=$(s).parent(),a=n.data("originalButton"),r=$(a).data("toolbarflexitem"),o=void 0;if(n.parents("ul").length>1&&(o=n.data("original-menu-element"),a=n.parents("li").last().data("originalButton"),r=$(a).data("toolbarflexitem")),r)return o?(i.preventDefault(),r.selectedAnchor=$(o).children("a")):r.selectedAnchor=s,void(r.selected=!0)}t.selectedAnchor=s,t.selected=!0}}),"actionbutton"===this.type&&(i.on("beforeopen.toolbarflexitem",this.handleActionButtonBeforeOpen.bind(this)),$("body").off("resize.toolbarflexitem").on("resize.toolbarflexitem",this.handleActionButtonResize.bind(this))),i.on("focus.toolbarflexitem",this.handleFocus.bind(this))},handleActionButtonBeforeOpen:function(){this.refreshMoreActionsMenu()},handleActionButtonResize:function(){this.refreshMoreActionsMenu()},handleFocus:function(e){e.target&&e.target===this.element&&(this.toolbarAPI.focusedItem=this)},render:function(){this.disabled=this.disabled,this.hasReadOnly&&(this.readonly=this.readonly);var e=$(this.element),t=rs[this.type];if(t){var i=e.data(t);i?i.updated(this.settings.componentSettings):e[t](this.settings.componentSettings)}"actionbutton"===this.type&&(this.renderMoreActionsMenu(),this.refreshMoreActionsMenu()),this.handleEvents()},renderMoreActionsMenu:function(){var e=this.componentAPI;if(e&&this.toolbarAPI){var t=e.menu;t&&t.length||(t=$('<ul class="popupmenu"></ul>').insertAfter(this.element)),this.teardownPredefinedItems();var i=this.toolbarAPI.toPopupmenuData();!function e(t,i){t.menuId&&delete t.menuId;var s=i?"submenu":"menu";Array.isArray(t[s])&&t[s].forEach(function(t){e(t,!0)})}(i);var s=$(e.renderItem(i));this.predefinedItems=s,this.linkToolbarItems(i),t.prepend(this.predefinedItems),e.updated({menu:t,predefined:s}),this.menuRendered=!0}},refreshMoreActionsMenu:function(){if("actionbutton"===this.type){this.hasNoOverflowedItems=!0;var e=this.componentAPI;if(e&&this.toolbarAPI){e.settings.beforeOpen||this.predefinedItems&&this.predefinedItems.length||!this.toolbarAPI.items.length||this.renderMoreActionsMenu();var t=!0;this.toolbarAPI.items.forEach(function(t){if(t.actionButtonLink){var s=t.toPopupmenuData();s.overflowed=t.overflowed,s.id&&delete s.id,e.refreshMenuItem(t.actionButtonLink,s,i)}}),this.hasNoOverflowedItems=t}}function i(e,i){if(!i.isSubmenuItem){if(!0===i.overflowed)return e.classList.add("is-overflowed"),i.visible&&e.classList.remove("hidden"),void(t=!1);e.classList.remove("is-overflowed"),e.classList.add("hidden")}}},unlinkToolbarItems:function(){function e(t){var i=$($(t).data("original-menu-element"));if(i.removeData("action-button-link"),$(t).removeData("original-menu-element"),i.hasClass("submenu"))for(var s=t.querySelector(".popupmenu").children,n=0;n<s.length;n++)e(s[n])}"actionbutton"===this.type&&this.menuRendered&&this.predefinedItems&&this.predefinedItems.length&&this.predefinedItems.each(function(t,i){var s=$(i).data("originalButton"),n=$(s).data("toolbarflexitem");if(n.actionButtonLink=null,$(i).removeData("original-button"),"menubutton"===n.type)for(var a=i.querySelector(".popupmenu").children,r=0;r<a.length;r++)e(a[r])})},linkToolbarItems:function(e){function t(e,i){var s=e.elementLink;$(s).data("action-button-link",i),$(i).data("original-menu-element",s);var n=e.submenu;if(n&&n.length)for(var a=i.querySelector(".popupmenu").children,r=0;r<a.length;r++)t(n[r],a[r])}"actionbutton"===this.type&&e&&(Array.isArray(e)||(e=e.menu),this.predefinedItems.each(function(i,s){var n=e[i].itemLink;n.actionButtonLink=s,$(s).data("original-button",n.element);var a=e[i].submenu;if(a&&a.length)for(var r=s.querySelector(".popupmenu").children,o=0;o<r.length;o++)t(a[o],r[o])}))},toPopupmenuData:function(){if("searchfield"!==this.type&&"toolbarsearchfield"!==this.type&&"actionbutton"!==this.type){var e={itemLink:this,disabled:this.disabled,visible:this.visible},t=this.element.querySelector(".icon:not(.close):not(.icon-dropdown) > use");if(t&&(e.icon=t.getAttribute("xlink:href").replace("#icon-","")),"button"!==this.type&&"menubutton"!==this.type||(e.text=this.element.textContent.trim()),"menubutton"===this.type){var i=this.componentAPI.menu;if(i.length){var s=this.componentAPI.toData({noMenuWrap:!0}),n=this.componentAPI.element[0].id;n&&(e.id=this.toolbarAPI.uniqueId+"-"+n),e.submenu=function e(t,i){var s=t.querySelectorAll("li:not(.heading)");return i.forEach(function(t,i){if(t.elementLink=s[i],t.submenu){var n=s[i].querySelector(".popupmenu");t.submenu=e(n,t.submenu)}}),i}(i[0],s)}else e.submenu=[]}return e}},toData:function(){var e={type:this.type,disabled:this.disabled,focused:this.focused,selected:this.selected,overflowed:this.overflowed,visible:this.visible};this.hasReadOnly&&(e.readOnly=this.readOnly),this.actionButtonLink&&(e.actionButtonLink=this.actionButtonLink),this.componentAPI&&(e.componentAPI=this.componentAPI);var t=this.element.querySelector(".icon:not(.close):not(.icon-dropdown) > use");return t&&(e.icon=t.getAttribute("xlink:href").replace("#icon-","")),"button"!==this.type&&"menubutton"!==this.type||(e.text=this.element.textContent.trim()),"actionbutton"===this.type&&(e.predefinedItems=this.predefinedItems),"menubutton"!==this.type&&"actionbutton"!==this.type||(e.submenu=this.componentAPI.toData({noMenuWrap:!0})),e},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown(),this.init()},teardownPredefinedItems:function(){"actionbutton"===this.type&&(this.unlinkToolbarItems(),this.predefinedItems&&this.predefinedItems.length&&this.predefinedItems.remove())},teardown:function(){$(this.element).off("selected.toolbarflexitem").off("beforeopen.toolbarflexitem").off("focus.toolbarflexitem"),$("body").off("resize.toolbarflexitem"),this.teardownPredefinedItems(),delete this.type,delete this.selected,delete this.focusable,delete this.visible,delete this.disabled,delete this.readOnly,delete this.section,delete this.toolbar,delete this.trueSelected,delete this.menuRendered}},$.fn.toolbarflexitem=function(e){return this.each(function(){var t=$.data(this,"toolbarflexitem");if(t)t.updated(e);else{var i=(t=$.data(this,"toolbarflexitem",new ls(this,e))).destroy;t.destroy=function(){"function"==typeof i&&i.call(this),$.removeData(this,"toolbarflexitem")}}})};var ds={beforeMoreMenuOpen:null};function cs(e,t){this.element=e,this.settings=m.mergeSettings(this.element,t,ds),this.init()}cs.prototype={trueFocusedItem:void 0,sections:[],items:[],init:function(){var e=this;this.uniqueId=m.uniqueId(this.element),this.sections=m.getArrayFromList(this.element.querySelectorAll(".toolbar-section")),this.items=this.getElements().map(function(t){var i={};return $(t).hasClass("btn-actions")&&e.settings.beforeMoreMenuOpen&&(i.beforeOpen=e.settings.beforeMoreMenuOpen),$(t).toolbarflexitem({toolbarAPI:e,componentSettings:i}),$(t).data("toolbarflexitem")}),this.items&&(this.items.forEach(function(t){t.focused&&(void 0===e.focusedItem?e.focusedItem=t:t.focused=!1)}),this.focusedItem||(this.focusedItem=this.items[0]),this.render(),this.handleEvents())},render:function(){this.element.setAttribute("role","toolbar"),this.items.forEach(function(e){e.render()})},handleEvents:function(){var e=this;this.keydownListener=this.handleKeydown.bind(this),this.element.addEventListener("keydown",this.keydownListener),this.keyupListener=this.handleKeyup.bind(this),this.element.addEventListener("keyup",this.keyupListener),this.clickListener=this.handleClick.bind(this),this.element.addEventListener("click",this.clickListener),$(this.element).on("selected.toolbar-flex",function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s]}),$(this.element).on("collapsed-responsive.toolbar-flex",function(t,i){t.stopPropagation(),e.navigate(i,null,!0)})},handleKeydown:function(e){var t=e.target;$(t).data("toolbarflexitem")&&this.handleItemKeydown(e)},handleItemKeydown:function(e){var t=k.isRTL(),i=e.key,s=this.getItemFromElement(e.target);function n(){e.preventDefault()}if("Enter"!==i)if(" "!==i){if(["ArrowLeft","Left","ArrowUp","Up"].indexOf(i)>-1){if("searchfield"===s.type&&("ArrowLeft"===i||"Left"===i))return;return this.navigate(t?1:-1,void 0,!0),void n()}if(["ArrowRight","Right","ArrowDown","Down"].indexOf(i)>-1){if("searchfield"===s.type&&("ArrowRight"===i||"Right"===i))return;this.navigate(t?-1:1,void 0,!0),n()}}else"hyperlink"===s.type&&this.select(e.target);else this.clickByEnterKey=!0},handleKeyup:function(e){this.clearClickByEnter(e)},handleClick:function(e){var t=e.target;$(t).data("toolbarflexitem")&&this.handleItemClick(e),this.clearClickByEnter()},handleItemClick:function(e){var t=this.getItemFromElement(e.target);this.select(t),this.focusedItem=t},clearClickByEnter:function(e){this.clickByEnterKey&&("menubutton"!==this.type&&"actionbutton"!==this.type||e.preventDefault(),delete this.clickByEnterKey)},getElements:function(){var e=[],t=[];return as.forEach(function(e){t.push(e.selector)}),t=t.join(", "),m.getArrayFromList(this.element.querySelectorAll(t)).forEach(function(t){var i=!1;as.forEach(function(s){!i&&$(t).is(s.selector)&&("function"!=typeof s.filter||s.filter(t))&&(i=!0,e.push(t))})}),e},getItemFromElement:function(e){if(e instanceof ls)return e;for(var t=void 0,i=0;i<this.items.length;i++)this.items[i].element.innerHTML===e.innerHTML&&(t=this.items[i]);if(!t)throw new Error("No Toolbar Item instance available for element "+e+".");return t},get searchfieldAPI(){for(var e=0;e<this.items.length;e++)if("searchfield"===this.items[e].type)return this.items[e].componentAPI},get focusedItem(){if(this.trueFocusedItem)return this.trueFocusedItem;for(var e=0;e<this.items.length;e++)if(!0===this.items[e].focused)return this.items[e]},set focusedItem(e){if(0!==this.items.length){for(var t=0;t<this.items.length;t++)this.items[t].focused=!1;e.focused=!0,this.trueFocusedItem=e}},get hasFocusableItems(){for(var e=0;e<this.items.length;e++)if(!0===this.items[e].focusable)return!0;return!1},get canManageFocus(){var e=document.activeElement;if(this.element.contains(e))return!0;for(var t=0;t<this.items.length;t++)if("searchfield"===this.items[t].type&&this.items[t].componentAPI.isFocused)return!0;return"BODY"===e.tagName},get overflowedItems(){for(var e=[],t=0;t<this.items.length;t++)!0===this.items[t].overflowed&&e.push(this.items[t]);return e},navigate:function(e,t,i){if(!1!==this.hasFocusableItems){var s=0+e;for(null==t&&(t=this.items.indexOf(this.focusedItem));0!==e;)e>0&&(t===this.items.length-1?t=0:t++,--e),e<0&&(0===t?t=this.items.length-1:--t,e++);var n=this.items[t];!1!==n.focusable?(this.focusedItem=n,i&&this.canManageFocus&&this.focusedItem.element.focus()):this.navigate(s>0?1:-1,t,i)}},select:function(e){var t=this.getItemFromElement(e);switch(t.type){case"searchfield":case"actionbutton":case"menubutton":if(this.clickByEnterKey)return;t.selected=!0;break;default:t.selected=!0}},toPopupmenuData:function(){var e={noMenuWrap:!0},t=!1;return e.menu=this.items.filter(function(e){return"actionbutton"!==e.type&&"searchfield"!==e.type}).map(function(e){return function(e){var i=e.toPopupmenuData();return i&&i.icon&&(t=!0),i}(e)}),e.hasIcons=t,e},toData:function(){var e={};return e.items=this.items.map(function(e){return e.toData()}),e},get disabled(){return this.trueDisabled},set disabled(e){this.trueDisabled=e,!0!==e?this.element.classList.remove("is-disabled"):this.element.classList.add("is-disabled")},updated:function(e){"object"===(void 0===e?"undefined":u(e))&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown(),this.init()},teardown:function(){this.element.removeEventListener("keydown",this.keydownListener),this.element.removeEventListener("keyup",this.keyupListener),this.element.removeEventListener("click",this.clickListener),$(this.element).off("selected.toolbar-flex"),$(this.element).off("collapsed-responsive.toolbar-flex"),this.items.forEach(function(e){e.teardown()}),delete this.items,delete this.sections},destroy:function(){this.teardown()}},$.fn.toolbarflex=function(e){return this.each(function(){var t=$.data(this,"toolbar-flex");if(t)t.updated(e);else{var i=(t=$.data(this,"toolbar-flex",new cs(this,e))).destroy;t.destroy=function(){"function"==typeof i&&i.call(this),$.removeData(this,"toolbar-flex")}}})},$.fn.toolbarsearchfield=$.fn.searchfield;var hs={};function us(e,t){this.settings=m.mergeSettings(e,t,hs),this.element=$(e),this.init()}us.prototype={init:function(){this.isIe="ie"===l.browser.name,this.isIeEdge="edge"===l.browser.name,this.handleEvents()},valMethod:function(e,t){switch(e.attr("type")){case"checkbox":case"radio":return e.prop("checked");case"file":if("boolean"==typeof t&&t){var i=e.attr("original");return void 0!==i?i:""}return e.parent().find('[type="text"]').val();default:return e.val()}},getAbsolutePosition:function(e){var t=e.position();return e.parents().each(function(){if("relative"===window.getComputedStyle(this,null).position)return!1;t.left+=this.scrollLeft,t.top+=this.scrollTop}),{left:t.left,top:t.top}},unbind:function(){if(this.element.removeClass("dirty").off("resetdirty.dirty change.dirty doresetdirty.dirty"),this.settings&&"object"===u(this.settings.d)){var e=this.settings.d;$(".icon-dirty, .msg-dirty",e.field).add(e.icon).add(e.msg).remove()}return $.removeData(this.element[0],"original"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,hs)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"trackdirty")},handleEvents:function(){var e=this,t=this.element;if(t.is(".editor")){var i=t.parent().find("textarea");i.data("original",this.valMethod(i))}t.data("original",this.valMethod(t,!0)).on("resetdirty.dirty",function(){if(t.is(".editor")){var i=t.parent().find("textarea");i.data("original",e.valMethod(i))}t.data("original",e.valMethod(t)).triggerHandler("doresetdirty.dirty")}).on("change.dirty doresetdirty.dirty",function(i){var s=t,n=t.closest(".field, .radio-group"),a=$("label:visible",n),r={class:"",style:""};if(n.is(".field-fileupload")&&(s=n.find("input.fileupload-background-transparent")),n.is(".editor-container")&&(s=n.find(".editor-source")),a[0]||(a=t.next("label")),"true"===t.attr("data-trackdirty")){if(t.addClass("dirty"),t.is('[type="checkbox"], [type="radio"]')&&(r.class+=" dirty-"+t.attr("type"),r.class+=t.is(":checked")?" is-checked":""),t.is("select")&&(r.class+=" is-select",s=t.next(".dropdown-wrapper").find(".dropdown")),r.icon=s.prev(),!r.icon.is(".icon-dirty")){t.is('[type="checkbox"]')?(r.rect=e.getAbsolutePosition(a),r.style="left:"+r.rect.left+"px; top:"+r.rect.top+"px;"):t.is(".colorpicker")&&!k.isRTL()&&(r.rect=e.getAbsolutePosition(t),r.style="left:"+r.rect.left+"px; top:"+r.rect.top+"px;"),r.icon='<span class="icon-dirty'+r.class+'"></span>',r.msg=k.translate("MsgDirty")||"",r.msg='<span class="audible msg-dirty">'+r.msg+"</span>";var o=$($(s[0].parentElement).find("input")[0]);s=t.is('[type="radio"]')?o:s,0===$(s[0].parentElement).find(".icon-dirty").length&&(s.before(r.icon),a.append(r.msg),r.style&&s.prev(".icon-dirty")[0]&&(s.prev(".icon-dirty")[0].style.cssText=r.style)),r.icon=s.prev(),r.msg=a.find(".msg-dirty")}var l=t.data("original"),d=e.valMethod(t);if(r.field=n,e.settings.d=r,n.is(".editor-container")){var c=n.find("textarea");l=c.data("original"),d=e.valMethod(c),(e.isIe||e.isIeEdge)&&(d=t[0].innerHTML)}if(d===l||t.attr("multiple")&&m.equals(d,l))return t.removeClass("dirty"),$(".icon-dirty, .msg-dirty",n).add(r.icon).add(r.msg).remove(),void t.trigger("doresetdirty"===i.type?"afterresetdirty":"pristine");t.trigger("dirty")}})}},$.fn.trackdirty=function(e){return this.each(function(){var t=$.data(this,"trackdirty");t?t.updated(e):t=$.data(this,"trackdirty",new us(this,e))})};var ps={dataset:null,source:null,selectable:"single",hideCheckboxes:!1,menuId:null,useStepUI:!1,folderIconOpen:"open-folder",folderIconClosed:"closed-folder",sortable:!1,onBeforeSelect:null,onExpand:null,onCollapse:null};function gs(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,ps),this.init()}gs.prototype={init:function(){this.isIe11="ie"===l.browser.name&&"11"===l.browser.version,this.initTree(),this.handleKeys(),this.setupEvents(),-1===this.loadData(this.settings.dataset)&&(this.syncDataset(),this.initSelected(),this.focusFirst(),this.attachMenu(this.settings.menuId),this.createSortable())},initTree:function(){var e=this,t=this.settings,i=this.element.find("a"),s=this.element.attr("data-selectable");t.selectable=void 0===s||"single"!==s.toLowerCase()&&"multiple"!==s.toLowerCase()?t.selectable:s,this.isMultiselect="multiple"===t.selectable,t.hideCheckboxes=t.hideCheckboxes||!this.isMultiselect,this.element.addClass(this.isMultiselect?" is-multiselect":""),i.each(function(){var t=$(this);e.decorateNode(t)})},initSelected:function(){var e=this;[].slice.call(this.element[0].querySelectorAll("li")).forEach(function(t){return e.setNodeStatus($(t.querySelector("a")))})},focusFirst:function(){var e=this.element[0].querySelector("a");e&&e.setAttribute("tabindex","0")},setFocus:function(e){(e=this.isjQuery(e)?e[0]:e)&&(e.focus(),e.classList.remove("hide-focus"))},decorateNode:function(e,t,i){var s,n=(e=this.isjQuery(e)?e:$(e))[0].getAttribute("data-badge"),a=e[0].getAttribute("data-alert-icon"),r=e.parentsUntil(this.element,"ul[role=group].is-disabled").length>0,o=e[0].classList.contains("is-disabled")||r;if(void 0!==n&&(n=m.parseSettings(e,"data-badge")),e[0].setAttribute("role","treeitem"),e[0].setAttribute("tabindex","-1"),e[0].setAttribute("aria-selected","false"),o){e[0].classList.add("is-disabled"),e[0].setAttribute("aria-disabled","true");var l=e.next();if(l[0]&&"ul"===l[0].tagName.toLowerCase()&&l[0].classList.contains("is-open"))[].slice.call(l[0].querySelectorAll("a")).forEach(function(e){e.classList.add("is-disabled"),e.setAttribute("aria-disabled","true")}),[].slice.call(e[0].parentNode.querySelectorAll("ul")).forEach(function(e){return e.classList.add("is-disabled")})}s=e.parentsUntil(this.element,"ul").length-1,e[0].setAttribute("aria-level",s+1);var d=e.parent().index();e[0].setAttribute("aria-posinset",d+1);var c=e.closest("li").siblings().length+1;e[0].setAttribute("aria-setsize",c);var h=e.next("ul");h[0]&&h.children().length>0&&e[0].setAttribute("aria-expanded",h[0].classList.contains("is-open")?"true":"false");var u=e.contents().filter(function(){return!$(this).is(".tree-badge")}).text();e[0].textContent="",0===e.children("svg.icon-tree").length&&(t||""===t?e[0].insertAdjacentHTML("afterbegin",$.createIcon({icon:t,classes:["icon-tree"]})):e[0].insertAdjacentHTML("afterbegin",$.createIcon({icon:"tree-node",classes:["icon-tree"]})),this.settings.useStepUI&&e[0].insertAdjacentHTML("afterbegin",$.createIcon({icon:a,classes:["step-alert","icon-"+a]}))),!this.isMultiselect||this.settings.hideCheckboxes&&!1!==i||e[0].insertAdjacentHTML("beforeend",'<span class="tree-checkbox"></span>');var p=this.getBadgeHtml(n);""!==p&&e[0].insertAdjacentHTML("beforeend",p);var g=document.createElement("span");if(g.classList.add("tree-text"),g.textContent=u,e[0].appendChild(g),this.hasIconClass(e)&&this.setTreeIcon(e.find("svg.icon-tree"),e[0].getAttribute("class")),h[0]&&"ul"===h[0].tagName.toLowerCase()){var f=e[0].getAttribute("class");h[0].setAttribute("role","group"),h[0].parentNode.classList.add("folder"),this.setTreeIcon(e.find("svg.icon-tree"),h[0].classList.contains("is-open")?this.settings.folderIconOpen:this.settings.folderIconClosed),f&&-1===f.indexOf("open")&&-1===f.indexOf("closed")&&(e[0].setAttribute("class",o?"is-disabled":""),this.setTreeIcon(e.find("svg.icon-tree"),h[0].classList.contains("is-open")?this.settings.folderIconOpen:this.settings.folderIconClosed)),this.hasIconClass(e)&&(f=e[0].getAttribute("class"),this.setTreeIcon(e.find("svg.icon-tree"),h[0].classList.contains("is-open")?f:f.replace("open","closed")))}e.hideFocus()},setTreeIcon:function(e,t){if(e&&"string"==typeof t){e=this.isjQuery(e)?e:$(e);var i=t.replace(/#?icon-|hide-focus|\s?/gi,"");e.changeIcon(i)}},expandAll:function(e){var t=this,i=e;(i=void 0!==i?this.isjQuery(i)?$.makeArray(i):i:[].slice.call(this.element[0].querySelectorAll("ul[role=group]"))).forEach(function(e){var i=e.previousElementSibling;if(e.parentNode.classList.add("is-open"),e.classList.add("is-open"),e.style.height="",i&&"a"===i.tagName.toLowerCase()){var s=i.querySelector("svg.icon-tree");t.setTreeIcon(s,t.settings.folderIconOpen),i.setAttribute("aria-expanded",!0),t.hasIconClass(i)&&t.setTreeIcon(s,i.getAttribute("class"))}})},collapseAll:function(e){var t=this,i=e;(i=void 0!==i?this.isjQuery(i)?$.makeArray(i):i:[].slice.call(this.element[0].querySelectorAll("ul[role=group]"))).forEach(function(e){var i=e.previousElementSibling;if(e.parentNode.classList.remove("is-open"),e.classList.remove("is-open"),e.style.height=0,i&&"a"===i.tagName.toLowerCase()){var s=i.querySelector("svg.icon-tree");t.setTreeIcon(s,t.settings.folderIconClosed),i.setAttribute("aria-expanded",!1),i.classList.remove("is-selected"),t.hasIconClass(i)&&t.setTreeIcon(s,i.getAttribute("class").replace("open","closed"))}})},isjQuery:function(e){return e&&(e instanceof jQuery||e.constructor.prototype.jquery)},selectNodeById:function(e){this.selectNodeByJquerySelector("#"+e)},selectNodeByJquerySelector:function(e){var t=this.isjQuery(e)?e:$(e);if(t.length&&!t.is(".is-disabled")){var i=t.parentsUntil(this.element,"ul[role=group]");this.expandAll(i),this.selectNode(t,!0)}},unSelectedNode:function(e,t){if(0!==e.length){var i=this;$("a",this.element).attr("tabindex","-1"),e.attr("tabindex","0"),$("a:not(.is-disabled)",e.parent()).attr("aria-selected","false").parent().removeClass("is-selected"),this.syncNode(e),this.setNodeStatus(e),t&&e.focus(),[].slice.call(this.element[0].querySelectorAll("li")).forEach(function(e){return e.classList.remove("is-active")}),e[0].parentNode.classList.add("is-active"),setTimeout(function(){var t=e.data("jsonData")||{};i.element.triggerHandler("unselected",{node:e,data:t})},0)}},selectNode:function(e,t){var i=this,s=this.settings;if(0!==e.length){var n=void 0;"function"==typeof s.onBeforeSelect?(n=s.onBeforeSelect(e))&&n.done&&"function"==typeof n.done?n.done(function(s){s&&i.selectNodeFinish(e,t)}):n&&i.selectNodeFinish(e,t):i.selectNodeFinish(e,t)}},selectNodeFinish:function(e,t,i){if(this.isMultiselect&&i)if("click"===i.type||"touch"===i.type){if(i.target.classList.contains("icon")&&e[0].parentNode.classList.contains("folder"))return}else if("keydown"===i.type){var s=i.charCode||i.keyCode;if(37===s||39===s)return}var n=this,a=[].slice.call(this.element[0].querySelectorAll("a"));if(a.forEach(function(e){return e.setAttribute("tabindex","-1")}),e[0].setAttribute("tabindex","0"),this.isMultiselect){[].slice.call(e[0].parentNode.querySelectorAll("a:not(.is-disabled)")).forEach(function(e){e.setAttribute("aria-selected","true"),e.classList.add("is-selected"),e.parentNode.classList.add("is-selected")})}else{if(e[0].classList.contains("is-selected"))return;a.forEach(function(e){var t=$(e),i=t.data("jsonData");i&&(delete i.selected,t.data("jsonData",i)),e.setAttribute("aria-selected","false"),e.classList.remove("is-selected"),e.parentNode.classList.remove("is-selected")}),e[0].setAttribute("aria-selected","true"),e[0].classList.add("is-selected"),e[0].parentNode.classList.add("is-selected")}this.syncNode(e),this.loading||this.setNodeStatus(e),t&&e.focus(),[].slice.call(this.element[0].querySelectorAll("li")).forEach(function(e){return e.classList.remove("is-active")}),e[0].parentNode.classList.add("is-active"),setTimeout(function(){var t=e.data("jsonData")||{};n.element.triggerHandler("selected",{node:e,data:t})},0)},setNodeStatus:function(e){var t=this,i=e.data("jsonData"),s=void 0;if(this.isMultiselect){var n=function(e,i){e.forEach(function(e){var s=$(e.querySelector("a")),n=t.getSelectedStatus(s,i);"mixed"===n?(e.classList.remove("is-selected","is-partial"),e.classList.add("is-partial")):n?(e.classList.remove("is-selected","is-partial"),e.classList.add("is-selected")):e.classList.remove("is-selected","is-partial"),t.syncNode(s)})},a=!1;n(s=[].slice.call(e[0].parentNode.querySelectorAll("li.folder")),a),a=!(!s.length&&i&&!i.selected),s=e.parentsUntil(this.element,"li.folder"),n(s=[].slice.call(s.toArray()),a)}else{var r=e[0],o=r.parentNode;i&&i.selected?(o.classList.add("is-selected"),r.classList.add("is-selected"),r.setAttribute("aria-selected",!0)):(o.classList.remove("is-selected","is-partial"),r.classList.remove("is-selected","is-partial"),r.setAttribute("aria-selected",!1))}},getSelectedStatus:function(e,t){var i=0,s=0,n=0,a=void 0;e.parent().find("a").each(function(e){t&&0===e||(i++,(a=$(this).data("jsonData"))&&a.selected?s++:n++)});return i===s||i!==n&&"mixed"},toggleNode:function(e,t){var i=e.next(),s=this,n=this.settings,a=void 0;if(i[0]&&"ul"===i[0].tagName.toLowerCase()&&"group"===i[0].getAttribute("role"))if(i[0].classList.contains("is-open"))"function"==typeof n.onCollapse?(a=n.onCollapse(e))&&a.done&&"function"==typeof a.done?a.done(function(i){i&&s.selectNodeFinish(e,focus,t)}):a&&s.selectNodeFinish(e,focus,t):s.selectNodeFinish(e,focus,t),s.setTreeIcon(e.closest(".folder").removeClass("is-open").end().find("svg.icon-tree"),n.folderIconClosed),s.hasIconClass(e.closest(".folder a"))&&s.setTreeIcon(e.closest(".folder a").find("svg.icon-tree"),e.closest(".folder a").attr("class").replace("open","closed").replace(/\s?is-selected/,"")),s.isAnimating=!0,s.isMultiselect||(s.unSelectedNode(e.parent().find("li.is-selected"),!1),e[0].classList.remove("is-selected")),i.one("animateclosedcomplete",function(){i[0].classList.remove("is-open"),s.isAnimating=!1}).animateClosed(),e[0].setAttribute("aria-expanded","true"!==e[0].getAttribute("aria-expanded"));else{"function"==typeof n.onExpand?(a=n.onExpand(e))&&a.done&&"function"==typeof a.done?a.done(function(i){i&&s.selectNodeFinish(e,focus,t)}):a&&s.selectNodeFinish(e,focus,t):s.selectNodeFinish(e,focus,t);var r=e.data("jsonData");if(n.source&&r.children&&0===r.children.length){var o={node:e,data:e.data("jsonData")};return e[0].classList.add("is-loading"),s.loading=!0,void s.settings.source(o,function(t){var n=r.id,a=s.findById(n);a.children=t,s.addChildNodes(a,e.parent()),e[0].classList.remove("is-loading"),s.loading=!1,s.accessNode(i,e),r.children=t,e.data("jsonData",r),s.selectNode(e,!0),s.initSelected()})}s.accessNode(i,e)}},accessNode:function(e,t){var i=this,s=t.attr("class");this.setTreeIcon(t.closest(".folder").addClass("is-open").end().find("svg.icon-tree"),this.settings.folderIconOpen),this.hasIconClass(s)&&this.setTreeIcon(t.find("svg.icon-tree"),s.replace("is-selected","")),this.isAnimating=!0,e.one("animateopencomplete",function(){i.isAnimating=!1}).addClass("is-open").css("height",0).animateOpen(),t[0].setAttribute("aria-expanded","true"!==t[0].getAttribute("aria-expanded"))},openNode:function(e,t){var i=this,s=t.data("jsonData");if(i.settings.source&&s.children&&0===s.children.length){var n={node:t,data:t.data("jsonData")};return t.addClass("is-loading"),i.loading=!0,void i.settings.source(n,function(n){var a=s.id,r=i.findById(a);r.children=n,i.addChildNodes(r,t.parent()),t.removeClass("is-loading"),i.loading=!1,i.accessNode(e,t),s.children=n,t.data("jsonData",s),i.selectNode(t,!0),i.initSelected()})}i.accessNode(e,t)},hasIconClass:function(e){return"string"!=typeof e&&(this.isjQuery(e)&&(e=e.length>1?e.first()[0]:e[0]),e=e.getAttribute("class")),e&&e.indexOf("icon")>-1},closeNode:function(e,t){var i=this;i.setTreeIcon(t.closest(".folder").removeClass("is-open").end().find("svg.icon-tree"),i.settings.folderIconClosed),i.hasIconClass(t.closest(".folder a"))&&i.setTreeIcon(t.closest(".folder a").find("svg.icon-tree"),t.closest(".folder a").attr("class").replace("open","closed").replace(/\s?is-selected/,"")),i.isAnimating=!0,i.isMultiselect||(i.unSelectedNode(t.parent().find("li.is-selected"),!1),t.removeClass("is-selected")),e.one("animateclosedcomplete",function(){e.removeClass("is-open"),i.isAnimating=!1}).animateClosed(),t.attr("aria-expanded","true"!==t.attr("aria-expanded"))},setupEvents:function(){var e=this;e.element.on("updated.tree",function(t,i){e.updated(i),e.initTree()})},handleKeys:function(){var e=this;this.element.on("click.tree","a:not(.is-clone)",function(t){var i=$(this),s=this.parentNode;return i[0].classList.contains("is-disabled")||i[0].classList.contains("is-loading")||(e.isMultiselect?t.target.classList.contains("icon")&&s.classList.contains("folder")?e.toggleNode(i,t):s.classList.contains("is-selected")||s.classList.contains("is-partial")?e.unSelectedNode(i,!0):e.selectNode(i,!0):(e.selectNode(i,!0),e.toggleNode(i,t)),t.stopPropagation()),e.popupEl&&e.popupEl.data("popupmenu")&&(e.popupEl.data("popupmenu").close(),e.popupEl=null),!1}),this.element.on("focus.tree","a",function(){if(0===parseInt(this.getAttribute("aria-level"),10)&&1===parseInt(this.getAttribute("aria-posinset"),10)&&this.classList.contains("is-disabled")){var e=$.Event("keydown.tree");return e.keyCode=40,void $(this).trigger(e)}}),this.element.on("keydown.tree","a",function(t){var i=t.charCode||t.keyCode,s=$(this),n=void 0,a=void 0;if(!e.isAnimating){if(40===i){var r=e.getNextNode(s);e.setFocus(r)}if(38===i){var o=e.getPreviousNode(s);e.setFocus(o)}if(32===t.keyCode&&s.trigger("click.tree"),37===i)return k.isRTL()?s.next().hasClass("is-open")?(a=s.next().find("a:first"),e.setFocus(a)):e.toggleNode(s,t):s.next().hasClass("is-open")?e.toggleNode(s,t):(a=s.closest(".folder").find("a:first"),e.setFocus(a)),t.stopPropagation(),!1;if(39===i)return k.isRTL()?s.next().hasClass("is-open")?e.toggleNode(s,t):(n=s.closest(".folder").find("a:first"),e.setFocus(n)):s.next().hasClass("is-open")?(n=s.next().find("a:first"),e.setFocus(n)):(e.toggleNode(s,t),e.setFocus(s)),t.stopPropagation(),!1;36===i&&(n=e.element.find("a:first:visible"),e.setFocus(n)),35===i&&(n=e.element.find("a:last:visible"),e.setFocus(n))}}),this.element.on("keypress.tree","a",function(t){var i=t.charCode||t.keyCode,s=$(this);if(i>=37&&i<=40||32===i)return t.stopPropagation(),!1;0!==t.which&&s.closest("li").nextAll().find("a:visible").each(function(){var i=$(this);if(i.text().substr(0,1).toLowerCase()===String.fromCharCode(t.which).toLowerCase())return e.setFocus(i),!1})})},loadData:function(e){if(!e)return-1;var t=this;t.element.empty(),t.loading=!0,e=this.arrangeDataset(e);var i="";t.jsonData=[];for(var s=0,n=e.length;s<n;s++)i+=t.getNodeHtml(e[s],s);t.element[0].insertAdjacentHTML("beforeend",i),[].slice.call(t.element[0].querySelectorAll('a[role="treeitem"]')).forEach(function(e,i){var s=$(e),n=t.jsonData[i];s.data("jsonData",n),n.selected&&t.selectNode(s,n.focus)});for(var a=[].slice.call(t.element[0].querySelectorAll("select.dropdown")),r=0;r<a.length;r++){var o=a[r];t.jsonData[r].disabled?$(o).dropdown().disable():$(o).dropdown().on("selected.tree",function(){var e=t.findById(this.parentElement.previousElementSibling.id);e.text=this.value,t.updateNode(e)})}t.jsonData=void 0,t.loading=!1,t.syncDataset(),t.initSelected(),t.focusFirst(),t.attachMenu(t.settings.menuId),t.createSortable()},arrangeDataset:function(e){if(!this.hasKeyInData("parent",e))return e;e=e||this.settings.dataset;var t=JSON.parse(JSON.stringify(e));!function e(i){for(var s=0;s<i.length;s++)void 0!==i[s].parent&&(n=i[s],a=void 0,a=!1,function e(t){for(var i=0;i<t.length&&!a;i++)t[i].id===n.parent&&((s=t[i]).children=s.children||[],s.children.push(n),a=!0),void 0!==t[i].children&&e(t[i].children);var s}(t)),void 0!==i[s].children&&e(i[s].children);var n,a}(e);return function e(t,i){for(var s=0;s<t.length;s++)void 0!==t[s].children&&e(t[s].children,t[s].id),void 0===i&&void 0!==t[s].parent||void 0!==i&&void 0!==t[s].parent&&i!==t[s].parent?(t.splice(s,1),s--):delete t[s].parent}(t),this.settings.dataset=t,t},hasKeyInData:function(e,t){for(var i=!1,s=function t(s){for(var n in s)if(s.hasOwnProperty(n)){var a=s[n];if("object"!==(void 0===a?"undefined":u(a))||i?e===n&&(i=!0):t(a),i)break}},n=0,a=(t=t||this.settings.dataset).length;n<a&&!i;n++)s(t[n]);return i},getNodeHtml:function(e,t,i,s){var n="",a="";i=i||0,t+=1;var r=this.settings,o=s||e.disabled||!1,l={id:void 0!==e.id?' id="'+e.id+'"':"",href:' href="'+(void 0!==e.href?e.href:"#")+'"',expanded:' aria-expanded="'+(e.open?"true":"false")+'"',icon:e.icon||""===e.icon?e.icon:"tree-node",alertIcon:"",alertIconAttr:void 0!==e.alertIcon?' data-alert-icon="'+e.alertIcon+'"':"",text:'<span class="tree-text">'+e.text+"</span>",class:["hide-focus"],ariaDisabled:o?'aria-disabled="true"':"",checkbox:!this.isMultiselect||this.settings.hideCheckboxes&&!1!==e.hideCheckbox?"":'<span class="tree-checkbox"></span>',badge:"object"===u(e.badge)?this.getBadgeHtml(e.badge):""};this.jsonData.push(e),r.useStepUI&&(l.alertIcon='<svg class="icon step-alert icon-'+e.alertIcon+'" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-'+e.alertIcon+'"></use>');var d=e.children&&e.children.constructor===Array,c=d?"folder":"";if(""!==(c+=e.selected?" is-selected":"")&&(c=' class="'+(c+=e.open?" is-open":"")+'"'),o&&l.class.push("is-disabled"),e.icon&&(l.icon=e.icon,(!d||d&&/open|closed/i.test(e.icon))&&l.class.push(e.icon)),d&&(e.open?(l.icon=e.icon&&/open|closed/i.test(e.icon)?e.icon:r.folderIconOpen,s=o):l.icon=e.icon&&/open|closed/i.test(e.icon)?e.icon.replace("open","closed"):r.folderIconClosed),l.icon="#icon-"+l.icon.replace(/^#?icon-?/,""),l.class=' class="'+l.class.join(" ")+'"',l.style="","dropdown"===e.type&&(l.style='style="display: none"',e.data)){n='<select class="dropdown" close-on-select="true">';for(var h=0;h<e.data.length;h++){var p=e.data[h];p.value===e.text?(a=p.text,n+='<option value="'+p.value+'" selected>'+p.text+"</option>"):n+='<option value="'+p.value+'">'+p.text+"</option>"}n+='</select><div class="dropdown-wrapper"><div class="dropdown"><span>'+a,n='<div class="treeDropdown" style="width: 80px; margin-left: 35px; margin-bottom: -15px">'+(n+='</span></div><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-dropdown"></use></svg></div>')+"</div>"}var g="\n      <li"+c+'>\n        <a role="treeitem" aria-selected="false" tabindex="-1" '+l.style+'\n          aria-level="'+i+'"\n          aria-position="'+t+'"\n          aria-setsize="'+t+'"\n          '+(l.id+l.href+l.class+l.expanded+l.ariaDisabled+l.alertIconAttr)+'>\n            <svg class="icon-tree icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="'+l.icon+'"></use>\n            </svg>'+(l.checkbox+l.alertIcon+l.badge+l.text)+"\n        </a>\n        "+n;if(d){g+='<ul class="folder'+(e.open?" is-open":"")+'" role="group">';for(var f=0,m=e.children.length;f<m;f++)g+=this.getNodeHtml(e.children[f],f,i+1,s);g+="</ul>"}return g+="</li>"},getBadgeHtml:function(e){var t={html:"",style:"",class:["badge","tree-badge"]};return e&&!e.remove&&(t.text="",void 0!==e.text&&(t.text=e.text.toString(),1===t.text.length&&t.class.push("round")),/info|good|error|alert|pending/i.test(e.type)?t.class.push(e.type):e.type&&"#"===e.type.charAt(0)&&7===e.type.length&&(t.style="background-color: "+e.type+" !important;"),e.backColor&&(t.style="background-color: "+e.backColor+" !important;"),e.foreColor&&(t.style+="color: "+e.foreColor+" !important;"),""!==t.style&&(t.style=' style="'+t.style+'"'),""!==t.text&&(e.type&&-1!==e.type.indexOf("pending")&&(t.text=""),t.html='<span class="'+t.class.join(" ")+'"'+t.style+">"+t.text+"</span>")),t.html},addToDataset:function(e,t){var i=void 0,s=void 0,n=void 0;if(e.parent&&(i=this.findById(e.parent)),t instanceof jQuery&&t.is("li")){var a=(s=this.findById($(t[0].parentNode.parentNode).find("a")[0].id)).children||s.node.data("jsonData").children;n=a.findIndex(function(e){return e.text.trim()===$(t).text().trim()}),a.splice(n,0,e)}return"bottom"!==t||e.parent||i||this.settings.dataset.push(e),"top"!==t||e.parent||i||this.settings.dataset.unshift(e),e.parent&&i&&(i.children||(i.children=[]),"bottom"===t?i.children.push(e):i.children.unshift(e)),!(e.parent&&!i)},findById:function(e,t){for(var i in t||(t=this.settings.dataset),t){var s=t[i];if(s.id===e)return s;if(s.children||s.node.data("jsonData").children){var n=this.findById(e,s.children||s.node.data("jsonData").children);if(n)return n}}return null},getNodeByIdIfSelected:function(e,t){var i=this.findById(e,t);return i&&i.selected?i:null},getSelectedNodes:function(){var e=void 0,t=void 0,i=[];return $("li.is-selected",this.element).each(function(){e=$("a:first",this),t=e.data("jsonData"),i.push({node:e,data:t})}),i},getNextNode:function(e){var t=e.parent().next().find("a:first"),i=e.next();if(i.is("ul.is-open")&&(t=i.find("a:first")),t.hasClass("is-disabled")&&(t=t.parent().next().find("a:first")),0===t.length)for(var s=0,n=e;s<1e3&&!(t=(n=n.parent().closest(".folder")).next().find("a:first")).length;s++);return t.hasClass("is-disabled")&&(t=this.getNextNode(t)),t},getPreviousNode:function(e){var t=e.parent().prev().find("a:first"),i=t.parent();return i.is(".folder.is-open")&&i.find("ul.is-open a").length&&!i.find("ul.is-disabled").length&&(t=i.find("ul.is-open a:last")),t.hasClass("is-disabled")&&(i=(t=t.parent().prev().find("a:first")).parent()).is(".folder.is-open")&&i.find("ul.is-open a").length&&!i.find("ul.is-disabled").length&&(t=i.find("ul.is-open a:last")),0===t.length&&(t=e.closest("ul").prev("a")),t.hasClass("is-disabled")&&(t=this.getPreviousNode(t)),t},syncDataset:function(e){var t=[],i=this;e=e||this.element,[].slice.call(e.children("li").toArray()).forEach(function(e){t.push(i.syncNode(e.querySelector("a")))}),this.settings.dataset=t,this.element.triggerHandler("rendered",{data:this.settings.dataset})},syncNode:function(e){var t=this,i=this.isjQuery(e)?e:$(e),s=(e=i[0]).parentNode,n=function(e,t){return e.classList.contains(t)},a={node:i,id:e.getAttribute("id"),text:e.querySelector(".tree-text").textContent};(n(e,"is-open")||s&&"li"===s.tagName.toLowerCase()&&n(s,"is-open"))&&(a.open=!0);var r=e.getAttribute("href");r&&(a.href=r),n(s,"is-selected")&&(a.selected=!0),n(e,"is-disabled")&&(a.disabled=!0);var o=e.getAttribute("class");o&&o.indexOf("icon")>-1&&(a.icon=o);var l=i.next();l[0]&&"ul"===l[0].tagName.toLowerCase()&&(a.children=[],[].slice.call(l.children("li").toArray()).forEach(function(e){a.children.push(t.syncNode(e.querySelector("a")))}));var d=i.data("jsonData");return d&&(delete d.selected,delete d.children,a=$.extend({},d,a)),i.data("jsonData",a),a},addNode:function(e,t,i){var s=this,n=void 0,a=void 0,r=void 0,o="object"===u(e.badge)?JSON.stringify(e.badge):e.badge;e.href=void 0!==e.href?e.href:"#",t=t||"bottom";var l=document.createElement("a");l.setAttribute("id",e.id),l.setAttribute("href",e.href),void 0!==o&&l.setAttribute("data-badge",o),void 0!==e.alertIcon&&l.setAttribute("data-alert-icon",e.alertIcon),e.text&&(l.textContent=e.text),e.disabled&&l.classList.add("is-disabled"),e.icon&&l.classList.add(e.icon);var d=document.createElement("li");if(e.open&&d.classList.add("is-open"),d.appendChild(l),"dropdown"===e.type&&(l.setAttribute("style","display: none"),e.data)){a='<select class="dropdown" close-on-select="true">';for(var c=0;c<e.data.length;c++)(r=e.data[c]).value===e.text?(n=r.text,a+='<option value="'+r.value+'" selected>'+r.text+"</option>"):a+='<option value="'+r.value+'">'+r.text+"</option>";a+='</select><div class="dropdown-wrapper"><div class="dropdown"><span>'+n,a+='</span></div><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-dropdown"></use></svg></div>',$('<div class="treeDropdown" style="width: 80px; margin-left: 35px; margin-bottom: -15px">'+a+"</div>").appendTo(d),e.disabled?$(d).find("select.dropdown").dropdown().disable():$(d).find("select.dropdown").dropdown().on("selected.tree",function(){var e=s.findById(this.parentElement.previousElementSibling.id);e.text=this.value,s.updateNode(e)})}var h=!!this.loading||this.addToDataset(e,t);return e.parent instanceof jQuery&&(h=!0),t instanceof jQuery&&"before"===i?($(d).insertBefore(t),h=!0):t instanceof jQuery&&"after"===i&&($(d).insertAfter(t),h=!0),!(t instanceof jQuery)||e.parent&&h||e.parent instanceof jQuery||"before"===i||"after"===i||(t[0].appendChild(d),h=!0),"bottom"!==t||e.parent&&h||this.element[0].appendChild(d),"top"!==t||e.parent&&h||this.element.prepend(d),e.parent?(h&&"string"==typeof e.parent&&(d=this.element.find("#"+e.parent).parent(),!e.disabled&&d.is(".is-selected")&&void 0===e.selected&&(e.selected=!0),this.addAsChild(e,d)),e.parent&&e.parent instanceof jQuery&&(d=e.parent,e.parent.is("a")&&(d=e.parent.parent()),this.addAsChild(e,d)),this.isjQuery(d)&&(e.node=d.find("ul li a#"+e.id))):(d=$(d),this.addChildNodes(e,d),e.node=d.children("a").first()),l=$(l),this.decorateNode(l,e.icon,e.hideCheckbox),e.selected&&this.selectNode(l,e.focus),l.data("jsonData",e),d},addAsChild:function(e,t){var i=(t=this.isjQuery(t)?t[0]:t).querySelector("ul");i||(t.insertAdjacentHTML("beforeend",'<ul class="folder"></ul>'),i=t.querySelector("ul")),e.open&&i.classList.add("is-open"),this.decorateNode(t.querySelector("a")),e.parent="",this.addNode(e,$(i))},addChildNodes:function(e,t){var i=this,s=(t=this.isjQuery(t)?t[0]:t).querySelector("ul");e.children?(s||(t.insertAdjacentHTML("beforeend",'<ul class="folder'+(e.open?" is-open":"")+'"></ul>'),s=t.querySelector("ul")),s.innerHTML="",e.children&&e.children.forEach(function(e){return i.addNode(e,$(s))})):s&&s.parentNode.removeChild(s)},isTrue:function(e){return null!=e&&("boolean"==typeof e&&!0===e||"string"==typeof e&&"true"===e.toLowerCase())},isFalse:function(e){return null!=e&&("boolean"==typeof e&&!1===e||"string"==typeof e&&"false"===e.toLowerCase())},updateNode:function(e){var t=e.node?{node:e.node}:this.findById(e.id);if(t&&t.node[0]){var i=t.node[0].parentNode,s=t.node[0].querySelector(".tree-text"),n=this.isTrue(e.disabled)||this.isFalse(e.enabled),a=this.isTrue(e.enabled)||this.isFalse(e.disabled);if(e.badge){var r=t.node[0].querySelector(".tree-badge");if(!r&&!e.badge.remove&&void 0!==e.badge.text&&""!==$.trim(e.badge.text)){var o=document.createElement("span");o.classList.add("tree-badge","badge"),s.parentNode.insertBefore(o,s),r=t.node[0].querySelector(".tree-badge")}r&&(void 0!==e.badge.text&&(e.badge.text=e.badge.text.toString(),r.textContent=e.badge.text,r.classList.remove("round"),1===e.badge.text.length&&r.classList.add("round")),void 0!==e.badge.type&&(r.classList.remove("info","good","error","alert","pending"),/info|good|error|alert|pending/i.test(e.badge.type)?r.classList.add(e.badge.type):"#"===e.badge.type.charAt(0)&&7===e.badge.type.length&&(r.style.backgroundColor=e.badge.type),-1!==e.badge.type.indexOf("pending")&&(r.textContent="")),t.badge=e.badge,this.parseBool(e.badge.remove)&&(r.parentNode.removeChild(r),void 0!==t.badge&&delete t.badge))}if(e.text&&(s.textContent=e.text,t.text=e.text),e.icon?(this.setTreeIcon(t.node[0].querySelector("svg.icon-tree"),e.icon),t.icon=e.icon):e.children&&e.children.length&&!i.classList.contains("folder")&&this.convertFileToFolder(t.node),n)if(t.node[0].classList.add("is-disabled"),t.node[0].setAttribute("aria-disabled","true"),i.classList.contains("folder")&&i.classList.contains("is-open"))[].slice.call(i.querySelectorAll("a, ul[role=group]")).forEach(function(e){e.classList.add("is-disabled"),e.setAttribute("aria-disabled","true")});if(a)if(!(t.node.parentsUntil(this.element,"ul[role=group].is-disabled").length>0))if(t.node[0].classList.remove("is-disabled"),t.node[0].removeAttribute("aria-disabled"),i.classList.contains("folder")&&i.classList.contains("is-open"))[].slice.call(i.querySelectorAll("a, ul[role=group]")).forEach(function(e){e.classList.remove("is-disabled"),e.removeAttribute("aria-disabled")});e.node&&this.syncDataset(),e.children&&(e.children.length?this.addChildNodes(e,i):this.removeChildren(e,i)),this.createSortable()}},parseBool:function(e){return!/^(false|0)$/i.test(e)&&!!e},removeChildren:function(e,t){var i=(t=this.isjQuery(t)?t[0]:t).querySelector("ul");this.setTreeIcon(t.querySelector("svg.icon-tree"),e.icon||"icon-tree-node"),t.classList.remove("folder","is-open"),i&&i.parentNode.removeChild(i)},removeNode:function(e){var t=this.findById(e.id);e instanceof jQuery?(t=e).parent().remove():t&&t.node.parent().remove(),t&&this.syncDataset()},attachMenu:function(e){var t=this;e&&this.element.off("contextmenu.tree").on("contextmenu.tree","a",function(i){var s=$(this);return i.preventDefault(),t.popupEl=$(i.currentTarget).popupmenu({menuId:e,eventObj:i,trigger:"immediate",attachToBody:!0}).off("selected").on("selected",function(e,i){t.element.triggerHandler("menuselect",{node:s,item:i})}),t.element.triggerHandler("menuopen",{menu:$("#"+e),node:s}),!1})},createSortable:function(){if(this.settings.sortable){var e=this,t=void 0,i=void 0,s=void 0;if(e.targetArrow=e.element[0].previousElementSibling,e.linkSelector="a:not(.is-dragging-clone):not(.is-disabled)",!e.targetArrow||e.targetArrow&&!e.targetArrow.classList.contains("tree-drag-target-arrow")){var n=document.createElement("div");n.classList.add("tree-drag-target-arrow"),e.element[0].parentNode.insertBefore(n,e.element[0]),e.targetArrow=e.element[0].previousElementSibling}i=setInterval(function(){e.loading||(clearInterval(i),[].slice.call(e.element[0].querySelectorAll(e.linkSelector)).forEach(function(i){var n=$(i);n.data("drag")||n.on("mousedown.tree",function(e){e.preventDefault(),s=!(3===e.which||e.target.classList.contains("icon")&&i.parentNode.classList.contains("folder"))}).drag({clone:!0,cloneAppendTo:n.closest("li"),clonePosIsFixed:!0}).on("dragstart.tree",function(a,r,o){if(!o||!s)return i.classList.remove("is-dragging"),void(o&&o[0].parentNode.removeChild(o[0]));(t=o)[0].removeAttribute("id"),t[0].classList.add("is-dragging-clone"),[].slice.call(t[0].querySelectorAll(".tree-checkbox, .tree-badge")).forEach(function(e){return e.parentNode.removeChild(e)});var l=n.closest("ul");e.sortable={startIndex:$(e.linkSelector,e.element).index(n),startNode:n,startIcon:$("svg.icon-tree",n).getIconName(),startUl:l,startLi:n.closest("li"),startFolderNode:l.prev("a"),startWidth:n.outerWidth()},e.element.triggerHandler("sortstart",e.sortable),a.preventDefault(),a.stopImmediatePropagation()}).on("drag.tree",function(i,s){t&&(t[0].style.left=s.left+"px",t[0].style.top=s.top+"px",t[0].style.opacity="1",e.setDragOver(t,s))}).on("dragend.tree",function(i,s){if(e.targetArrow.style.display="none",[].slice.call(e.element[0].querySelectorAll(e.linkSelector)).forEach(function(e){return e.classList.remove("is-over")}),t&&e.sortable.overDirection){t[0].style.left=s.left+"px",t[0].style.top=s.top+"px";var n=e.sortable.startNode.parent(),a=e.sortable.overNode.parent();"over"===e.sortable.overDirection?(a[0].classList.contains("folder")||e.convertFileToFolder(e.sortable.overNode),a[0].querySelector("ul").appendChild(n[0]),a[0].classList.contains("is-open")||e.toggleNode(e.sortable.overNode,i)):"up"===e.sortable.overDirection?n.insertBefore(a):"down"===e.sortable.overDirection&&(a[0].classList.contains("is-open")&&a[0].classList.contains("folder")?$("ul:first",a).prepend(n):n.insertAfter(a)),!e.sortable.startUl[0].querySelector("li")&&e.sortable.startFolderNode.data("oldData")&&"file"===e.sortable.startFolderNode.data("oldData").type&&e.convertFolderToFile(e.sortable.startFolderNode),m.fixSVGIcons(n),e.element.triggerHandler("sortend",e.sortable),e.syncDataset(),e.isMultiselect&&e.initSelected()}})}))},10)}},setDragOver:function(e,t){var i=this,s=e[0].querySelector("svg.icon-tree"),n=i.element[0].getBoundingClientRect(),a=20,r=void 0,o=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0,p=void 0,g=void 0,f=void 0,m=void 0,v=void 0,b=function(){i.sortable.overNode=null,i.sortable.overIndex=null,i.sortable.overDirection=null,i.targetArrow.style.display="none",i.setTreeIcon(s,"icon-cancel")};t.top>n.top-a&&t.top<n.bottom+a&&t.left>n.left-a-i.sortable.startWidth&&t.left<n.left+n.height+a?(a=2,(u=[].slice.call(i.element[0].querySelectorAll(i.linkSelector))).forEach(function(e,n){if(m=null,p=e.getBoundingClientRect(),t.top>p.top-a&&t.top<p.bottom+a){if(c=$(e),!!c.parentsUntil(i.element,".folder").filter(function(){return $("a:first",this).is(i.sortable.startNode)&&i.sortable.startLi.is(".folder")}).length)return void b();d=e.parentNode,g=p.left,h=c.closest("ul"),r=parseInt(d.style.marginTop,10)>0?2:0,o=n-1===i.sortable.startIndex&&h.is(i.sortable.startUl),l=n+1===i.sortable.startIndex&&h.is(i.sortable.startUl),u.forEach(function(e){return e.classList.remove("is-over")}),v=function(){m?(i.setTreeIcon(s,i.sortable.startIcon),"over"===m?(i.targetArrow.style.display="none",e.classList.contains("is-disabled")||e.classList.add("is-over")):(u.forEach(function(e){return e.classList.remove("is-over")}),f="up"===m?p.top-1.5-(d.classList.contains("is-active")?3:0):p.bottom+(d.nextElementSibling&&d.nextElementSibling.classList.contains("is-active")?-1:1.5)+r,i.targetArrow.style.left=g+"px",i.targetArrow.style.top=f+"px",i.targetArrow.style.display="block"),i.sortable.overNode=c,i.sortable.overIndex=n,i.sortable.overDirection=m):b()},n!==i.sortable.startIndex&&(t.left>p.left-a-i.sortable.startWidth&&t.left<p.right+a?m=!o&&t.top<p.top?"up":!l&&t.top>p.top+2*a?"down":"over":!o&&t.top<p.top?m="up":l||(m="down")),v(m)}})):b()},convertFileToFolder:function(e){var t=document.createElement("ul");t.setAttribute("role","group");var i={icon:$("svg.icon-tree",e).getIconName(),type:"file"};if(this.hasIconClass(e)){var s=e.attr("class").replace(/\s?is-selected/,"");i.iconClass=s,e.removeClass(s)}e.data("oldData",i);var n=e[0].parentNode;n&&"li"===n.tagName.toLowerCase()&&(n.classList.add("folder"),n.appendChild(t)),this.setTreeIcon($("svg.icon-tree",e),this.settings.folderIconClosed)},convertFolderToFile:function(e){var t=e.parent(".folder");t.removeClass("folder is-open"),$("ul:first",t).remove(),t.length&&(this.setTreeIcon($("svg.icon-tree",e),e.data("oldData")?e.data("oldData").icon:"tree-node"),e.data("oldData")&&e.data("oldData").iconClass&&e.addClass(e.data("oldData").iconClass),e.data("oldData",null))},unbind:function(){return this.settings.sortable&&(this.element.find("a").each(function(){var e=$(this),t=e.data("drag");e.off("mousedown.tree"),t&&t.destroy&&t.destroy()}),this.element.prev(".tree-drag-target-arrow").remove()),this.element.off("contextmenu.tree updated.tree click.tree focus.tree keydown.tree keypress.tree"),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,ps)),this.unbind().init()},destroy:function(){this.unbind(),this.element.empty(),$.removeData(this.element[0],"tree")},disable:function(){[].slice.call(this.element[0].querySelectorAll("a")).forEach(function(e){e.classList.add("is-disabled"),e.setAttribute("aria-disabled","true")})},enable:function(){[].slice.call(this.element[0].querySelectorAll("a")).forEach(function(e){e.classList.remove("is-disabled"),e.removeAttribute("aria-disabled")})},preserveEnablementState:function(){var e=[].slice.call(this.element[0].querySelectorAll("a")),t=[];return e.forEach(function(e){e.classList.contains("is-disabled")||!0===e.getAttribute("aria-disabled")?t.push({nodeId:e.id,state:"disabled"}):t.push({nodeId:e.id,state:"enabled"})}),this.settings.originalEnablementState=t,t},restoreEnablementState:function(){var e=this.settings,t=[].slice.call(this.element[0].querySelectorAll("a"));void 0!==e.originalEnablementState&&null!==e.originalEnablementState&&t.forEach(function(t){e.originalEnablementState.forEach(function(e){e.nodeId===t.id&&("disabled"===e.state?(t.classList.add("is-disabled"),t.setAttribute("aria-disabled","true")):(t.classList.remove("is-disabled"),t.removeAttribute("aria-disabled")))})})}},$.fn.tree=function(e){return this.each(function(){var t=$.data(this,"tree");t?t.updated(e):t=$.data(this,"tree",new gs(this,e))})};var fs={dataset:[],redrawOnResize:!0,margin:{top:20,right:20,bottom:20,left:20},colors:null,showLabel:!0,labelFormatter:".0%",showTitle:!0,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"}};function ms(e,t){this.settings=m.mergeSettings(e,t,fs),t&&t.dataset&&(this.settings.dataset=t.dataset),this.element=$(e),this.init()}ms.prototype={init:function(){return this.build().handleEvents(),this.element.trigger("rendered",[this.svg]),this},build:function(){return this.setupColors(),this.updateData(this.settings.dataset),this},setupColors:function(){if(!this.settings.colors||this.useBuiltInColors){var e=H.themeColors().palette;this.settings.colors=[e.azure[100].value,e.azure[90].value,e.azure[80].value,e.azure[70].value,e.azure[60].value,e.azure[40].value,e.azure[30].value,e.azure[20].value,e.amethyst[100].value,e.amethyst[90].value,e.amethyst[80].value,e.amethyst[70].value,e.amethyst[60].value,e.amethyst[50].value,e.amethyst[40].value,e.amethyst[40].value,e.amethyst[30].value,e.amethyst[20].value,e.turquoise[100].value,e.turquoise[90].value,e.turquoise[80].value,e.turquoise[70].value,e.turquoise[60].value,e.turquoise[50].value,e.turquoise[40].value,e.turquoise[40].value,e.turquoise[30].value,e.turquoise[20].value],this.useBuiltInColors=!0}},updateData:function(e){var t=this,i=Object.create(this.settings.margin),s=this.element.parent().width()-i.left-i.right,n=this.element.parent().height()-i.top-i.bottom,a=d3.scaleOrdinal().range(this.settings.colors);if(0!==e.length){this.settings.showTitle&&e.name&&(d3.select(this.element[0]).append("div").attr("class","chart-treemap-title").text(e.name),n-=35,i.top-=19);var r=d3.treemap().size([s,n]);this.root=d3.select(this.element[0]).classed("chart-treemap",!0).append("div").style("position","relative").style("width",s+i.left+i.right+"px").style("height",n+i.top+i.bottom+"px").style("left",i.left+"px").style("top",i.top+"px");var o=d3.hierarchy(e,function(e){return e.children}).sum(function(e){return e.value}),l=r(o);this.total=d3.sum(l.leaves(),function(e){return e.value}),this.root.datum(o).selectAll(".chart-treemap-node").data(l.leaves()).enter().append("div").attr("class","chart-treemap-node").style("left",function(e){return e.x0+"px"}).style("top",function(e){return e.y0+"px"}).style("width",function(e){return Math.max(0,e.x1-e.x0-1)+"px"}).style("height",function(e){return Math.max(0,e.y1-e.y0-1)+"px"}).style("background",function(e){return e&&e.parent&&e.parent.data?a(e.parent.data.name):""}).text(function(e){return e.data.name}),this.settings.showLabel&&this.root.selectAll(".chart-treemap-node").append("span").attr("class","chart-treemap-percent").text(function(e){return d3.format(t.settings.labelFormatter)(e.value/t.total)})}else this.element.emptymessage(this.settings.emptyMessage)},handleEvents:function(){var e=this;return this.element.on("updated.treemap",function(){e.updated()}),this.settings.redrawOnResize&&($("body").on("resize.treemap",function(){e.handleResize()}),this.element.on("resize.treemap",function(){e.handleResize()})),$("html").on("themechanged.treemap",function(){e.updated()}),this},handleResize:function(){this.width!==this.element.width()&&(this.width=this.element.width(),this.element.is(":visible")&&this.updated())},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.dataset&&(this.settings.dataset=e.dataset),this.setupColors(),this.element.empty(),this.build()},teardown:function(){return this.element.off("updated.treemap"),$("body").off("resize.treemap"),$("html").off("themechanged.treemap"),this},destroy:function(){this.element.empty().removeClass("chart-treemap"),tt.removeTooltip(),this.teardown(),$.removeData(this.element[0],"treemap")}},$.fn.treemap=function(e){return this.each(function(){var t=$.data(this,"treemap");t?t.updated(e):t=$.data(this,"treemap",new ms(this,e))})};var vs={ticks:null};function bs(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,vs),this.init()}function ys(e,t,i,s,n,a){var r=n.placeholder;if(r&&""===e){return"[object Function]"==={}.toString.call(r)?r=r(t,i,s,n,a):a&&r in a&&(r=a[r]),r}return""}bs.prototype={init:function(){this.build().handleEvents()},build:function(){return this.header=this.element.find(".wizard-header"),this.header.length||(this.header=$('<div class="wizard-header"></div>').appendTo(this.element)),this.bar=this.element.find(".bar"),this.bar.length||(this.bar=$('<div class="bar"></div>').appendTo(this.header)),this.completedRange=this.element.find(".completed-range"),this.completedRange.length||(this.completedRange=$('<div class="completed-range"></div>').appendTo(this.bar)),this.buildTicks().updateRange(),this},buildTicks:function(){var e=this.settings.ticks;if(this.ticks=this.bar.children(".tick"),!this.ticks.length&&e){for(var t=0;t<e.length;t++){var i=$('<a ng-click="handleClick()" class="tick '+(e[t].state?e[t].state:"")+'" href="'+(e[t].href?e[t].href:"#")+'"><span class="label">'+e[t].label+"</span></a>");e[t].ngClick&&i.attr("ng-click",e[t].ngClick),this.bar.append(i)}this.ticks=this.bar.children(".tick")}return this.positionTicks(),$(".tick",this.element).each(function(){var e=$(this);e.hasClass("is-disabled")&&e.removeAttr("onclick ng-click")}),this.element.find(".wizard-header")[0].style.opacity="1",this},positionTicks:function(){var e=this.ticks.length,t=100/(e-1),i=[];function s(i){return 0===i?0:i===e-1?100:t*i}for(var n=0;n<e;n++)i.push(s(n));this.ticks.each(function(e){var t=$(this),s=t.children(".label"),n=k&&k.isRTL()?100-i[e]:i[e];this.style.left=n+"%";for(var a=0,r=s.length;a<r;a++)s[a].style.left="-"+(s.outerWidth()/2-t.outerWidth()/2)+"px";t.is(".is-disabled")&&t.attr("tabindex","-1")})},updateRange:function(){var e=this.ticks.filter(".current").last(),t=0;return e.length&&(t=100*parseFloat(window.getComputedStyle(e[0]).left)/parseFloat(window.getComputedStyle(e.parent()[0]).width),t=k&&k.isRTL()?100-t:t),this.completedRange[0].style.width=t+"%",this},updated:function(e){return e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.buildTicks().updateRange(),this},teardown:function(){return this.ticks.off("click.wizard"),this.element.off("updated.wizard"),this.ticks.remove(),this},select:function(e,t){return D(this.activate,this.select).apply(this,[e,t])},activate:function(e,t){if(void 0===e&&!t)return this;var i,s=this;if(i=void 0,void 0===e||null!=e&&e.type&&e.target||t||(t=e),t=void 0===t?(i=$(e.target)).is(".label")?i.parent():i:"number"==typeof t?s.ticks.eq(t):t,e&&(t.is("[disabled], .is-disabled")||!t.is("a")))return e.preventDefault(),e.stopPropagation(),this;if(!1===this.element.triggerHandler("beforeactivate",[t]))return this;var n=this.ticks.index(t);return this.ticks.removeClass("complete current").eq(n).addClass("current").prevAll(".tick").addClass("complete"),this.updateRange(),this.element.trigger("activated",[t]),setTimeout(function(){s.element.trigger("afteractivated",[t])},300),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"wizard")},handleEvents:function(){var e=this;return this.element.on("updated",function(){e.updated()}),this.ticks.on("click.wizard",function(t){e.activate(t,$(this))}),this}},$.fn.wizard=function(e){return this.each(function(){var t=$.data(this,"wizard");t?t.updated(e):t=$.data(this,"wizard",new bs(this,e))})};var ws={Text:function(e,t,i){return null==i||""===i?"":i.toString()},Input:function(e,t,i,s){return s.inlineEditor?'<label for="datagrid-inline-input-'+e+"-"+t+'" class="audible">'+s.name+'</label><input id="datagrid-inline-input-'+e+"-"+t+'" class="'+("right"===s.align?"is-number-mask":"")+'" value="'+i+'">':null==i||""===i?"":i.toString()},Placeholder:function(e,t,i,s,n){var a=ys(i,e,t,i,s,n);return""!==a?'<span class="is-placeholder">'+a+"</span>":null==i||""===i?"":i.toString()},Ellipsis:function(e,t,i,s){var n=null==i||""===i?"":i.toString();return s.textOverflow="ellipsis",n},Password:function(e,t,i){return(null==i||""===i?"":i.toString()).replace(/./g,"*")},Readonly:function(e,t,i){return'<span class="is-readonly">'+(null==i?"":i)+"</span>"},Date:function(e,t,i,s,n){var a=null==i?"":i,r=void 0;return"string"==typeof i&&i?(r=s.sourceFormat?k.parseDate(i,"string"==typeof s.sourceFormat?{pattern:s.sourceFormat}:s.sourceFormat):k.parseDate(i,"string"==typeof s.dateFormat?{pattern:s.dateFormat}:s.dateFormat))?a=k.formatDate(r,"string"==typeof s.dateFormat?{pattern:s.dateFormat}:s.dateFormat):"NaN/NaN/NaN"!==(a=k.formatDate(i,"string"==typeof s.dateFormat?{pattern:s.dateFormat}:s.dateFormat))&&a||""===a||(a=i):i&&(a=k.formatDate(i,"string"==typeof s.dateFormat?{pattern:s.dateFormat}:s.dateFormat)),s.editor&&!0!==n?'<span class="trigger">'+a+"</span>"+$.createIcon({icon:"calendar",classes:["icon-calendar"]}):a},Time:function(e,t,i,s,n){var a=null==i?"":i,r="object"===(void 0===k?"undefined":u(k))&&k.calendar().dateFormat?k.calendar().dateFormat.short:null,o="object"===(void 0===k?"undefined":u(k))&&k.calendar().timeFormat?k.calendar().timeFormat:null,l=void 0;return"string"==typeof i&&i?(l=k.formatDate(function(e){if(""===e)return null;var t=e.match(/(\d+)(?::(\d\d))(?::(\d\d))?\s*([pP]?)/i);if(null===t)return null;var i=new Date;return i.setHours(parseInt(t[1],10)+(t[4]?12:0)),i.setMinutes(parseInt(t[2],10)||0),i.setSeconds(parseInt(t[3],10)||0),i}(i),{pattern:r+" "+(s.sourceFormat||s.timeFormat||o)}))&&(a=l.slice(l.indexOf(" "))):i&&(l=k.formatDate(i,{pattern:r+" "+(s.sourceFormat||s.timeFormat||o)}))&&(a=l.slice(l.indexOf(" "))),a=a.replace(/^\s/,""),s.editor&&!0!==n?'<span class="trigger">'+a+"</span>"+$.createIcon({icon:"clock",classes:["icon-clock"]}):a},Autocomplete:function(e,t,i){return null==i?"":i},Lookup:function(e,t,i,s,n){var a=null==i?"":i,r=!1,o=ys(a,e,t,i,s,n);return""!==o&&(r=!0),s.editor?(s.editorOptions&&"function"==typeof s.editorOptions.field&&(a=s.editorOptions.field(n,null,null),r=!1),null!=a&&""!==a||(a="",o&&(r=!0,a=o)),'<span class="trigger '+(r?"is-placeholder":"")+("right"===s.align?"align-text-right":"")+'">'+a+"</span>"+$.createIcon({icon:"search-list",classes:["icon-search-list"]})):r?'<span class="is-placeholder">'+o+"</span>":a},Decimal:function(e,t,i,s,n){var a=i;void 0!==k&&null!=a&&""!==a&&(a=k.formatNumber(i,s.numberFormat));var r=ys(a=null==a||"NaN"===a?"":a,e,t,i,s,n);return""!==r?'<span class="is-placeholder">'+r+"</span>":a},Integer:function(e,t,i,s){var n=i;return void 0!==k&&null!=n&&""!==n&&(n=k.formatNumber(i,s.numberFormat||{style:"integer"})),null==n||"NaN"===n?"":n},Hyperlink:function(e,t,i,s,n,a){var r=s.href||"#";if(s.href&&"function"==typeof s.href){if(null==(r=s.href(e,t,n,s)))return s.text||i}else r=r.replace("{{value}}",i);var o=s.text||i;return o||s.icon?s.icon?'<a href="'+r+'" class="btn-icon row-btn '+(s.cssClass||"")+'" '+(a.settings.rowNavigation?'tabindex="-1"':"")+(s.hyperlinkTooltip?' title="'+s.hyperlinkTooltip+'"':"")+">\n          "+$.createIcon({icon:s.icon,file:s.iconFile})+'\n          <span class="audible">'+o+"</span>\n        </a>":'<a href="'+r+'" '+(a.settings.rowNavigation?'tabindex="-1"':"")+' role="presentation" class="hyperlink '+(s.cssClass||"")+'"'+(s.target?' target="'+s.target+'"':"")+(s.hyperlinkTooltip?' title="'+s.hyperlinkTooltip+'"':"")+">"+o+"</a>":""},Template:function(e,t,i,s,n){var a=s.template,r="";return We&&n&&a&&(r=We.compile("{{#dataset}}"+a+"{{/dataset}}",{dataset:n})),r},Drilldown:function(){var e=k.translate("Drilldown");return void 0===e&&(e=""),'<button type="button" tabindex="-1" class="btn-icon small datagrid-drilldown">\n         '+$.createIcon({icon:"drilldown"})+"\n        <span>"+e+"</span>\n      </button>"},RowReorder:function(){var e=k.translate("ReorderRows");return void 0===e&&(e="Reorder Rows"),'<div class="datagrid-reorder-icon">\n         '+$.createIcon({icon:"drag"})+'\n        <span class="audible">'+e+"</span>\n      </div>"},Checkbox:function(e,t,i,s,n,a){var r=void 0;r=s.isChecked?s.isChecked(i):void 0!==i&&(!0===i||1===parseInt(i,10));var o='<span class="hidden" aria-hidden="true" role="presentation"> '+k.translate(r?"Yes":"No")+"</span>",l=a.wasJustUpdated;return a.wasJustUpdated=!1,'<div class="datagrid-checkbox-wrapper"><span role="checkbox" aria-label="'+s.name+'" class="datagrid-checkbox\n     '+(r?"is-checked "+(l?" ":" no-animation"):"")+'" aria-checked="'+r+'"></span>'+o+"</div>"},SelectionCheckbox:function(e,t,i,n,a,r){var o=void 0!==i&&!0===i;i||(o=r.isRowSelected(a));var l=" ";if(r.settings.columnIds.length>0)for(var d=0;d<r.settings.columnIds.length;d++)l+=a[r.settings.columnIds[d]];return l=s.ensureAlphaNumericWithSpaces(l),'<div class="datagrid-checkbox-wrapper"><span role="checkbox" aria-label="'+(n.name?n.name:k.translate("Select")+l)+'" class="datagrid-checkbox datagrid-selection-checkbox'+(o?" is-checked no-animate":"")+'" aria-checked="'+o+'"></span></div>'},Actions:function(e,t,i,s){return'<button type="button" class="btn-actions" aria-haspopup="true" aria-expanded="false" aria-owns="'+s.menuId+'">\n        <span class="audible">'+(s.title||k.translate("More"))+"</span>\n        "+$.createIcon({icon:"more"})+"\n      </button>"},Textarea:function(e,t,i){return'<span class="datagrid-multiline-text">'+(null==i?"":i)+"</span>"},Editor:function(e,t,i,n){var a=null==i?"":i,r="is-editor";return r+=n.singleline?" is-singleline":" datagrid-multiline-text",'<div class="'+(r+=n.contentTooltip?" content-tooltip":"")+'">'+s.unescapeHTML(a)+"</div>"},Expander:function(e,t,i){return'<button type="button" aria-label="'+k.translate("ExpandCollapse")+'" class="btn-icon datagrid-expand-btn" tabindex="-1">\n      <span class="icon plus-minus"></span>\n      </button>'+(i?"<span> "+i+"</span>":"")},GroupRow:function(e,t,i,s,n,a){var r=a.settings.groupable,o={left:"",center:"",right:""},l="",d=void 0===r.expanded||r.expanded;r.expanded&&"function"==typeof r.expanded&&(d=r.expanded(e,t,i,s,n,a));for(var c=0;c<r.fields.length;c++)l+=n[r.fields[c]]+(0===c?"":",");r.groupRowFormatter&&(l=r.groupRowFormatter(e,t,i,s,n,a));var h='<button type="button" class="btn-icon datagrid-expand-btn'+(d?" is-expanded":"")+'" tabindex="-1">\n    <span class="icon plus-minus'+(d?" active":"")+'"></span>\n    <span class="audible">'+k.translate("ExpandCollapse")+"</span>\n    </button><span> "+l+"</span>";return o[a.getContainer(r.fields?r.fields[0]:"")]=h,o},GroupFooterRow:function(e,t,i,s,n,a){var r=a.settings.groupable,o={left:"",center:"",right:""},l=a.settings.frozenColumns.left.length,d=a.settings.frozenColumns.right.length,c=a.columnIdxById(r.aggregate),h=a.getContainer(r.aggregate);return o.left='<td role="gridcell" colspan="'+l+'"><div class="datagrid-cell-wrapper"></div></td><td role="gridcell"><div class="datagrid-cell-wrapper">'+("left"===h?n.sum:"<span>&nbsp;</span>")+"</div></td>",o.center='<td role="gridcell" colspan="'+(c-l-d)+'"><div class="datagrid-cell-wrapper"></div></td><td role="gridcell"><div class="datagrid-cell-wrapper">'+("center"===h?n.sum:"<span>&nbsp;</span>")+"</div></td>",o.right='<td role="gridcell" colspan="'+d+'"><div class="datagrid-cell-wrapper"></div></td><td role="gridcell"><div class="datagrid-cell-wrapper">'+("right"===h?n.sum:"<span>&nbsp;</span>")+"</div></td>",r.groupFooterRowFormatter&&(o[h]=r.groupFooterRowFormatter(c,e,t,i,s,n,a)),o},SummaryRow:function(e,t,i,s){var n="",a=s.summaryText||"";return"after"===s.summaryTextPlacement&&(n=a,a=""),void 0!==k&&s.numberFormat&&null!=i&&""!==i&&(i=k.formatNumber(+i,s.numberFormat)),a+(null==i||""===i?"":i.toString())+n},Tree:function(e,t,i,s,n,a){var r=!n||n.expanded,o=a&&a.settings.treeDepth&&a.settings.treeDepth[e]?a.settings.treeDepth[e].depth:0,l=n&&n.isAllChildrenFiltered,d=l?" disabled":"";r&&l&&(r=!1),n&&void 0!==n.isAllChildrenFiltered&&delete n.isAllChildrenFiltered;var c='<button type="button" class="btn-icon datagrid-expand-btn'+(r?" is-expanded":"")+'" tabindex="-1"'+(o?' style="margin-left: '+(o?30*(o-1)+"px":"")+'"':"")+d+'>\n      <span class="icon plus-minus '+(r?" active":"")+'"></span>\n      <span class="audible">'+k.translate("ExpandCollapse")+"</span>\n      </button>"+(i?" <span>"+i+"</span>":""),h=' <span class="datagrid-tree-node"'+(o?' style="margin-left: '+(o?30*o+"px":"")+'"':"")+">"+i+"</span>";return n&&n[s.children?s.children:"children"]?c:h},ClassRange:function(e,t,i,s){var n=s.ranges,a="",r="";if(!n)return{};for(var o=0;o<n.length;o++)i>=n[o].min&&i<=n[o].max&&(a=n[o].classes,r=n[o].text?n[o].text:a.split(" ")[0]),i===n[o].value&&(a=n[o].classes,r=n[o].text?n[o].text:i);return{classes:a,text:r}},Badge:function(e,t,i,s){var n=s.color,a=s.name;if(s.ranges){var r=ws.ClassRange(e,t,i,s);n=r.classes,a=r.text}return'<span class="badge '+n+'">'+i+' <span class="audible">'+a+"</span></span>"},Tag:function(e,t,i,s){return'<span class="tag '+ws.ClassRange(e,t,i,s).classes+'">'+i+"</span>"},Alert:function(e,t,i,s){var n=ws.ClassRange(e,t,i,s);return $.createIcon({icon:n.classes,classes:["icon","datagrid-alert-icon","icon-"+n.classes]})+'<span class="datagrid-alert-text">'+("value"===n.text?i:n.text)+"</span>"},Image:function(e,t,i,s){return'<img class="datagrid-img" src="'+i+'" alt="'+(s.alt?s.alt:k.translate("Image"))+'"'+(s.dimensions?' style="height:'+s.dimensions.height+";width:"+s.dimensions.height+'"':"")+"/>"},Color:function(e,t,i,s){var n=ws.ClassRange(e,t,i,s),a=null==i||""===i?"":i.toString();return'<span class="'+n.classes+'">'+a+"</span>"},Colorpicker:function(e,t,i,s){var n=null==i||""===i?"":i.toString();return s.inlineEditor?n:(n='<span class="colorpicker-container trigger dropdown-trigger"><span class="'+("swatch"+(""===i?" is-empty":""))+'" style="background-color: '+i+'"></span><input class="colorpicker" id="colorpicker-'+t+'" name="colorpicker-'+t+'" type="text" role="combobox" aria-autocomplete="list" value="'+i+'" aria-describedby="">',n+='<span class="trigger">'+$.createIcon({icon:"dropdown"})+"</span></span>")},Button:function(e,t,i,s,n,a){var r=void 0;r=s.text?s.text:null==i||""===i?"":i.toString();var o='<button type="button" class="'+(s.icon?"btn-icon":"btn-secondary")+" row-btn "+(s.cssClass?s.cssClass:"")+'"'+(a.settings.rowNavigation?' tabindex="-1"':"")+" >";return s.icon&&(o+=$.createIcon({icon:s.icon,file:s.iconFile})),o+="<span>"+r+"</span></button>"},Dropdown:function(e,t,i,s,n){var a=i,r=void 0,o=void 0,l=!1;if(s.options&&void 0!==i){r=s.caseInsensitive&&"string"==typeof i?i.toLowerCase():i;for(var d=0,c=s.options.length;d<c;d++)if(o=s.options[d],(s.caseInsensitive&&"string"==typeof o.value?o.value.toLowerCase():o.value)===r){a=o.label;break}}var h=ys(a,e,t,i,s,n);""!==h&&(l=!0,a=h);var u='<span class="trigger dropdown-trigger '+(l?"is-placeholder":"")+'">'+a+"</span>"+$.createIcon({icon:"dropdown"});if(s.inlineEditor){u='<label for="full-dropdown" class="audible">'+s.name+'</label><select id="datagrid-dropdown'+e+'" class="dropdown">';for(var p=0,g=s.options.length;p<g;p++){var f=s.options[p],m=void 0;m=void 0!==f.label?f.label:void 0!==f.value?f.value:"",u+="<option"+(void 0===f.id?"":' id="'+f.id+'"')+'  value="'+f.value+'"'+(f.selected||f.value===r?" selected ":"")+">"+m+"</option>"}u+='</select>\n      <div class="dropdown-wrapper is-inline">\n        <div class="dropdown"><span>'+a+'</span></div>\n        <svg class="icon" focusable="false" aria-hidden="true" role="presentation">\n          <use xlink:href="#icon-dropdown"></use>\n        </svg>\n      </div>'}return u},Fileupload:function(e,t,i,s){var n=null==i||""===i?"":i.toString();return s.inlineEditor||(n=""===$.trim(n)?'<span class="trigger">'+n+"</span>"+$.createIcon({icon:"folder",classes:["icon-fileupload"]}):'<span class="trigger is-clearable">'+n+"</span>"+$.createIcon({icon:"close",classes:["icon-close"]})+$.createIcon({icon:"folder",classes:["icon-fileupload"]})),n},Spinbox:function(e,t,i,s){var n=null==i||""===i?"":i.toString();return s.inlineEditor&&(n='<label for="spinbox-'+t+'" class="audible">Quantity</label>\n        <span class="spinbox-wrapper"><span class="spinbox-control down">-</span>\n        <input id="spinbox-'+t+'" name="spinbox-'+t+'" type="text" class="spinbox" value="'+i+'">\n        <span class="spinbox-control up">+</span></span>'),n},Favorite:function(e,t,i,s,n,a){var r=void 0;r=s.isChecked?s.isChecked(i):void 0!==i&&!0===i;var o=s.editor&&a.settings.editable;return r?'<span aria-label="'+k.translate("Favorite")+'" class="icon-favorite'+(o?" is-editable":"")+'">'+$.createIcon({icon:"star-filled"})+"</span>":s.showEmpty?'<span aria-label="'+k.translate("Favorite")+'" class="icon-favorite'+(o?" is-editable":"")+'">'+$.createIcon({icon:"star-outlined"})+"</span>":""},Status:function(e,t,i,s,n){return n&&n.rowStatus?$.createIcon({icon:n.rowStatus.icon,classes:["icon","icon-"+n.rowStatus.icon]})+'<span class="audible">'+n.rowStatus.text+"</span>":"<span></span>"},TargetedAchievement:function(e,t,i,s){var n=100*i,a=n+"%",r=ws.ClassRange(e,t,n,s),o=s.target,l=n>60;return s.text&&(a=(a=(a=(a=(a=(a=(a=s.text).replace("{{value}}",i)).replace("<% value %>",i)).replace("<%value%>",i)).replace("{{percent}}",n)).replace("<% percent %>",n)).replace("<%percent%>",n),s.showPercentText=!0,l=n>75),'<div class="total bar chart-completion-target chart-targeted-achievement">\n              <div class="target remaining bar" style="width: '+(o||0)+'%;"></div>\n              <div class="completed bar '+(s.ranges&&r.classes?r.classes:"primary")+'" style="width: '+n+'%;"></div>\n              '+(s.showPercentText?'<div class="chart-targeted-text l-center" '+(l?'style="color: white"':"")+">"+a+"</div>\n            </div>":'<div class="audible">'+n+"%</div>")}};function xs(e,t,i,s,n,a,r,o,l){if(a.align&&e.addClass("l-"+a.align+"-text"),a.maxLength&&e.attr("maxlength",a.maxLength),a.uppercase&&e.addClass("uppercase-text"),a.mask&&"function"==typeof a.mask){var d=a.mask(t,i,s,a,l);e.mask({pattern:d,mode:a.maskMode})}else if(a.maskOptions&&"function"==typeof a.maskOptions){var c=a.maskOptions(t,i,s,a,l);e.mask(c)}else a.mask&&e.mask({pattern:a.mask,mode:a.maskMode});var h={patternOptions:{allowNegative:!0,allowDecimal:!0,integerLimit:4,decimalLimit:2,symbols:{thousands:k.currentLocale.data.numbers?k.currentLocale.data.numbers.group:",",decimal:k.currentLocale.data.numbers?k.currentLocale.data.numbers.decimal:".",negative:k.currentLocale.data.numbers?k.currentLocale.data.numbers.minusSign:"-"}},process:"number"},u=!1;a.maskOptions&&(u=!0),a.numberFormat&&(u=!0,h={patternOptions:{decimalLimit:a.numberFormat.maximumFractionDigits}}),a.maskOptions&&"function"==typeof a.maskOptions&&(u=!1),u&&(a.maskOptions=m.extend(!0,{},h,a.maskOptions),e.mask(a.maskOptions)),a.align&&"right"===a.align||e.removeClass("is-number-mask")}var Cs={Input:function(e,t,i,s,n,a,r,o){this.name="input",this.originalValue=i,this.useValue=!!n.inlineEditor,this.init=function(){n.inlineEditor?this.input=s.find("input"):this.input=$('<input type="'+(n.inputType||"text")+'" autocomplete="off"/>').appendTo(s),xs(this.input,e,t,i,0,n,0,0,o)},this.val=function(e){var t=void 0;return e&&this.input.val(e),n&&n.numberFormat&&"percent"===n.numberFormat.style?(t=this.input.val().trim().replace(/(\s%?|%)$/g,""),k.parseNumber(t)/100):this.input.val()},this.focus=function(){this.input.focus().select()},this.destroy=function(){var e=this;n.inlineEditor||setTimeout(function(){e.input.remove()},0)},this.init()},Textarea:function(e,t,i,s,n){this.name="textarea",this.originalValue=i,this.init=function(){this.input=$('<textarea class="textarea"></textarea>').appendTo(s),n.maxLength&&this.input.attr("maxlength",n.maxLength),n.uppercase&&this.input.addClass("uppercase-text")},this.val=function(e){return e&&this.input.focus().val(e),this.input.val()},this.focus=function(){this.input.focus()},this.destroy=function(){var e=this;setTimeout(function(){e.input.remove()},0)},this.init()},Editor:function(e,t,i,n,a,r,o){this.name="editor",this.originalValue=i,this.init=function(){var e=this,t=$.extend({},{buttons:{editor:["bold","italic","underline","strikethrough","separator","foreColor"],source:[]},excludeButtons:{editor:[]}},a.editorOptions);this.editorWidth=o.setUnit(t.width||n.outerWidth()),delete t.width,n[0].innerHTML='<div class="editor-wrapper" style="width: '+this.editorWidth+';">\n          <div class="editor" data-init="false">'+s.unescapeHTML(i)+"</div>\n        </div>",this.td=n.closest("td"),this.input=$(".editor",n),this.input.popover({content:$(".editor-wrapper",n),placementOpts:{x:0,y:"-"+(parseInt(n[0].style.height,10)+35),parent:this.td,parentXAlignment:k.isRTL()?"right":"left",strategies:["flip","nudge","shrink"]},placement:"bottom",popover:!0,trigger:"immediate",tooltipElement:"#editor-popup",extraClass:"editor-popup"}).editor(t).on("hide.editor",function(){o.commitCellEdit(e.input)}).on("keydown.editor",function(t){var i=t.which||t.keyCode||t.charCode||0;if((t.ctrlKey||t.metaKey)&&(13===i||10===i)){var s=e.input.data("tooltip");s&&(s.hide(),o.setNextActiveCell(t))}}),m.fixSVGIcons($("#editor-popup"))},this.val=function(){return this.input.html()},this.focus=function(){var e=this;setTimeout(function(){e.input.focus()},0)},this.destroy=function(){var e=this;n.removeAttr("style"),o.quickEditMode=!1,e.input.off("hide.editor keydown.editor"),setTimeout(function(){e.input.remove()},0)},this.init()},Checkbox:function(e,t,i,s,n,a,r){this.name="checkbox",this.originalValue=i,this.useValue=!0,this.container=s,this.init=function(){this.input=$('<input type="checkbox" class="checkbox"/>').appendTo(s),this.input.after('<label class="checkbox-label"></label>'),n.align&&this.input.addClass("l-"+n.align+"-text")},this.val=function(e){var t=void 0;if(void 0===e)return this.input.prop("checked");t=n.isChecked?n.isChecked(e):e,"click"!==a.type&&("keydown"!==a.type||32!==a.keyCode)||$(a.target).is(".datagrid-checkbox-wrapper, .datagrid-cell-wrapper")||(t=!t,r.setNextActiveCell(a)),this.input.prop("checked",t)},this.focus=function(){this.input.trigger("focusout"),this.container.parent().focus()},this.destroy=function(){var e=this;setTimeout(function(){e.input.next(".checkbox-label").remove(),e.input.remove()},0)},this.init()},Colorpicker:function(e,t,i,n,a,r,o){this.name="colorpicker",this.originalValue=i,this.useValue=!0,i=s.stripTags(i),this.init=function(){this.input=$('<input id="colorpicker-'+t+'" name="colorpicker-'+t+'" class="colorpicker" value="'+i+'" type="text" autocomplete="off"/>').appendTo(n),this.input.colorpicker(a.editorOptions)},this.val=function(e){return e?this.input.val(e):this.input.val()},this.focus=function(){var t=this;this.input.trigger("openlist"),o.rowNodes(e).removeClass("is-hover-row"),this.input.focus().select(),this.input.off("listclosed").on("listclosed",function(){o.commitCellEdit(t.input),n.parent("td").focus()})},this.destroy=function(){},this.init()},Dropdown:function(e,t,i,s,n,a,r,o){this.name="dropdown",this.originalValue=i,this.useValue=!0,this.cell=r.activeCell,this.init=function(){var l=this;if(n.inlineEditor)this.input=s.find("select");else{if(this.input=$('<select class="dropdown"></select>').appendTo(s),n.options){var d=void 0,c=void 0,h=void 0;i=r.fieldValue(o,n.field);for(var p=n.caseInsensitive&&"string"==typeof i?i.toLowerCase():i,g=0;g<n.options.length;g++)d=$("<option></option>"),c=n.options[g],h=n.caseInsensitive&&"string"==typeof c.value?c.value.toLowerCase():c.value,(c.selected||p===h)&&(d.attr("selected","true"),this.originalValue=h),d.attr("value",c.value).attr("id",c.id).attr("data-type",u(c.value)),d.text(c.label),this.input.append(d)}var f=n.editorOptions||{};f.cssClass&&/is-editing/g.test(f.cssClass)||(f.cssClass=f.cssClass||"",f.cssClass+=" is-editing"),this.input.dropdown(f),this.input.on("requestend",function(){l.val(l.datasetValue)}),this.input.data("dropdown").settings.sourceArguments={column:n,container:s,grid:r,cell:t,event:a,row:e,rowData:o,value:i}}},this.val=function(e){if(this.datasetValue=e,void 0!==e){var t=n.caseInsensitive&&"string"==typeof e?e.toLowerCase():e;this.input.val(e),this.input.find("option").each(function(){var e=$(this),i=e.attr("value"),s=e.attr("data-type"),a=i;"number"===s?a=parseFloat(i):"boolean"===s?a="true"===i:"string"===s&&n.caseInsensitive&&(a=i.toLowerCase()),a===t&&e.attr("selected","true")})}var i=this.input.find(":selected"),s=i.attr("value"),a=i.attr("data-type");return"number"===a?s=parseFloat(s):"boolean"===a&&(s="true"===s),void 0===s&&(s=i.text()),s},this.focus=function(){var t=this;"click"===a.type?(this.input.trigger("openlist"),r.rowNodes(e).removeClass("is-hover-row"),$("#dropdown-list input").focus()):this.input[0].parentNode.querySelector("div.dropdown").focus();this.input.off("listclosed").on("listclosed",function(e,i){r.commitCellEdit(t.input),"select"!==i?"tab"===i&&setTimeout(function(){s.parent("td").focus()},100):s.parent("td").focus()})},this.destroy=function(){},this.init()},Date:function(e,t,i,s,n,a,r){this.name="date",this.originalValue=i,this.init=function(){this.input=$('<input class="datepicker" autocomplete="off"/>').appendTo(s),this.input.datepicker(n.editorOptions||{dateFormat:n.dateFormat})},this.val=function(i){return"0000"!==i&&"000000"!==i&&"00000000"!==i||(i=""),i&&this.input.val(i),ws.Date(e,t,this.input.val(),n,!0)},this.focus=function(){var e=this;this.input.select().focus(),"click"===a.type&&$(a.target).is(".icon")&&(this.input.parent().find(".icon").trigger("click"),this.input.closest("td").addClass("is-focused")),this.input.on("listclosed",function(){e.input.closest("td").removeClass("is-focused"),setTimeout(function(){e.input.trigger("focusout"),s.parent().focus(),r.setNextActiveCell(a)},1)})},this.destroy=function(){var e=this;setTimeout(function(){r.quickEditMode=!1,e.input.remove()},0)},this.init()},Fileupload:function(e,t,i,n,a,r,o){var l=this,d=m.mergeSettings(void 0,a.editorOptions,{allowedTypes:"*"}),c=d.allowedTypes.split(/[\s|]+/g),h=m.uniqueId(this,"fileupload-"+e+"-"+t+"-"),u=d.useMultiple?" multiple":"",p=d.isDisabled?" disabled":"",g="";if(1===c.length)"*"!==c[0]&&(g="."+s.ensureAlphaNumeric(c[0]));else for(var f=0,v=c.length;f<v;f++)g+="."+s.ensureAlphaNumeric(c[f])+(f!==v-1?",":"");""!==g&&(g=' accept="'+g+'"'),this.name="fileupload",this.originalValue=i,this.status="init",this.useValue=!0,this.init=function(){h=s.ensureAlphaNumeric(h),u=s.ensureAlphaNumeric(u),p=s.ensureAlphaNumeric(p),this.input=$('<input id="'+h+'" name="'+h+'" class="fileupload" type="file" '+g+u+p+' autocomplete="off"/>'),n.append("<label>"+this.input[0].outerHTML+"</label>"),this.api=this.input.fileupload(a.editorOptions).data("fileupload"),this.input.closest("td").addClass("is-fileupload").find("label:eq(1)").addClass("audible")},this.val=function(e){return e?(e=s.stripTags(e),this.input.attr("value",e),e):this.input.val()},this.focus=function(){var e=function(){""!==l.originalValue&&(l.status="clear"),o.commitCellEdit(l.input)},t=function(){l.api&&($("body").one("focusin.fileuploadeditor",function(){setTimeout(function(){"change"!==l.status&&(l.status="cancel",o.commitCellEdit(l.input))},100)}),l.api.fileInput.trigger("click"))};if(l.input.on("change.fileuploadeditor",function(){l.status="change",o.commitCellEdit(l.input)}),"keydown"===r.type){var i=r.which||r.keyCode||r.charCode||0;8===i||46===i?e():13===i||10===i?t():o.commitCellEdit(l.input)}if("click"===r.type){var s=$(r.target);s.is(".icon-close")?e():s.is(".icon-fileupload")?t():o.commitCellEdit(l.input)}},this.destroy=function(){l.input.off("change.fileuploadeditor"),o.quickEditMode=!1,l.api&&l.api.destroy()},this.init()},Time:function(e,t,i,s,n,a,r){this.name="time",this.originalValue=i,this.init=function(){this.input=$('<input class="timepicker" autocomplete="off" />').appendTo(s),this.api=this.input.timepicker(n.editorOptions||"").data("timepicker")},this.val=function(e){return e&&this.input.val(e),this.input.val()},this.focus=function(){var e=this;this.input.select().focus(),"click"===a.type&&$(a.target).is(".icon")&&(this.input.parent().find(".icon").trigger("click"),this.input.closest("td").addClass("is-focused")),this.api.trigger.on("hide.editortime",function(){e.input.closest("td").removeClass("is-focused"),setTimeout(function(){e.input.trigger("focusout"),s.parent().focus(),r.setNextActiveCell(a)},1)})},this.destroy=function(){var e=this;e.api&&e.api.trigger&&e.api.trigger.off("hide.editortime"),setTimeout(function(){r.quickEditMode=!1,e.input.remove()},0)},this.init()},Lookup:function(e,t,i,s,n,a,r,o){this.name="lookup",this.originalValue=i,this.init=function(){this.input=$('<input class="lookup '+("right"===n.align?"align-text-right":"")+'" data-init="false" autocomplete="off" />').appendTo(s),xs(this.input,e,t,i,0,n,0,0,o),this.input.lookup(n.editorOptions),this.input.data("lookup").settings.clickArguments={column:n,container:s,grid:r,cell:t,event:a,row:e,rowData:o,value:i}},this.val=function(e){var t=this.input.val();return t&&t.indexOf("|")>-1&&(t=t.substr(0,t.indexOf("|"))),e?this.input.val(e):t},this.focus=function(){var e=this.input.data("lookup"),t=this.input.closest("td");"keydown"===a.type&&(this.input.select().focus(),t.on("keydown.editorlookup",function(e){40===e.keyCode&&(e.preventDefault(),e.stopPropagation())})),"click"===a.type&&($(a.target).is("svg")?e.openDialog(a):(this.input.select().focus(),t.on("touchcancel.editorlookup touchend.editorlookup",".trigger",function(){e.openDialog()}))),this.input.on("change.editorlookup",function(){r.quickEditMode=!1})},this.destroy=function(){var e=this,t=this.input.closest("td");setTimeout(function(){r.quickEditMode=!1,t.off("keydown.editorlookup").find(".trigger").off("touchcancel.editorlookup touchend.editorlookup"),e.input.remove()},0)},this.init()},Autocomplete:function(e,t,i,s,n,a,r){this.name="autocomplete",this.originalValue=i,this.init=function(){this.input=$('<input class="autocomplete datagrid-autocomplete" autocomplete="off" />').appendTo(s),n.editorOptions||(n.editorOptions={}),n.editorOptions.width=s.parent().width(),n.editorOptions.offset={left:-1,top:"medium"===r.settings.rowHeight?1:5},n.maxLength&&this.input.attr("maxlength",n.maxLength),n.uppercase&&this.input.addClass("uppercase-text"),this.input.autocomplete(n.editorOptions)},this.val=function(e){return e?this.input.val(e):this.input.val()},this.focus=function(){r.quickEditMode=!0,this.input.select().focus()},this.destroy=function(){var e=this;setTimeout(function(){r.quickEditMode=!1,e.input.remove()},0)},this.init()},Spinbox:function(e,t,i,s,a,r,o){this.name="spinbox",this.originalValue=i,this.useValue=!0,this.init=function(){if(a.inlineEditor)this.input=s.find("input");else{var e='<label for="spinbox-'+t+'" class="audible">Quantity</label>\n        <span class="spinbox-wrapper"><span class="spinbox-control down">-</span>\n        <input id="spinbox-'+t+'" name="spinbox-'+t+'" type="text" class="spinbox" value="\'+ '+i+' +\'" autocomplete="off" />\n        <span class="spinbox-control up">+</span></span>';n.append(s,e,"<label><span><input>"),this.input=s.find("input"),a.editorOptions||(a.editorOptions={}),this.input.spinbox(a.editorOptions)}},this.val=function(e){return e&&this.input.val(e),parseInt(this.input.val(),10)},this.focus=function(){o.quickEditMode=!0,this.input.select().focus()},this.destroy=function(){var e=this;a.inlineEditor||setTimeout(function(){o.quickEditMode=!1;var t=e.val();e.input&&e.input.data("spinbox")&&e.input.data("spinbox").destroy(),e.input&&e.input.remove(),s.text(t)},0)},this.init()},Favorite:function(e,t,i,s,n,a,r){this.name="favorite",this.useValue=!0,this.originalValue=i,this.init=function(){this.input=$('<span class="icon-favorite">'+$.createIcon({icon:i?"star-filled":"star-outlined"})+'<input type="checkbox"></span>').appendTo(s),this.input=this.input.find("input")},this.val=function(e){var t=void 0;if(void 0===e)return this.input.prop("checked");t=n.isChecked?n.isChecked(e):e,"click"!==a.type&&("keydown"!==a.type||32!==a.keyCode)||$(a.target).is(".datagrid-cell-wrapper")||(t=!t,r.setNextActiveCell(a)),this.input.prop("checked",t),this.input.find("use").attr("xlink:href",t?"#icon-star-filled":"#icon-star-outlined")},this.focus=function(){this.input.trigger("focusout").focus()},this.destroy=function(){var e=this;setTimeout(function(){e.input.parent().remove()},0)},this.init()}},ks={cleanExtra:function(e,t){var i=[];if(i=!t&&e?ks.datasetToHtml(e):ks.appendRows(t.settings.dataset,t.table[0].cloneNode(!0),t),!e&&!i[0].querySelector("thead")){for(var s=i[0].querySelector("tbody"),n=i[0].createTHead(),a=n.insertRow(0),r=t.headerNodes(),o=0;o<r.length;o++){var l=r[o],d=a.insertCell(o);d.innerHTML=l.querySelector(".datagrid-header-text").textContent.trim(),d.setAttribute("class",l.classList),d.setAttribute("id",l.getAttribute("id")),l.getAttribute("data-exportable")&&d.setAttribute("data-exportable",l.getAttribute("data-exportable"))}s.parentNode.insertBefore(n,s)}(i=function(e){var t=function(e){e.parentNode&&e.parentNode.removeChild(e)},i=[];return[].slice.call(e[0].querySelectorAll("tr")).forEach(function(e){e.classList.contains("is-hidden")||e.classList.contains("datagrid-expandable-row")?t(e):[].slice.call(e.querySelectorAll("th, td, div, span")).forEach(function(e){if(e.classList.contains("is-hidden"))t(e);else{var s=e.getAttribute("data-exportable");if(s&&"no"===s){var n=parseInt(e.id.slice(-1),10);return i.push(n+1),void t(e)}var a=e.getAttribute("aria-colindex");if("td"===e.tagName.toLowerCase()&&a&&-1!==i.indexOf(parseInt(a,10)))t(e);else{for([].slice.call(e.querySelectorAll(".is-hidden, .datagrid-expand-btn, .is-draggable-target, .handle, .sort-indicator, .datagrid-filter-wrapper")).forEach(function(e){return t(e)});e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);var r=e.textContent;"="===r.substr(0,1)&&""!==r.substr(1,1)&&(e.textContent="'"+r+"'")}}})}),e}(i),t&&t.settings.exportConvertNegative)&&[].slice.call(i[0].querySelectorAll("td")).forEach(function(e){e.textContent=e.textContent.replace(/^(.+)(-$)/,"$2$1")});return i},save:function(e,t){var i=(t.match(/\.([^.]*?)(?=\?|#|$)/)||[])[1],s="string"==typeof i&&/\b(xlsx|xls)\b/g.test(i);if("ie"===l.browser.name||"edge"===l.browser.name){if(window.navigator.msSaveBlob){var n=new Blob([e],{type:"application/csv;charset=utf-8;"});navigator.msSaveBlob(n,t)}}else if(window.URL.createObjectURL){var a=new Blob([e],{type:"application/"+(s?"vnd.ms-excel":"csv")+";charset=utf-8;"}),r=URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}else{var d=document.createElement("a");d.href=this.base64(e),d.download=t,document.body.appendChild(d),d.click(),document.body.removeChild(d)}},datasetToHtml:function(e){for(var t="<tbody>",i=function(i,s){t+="<tr>",Object.keys(e[i]).forEach(function(s,n){e[i]&&Object.prototype.hasOwnProperty.call(e[i],s)&&(t+="<td>"+e[i][s]+"</td>")}),t+="</tr>"},s=0,n=e.length;s<n;s++)i(s);return t+="</tbody>",$("<table></table>").append(t)}};ks.appendRows=function(e,t,i){var s,n=(s=t)&&(s instanceof jQuery||s.constructor.prototype.jquery)?t:$(t);t=n[0];var a="",r=t.querySelector("tbody");r.innerHTML="";return e.forEach(function(e,t){!function e(t,s){if(!t.isFiltered){var n=i.rowHtml(t,s,s,!1,!1,s,!0),r=document.createElement("tr");if(r.innerHTML=n.left+n.center+n.right,a+=r.outerHTML,t.children)for(var o=0,l=t.children.length;o<l;o++)e(t.children[o],o)}}(e,t)}),r.insertAdjacentHTML("beforeend",a),n},ks.base64=function(e){return window.btoa?"data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(e))):"data:application/vnd.ms-excel;,"+unescape(encodeURIComponent(e))},ks.copyToDataSet=function(e,t,i,s,n){for(var a=function(e,t,i,s){for(var n=0,a=e.length;n<a;n++){var r=t.columns[s];r.formatter!==ws.Readonly&&(r.editor.name===Cs.Input.name?("integer"===r.filterType||"decimal"===r.filterType||"number"===r.filterType)&&isNaN(e[n].trim())||(i[r.field]=e[n]):r.editor.name===Cs.Input.name&&(isNaN(Date.parse(e[n]))||(i[r.field]=new Date(e[n])))),s++}},r=e.length,o=n.settings.columns.length,l=0;l<r;l++){var d=e[l].split("\t"),c=i;if(t<s.length){var h=s[t];a(d,n.settings,h,c)}else{for(var u={},p=0;p<o;p++)u[n.settings.columns[p].field]="";a(d,n.settings,u,c),s.push(u)}t++}n.renderRows(),n.syncSelectedUI(),n.pagerRefresh("bottom")},ks.exportToExcel=function(e,t,i,s){var n,a={worksheet:t||"Worksheet",table:ks.cleanExtra(i,s)[0].innerHTML};e=(e||s.element[0].id||"Export")+".xls",ks.save((n=a,'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:Panes></x:Panes><x:DisplayGridlines></x:DisplayGridlines></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table border="1px solid #999999">{table}</table></body></html>'.replace(/{(\w+)}/g,function(e,t){return n[t]})),e)},ks.exportToCsv=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sep=,",s=arguments[3],n=ks.cleanExtra(t,s);e=(e||s.element[0].id||"Export")+".csv",ks.save(function(e){var t=[];return[].slice.call(e[0].querySelectorAll("tr")).forEach(function(e){var i=[];[].slice.call(e.querySelectorAll("td, th")).forEach(function(e){return i.push(e.textContent.replace(/\r?\n|\r/g,"").replace(/"/g,'""').trim())}),t.push(i.join('","'))}),t.unshift([""+i]),'"'+t.join('"\n"')+'"'}(n),e)};var $s,Ts,Ss,As=($s=m.equals,Ts=function(e,t){return e.reduce(function(e,i){var s,n=function(e,t){for(var i={},s=0,n=t.length;s<n;s++)i[t[s]]=e[t[s]];return i}(i,t);return s=n,e.some(function(e){return $s(e,s)})||e.push(n),e},[])},(Ss=function(e,t){return Ts(e,t).map(function(t){return{key:t,values:function(e,t){var i=[];return e.map(function(e,s){for(var n in t)if(t[n]!==e[n])return;e.idx=s,i.push(e)}),i}(e,t).map(function(e){return e})}})}).register=function(e,t){return Ss[e]=function(e,i,s){return this.extra=s,Ss(e,i).map(t,this)}},Ss);As.register("none",function(e){return $.extend({},e.key,{values:e.values})}),As.register("sum",function(e){var t=this.extra;return $.extend({},e.key,{values:e.values},{sum:e.values.reduce(function(e,i){return e+Number(i[t])},0)})}),As.register("max",function(e){var t=this.extra;return $.extend({},e.key,{values:e.values},{max:e.values.reduce(function(e,i){return Math.max(e,Number(i[t]))},Number.NEGATIVE_INFINITY)})}),As.register("list",function(e){var t=this.extra;return $.extend({},e.key,{values:e.values},{list:e.values.map(function(e){for(var i=[],s=0,n=t.list.length;s<n;s++){var a=!!t.exclude&&e[t.exclude];e[t.list[s]]&&!a&&i.push({value:e[t.list[s]],key:t.list[s]})}return i})})});var Ds={aggregate:function(e,t){for(var i={},s=this,n=0,a=t.length;n<a;n++)t[n].aggregator&&function(){var a=t[n].field;s.sum=function(e,t){if(t.isFiltered)return e;var i=void 0;return i=a.indexOf(".")>-1?a.split(".").reduce(function(e,t){return e?e[t]:""},t):t[a],e+Number(i)};var r=e.reduce(s[t[n].aggregator],0);if(a.indexOf(".")>-1)for(var o=i,l=0,d=a.split(".").length;l<d;l++)l===a.split(".").length-1?o[a.split(".")[l]]=r:(a.split(".")[l]in o||(o[a.split(".")[l]]={}),o=o[a.split(".")[l]]);else i[a]=r}();return i}},Is={actionableMode:!1,cellNavigation:!0,rowNavigation:!0,showHoverState:!0,alternateRowShading:!1,columns:[],frozenColumns:{left:[],right:[]},dataset:[],columnReorder:!1,saveColumns:!1,saveUserSettings:{},focusAfterSort:!1,editable:!1,isRowDisabled:null,isList:!1,menuId:null,headerMenuId:null,menuSelected:null,menuBeforeOpen:null,headerMenuSelected:null,headerMenuBeforeOpen:null,uniqueId:null,rowHeight:"normal",fixedRowHeight:null,selectable:!1,selectChildren:!0,onBeforeSelect:null,allowSelectAcrossPages:null,groupable:null,spacerColumn:!1,showNewRowIndicator:!0,stretchColumn:"last",stretchColumnOnChange:!1,twoLineHeader:!1,clickToSelect:!0,toolbar:!1,initializeToolbar:!0,columnIds:[],paging:!1,pagesize:25,pagesizes:[10,25,50,75],showPageSizeSelector:!0,indeterminate:!1,source:null,hidePagerOnOnePage:!1,filterable:!1,filterWhenTyping:!0,disableClientFilter:!1,disableClientSort:!1,resultsText:null,showFilterTotal:!0,virtualized:!1,virtualRowBuffer:10,rowReorder:!1,showDirty:!1,showSelectAllCheckBox:!0,allowOneExpandedRow:!0,enableTooltips:!1,disableRowDeactivation:!1,sizeColumnsEqually:!1,expandableRow:!1,exportConvertNegative:!1,columnGroups:null,treeGrid:!1,onPostRenderCell:null,onDestroyCell:null,onEditCell:null,onExpandRow:null,onKeyDown:null,emptyMessage:{title:k?k.translate("NoData"):"No Data Available",info:"",icon:"icon-empty-no-data"},searchExpandableRow:!0,allowChildExpandOnMatch:!1};function Es(e,t){this.settings=m.mergeSettings(e,t,Is),this.element=$(e),t.dataset&&(this.settings.dataset=t.dataset),this.init()}Es.prototype={get pagerAPI(){var e=void 0;return this.tableBody&&this.tableBody.length&&(e=this.tableBody.data("pager")),e},get pager(){return S("pagerAPI","pager"),this.pagerAPI},init:function(){var e=$("html");this.isTouch=l.features.touch,this.isSafari=e.is(".is-safari"),this.isWindows=-1!==navigator.userAgent.indexOf("Windows"),this.isInModal=!1,this.appendTooltip(),this.initSettings(),this.originalColumns=this.columnsFromString(JSON.stringify(this.settings.columns)),this.removeToolbarOnDestroy=!1,this.nonVisibleCellErrors=[],this.recordCount=0,this.canvas=null,this.totalWidths={left:0,center:0,right:0},this.totalMinWidths={left:0,center:0,right:0},this.editor=null,this.activeCell={node:null,cell:null,row:null},this.dontSyncUi=!1,this.widthPercent=!1,this.rowSpans=[],this.headerWidths=[],this.filterRowRendered=!1,this.scrollLeft=0,this.scrollTop=0,this._selectedRows=[],this.restoreColumns(),this.restoreUserSettings(),this.appendToolbar(),this.setTreeDepth(),this.setRowGrouping(),this.setTreeRootNodes(),this.firstRender(),this.handleEvents(),this.handleKeys(),this.element.trigger("rendered",[this.element,this.headerContainer.find("thead"),this.pagerBar])},initSettings:function(){this.ignoredColumnById("rowStatus"),this.setInlineActionableMode(),this.sortColumn={sortField:null,sortAsc:!0},this.gridCount=$(".datagrid").length+1,this.lastSelectedRow=0,this.contextualToolbar=this.element.prev(".contextual-toolbar"),this.contextualToolbar.addClass("datagrid-contextual-toolbar")},ignoredColumnById:function(e){var t=this.settings;if(e&&t.columns&&(!t.columns||t.columns.length)){for(var i={index:-1},s=0,n=t.columns.length;s<n;s++)t.columns[s].id===e&&(i.index=s);i.index>-1&&t.columns.splice(i.index,1)}},setInlineActionableMode:function(){var e=this.settings;if(e.columns&&(!e.columns||e.columns.length)){for(var t={index:-1},i=0,s=e.columns.length;i<s;i++)e.columns[i].inlineEditor&&(t.index=i);this.inlineMode=t.index>-1,this.inlineMode?(this.element[0].classList.add("has-inline-editor"),this.settings.actionableMode=!0):this.element[0].classList.remove("has-inline-editor")}},render:function(e,t){if(t||(t={}),e&&(t.type="filterrow"),this.settings.source)return t.preserveSelected=!0,void this.triggerSource(t);this.loadData(this.settings.dataset,t)},firstRender:function(){this.hasLeftPane=this.settings.frozenColumns.left.length>0,this.hasRightPane=this.settings.frozenColumns.right.length>0,this.bodyContainer=$('<div class="datagrid-body-container"></div>'),this.hasLeftPane&&(this.bodyWrapperLeft=$('<div class="datagrid-body left"></div>'),this.tableLeft=$("<table></table>").addClass("datagrid").attr("role",this.settings.treeGrid?"treegrid":"grid").appendTo(this.bodyWrapperLeft),this.bodyContainer.append(this.bodyWrapperLeft)),this.bodyWrapperCenter=$('<div class="datagrid-body center scroll-x'+(this.hasRightPane?"":" scroll-y")+'"></div>'),this.table=$("<table></table>").addClass("datagrid").attr("role",this.settings.treeGrid?"treegrid":"grid").appendTo(this.bodyWrapperCenter),this.bodyContainer.append(this.bodyWrapperCenter),this.hasRightPane&&(this.bodyWrapperRight=$('<div class="datagrid-body right scroll-y"></div>'),this.tableRight=$("<table></table>").addClass("datagrid").attr("role",this.settings.treeGrid?"treegrid":"grid").appendTo(this.bodyWrapperRight),this.bodyContainer.append(this.bodyWrapperRight)),this.element.addClass("datagrid-container").attr("x-ms-format-detection","none"),this.isWindows&&this.element.addClass("is-windows"),"normal"!==this.settings.rowHeight&&(this.hasLeftPane&&this.tableLeft.addClass(this.settings.rowHeight+"-rowheight"),this.table.addClass(this.settings.rowHeight+"-rowheight"),this.hasRightPane&&this.tableRight.addClass(this.settings.rowHeight+"-rowheight"),this.element.addClass(this.settings.rowHeight+"-rowheight")),this.settings.isList?$(this.element).addClass("is-gridlist"):$(this.element).removeClass("is-gridlist"),this.isInitialRender=!0,this.table.empty(),this.clearHeaderCache(),this.renderRows(),this.element.append(this.bodyContainer),this.renderHeader(),this.container=this.element.closest(".datagrid-container"),this.settings.emptyMessage&&(this.setEmptyMessage(this.settings.emptyMessage),this.checkEmptyMessage()),this.buttonSelector=".btn, .btn-secondary, .btn-primary, .btn-modal-primary, .btn-tertiary, .btn-icon, .btn-actions, .btn-menu, .btn-split",$(this.buttonSelector,this.table).button(),this.handlePaging(),this.triggerSource("initial")},addRow:function(e,t){var i=this,s=!1,n=0,a=void 0,r=void 0;t&&"top"!==t||(t="top",s=!0),e.rowStatus={icon:"new",text:k.translate("New"),tooltip:k.translate("New")},this.saveDirtyRows();var o=this.settings.groupable&&this.originalDataset?this.originalDataset:this.settings.dataset;"string"==typeof t?o[s?"unshift":"push"](e):o.splice(t,0,e),this.restoreDirtyRows(),this.setRowGrouping(),this.pagerRefresh(t),this.syncSelectedRowsIdx(),this.renderRows(),this.syncSelectedUI(),setTimeout(function(){n=s?n:i.settings.dataset.length-1,i.setActiveCell(n,0),r=i.tableBody.find('tr[aria-rowindex="'+(n+1)+'"]'),a={row:n,cell:0,target:r,value:e,oldValue:{}},i.element.triggerHandler("addrow",a)},100)},pagerRefresh:function(e,t){if(this.pagerAPI){var i={};"string"==typeof e?i.activePage="top"===e?1:this.pagerAPI.state.pages:"number"==typeof e&&(i.activePage=Math.floor(e/(this.pagerAPI.settings.pagesize+1))),this.settings.source||(i.total=this.settings.dataset.length,i.pagesize=this.settings.pagesize),t&&(i.activePage=this.settings.pagesize*this.pager.activePage>this.settings.dataset.length?1:this.pager.activePage),this.renderPager(i,!0)}},removeRow:function(e,t,i){var s=this.tableBody.find('tr[aria-rowindex="'+(e+1)+'"]'),n=this.settings.groupable&&this.originalDataset?this.originalDataset:this.settings.dataset,a=n[e];this.unselectRow(e,t),n.splice(e,1),this.preventSelection=!0,t||(this.setRowGrouping(),this.pagerRefresh("top",!0),this.renderRows()),0!==this.nonVisibleCellErrors.length&&(this.nonVisibleCellErrors=$.grep(this.nonVisibleCellErrors,function(t){return t.row!==e}),this.showNonVisibleCellErrors()),delete this.preventSelection,this.syncSelectedUI();var r={row:e,cell:null,target:s,item:a,oldValue:a};return i?r:(this.element.trigger("rowremove",r),!0)},removeSelected:function(e){this._selectedRows.sort(function(e,t){return e.idx<t.idx?-1:e.idx>t.idx?1:0});for(var t=[],i=this._selectedRows.length-1;i>=0;i--)t.push({row:this._selectedRows[i].idx,item:this._selectedRows[i],cell:null,target:null}),this.removeRow(this._selectedRows[i].idx,i>0,e);e&&this.element.trigger("rowremove",t)},updateDataset:function(e,t){if(this.settings.toolbar&&this.settings.toolbar.keywordFilter){var i=this.element.parent().find(".toolbar").find(".searchfield");i.val(""),i.parent().removeClass("has-text"),this.clearFilter()}this.loadData(e,t)},triggerSource:function(e,t,i){if(this.settings.source){var s=this,n={};this.pagerAPI&&(n=this.pagerAPI.state),"string"==typeof e?(n.type=e,n.trigger=i):e&&(n=m.extend({},n,e)),t&&"function"!=typeof t&&"string"==typeof t.type&&(n.type=t.type),!1!==this.element.triggerHandler("beforepaging",n)&&(this.sortColumn&&this.sortColumn.sortId&&(n.sortAsc=this.sortColumn.sortAsc,n.sortField=this.sortColumn.sortField,n.sortId=this.sortColumn.sortId),this.filterExpr&&this.filterExpr.length&&(n.filterExpr=this.filterExpr),this.element.trigger("paging",n),this.settings.source(n,function(e,i){i.activePage>-1&&(s.activePage=i.activePage),i.grandTotal&&(s.grandTotal=i.grandTotal),s.loadData(e,i),t&&"function"==typeof t&&t(!0),s.element.trigger("afterpaging",n)}))}},loadData:function(e,t){this.settings.dataset=e,t||(t={}),"filterrow"===t.type&&(t.activePage=this.pagerAPI&&this.pagerAPI.activePage||1,t.pagesize=this.settings.pagesize,t.total=t.total||-1,t.type="filterrow"),t.activePage||(t.activePage=1,t.pagesize=this.settings.pagesize,t.total=-1,this.settings.treeGrid&&(t.preserveSelected=!0)),this.settings.source&&t.grandTotal?this.grandTotal=t.grandTotal:this.grandTotal=null,this.pagerAPI&&this.settings.showDirty&&this.settings.source&&/first|last|next|prev|sorted/.test(t.type)&&(this.dirtyArray=void 0),this.setTreeDepth(),this.settings.source&&(this.originalDataset=null,this.setRowGrouping()),this.setTreeRootNodes(),void 0===t.preserveSelected?this.settings.source?this._selectedRows=[]:"initial"!==t.type&&t.type||this.unSelectAllRows():!1===t.preserveSelected&&(this.settings.source?this._selectedRows=[]:this.unSelectAllRows()),this.settings.disableClientFilter&&(this.restoreFilter=!0,this.restoreSortOrder=!0,this.savedFilter=this.filterConditions()),"initial"===t.type?(this.clearHeaderCache(),this.restoreUserSettings(),this.renderRows(),this.renderHeader()):0===this.headerContainer.find(".datagrid-filter-wrapper .is-open").length?(this.clearHeaderCache(),this.setTreeDepth(),this.setRowGrouping(),this.setTreeRootNodes(),this.renderRows(),this.syncColGroups()):this.renderRows(),this.cellNode(0,0,!0).attr("tabindex","0"),this.renderPager(t,!0),this.syncSelectedUI(),this.displayCounts()},uniqueId:function(e){return e=null==e?"":e,(this.settings.uniqueId?this.settings.uniqueId+"-"+e:window.location.pathname.split("/").pop().replace(/\.xhtml|\.shtml|\.html|\.htm|\.aspx|\.asp|\.jspx|\.jsp|\.php/g,"").replace(/[^-\w]+/g,"").replace(/\./g,"-").replace(/ /g,"-").replace(/%20/g,"-")+"-"+(this.element.attr("id")||"datagrid")+"-"+(this.gridCount||0)+e).replace(/--/g,"-")},visibleColumns:function(e){for(var t=[],i=0;i<this.settings.columns.length;i++){var s=this.settings.columns[i];s.hidden||(e&&"selectionCheckbox"===s.id||t.push(s))}return t},lastColumnIdx:function(){var e=0;if(this.lastColumn)return this.lastColumn;for(var t=0;t<this.settings.columns.length;t++){this.settings.columns[t].hidden||(e=t)}return this.lastColumn=e,e},getColumnGroup:function(e){for(var t=0,i=this.settings.columnGroups,s=0;s<i.length;s++)if(!i[s].hidden&&(t+=i[s].colspan)>=e)return this.uniqueId("-header-group-"+s);return""},updateColumnGroup:function(){var e=this.settings.columnGroups;if(this.originalColGroups||(this.originalColGroups=JSON.parse(JSON.stringify(e))),this.settings.groupable)for(var t=this.tableBody.find(".datagrid-rowgroup-header"),i=this.visibleColumns().length,s=0;s<t.length;s++)t[s].children[0].setAttribute("colspan",i);else if(e&&this.colGroups){var n=[].slice.call(this.colGroups[0].querySelectorAll("th")),a=this.settings.columns,r=a.length,o=this.visibleColumns().length,l=e.map(function(e){return parseInt(e.colspan,10)}),d=function(){return l.reduce(function(e,t){return e+t},0)},c=function(){var e=d();return e>r?e-r:r-e},h=void 0;if(d()>r)for(var u=!0,p=l.length-1;p>=0&&u;p--)h=c(),l[p]>=h?(l[p]-=h,u=!1):l[p]=0;var g=0,f=0;if(l.forEach(function(t,i){for(var s=t,o=g+t;g<o;g++)g<r&&a[g].hidden&&s--;s>0&&(f+=s);var l=n[i];l.setAttribute("colspan",s>0?s:1),e[i].hidden||s<1?l.classList.add("hidden"):l.classList.remove("hidden")}),f<o){var m=n[n.length-1];h=o-f,m.setAttribute("colspan",h>0?h:1)}}},updateGroupHeadersAfterColumnReorder:function(e,t){var i=this.settings.columnGroups;if(i){this.originalColGroups||(this.originalColGroups=JSON.parse(JSON.stringify(i)));var s=i.map(function(e){return parseInt(e.colspan,10)}),n={from:null,to:null,total:0};s.forEach(function(i,s){n.total+=i,n.total>e&&null===n.from&&(n.from=s),n.total>t&&null===n.to&&(n.to=s)}),n.from!==n.to&&(i[n.from].colspan-=1,i[n.to].colspan+=1)}},headerText:function(e){var t=e.name?e.name:"";return t||"drilldown"!==e.id?t:'<span class="audible">'+(t=k.translate("Drilldown"))+"</span>"},getContainer:function(e){return this.settings.frozenColumns.left&&this.settings.frozenColumns.left.indexOf(e)>-1?"left":this.settings.frozenColumns.right&&this.settings.frozenColumns.right.indexOf(e)>-1?"right":"center"},renderHeader:function(){var e=this,t={left:"",center:"",right:""},i={left:"<colgroup>",center:"<colgroup>",right:"<colgroup>"},s={left:"",center:"",right:""},a=void 0,r=this.settings.columnGroups;if(r){this.element.addClass("has-group-headers");var o=this.settings.columns,l=o.length,d=this.visibleColumns().length,c=r.map(function(e){return parseInt(e.colspan,10)}),h=function(){return c.reduce(function(e,t){return e+t},0)},u=function(){var e=h();return e>l?e-l:l-e};t.left+='<tr role="row" class="datagrid-header-groups">',t.center+='<tr role="row" class="datagrid-header-groups">',t.right+='<tr role="row" class="datagrid-header-groups">';var p=void 0;if(h()>l)for(var g=!0,f=c.length-1;f>=0&&g;f--)p=u(),c[f]>=p?(c[f]-=p,g=!1):c[f]=0;var m=0,v=0;if(c.forEach(function(i,s){for(var n=i,d=m+i;m<d;m++)m<l&&o[m].hidden&&n--;var c=r[s].hidden||n<1?' class="hidden"':"",h=' colspan="'+(n>0?n:1)+'"',u=r[s].align?"l-"+r[s].align+"-text":"";a=e.uniqueId("-header-group-"+s),n>0&&(v+=n),t.center+="<th"+c+h+' id="'+a+'" class="'+u+'"><div class="datagrid-column-wrapper"><span class="datagrid-header-text">'+r[s].name+"</span></div></th>"}),v<d){var b=' colspan="'+((p=d-v)>0?p:1)+'"';t.center+="<th"+b+"></th>"}t.center+="</tr><tr>"}else t.left+='<tr role="row">',t.center+='<tr role="row">',t.right+='<tr role="row">';for(var y=0;y<this.settings.columns.length;y++){var w=e.settings.columns[y],x=e.getContainer(w.id),C=e.uniqueId("-header-"+y),k=void 0===w.sortable||w.sortable,T=void 0===w.resizable||w.resizable,S=void 0===w.exportable||w.exportable,A="selectionCheckbox"===w.id,D=this.getHeaderAlignmentClass(w);(e.hasLeftPane||e.hasRightPane)&&(e.settings.frozenColumns.left&&e.settings.frozenColumns.left.indexOf(w.id)>-1||e.settings.frozenColumns.right&&e.settings.frozenColumns.right.indexOf(w.id)>-1)&&(w.hideable=!1),void 0===w.hideable&&(w.hideable=!0);var I="";I+=k?" is-sortable":"",I+=T?" is-resizable":"",I+=w.hidden?" is-hidden":"",I+=w.filterType?" is-filterable":"",I+="ellipsis"===w.textOverflow?" text-ellipsis":"",I=""!==(I+=""!==D?D:"")?' class="'+I.substr(1)+'"':"",t[x]+='<th scope="col" role="columnheader" id="'+C+'" data-column-id="'+w.id+'"'+(w.field?' data-field="'+w.field+'"':"")+(w.headerTooltip?' title="'+w.headerTooltip+'"':"")+(!1===w.reorderable?' data-reorder="false"':"")+(r?' headers="'+e.getColumnGroup(y)+'"':"")+' data-exportable="'+(S?"yes":"no")+'"'+I+">";var E="";k&&(E='<div class="sort-indicator"><span class="sort-asc">'+$.createIcon({icon:"dropdown"})+'</span><span class="sort-desc">'+$.createIcon({icon:"dropdown"})+"</div>"),t[x]+='<div class="'+(A?"datagrid-checkbox-wrapper ":"datagrid-column-wrapper")+D+'">\n      <span class="datagrid-header-text'+(w.required?" required":"")+'">'+e.headerText(this.settings.columns[y])+(" l-center-text"===D?E:"")+"</span>",s[x]+="<col"+this.columnWidth(w,y)+(w.hidden?' class="is-hidden"':"")+">",A&&(e.settings.showSelectAllCheckBox?t[x]+='<span aria-checked="false" class="datagrid-checkbox" aria-label="Selection" role="checkbox"></span>':t[x]+='<span aria-checked="false" class="datagrid-checkbox" aria-label="Selection" role="checkbox" style="display:none"></span>'),k&&" l-center-text"!==D&&(t[x]+=E),t[x]+="</div>"+e.filterRowHtml(w,y)+"</th>"}if(t.left+="</tr>",t.center+="</tr>",t.right+="</tr>",i.left+=s.left+"</colgroup>",i.center+=s.center+"</colgroup>",i.right+=s.right+"</colgroup>",void 0===e.headerRow){e.headerContainer=$('<div class="datagrid-header-container"></div>').prependTo(e.element);var L='<div class="datagrid-header"><table role="grid"></table></div>';e.hasLeftPane&&(e.headerContainerLeft=$(L).addClass("left"),e.headerContainer.append(e.headerContainerLeft),e.headerTableLeft=e.headerContainerLeft.find("table"),e.headerTableLeft.width(this.headerTableWidth("left")),e.headerTableLeft.css("min-width",this.headerTableMinWidth("left")),e.headerColGroupLeft=$(i.left).appendTo(e.headerTableLeft),n.append(e.headerContainerLeft.find("table"),"<thead>"+t.left+"</thead>","*"),e.headerRowLeft=e.headerContainerLeft.find("thead")),e.headerContainerCenter=$(L).addClass("center"),e.headerContainer.append(e.headerContainerCenter),e.headerTable=e.headerContainerCenter.find("table"),e.headerTable.width(this.headerTableWidth("center")),e.headerTable.css("min-width",this.headerTableMinWidth("center")),e.headerColGroup=$(i.center).appendTo(e.headerTable),n.append(e.headerContainerCenter.find("table"),"<thead>"+t.center+"</thead>","*"),e.headerRow=e.headerContainerCenter.find("thead"),e.hasRightPane&&(e.headerContainerRight=$(L).addClass("right"),e.headerContainer.append(e.headerContainerRight),e.headerTableRight=e.headerContainerRight.find("table"),e.headerTableRight.width(this.headerTableWidth("right")),e.headerTableRight.css("min-width",this.headerTableMinWidth("right")),e.headerColGroupRight=e.hasRightPane?$(i.right).appendTo(e.headerTableRight):"",n.append(e.headerContainerRight.find("table"),"<thead>"+t.right+"</thead>","*"),e.headerRowRight=e.headerContainerRight.find("thead"))}else e.hasLeftPane&&(e.headerTableLeft.width(this.headerTableWidth("left")),e.headerTableLeft.css("min-width",this.headerTableMinWidth("left")),n.html(e.headerRowLeft,t.left,"*"),e.headerColGroupLeft.html(s.left)),e.headerTable.width(this.headerTableWidth("center")),e.headerTable.css("min-width",this.headerTableMinWidth("center")),n.html(e.headerRow,t.center,"*"),e.headerColGroup.html(s.center),e.hasRightPane&&(e.headerTableRight.width(this.headerTableWidth("right")),e.headerTableRight.css("min-width",this.headerTableMinWidth("right")),n.html(e.headerRowRight,t.right,"*"),e.headerColGroupRight.html(s.right));r&&e.headerRow&&(e.colGroups=e.headerRow.find(".datagrid-header-groups")),e.syncHeaderCheckbox(this.settings.dataset),e.setScrollClass(),e.attachFilterRowEvents(),e.settings.columnReorder&&e.createDraggableColumns(),this.restoreSortOrder=!1,this.setSortIndicator(this.sortColumn.sortId,this.sortColumn.sortAsc),this.restoreFilter?(this.restoreFilter=!1,this.applyFilter(this.savedFilter,"restore"),this.savedFilter=null):this.filterExpr&&this.filterExpr.length>0&&this.setFilterConditions(this.filterExpr),this.activeEllipsisHeaderAll()},syncColGroups:function(){this.bodyColGroup&&(this.headerColGroup.children().remove(),this.bodyColGroup.children().clone().appendTo(this.headerColGroup)),this.table&&this.headerTable&&this.table.css("min-width")&&this.headerTable.css("min-width",this.table.css("min-width")),this.table&&this.headerTable&&this.table.css("width")&&this.headerTable.css("width",this.table.css("width"))},getHeaderAlignmentClass:function(e){return void 0===e.headerAlign?e.align?" l-"+e.align+"-text":"":" l-"+e.headerAlign+"-text"},filterSetDatepicker:function(e,t,i){var s=e.data("datepicker"),n=e.data("is-range");i=i||{};var a=function(){s&&"function"==typeof s.destroy&&s.destroy(),e.datepicker(i)};s&&n||"in-range"!==t?s&&!n||"in-range"===t||(i.range={useRange:!1},e.removeData("is-range"),a()):(e.data("is-range",!0),i.range={useRange:!0},a())},filterRowHtml:function(e,t){var i="",s=this.getHeaderAlignmentClass(e);if(e.filterType){var n=e,a=this.uniqueId("-header-filter-"+t),r=Array.isArray(n.filterRowEditorOptions)?n.filterRowEditorOptions:n.options,o=void 0,l="";if("select"===n.filterType&&r){for(var d=!1,c=0,h=r.length;c<h;c++)if(!r[c].label){d=!0;break}d||(l="<option></option>")}switch(i='<div class="datagrid-filter-wrapper'+s+'" '+(this.settings.filterable?"":' style="display:none"')+">"+this.filterButtonHtml(n)+'<label class="audible" for="'+a+'">'+n.name+"</label>",n.filterType){case"checkbox":break;case"date":i+="<input "+(n.filterDisabled?" disabled":"")+' type="text" class="datepicker" id="'+a+'"/>';break;case"integer":o={patternOptions:{allowNegative:!0,allowThousandsSeparator:!1,allowDecimal:!1,symbols:{thousands:k.currentLocale.data.numbers?k.currentLocale.data.numbers.group:",",decimal:k.currentLocale.data.numbers?k.currentLocale.data.numbers.decimal:".",negative:k.currentLocale.data.numbers?k.currentLocale.data.numbers.minusSign:"-"}},process:"number"},n.maskOptions=m.extend(!0,{},o,n.maskOptions),i+="<input"+(n.filterDisabled?" disabled":"")+' type="text" id="'+a+'" />';break;case"percent":case"decimal":var u={patternOptions:{allowNegative:!0,allowDecimal:!0,symbols:{thousands:k.currentLocale.data.numbers?k.currentLocale.data.numbers.group:",",decimal:k.currentLocale.data.numbers?k.currentLocale.data.numbers.decimal:".",negative:k.currentLocale.data.numbers?k.currentLocale.data.numbers.minusSign:"-"}},process:"number"};n.numberFormat?(o={patternOptions:{decimalLimit:n.numberFormat.maximumFractionDigits}},n.maskOptions=m.extend(!0,{},o,u,n.maskOptions)):n.maskOptions=m.extend(!0,{},u,n.maskOptions),i+="<input"+(n.filterDisabled?" disabled":"")+' type="text" id="'+a+'" />';break;case"contents":case"select":if(i+='<select id="'+a+'" '+("select"===n.filterType?'class="dropdown"':'multiple class="multiselect"')+(n.filterDisabled?" disabled":"")+">"+l,r)for(var p=0,g=r.length;p<g;p++){var f=r[p],v=n.caseInsensitive&&"string"==typeof f.value?f.value.toLowerCase():f.value;f&&""!==v&&(i+='<option value = "'+v+'">'+f.label+"</option>")}i+='</select><div class="dropdown-wrapper"><div class="dropdown"><span></span></div><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-dropdown"></use></svg></div>';break;case"multiselect":if(i+='<select id="'+a+'" class="multiselect" multiple'+(n.filterDisabled?" disabled":"")+">",r)for(var b=0,y=r.length;b<y;b++){var w=r[b],x=n.caseInsensitive&&"string"==typeof w.value?w.value.toLowerCase():w.value;w&&"string"==typeof w.label&&(i+='<option value = "'+x+'">'+w.label+"</option>")}i+='</select><div class="dropdown-wrapper"><div class="dropdown"><span></span></div><svg class="icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-dropdown"></use></svg></div>';break;case"time":i+="<input "+(n.filterDisabled?" disabled":"")+' type="text" class="timepicker" id="'+a+'"/>';break;case"lookup":i+="<input "+(n.filterDisabled?" disabled":"")+' type="text" class="lookup" id="'+a+'" >';break;default:i+="<input"+(n.filterDisabled?" disabled":"")+' type="text" id="'+a+'"/>'}i+="</div>"}return e.filterType||(i='<div class="datagrid-filter-wrapper is-empty '+s+'"></div>'),i},attachFilterRowEvents:function(){var e=this,t=this;if(this.settings.filterable){this.element.addClass("has-filterable-columns"),this.settings.twoLineHeader&&this.element.addClass("has-two-line-header"),this.headerContainer.off("click.datagrid-filter").on("click.datagrid-filter",".btn-filter",function(){var e=$(this).data("popupmenu");return e?e.close(!0,!0):$(this).off("beforeopen.datagrid-filter").on("beforeopen.datagrid-filter",function(){var e=$(this).next(".popupmenu-wrapper");m.fixSVGIcons(e),t.hideTooltip()}).popupmenu({trigger:"immediate",offset:{y:15},placementOpts:{strategies:["flip","nudge"]}}).off("selected.datagrid-filter").on("selected.datagrid-filter",function(e,i){var s=i.closest('th[role="columnheader"]'),n=t.columnById(s.attr("data-column-id"))[0];if(n&&"date"===n.filterType){var a=s.find("input"),r=s.find(".btn-filter .icon-dropdown:first").getIconName().replace("filter-","");t.filterSetDatepicker(a,r,n.editorOptions)}t.applyFilter(null,"selected")}).off("close.datagrid-filter").on("close.datagrid-filter",function(){var e=$(this).data("popupmenu");e&&e.destroy()}),!1});var i=void 0;this.headerContainer.off("keydown.datagrid").on("keydown.datagrid",".datagrid-filter-wrapper input",function(e){return clearTimeout(i),e.stopPropagation(),13!==e.which||(t.applyFilter(null,"enter"),e.preventDefault(),e.stopPropagation(),!1)}),this.settings.filterWhenTyping&&this.headerContainer.off("keyup.datagrid").on("keyup.datagrid",".datagrid-filter-wrapper input",function(s){13!==s.which&&(e.activeCell&&e.activeCell.isFocused&&(e.activeCell.isFocused=!1),clearTimeout(i),i=setTimeout(function(){t.applyFilter(null,"keyup")},400))}),this.headerContainer.find("tr:last th").each(function(){var e=t.columnById($(this).attr("data-column-id"))[0],i=$(this);if(!e)return!0;i.find("select.dropdown").each(function(){var s=$(this);s.dropdown(e.editorOptions).on("selected.datagrid",function(){t.applyFilter(null,"selected")}).on("listopened.datagrid",function(){var e=s.data("dropdown");e&&(t.isInViewport(e.list[0])||t.adjustPosLeft(e.list[0]))}),s.data("dropdown").settings.sourceArguments={column:e,container:i,grid:t,cell:e,event:void 0,row:-1,rowData:{},value:void 0}}),i.find("select.multiselect").each(function(){var s=this,n=$(this);n.multiselect(e.editorOptions).on("selected.datagrid",function(){var e=$(s);$("#"+e.attr("id")).val(e.val()),t.applyFilter(null,"selected")}),n.data("dropdown").settings.sourceArguments={column:e,container:i,grid:t,cell:e,event:void 0,row:-1,rowData:{},value:void 0}}),e.maskOptions&&i.find("input").mask(e.maskOptions),e.mask&&i.find("input").mask(e.mask);var s=i.find(".datepicker");s.length&&"function"==typeof $().datepicker&&s.datepicker(e.editorOptions||{dateFormat:e.dateFormat}).on("listclosed.datepicker",function(){t.applyFilter(null,"selected")});var n=i.find(".lookup");n.length&&"function"==typeof $().lookup&&(e.editorOptions&&(e.editorOptions.clickArguments?e.editorOptions.clickArguments.grid=t:e.editorOptions.clickArguments={grid:t}),n.lookup(e.editorOptions||{}).on("change",function(){t.applyFilter(null,"selected")}));var a=i.find(".timepicker");return a.length&&"function"==typeof $().timepicker&&a.timepicker(e.editorOptions||{timeFormat:e.timeFormat}),e.mask&&i.find("input").mask({pattern:e.mask,mode:e.maskMode}),null}),t.filterRowRendered=!0}},filterItemHtml:function(e,t,i){return'<li class="'+e+" "+(i?" is-checked":"")+'"><a href="#">'+$.createIcon({classes:"icon icon-filter",icon:"filter-"+e})+"<span>"+k.translate(t)+"</span></a></li>"},filterButtonHtml:function(e){if(!e.filterType)return"";var t=this,i=e.filterDisabled,s=$.isArray(e.filterConditions)?e.filterConditions:[],n=function(e,i,n){var a,r,o=!(!s.length||s[0]!==e)||n;return!s.length||(a=e,r=r||s,$.inArray(a,r)>-1)?t.filterItemHtml(e,i,o):""},a=function(e){return'<button type="button" class="btn-menu btn-filter" data-init="false" '+(i?" disabled":"")+(e?' data-default="'+e+'"':"")+' type="button"><span class="audible">Filter</span><svg class="icon-dropdown icon" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="#icon-filter-{{icon}}"></use></svg>'+$.createIcon({icon:"dropdown",classes:"icon-dropdown"})+'</button><ul class="popupmenu has-icons is-translatable is-selectable">'},r="",o="";return"contents"===e.filterType||"select"===e.filterType||"multiselect"===e.filterType?"":("text"===e.filterType&&(r=(r=a(o=s.length?s[0]:"contains")+n("contains","Contains",!0)+n("does-not-contain","DoesNotContain")+n("equals","Equals")+n("does-not-equal","DoesNotEqual")+n("is-empty","IsEmpty")+n("is-not-empty","IsNotEmpty")).replace("{{icon}}",o)),"checkbox"===e.filterType&&(r=(r+=a(o=s.length?s[0]:"selected-notselected")+n("selected-notselected","All",!0)+n("selected","Selected")+n("not-selected","NotSelected")).replace("{{icon}}",o)),"checkbox"!==e.filterType&&"text"!==e.filterType&&(r=(r+=a(o=s.length?s[0]:"equals")+n("equals","Equals","lookup"===e.filterType||"integer"===e.filterType||"decimal"===e.filterType||"date"===e.filterType||"time"===e.filterType)+n("does-not-equal","DoesNotEqual")+n("is-empty","IsEmpty")+n("is-not-empty","IsNotEmpty")).replace("{{icon}}",o)),"date"===e.filterType&&(r+=n("in-range","InRange")),/\b(integer|decimal|date|time|percent)\b/g.test(e.filterType)&&(r=(r+=""+n("less-than","LessThan")+n("less-equals","LessOrEquals")+n("greater-than","GreaterThan")+n("greater-equals","GreaterOrEquals")).replace("{{icon}}","less-than")),"text"===e.filterType&&(r=(r+=""+n("end-with","EndsWith")+n("does-not-end-with","DoesNotEndWith")+n("start-with","StartsWith")+n("does-not-start-with","DoesNotStartWith")).replace("{{icon}}","end-with")),"lookup"===e.filterType&&(r=(r=a(o=s.length?s[0]:"contains")+n("contains","Contains",!0)+n("does-not-contain","DoesNotContain")+n("equals","Equals")+n("does-not-equal","DoesNotEqual")+n("is-empty","IsEmpty")+n("is-not-empty","IsNotEmpty")+n("end-with","EndsWith")+n("does-not-end-with","DoesNotEndWith")+n("start-with","StartsWith")+n("does-not-start-with","DoesNotStartWith")+n("less-than","LessThan")+n("less-equals","LessOrEquals")+n("greater-than","GreaterThan")+n("greater-equals","GreaterOrEquals")).replace("{{icon}}",o)),r+="</ul>")},toggleFilterRow:function(){this.settings.filterable?(this.headerContainer.find(".datagrid-filter-wrapper").hide(),this.settings.filterable=!1,this.filterRowRendered=!1,this.element.removeClass("has-filterable-columns"),this.element.removeClass("has-two-line-header"),this.element.triggerHandler("closefilterrow")):(this.settings.filterable=!0,this.filterRowRendered=!0,this.element.addClass("has-filterable-columns"),this.settings.twoLineHeader&&this.element.addClass("has-two-line-header"),this.headerContainer.find(".datagrid-filter-wrapper").show(),this.element.triggerHandler("openfilterrow"),this.attachFilterRowEvents()),this.setupTooltips()},applyFilter:function(e,t){var i=this,s=!1;e?this.setFilterConditions(e):e=this.filterConditions(),void 0===this.filterExpr&&(this.filterExpr=[]),this.pagerAPI&&JSON.stringify(e)!==JSON.stringify(this.filterExpr)&&(this.filterExpr=e,s=!0);var n=function(t){for(var s=!0,n=function(n){var a=i.columnById(e[n].columnId)[0],r=t&&void 0!==t[a.field]?t[a.field]:i.fieldValue(t,a.field),o=null==r?"":r.toString().toLowerCase(),l=e[n].value.toString().toLowerCase(),d=null;if("percent"===a.filterType&&(l=(l/100).toString(),"decimal"===(""+a.name).toLowerCase()?(r=ws.Decimal(!1,!1,r,a),l=ws.Decimal(!1,!1,l,a)):"integer"===(""+a.name).toLowerCase()&&(r=ws.Integer(!1,!1,r,a),l=ws.Integer(!1,!1,l,a))),"text"===a.filterType){var c=a.formatter,h=e[n].columnId;o=null==(r=(r=i.formatValue(c,n,h,r,a,t,i)).replace(/(<([^>]+)>)|(amp;)|(&lt;([^>]+)&gt;)/gi,"").trim().toLowerCase())?"":r.toString().toLowerCase()}if("contents"!==a.filterType&&"select"!==a.filterType&&"multiselect"!==a.filterType||(r=null==r?"":r.toString().toLowerCase()),"number"!=typeof r&&(isNaN(r)||""===r||e[n].value instanceof Array)||"date"===a.filterType||"time"===a.filterType||(r=null===r?r:parseFloat(r),l=k.parseNumber(l)),"date"===a.filterType||"time"===a.filterType){"string"==typeof r&&(r=a.formatter(!1,!1,r,a,!0));var u=function(t,i){return(i=k.parseDate(i,e[n].format))&&("time"===a.filterType&&(i.setDate(1),i.setMonth(0),i.setYear(0)),i=i.getTime()),t instanceof Date?(t=new Date(t.getTime()),"time"===a.filterType?(t.setDate(1),t.setMonth(0),t.setYear(0)):a.editorOptions&&a.editorOptions.showTime||(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)),t=t.getTime()):"string"==typeof t&&t&&(t=a.sourceFormat?k.parseDate(t,"string"==typeof a.sourceFormat?{pattern:a.sourceFormat}:a.sourceFormat):k.parseDate(t,{pattern:e[n].format}))&&("time"===a.filterType?(t.setDate(1),t.setMonth(0),t.setYear(0)):a.editorOptions&&a.editorOptions.showTime||(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)),t=t.getTime()),{rValue:t,cValue:i}},p=null;if("in-range"===e[n].operator){var g=i.settings.columns.indexOf(a),f=i.headerContainer.find("th:eq("+g+") .datagrid-filter-wrapper input").data("datepicker");f&&(d=f.settings.range.data)&&d.start&&(p=u(r,d.start))}else p=u(r,e[n].value);r=p?p.rValue:r,l=p?p.cValue:l}switch(e[n].operator){case"equals":if(e[n].value instanceof Array){s=!1;for(var m=0;m<e[n].value.length;m++){e[n].value[m].toLowerCase()===r&&(""!==r.toString()||""===e[n].value[m])&&(s=!0)}}else s=r===l&&""!==r;break;case"does-not-equal":s=r!==l;break;case"contains":s=o.indexOf(l)>-1&&""!==r.toString();break;case"does-not-contain":s=-1===o.indexOf(l);break;case"end-with":s=o.lastIndexOf(l)===o.length-l.toString().length&&""!==o&&o.length>=l.toString().length;break;case"start-with":s=0===o.indexOf(l)&&""!==o;break;case"does-not-end-with":s=!(s=o.lastIndexOf(l)===o.length-l.toString().length&&""!==o&&o.length>=l.toString().length);break;case"does-not-start-with":s=!(0===o.indexOf(l)&&""!==o);break;case"is-empty":s=""===o;break;case"is-not-empty":if(""===r){s=""!==r;break}s=!(null===r);break;case"in-range":if(s=!1,d&&d.startDate&&d.endDate){var v=d.startDate.getTime(),b=d.endDate.getTime();s=r>=v&&r<=b&&null!==r}break;case"less-than":s=r<l&&""!==r&&null!==r;break;case"less-equals":s=r<=l&&""!==r&&null!==r;break;case"greater-than":s=r>l&&""!==r&&null!==r;break;case"greater-equals":s=r>=l&&""!==r&&null!==r;break;case"selected":if(a&&a.isChecked){s=a.isChecked(r);break}s=("1"===o||"true"===o||!0===r||1===r)&&""!==o;break;case"not-selected":if(a&&a.isChecked){s=!a.isChecked(r);break}s="0"===o||"false"===o||!1===r||0===r||""===o;break;case"selected-notselected":s=!0}if(!s)return{v:!1}},a=0;a<e.length;a++){var r=n(a);if("object"===(void 0===r?"undefined":u(r)))return r.v}return s};if(!this.settings.disableClientFilter){var a=void 0,r=void 0,o=void 0,l=void 0,d=void 0,c=void 0;if(this.settings.treeGrid){var h=function e(t,i){for(var s=0;s<t.length;s++){var a=t[s];r&&(r=!n(a)),a.isFiltered=!n(a),i&&!a.isFiltered&&(i.isFiltered=!1),a.children&&a.children.length&&e(a.children,a)}};for(o=0,d=(a=this.settings.dataset).length;o<d;o++)r=!n(a[o]),a[o].children&&a[o].children.length&&h(a[o].children),a[o].isFiltered=r}else if(this.settings.groupable)for(o=0,d=this.settings.dataset.length;o<d;o++){var p=!0;for(l=0,c=this.settings.dataset[o].values.length;l<c;l++)r=!n(this.settings.dataset[o].values[l]),this.settings.dataset[o].values[l].isFiltered=r,r||(p=!1);this.settings.dataset[o].isFiltered=p}else for(o=0,d=this.settings.dataset.length;o<d;o++)r=!n(this.settings.dataset[o]),this.settings.dataset[o].isFiltered=r}this.setChildExpandOnMatch(),this.settings.source||this.renderRows(),s&&this.setSearchActivePage({trigger:t,type:"filtered"}),this.settings.disableClientFilter&&"restore"===t||(this.element.trigger("filtered",{op:"apply",conditions:e,trigger:t}),this.saveUserSettings())},adjustPosLeft:function(e){var t=e.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth;t.left<0&&t.right<=i?e.style.left="20px":t.left>=0&&!(t.right<=i)&&(e.style.left=i-t.width-20+"px")},isInViewport:function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},setChildExpandOnMatch:function(){var e=this.settings;if(e.treeGrid){!function t(i,s){for(var n=0,a=i.length;n<a;n++){var r=i[n],o=r.children,l=o?o.length:0;if(l){if(!r.isFiltered)if(e.allowChildExpandOnMatch)for(var d=0;d<l;d++)o[d].isFiltered=!1;else{for(var c=!0,h=0;h<l;h++)o[h].isFiltered||(c=!1);r.isAllChildrenFiltered=c}t(o)}}}(e.dataset)}},clearFilter:function(){this.settings.filterable&&(this.clearFilterFields(),this.applyFilter(),this.element.trigger("filtered",{op:"clear",conditions:[]}))},clearFilterFields:function(){this.settings.filterable&&(this.headerContainer.find("input, select").each(function(){var e=$(this);e.val(""),e.is("select")&&e.find("option").each(function(){$(this).prop("selected",!1)}),e.trigger("updated")}),this.headerContainer.find(".btn-filter").each(function(){var e=$(this),t=e.next(),i=t.find("li:first");e.find("svg:first > use").attr("xlink:href","#icon-filter-"+e.attr("data-default")),t.find(".is-checked").removeClass("is-checked"),i.addClass("is-checked")}))},setFilterConditions:function(e){this.clearFilterFields();for(var t=0;t<e.length;t++){var i=this.headerContainer.find('th[data-column-id="'+e[t].columnId+'"]'),s=i.find("input, select"),n=i.find(".btn-filter"),a=n.next();if(void 0===e[t].value&&(e[t].value=""),s.val(e[t].value),s.is("select")){var r=e[t].value instanceof Array?e[t].value[0]:e[t].value;if(e[t].innerHTML&&(s[0].innerHTML=e[t].innerHTML),s.find('option[value="'+r+'"]').length)if(e[t].value instanceof Array&&!e[t].selectedOptions){var o=s[0].querySelectorAll("option");s.val("");for(var l=0;l<o.length;l++)o[l].selected=!1;for(var d=0;d<e[t].value.length;d++)s.find('option[value="'+e[t].value[d]+'"]').prop("selected",!0)}else s.find('option[value="'+e[t].value+'"]').prop("selected",!0);else{var c=s.data("dropdown");c&&c.setCode(e[t].value)}s.trigger("updated")}n.find("svg:first > use").attr("xlink:href","#icon-filter-"+e[t].operator),a.find(".is-checked").removeClass("is-checked"),a.find("."+e[t].operator).addClass("is-checked")}},filterConditions:function(){if(this.filterExpr&&1===this.filterExpr.length&&this.filterExpr[0].keywordSearch)return delete this.filterExpr[0].keywordSearch,this.filterExpr;var e=[];return this.headerContainer.find("th").each(function(){var t,i=$(this),s=i.find(".btn-filter"),n=i.find("input, select"),a=n.is("select"),r=s.find(".icon-dropdown:first"),o=null;if((s.length||a)&&"selected-notselected"!==(t=a?"equals":r.getIconName().replace("filter-",""))&&!(""===n.val()&&-1===["is-not-empty","is-empty","selected","not-selected"].indexOf(t)||n.val()instanceof Array&&0===n.val().length)){var l=n.val()?n.val():"";n.attr("data-mask-mode")&&"number"===n.attr("data-mask-mode")&&(l=k.parseNumber(l));var d={columnId:i.attr("data-column-id"),operator:t,value:l};n.data("datepicker")&&(o=n.data("datepicker").pattern,d.format=o),n.data("timepicker")&&(o=n.data("timepicker").settings.timeFormat,d.format=o),n.is("select")&&(d.innerHTML=n[0].innerHTML),e.push(d)}}),e},getExtraTop:function(){var e=this.settings,t={default:{short:0,medium:0,normal:0},filterable:{short:0,medium:0,normal:0},group:{short:-25,medium:-30,normal:-39},groupFilterable:{short:-29,medium:-30,normal:-41}};return e.columnGroups?e.filterable?t.groupFilterable[e.rowHeight]:t.group[e.rowHeight]:e.filterable?t.filterable[e.rowHeight]:t.default[e.rowHeight]},getTargetHeight:function(){var e=this.settings,t={default:{short:20,medium:28,normal:35},filterable:{short:53,medium:54,normal:60},group:{short:46,medium:56,normal:74},groupFilterable:{short:83,medium:87,normal:103}};return e.columnGroups?e.filterable&&this.filterRowRendered?t.groupFilterable[e.rowHeight]:t.group[e.rowHeight]:e.filterable&&this.filterRowRendered?t.filterable[e.rowHeight]:t.default[e.rowHeight]},createDraggableColumns:function(){var e=this,t=e.headerNodes().not('[data-column-id="selectionCheckbox"]'),i=$(".drag-target-arrows",e.element);i.length||(e.element.prepend('<span class="drag-target-arrows" style="height: '+e.getTargetHeight()+'px;"></span>'),i=$(".drag-target-arrows",e.element)),t.not('[data-reorder="false"]').prepend('</span><span class="handle">&#8286;</span>'),t.prepend('<span class="is-draggable-target"></span>'),t.last().append('<span class="is-draggable-target last"></span>'),e.element.addClass("has-draggable-columns"),$(".handle",t).each(function(){var s=null,n=null,a=null,r=0,o=$(this),l=o.parent();o.on("mousedown.datagrid",function(o){o.preventDefault(),l.drag({clone:!0,cloneAppendTo:t.first().parent().parent(),clonePosIsFixed:!0}).on("dragstart.datagrid",function(t,i,d){(s=d).removeAttr("id").addClass("is-dragging-clone").css({left:i.left,top:i.top,height:l.height(),border:0}),$(".is-draggable-target",s).remove(),e.setDraggableColumnTargets(),r=e.getExtraTop(),n=l.position(),a={top:i.top-n.top,left:i.left-n.left};var c=e.targetColumn(n);e.draggableStatus.startIndex=c,o.stopImmediatePropagation()}).on("drag.datagrid",function(l,d){s[0].style.left=parseInt(d.left,10)+"px",s[0].style.top=parseInt(d.top,10)+"px",n={top:d.top-a.top,left:d.left-a.left};var c=0,h=null,u=null,p=e.targetColumn(n);if($(".is-draggable-target",t).add(i).removeClass("is-over"),-1!==p)for(var g=0,f=e.draggableColumnTargets.length;g<f;g++)c=g+1,(h=e.draggableColumnTargets[g]).index===p&&h.index!==e.draggableStatus.startIndex&&(h.index>e.draggableStatus.startIndex&&c<f&&(h=e.draggableColumnTargets[c]),h.el.addClass("is-over"),i.addClass("is-over"),u=h.el[0].getBoundingClientRect(),i[0].style.left=parseInt(u.left,10)+"px",i[0].style.top=parseInt(u.top,10)+1+r+"px");o.stopImmediatePropagation()}).on("dragend.datagrid",function(r,o){s[0].style.left=parseInt(o.left,10)+"px",s[0].style.top=parseInt(o.top,10)+"px",n={top:o.top-a.top,left:o.left-a.left};var d=e.targetColumn(n),c=l.data("drag"),h=[],u=void 0,p=void 0,g=void 0,f=void 0;if(c&&c.destroy&&c.destroy(),e.draggableStatus.endIndex=d,$(".is-draggable-target",t).add(i).removeClass("is-over"),-1!==e.draggableStatus.endIndex&&e.draggableStatus.startIndex!==e.draggableStatus.endIndex){for(u=0,p=e.settings.columns.length;u<p;u++)e.settings.columns[u].hidden||"selectionCheckbox"===e.settings.columns[u].id||h.push(u);g=h[e.draggableStatus.startIndex]||0,f=h[e.draggableStatus.endIndex]||0,e.updateGroupHeadersAfterColumnReorder(g,f),e.arrayIndexMove(e.settings.columns,g,f),e.updateColumns(e.settings.columns)}})})})},setDraggableColumnTargets:function(){var e=this,t=e.headerNodes().not(".is-hidden").not('[data-column-id="selectionCheckbox"]'),i=void 0,s=void 0,n=void 0;e.draggableColumnTargets=[],e.draggableStatus={},$(".is-draggable-target.last",t.last()).length||t.last().append($(".is-draggable-target.last",e.headerNodes())),$(".is-draggable-target",t).each(function(a){var r=$(this).is(".last")?a-1:a;i=t.eq(r),s=i.position(),n=20,e.draggableColumnTargets.push({el:$(this),index:r,pos:s,width:i.outerWidth(),height:i.outerHeight(),dropArea:{x1:s.left-n,x2:s.left+i.outerWidth()+n,y1:s.top-n+e.getExtraTop(),y2:s.top+i.outerHeight()+n}})})},targetColumn:function(e){var t,i=-1,s=void 0,n=void 0;for(n=0,t=this.draggableColumnTargets.length-1;n<t;n++)s=this.draggableColumnTargets[n],e.left>s.dropArea.x1&&e.left<s.dropArea.x2&&e.top>s.dropArea.y1&&e.top<s.dropArea.y2&&(i=s.index);return i},arrayIndexMove:function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},createDraggableRows:function(){var e=this;this.settings.rowReorder&&(this.tableBody.children().filter(function(){return $(this).find(".datagrid-reorder-icon").length<1}).attr("data-arrange-exclude",!0),this.tableBody.arrange({placeholder:'<tr class="datagrid-reorder-placeholder"><td colspan="'+this.visibleColumns().length+'"></td></tr>',handle:".datagrid-reorder-icon",isVisualItems:!0}).off("beforearrange.datagrid").on("beforearrange.datagrid",function(t,i){e.isSafari&&i.start.css({display:"inline-block"})}).off("arrangeupdate.datagrid").on("arrangeupdate.datagrid",function(t,i){e.isSafari&&i.end.css({display:""}),e.reorderRow(i.startIndex,i.endIndex,i)}))},reorderRow:function(e,t,i){var s=t>e,n=this.tableBody.find("tr").eq(e),a=this.tableBody.find("tr").eq(t),r=this.settings.dataset.splice(e,1)[0];this.settings.dataset.splice(t,0,r),!i&&s&&n.insertAfter(a),i||s||n.insertBefore(a),(this.settings.rowTemplate||this.settings.expandableRow)&&s&&(this.tableBody.find("tr").eq(2*e).insertAfter(i.end),i.end.next().next().insertAfter(i.over)),!this.settings.rowTemplate&&!this.settings.expandableRow||s||this.tableBody.find("tr").eq(2*e).next().insertAfter(i.end);for(var o=this.tableBody.find("tr:not(.datagrid-expandable-row)"),l=0;l<o.length;l++)o[l].setAttribute("data-index",l),o[l].setAttribute("aria-rowindex",l+1);this.element.trigger("rowreorder",[{endIndex:t,startIndex:e,over:a,start:n}]),this.syncSelectedRowsIdx()},fieldValue:function(e,t){if(!t||!e)return"";if(t.indexOf(".")>-1)return t.split(".").reduce(function(e,t){return e?e[t]:""},e);var i=e[t],n=i||0===i||!1===i?i:"";return n=s.escapeHTML(n)},setTreeRootNodes:function(){this.settings.treeGrid&&(this.settings.treeRootNodes=this.settings.treeDepth.filter(function(e){return 1===e.depth}))},setTreeDepth:function(e){if(this.settings.treeGrid){var t=this,i=0,s=function e(s,n){i++,t.settings.treeDepth.push({idx:i,depth:n,node:s});for(var a=s.children||[],r=0,o=a.length;r<o;r++)e(a[r],n+1)};e=e||this.settings.dataset,t.settings.treeDepth=[];for(var n=0,a=e.length;n<a;n++)s(e[n],1)}},setRowGrouping:function(){var e=this.settings.groupable;e&&(this.originalDataset?this.settings.dataset=this.originalDataset:this.originalDataset=this.settings.dataset.slice(),e.aggregator&&"none"!==e.aggregator?"sum"!==e.aggregator?"max"!==e.aggregator?"list"!==e.aggregator?this.settings.dataset=As(this.settings.dataset,e.fields):this.settings.dataset=As.list(this.settings.dataset,e.fields,e.aggregatorOptions):this.settings.dataset=As.max(this.settings.dataset,e.fields,e.aggregate):this.settings.dataset=As.sum(this.settings.dataset,e.fields,e.aggregate):this.settings.dataset=As.none(this.settings.dataset,e.fields))},renderRows:function(){var e="",t="",i="",s=0,a=this.settings,r=this.table.find("tbody"),o=1;if(this.pagerAPI){var l=this.pagerAPI.state;o=l.filteredActivePage?l.filteredActivePage:l.activePage}for(this.bodyColGroupHtmlLeft="<colgroup>",this.bodyColGroupHtml="<colgroup>",this.bodyColGroupHtmlRight="<colgroup>",this.triggerDestroyCell(),s=0;s<this.settings.columns.length;s++){var d=this.settings.columns[s],c=this.getContainer(d.id),h=this.columnWidth(d,s);switch(c){case"left":this.bodyColGroupHtmlLeft+="<col"+h+(d.hidden?' class="is-hidden"':"")+"></col>";break;case"right":this.bodyColGroupHtmlRight+="<col"+h+(d.hidden?' class="is-hidden"':"")+"></col>";break;default:this.bodyColGroupHtml+="<col"+h+(d.hidden?' class="is-hidden"':"")+"></col>"}d.colspan&&(this.hasColSpans=!0)}this.emptyMessageContainer&&this.emptyMessageContainer.hide(),0===r.length&&(this.hasLeftPane&&(this.tableBodyLeft=$("<tbody></tbody>"),this.tableLeft.append(this.tableBodyLeft)),this.tableBody=$("<tbody></tbody>"),this.table.append(this.tableBody),this.hasRightPane&&(this.tableBodyRight=$("<tbody></tbody>"),this.tableRight.append(this.tableBodyRight))),this.groupArray=[],this.recordCount=0,this.filteredCount=0,a.treeGrid&&a.paging&&!a.source&&o>1&&(this.recordCount=a.treeRootNodes[a.pagesize*o-a.pagesize].idx-1),this.restoreSortOrder&&this.sortDataset();for(var u=!1,p=0;p<a.dataset.length;p++){if(a.paging&&!a.source){if(1===o&&p-this.filteredCount>=a.pagesize){a.dataset[p].isFiltered?this.filteredCount++:this.recordCount++;continue}if(o>1&&!(p-this.filteredCount>=a.pagesize*(o-1)&&p-this.filteredCount<a.pagesize*o)){a.dataset[p].isFiltered?this.filteredCount++:this.filteredCount&&this.recordCount++;continue}}if(!a.virtualized||this.isRowVisible(this.recordCount))if((!a.treeGrid&&a.dataset[p]).isFiltered)this.filteredCount++;else if(this.settings.groupable){if(!this.settings.groupable.suppressGroupRow){var g=this.rowHtml(a.dataset[p],this.recordCount,p,!0);this.hasLeftPane&&g.left&&(t+=g.left),g.center&&(e+=g.center),this.hasRightPane&&g.right&&(i+=g.right)}if(this.settings.groupable.showOnlyGroupRow&&a.dataset[p].values[0]){var f=a.dataset[p].values[0];a.dataset[p].list&&(f.list=a.dataset[p].list),f.values=a.dataset[p].values;var m=this.rowHtml(f,this.recordCount,p);this.hasLeftPane&&m.left&&(t+=m.left),m.center&&(e+=m.center),this.hasRightPane&&m.right&&(i+=m.right),this.recordCount++,this.groupArray.push({group:p,node:0});continue}for(var v=0;v<a.dataset[p].values.length;v++)if(!a.dataset[p].values[v].isFiltered){var b=this.rowHtml(a.dataset[p].values[v],this.recordCount,a.dataset[p].values[v].idx);this.hasLeftPane&&b.left&&(t+=b.left),b.center&&(e+=b.center),this.hasRightPane&&b.right&&(i+=b.right),this.recordCount++,this.groupArray.push({group:p,node:v})}if(this.settings.groupable.groupFooterRow){var y=this.rowHtml(a.dataset[p],this.recordCount,p,!0,!0);this.hasLeftPane&&y.left&&(t+=y.left),y.center&&(e+=y.center),this.hasRightPane&&y.right&&(i+=y.right)}}else{var w=p;a.treeGrid&&(w=this.recordCount);var x=this.rowHtml(a.dataset[p],w,p);this.hasLeftPane&&x.left&&(t+=x.left),x.center&&(e+=x.center),this.hasRightPane&&x.right&&(i+=x.right),this.recordCount++,a.dataset[p].rowStatus&&(u=!0)}else this.recordCount++}if(this.settings.summaryRow){var C=this.calculateTotals(),k=this.rowHtml(C,this.recordCount,null,!1,!0);this.hasLeftPane&&k.left&&(t+=k.left),k.center&&(e+=k.center),this.hasRightPane&&k.right&&(i+=k.right)}"<colgroup>"!==this.bodyColGroupHtml&&(this.bodyColGroupHtmlLeft+="</colgroup>",this.bodyColGroupHtml+="</colgroup>",this.bodyColGroupHtmlRight+="</colgroup>",this.bodyColGroupLeft&&this.bodyColGroupLeft.remove(),this.bodyColGroup&&this.bodyColGroup.remove(),this.bodyColGroupRight&&this.bodyColGroupRight.remove(),this.hasLeftPane&&(this.bodyColGroupLeft=$(this.bodyColGroupHtmlLeft),this.tableBodyLeft.before(this.bodyColGroupLeft)),this.bodyColGroup=$(this.bodyColGroupHtml),this.tableBody.before(this.bodyColGroup),this.hasRightPane&&(this.bodyColGroupRight=$(this.bodyColGroupHtmlRight),this.tableBodyRight.before(this.bodyColGroupRight))),this.hasLeftPane&&n.html(this.tableBodyLeft,t,"*"),n.html(this.tableBody,e,"*"),this.hasRightPane&&n.html(this.tableBodyRight,i,"*"),this.setVirtualHeight(),this.setScrollClass(),this.setupTooltips(u),this.afterRender()},afterRender:function(){var e=this,t=this;if(this.settings.onPostRenderCell)for(var i=function(e){var i=t.settings.columns[e];i.component&&t.tableBody.find("tr").each(function(){var e=$(this),s=t.settings.treeGrid?t.actualPagingRowIndex(t.actualRowIndex(e)):t.dataRowIndex(e),n=e.attr("data-lineage"),a=t.rowData(s),r=t.columnIdxById(i.id),o={row:n||s,cell:r,value:a,rowData:a,col:i,api:t};t.settings.onPostRenderCell(e.find("td").eq(r).find(".datagrid-cell-wrapper .content")[0],o)})},s=0;s<this.settings.columns.length;s++)i(s);var n=t.tableBody.find("select.dropdown");n.dropdown&&n.dropdown(),t.tableBody.find(".dropdown-wrapper.is-inline").prev("select").on("listclosed",function(){var e=$(this),i=e.val(),s=e.closest("tr");t.updateCellNode(s.attr("aria-rowindex"),e.closest("td").index(),i,!1,!0)});var a=t.tableBody.find(".spinbox");a.spinbox&&a.spinbox(),t.settings.source||(t.displayCounts(),t.checkEmptyMessage()),t.setAlternateRowShading(),t.createDraggableRows(),t.activeCell&&t.activeCell.node||(t.activeCell={node:t.cellNode(0,0).attr("tabindex","0"),isFocused:!1,cell:0,row:0}),t.activeCell.isFocused&&t.setActiveCell(t.activeCell.row,t.activeCell.cell),t.settings.paging&&t.settings.source&&!t.settings.allowSelectAcrossPages&&(t.preventSelection||(t._selectedRows=[]),t.syncSelectedUI()),t.settings.paging&&t.settings.source&&t.settings.allowSelectAcrossPages&&(t.syncSelectedRows(),t.syncSelectedUI()),t.settings.paging&&!t.settings.source&&null===t.settings.allowSelectAcrossPages&&(t.syncSelectedRows(),t.syncSelectedUI()),setTimeout(function(){if(t.element.trigger("afterrender",{body:t.bodyContainer,header:t.headerContainer,pager:t.pagerBar}),t.hasRightPane&&e.isWindows){var i=t.tableRight.width()+17;t.tableRight.parent().width(i),t.tableRight.parent().find(".datagrid-column-wrapper").eq(0).width(i),t.headerTableRight.width(i)}})},triggerDestroyCell:function(){var e=this,t=this;if(t.tableBody&&this.settings.onPostRenderCell&&this.settings.onDestroyCell){var i=t.tableBody.find("tr");if(0===i.length)return;for(var s=function(s){var n=e.settings.columns[s];n.component&&i.each(function(){var e=$(this),i=e.index(),s=t.columnIdxById(n.id),a={row:e.index(),cell:s,value:t.settings.dataset[i],col:n,api:t};t.settings.onDestroyCell(e.find("td").eq(s).find(".datagrid-cell-wrapper .content")[0],a)})},n=0;n<this.settings.columns.length;n++)s(n)}},cacheVirtualStats:function(){var e=this.element[0].offsetHeight,t=this.bodyWrapperCenter[0].scrollTop,i=e-("normal"===this.settings.rowHeight?40:"medium"===this.settings.rowHeight?30:25),s="normal"===this.settings.rowHeight?50:"medium"===this.settings.rowHeight?40:30;this.virtualRange={rowHeight:s,top:Math.max(t-(this.settings.virtualRowBuffer-1)*s,0),bottom:t+i+(this.settings.virtualRowBuffer-1)*s,totalHeight:s*this.settings.dataset.length,bodyHeight:i}},isRowVisible:function(e){if(!this.settings.virtualized)return!(this.settings.paging&&!this.settings.source&&e&&this.pagerAPI)||(this.pagerAPI.activePage-1)*this.settings.pagesize<=e&&this.pagerAPI.activePage*this.settings.pagesize>=e;0===e&&this.cacheVirtualStats();var t=e*this.virtualRange.rowHeight;return t>=this.virtualRange.top&&t<this.virtualRange.bottom},setVirtualHeight:function(){if(this.settings.virtualized&&this.virtualRange){var e=this.virtualRange.totalHeight-this.virtualRange.bottom,t=this.virtualRange.top;this.topSpacer=this.tableBody.find(".datagrid-virtual-row-top"),this.bottomSpacer=this.tableBody.find(".datagrid-virtual-row-bottom"),t>0&&!this.topSpacer.length&&(this.topSpacer=$('<tr class="datagrid-virtual-row-top" style="height: '+t+'px"><td colspan="'+this.visibleColumns().length+'"></td></tr>'),this.tableBody.prepend(this.topSpacer)),t>0&&this.topSpacer.length&&this.topSpacer.css("height",t+"px"),0===t&&(this.topSpacer.length||this.virtualRange.topRow<=1)&&this.topSpacer.remove(),e>0&&!this.bottomSpacer.length&&(this.bottomSpacer=$('<tr class="datagrid-virtual-row-bottom" style="height: '+e+'px"><td colspan="'+this.visibleColumns().length+'"></td></tr>'),this.tableBody.append(this.bottomSpacer)),e>0&&this.bottomSpacer.length&&this.bottomSpacer.css("height",e+"px"),e<=0&&(this.bottomSpacer.length||this.virtualRange.bottomRow>=this.settings.dataset.length)&&this.bottomSpacer.remove()}},setAlternateRowShading:function(){this.settings.alternateRowShading&&this.settings.treeGrid&&$('tr[role="row"]:visible',this.tableBody).removeClass("alt-shading").filter(":odd").addClass("alt-shading")},formatValue:function(e,t,i,s,n,a,r){return r=r||this,void 0===e&&(e=this.defaultFormatter),"string"==typeof e?ws[e](t,i,s,n,a,r).toString():e(t,i,s,n,a,r).toString()},rowHtml:function(e,t,i,s,n,a,r){var o,l=this.settings.summaryRow&&!s&&n,d=this.pagerAPI?this.pagerAPI.activePage:1,c={left:"",center:"",right:""},h=this.settings.treeDepth?this.settings.treeDepth[t]:0,u=null,p=0,g=!1,f=void 0;if(!e)return"";var m=!1;this.settings.isRowDisabled&&"function"==typeof this.settings.isRowDisabled&&(this.settings.isRowDisabled(i,e)&&(m=!0));if(e.isRowDisabled&&(m=!0),u=h=h?h.depth:0,this.settings.treeDepth&&this.settings.treeDepth.length)for(var v=0;v<this.settings.treeDepth.length;v++){var b=this.settings.treeDepth[v];if(t===b.idx-1){for(var y=null,w=0,x=v;x>=0&&(!((w=this.settings.treeDepth[x].depth<w||0===w?this.settings.treeDepth[x].depth:w)<b.depth)||(void 0===(y=this.settings.treeDepth[x]).node.isExpanded||y.node.isExpanded)&&1!==w);x--);g=!(!y||void 0===y.node.expanded||y.node.expanded)||e.isFiltered,u=b.depth;break}}if(this.settings.groupable&&!n){var C=this.settings.groupable;g=void 0!==C.expanded&&!C.expanded,C.expanded&&"function"==typeof C.expanded&&(g=!C.expanded(t,0,null,null,e,this),this.isFooterHidden=g)}var k=this.settings.frozenColumns.left.length,$=this.settings.frozenColumns.right.length,T=this.visibleColumns().length-k-$;if(this.settings.groupable&&s&&!n){var S=ws.GroupRow(t,0,null,null,e,this);return c.left='<tr class="datagrid-rowgroup-header'+(g?"":" is-expanded")+'" role="rowgroup"><td role="gridcell" colspan="'+k+'">'+(S.left||"<span>&nbsp;</span>")+"</td></tr>",c.center='<tr class="datagrid-rowgroup-header'+(g?"":" is-expanded")+'" role="rowgroup"><td role="gridcell" colspan="'+T+'">'+(S.center||"<span>&nbsp;</span>")+"</td></tr>",c.right='<tr class="datagrid-rowgroup-header'+(g?"":" is-expanded")+'" role="rowgroup"><td role="gridcell" colspan="'+$+'">'+(S.right||"<span>&nbsp;</span>")+"</td></tr>",c}if(this.settings.groupable&&s&&n){var A=ws.GroupFooterRow(t,0,null,null,e,this);return c.left='<tr class="datagrid-row datagrid-rowgroup-footer'+(this.isFooterHidden?" is-hidden":"")+'" role="rowgroup">'+(A.left||"<span>&nbsp;</span>")+"</tr>",c.center='<tr class="datagrid-row datagrid-rowgroup-footer'+(this.isFooterHidden?" is-hidden":"")+'" role="rowgroup">'+(A.center||"<span>&nbsp;</span>")+"</tr>",c.right='<tr class="datagrid-row datagrid-rowgroup-footer'+(this.isFooterHidden?" is-hidden":"")+'" role="rowgroup">'+(A.right||"<span>&nbsp;</span>")+"</tr>",this.isFooterHidden=!1,c}var D=t+1+(this.settings.source&&!this.settings.indeterminate?(d-1)*this.settings.pagesize:0);o=this.recordCount%2==0;var I=this.isRowSelected(e),E=e._rowactivated,L={class:"",svg:""};e&&e.rowStatus&&("new"!==e.rowStatus.icon||this.settings.showNewRowIndicator)&&(L.show=!0,L.class=" rowstatus-row-"+e.rowStatus.icon,L.icon="success"===e.rowStatus.icon?"#icon-check":"#icon-exclamation",L.title=""!==e.rowStatus.tooltip?' title="'+e.rowStatus.tooltip+'"':"",L.svg='<svg class="icon icon-rowstatus" focusable="false" aria-hidden="true" role="presentation"'+L.title+'><use xlink:href="'+L.icon+'"></use></svg>');var P="";for(this.settings.fixedRowHeight&&"function"==typeof this.settings.fixedRowHeight&&(P=' style="height: '+this.settings.fixedRowHeight(this.recordCount,D,i,e)+'"px" '),this.settings.fixedRowHeight&&"number"==typeof this.settings.fixedRowHeight&&(P=' style="height: '+this.settings.fixedRowHeight+'px" '),c.center='<tr role="row" aria-rowindex="'+D+'" data-index="'+i+'"'+(a?' data-lineage="'+a+'"':"")+(this.settings.treeGrid&&e.children?' aria-expanded="'+(e.expanded?'true"':'false"'):"")+(this.settings.treeGrid?' aria-level="'+u+'"':"")+(m?' aria-disabled="true"':"")+(I?' aria-selected="true"':"")+' class="datagrid-row'+L.class+(g?" is-hidden":"")+(e.isFiltered?" is-filtered":"")+(E?" is-rowactivated":"")+(m?" is-rowdisabled":"")+(I?"mixed"===this.settings.selectable?" is-selected hide-selected-color":" is-selected":"")+(this.settings.alternateRowShading&&!o?" alt-shading":"")+(l?" datagrid-summary-row":"")+(this.settings.cellNavigation||!1===this.settings.selectable?"":" is-clickable")+(this.settings.treeGrid?e.children?" datagrid-tree-parent":u>1?" datagrid-tree-child":"":"")+'"'+P+">",c.left=c.center,c.right=c.center,p=0;p<this.settings.columns.length;p++){var M=this.settings.columns[p],B=this.getContainer(M.id),R="",F=M.summaryRowFormatter||M.formatter||this.defaultFormatter,O=l?F:M.formatter||this.defaultFormatter,N=this.formatValue(O,t,p,this.fieldValue(e,this.settings.columns[p].field),this.settings.columns[p],e,this);if(0===N.indexOf('<span class="is-readonly">')&&(M.readonly=!0),(N.indexOf("datagrid-checkbox")>-1||N.indexOf("btn-actions")>-1)&&(R+=" l-center-text"),N.indexOf("trigger")>-1&&(R+=" datagrid-trigger-cell"),M.editor&&this.settings.editable&&(R+=" has-editor"),M.expanded&&(this.treeExpansionField=M.expanded),M.align&&(R+=" l-"+M.align+"-text"),"ellipsis"===M.textOverflow&&(R+=" text-ellipsis"),M.uppercase&&(R+=" uppercase-text"),R+=M.readonly?" is-readonly":"",R+=M.hidden?" is-hidden":"",M.isEditable&&!M.readonly){var z=this.fieldValue(e,this.settings.columns[p].field);M.isEditable(D-1,p,z,M,e)||(R+=" is-readonly")}var H="selectionCheckbox"===M.id||!M.readonly&&void 0!==M.editor?"":'aria-readonly="true"';if(M.isReadonly&&!M.readonly&&"selectionCheckbox"!==M.id){var q=this.fieldValue(e,this.settings.columns[p].field);M.isReadonly(this.recordCount,p,q,M,e)&&(R+=" is-cell-readonly",H='aria-readonly="true"')}var V=this.fieldValue(e,this.settings.columns[p].field);M.cssClass&&"function"==typeof M.cssClass&&(R+=" "+M.cssClass(this.recordCount,p,V,M,e)),M.cssClass&&"string"==typeof M.cssClass&&(R+=" "+M.cssClass),R+=M.focusable?" is-focusable":"";var W=this.calculateRowspan(V,t,M);if(""!==W){f>0&&!M.hidden&&(f-=1,R+=" is-hidden");var j=null;if(M.colspan&&"function"==typeof M.colspan){var G=this.fieldValue(e,this.settings.columns[p].field);j=M.colspan(D-1,p,G,M,e,this);var U=this.settings.columns.length-p;(j=j&&j>U?U:j)&&j>1?(f=j-1,M.align&&(R=R.replace(" l-"+M.align+"-text","")),R+=" l-left-text"):j=null}if(0!==p&&(L.class="",L.svg=""),""!==L.class&&(R+=" rowstatus-cell"),this.isCellDirty(this.settings.groupable?i:t,p)&&(R+=" is-dirty-cell"),""!==R&&(R=R.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")),c[B]+='<td role="gridcell" '+H+' aria-colindex="'+(p+1)+'" aria-describedby="'+this.uniqueId("-header-"+p)+'"'+(I?' aria-selected="true"':"")+(R?' class="'+R+'"':"")+(j?' colspan="'+j+'"':"")+(M.tooltip&&"string"==typeof M.tooltip?' title="'+M.tooltip.replace("{{value}}",V)+'"':"")+(this.settings.columnGroups?'headers = "'+this.uniqueId("-header-"+p)+" "+this.getColumnGroup(p)+'"':"")+(W||"")+">"+L.svg+'<div class="datagrid-cell-wrapper">',M.contentVisible)M.contentVisible(t+1,p,V,M,e)||(N="");this.settings.onPostRenderCell&&M.component&&(c[B]+='<div class="content"></div>',N=""),c[B]+=N+"</div></td>"}}if(c.left+="</tr>",c.center+="</tr>",c.right+="</tr>",this.settings.rowTemplate){var _=this.settings.rowTemplate,K=e,Y="";We&&K&&(Y=We.compile("{{#dataset}}"+_+"{{/dataset}}",{dataset:K})),this.hasLeftPane&&(c.left+='<tr class="datagrid-expandable-row no-border"><td colspan="'+k+'">\n          <div class="datagrid-row-detail"><div style="height: '+(this.settings.rowTemplateHeight||"107")+'px"></div></div>\n          </td></tr>'),c.center+='<tr class="datagrid-expandable-row"><td colspan="'+T+'">\n        <div class="datagrid-row-detail"><div class="datagrid-row-detail-padding">'+Y+"</div></div>\n        </td></tr>",this.hasRightPane&&(c.right+='<tr class="datagrid-expandable-row"><td colspan="'+k+'">\n          </td></tr>')}if(this.settings.expandableRow&&(this.hasLeftPane&&(c.left+='<tr class="datagrid-expandable-row"><td colspan="'+k+'"><div class="datagrid-row-detail"><div class="datagrid-row-detail-padding"></div></div></td></tr>'),c.center+='<tr class="datagrid-expandable-row"><td colspan="'+T+'"><div class="datagrid-row-detail"><div class="datagrid-row-detail-padding"></div></div></td></tr>'),e.children&&!r)for(var X=0,J=e.children.length;X<J;X++){var Q=a?a+"."+i:""+i;this.recordCount++;var Z=this.rowHtml(e.children[X],this.recordCount,X,!1,!1,Q);c.left+=Z.left,c.center+=Z.center,c.right+=Z.right}return c},calculateTextWidth:function(e){var t=e.name||"",i=0,n=0,a=0,r="",o=!1;if(e.hidden)return 0;if(e.formatter===ws.Colorpicker)r="";else if(e.formatter===ws.Dropdown&&e.options){for(var l="",d=0;d<e.options.length;d++)e.options[d].label.length>l.length&&(l=e.options[d].label);l=this.formatValue(e.formatter,0,0,l,e,null,this),r=l=s.stripHTML(l)}else{var c=0,h=this.settings.dataset;this.settings.groupable&&(h=this.originalDataset);for(var u=0;u<h.length;u++){var p=this.fieldValue(h[u],e.field),g=h[u];if(o=(p=this.formatValue(e.formatter,u,0,p,e,g,this)).toString().indexOf("btn-secondary")>-1,c=(p=s.stripHTML(p)).toString().length,this.settings.groupable&&g)for(var f=0;f<g.length;f++){var m=this.fieldValue(g[f],e.field);m=this.formatValue(e.formatter,u,0,m,e,g,this),(c=(m=s.stripHTML(m)).toString().length)>i&&(i=c,r=m)}c>i&&(i=c,r=p)}if(this.filterExpr&&this.filterExpr.length>0){var v=$.grep(this.filterExpr,function(t){return t.columnId===e.id});if(v&&1===v.length){var b=v[0].value;(c=b.toString().length)>i&&(i=c,r=b)}}if(""===r&&(e.formatter===ws.Date||e.formatter===ws.Time)){var y=new Date(9999,11,31,23,59,59,999);y=this.formatValue(e.formatter,0,0,y,e,null,this),r=y=s.stripHTML(y)}}var w=!!e.formatter&&e.formatter.toString().indexOf('<span class="tag')>-1;a+=45,!!e.formatter&&e.formatter.toString().indexOf("datagrid-alert-icon")>-1&&(a+=20),w&&(a+=10),o&&(a+=50),this.settings.editable&&e.editor===Cs.Spinbox&&(a+=46),!this.settings.editable||e.formatter!==ws.Dropdown&&e.formatter!==ws.Lookup&&e.editor!==Cs.Time||(a+=10),this.settings.editable&&e.editor===Cs.Date&&(a+=5),n=this.calculateTextRenderWidth(r)+a,e.formatter===ws.Colorpicker&&(n=150);var x=void 0===e.sortable||e.sortable?48:40,C=this.calculateTextRenderWidth(t,!0)+x;return e.filterType&&this.settings.filterable&&(C<40&&(C=40),"checkbox"!==e.filterType&&(""!==r?C<n+40&&""!==r&&(C=n+55):C<120&&(C=120))),Math.ceil(Math.max(n,C))},calculateTextRenderWidth:function(e,t){this.canvas=this.canvas||(this.canvas=document.createElement("canvas"));var i=this.canvas.getContext("2d");return this.fontCached&&this.fontHeaderCached||(this.fontCached=H.currentTheme.id&&H.currentTheme.id.indexOf("uplift")>-1?"400 16px arial":"400 14px arial",this.fontHeaderCached=H.currentTheme.id&&H.currentTheme.id.indexOf("uplift")>-1?"600 14px arial":"700 12px arial"),i.font=this.fontCached,t&&(i.font=this.fontHeaderCached),i.measureText(e).width},headerTableWidth:function(e){var t=this.headerWidths[this.settings.columns.length-1],i=!1;return t?(this.hasRightPane&&"right"===e&&(i="Mac OS X"===l.os.name&&this.bodyWrapperRight.width()-this.tableRight.width()>0),t.widthPercent?"100%":isNaN(this.totalWidths[e])?"":i?parseFloat(this.totalWidths[e])+15+"px":parseFloat(this.totalWidths[e])+"px"):""},headerTableMinWidth:function(e){return isNaN(this.totalMinWidths[e])?"":parseFloat(this.totalMinWidths[e])+"px"},setScrollClass:function(){var e=parseInt(this.bodyWrapperCenter[0].offsetHeight,10),t=parseInt(this.bodyWrapperCenter[0].scrollHeight,10)>e+2,i=parseInt(this.bodyWrapperCenter[0].offsetWidth,10),s=parseInt(this.bodyWrapperCenter[0].scrollWidth,10)>i;this.element.removeClass("has-vertical-scroll has-less-rows"),t&&this.element.addClass("has-vertical-scroll"),s&&this.element.addClass("has-horizontal-scroll"),!t&&this.tableBody[0].offsetHeight<e&&this.element.addClass("has-less-rows"),this.hasRightPane&&(this.element.addClass("has-frozen-right-columns"),m.getScrollbarWidth()>0&&this.element.addClass("has-visible-scrollbars"))},clearHeaderCache:function(){this.headerWidths=[],this.totalWidths.left=0,this.totalWidths.center=0,this.totalWidths.right=0,this.totalMinWidths.left=0,this.totalMinWidths.center=0,this.totalMinWidths.right=0,this.elemWidth=0,this.lastColumn=null,this.isInitialRender=!0,this.cacheColumnWidths()},cacheColumnWidths:function(){for(var e=0;e<this.settings.columns.length;e++){var t=this.settings.columns[e];this.calculateColumnWidth(t,e)}},columnWidth:function(e,t){if(this.elemWidth||(this.elemWidth=this.element.outerWidth(),0===this.elemWidth&&(this.elemWidth=this.element.closest(".tab-container").outerWidth()),this.widthSpecified=!1),this.headerWidths[t]){var i=this.headerWidths[t];return"default"!==i.width&&i.width?' style="width: '+i.width+(i.widthPercent?"%":"px")+'"':""}return this.calculateColumnWidth(e,t)},calculateColumnWidth:function(e,t){var i=this,s=void 0,n=this.visibleColumns(!0),a=this.lastColumnIdx(),r=this.getContainer(e.id);if(this.elemWidth||(this.elemWidth=this.element.outerWidth(),0===this.elemWidth&&(this.elemWidth=this.element.closest(".tab-container").outerWidth()),!this.elemWidth&&this.element.parent().is(".datagrid-default-modal-width")?(this.elemWidth=this.settings.paging?466:300,this.isInModal=!0):this.element.parent().is(".modal-body")&&(this.elemWidth=this.settings.paging?466:300,this.element.css("min-width")&&(this.elemWidth=parseInt(this.element.css("min-width"),10)),this.isInModal=!0),this.widthSpecified=!1,this.widthPixel=!1),this.headerWidths[t]){var o=this.headerWidths[t];return"default"===o.width?"":this.widthSpecified&&!o.width?"":' style="width: '+o.width+(o.widthPercent?"%":"px")+'"'}e.width&&(this.widthSpecified=!0,this.widthPercent=!1),!this.widthPixel&&e.width&&(this.widthPixel="string"!=typeof e.width);var l=e.width;"string"==typeof e.width&&-1===e.width.indexOf("px")&&(this.widthPercent=!0,s=e.width.replace("%",""));var d=this.calculateTextWidth(e);if(this.widthSpecified&&l||(l=Math.max(d,l||0)),a=t===this.lastColumnIdx(),(!this.widthSpecified||void 0===e.width)&&this.settings.sizeColumnsEqually&&-1===["selectionCheckbox","expander","drilldown","rowStatus","favorite"].indexOf(e.id)){var c=Math.round(this.elemWidth/n.length);l=c-(a?2:0),c<d&&(l=d)}if("selectionCheckbox"!==e.id&&"favorite"!==e.id||(l=43,e.width=l),"favorite"===e.id&&(l=62,e.width=l),"expander"===e.id&&(l=55,e.width=l),"rowStatus"===e.id&&(l=62,e.width=l),"rowReorder"===e.id&&(l=62,e.width=l),"drilldown"===e.id&&(l=78,e.width=l),e.minWidth&&l<e.minWidth&&(l=e.minWidth),e.minWidth&&l>e.maxWidth&&(l=e.maxWidth),this.headerWidths[t]={id:e.id,width:this.widthPercent?s:l,widthPercent:this.widthPercent},"spacerColumn"!==e.id&&(this.totalWidths[r]+=e.hidden?0:l),a&&this.isInitialRender&&!this.settings.spacerColumn){var h=this.elemWidth-this.totalWidths[r];if("last"!==this.settings.stretchColumn||this.settings.sizeColumnsEqually||(h>0&&h>l&&!this.widthPercent&&!e.width&&(l="",this.headerWidths[t]={id:e.id,width:l,widthPercent:this.widthPercent},this.totalMinWidths[r]=this.totalWidths[r],this.totalWidths[r]=this.isInModal?this.elemWidth:"100%"),h>0&&h<l&&!this.widthPercent&&!e.width&&(l+=h,this.headerWidths[t]={id:e.id,width:l,widthPercent:this.widthPercent},this.totalWidths[r]+=l,this.totalMinWidths[r]=this.totalWidths[r],this.totalWidths[r]=this.isInModal?this.elemWidth:"100%")),"last"!==this.settings.stretchColumn){this.headerWidths[t]={id:e.id,width:l,widthPercent:this.widthPercent};var u=this.elemWidth-this.totalWidths[r],p=$.grep(this.headerWidths,function(e){return e.id===i.settings.stretchColumn});u>0&&!p[0].widthPercent&&(p[0].width=""),this.totalWidths[r]=this.isInModal?this.elemWidth:"100%"}this.widthPercent?this.table.css("width","100%"):isNaN(this.totalWidths.center)?this.table.css("width",""):this.table.css("width",this.totalWidths.center),!isNaN(this.totalMinWidths.center)&&this.totalMinWidths.center>0&&this.table.css("min-width",this.totalMinWidths.center+"px"),this.hasLeftPane&&this.tableLeft.css("width",this.totalWidths.left),!isNaN(this.totalMinWidths.left)&&this.totalMinWidths.left>0&&this.tableLeft.css("min-width",this.totalMinWidths.left+"px"),this.hasRightPane&&this.tableRight.css("width",this.totalWidths.right),!isNaN(this.totalMinWidths.right)&&this.totalMinWidths.right>0&&this.tableRight.css("min-width",this.totalMinWidths.right+"px"),this.isInitialRender=!1}if(a&&this.isInitialRender&&this.settings.spacerColumn){var g=this.elemWidth-this.totalWidths[r];this.totalWidths[r]+=g,g>0&&!this.widthPercent&&!e.width&&this.settings.columns.push({id:"spacerColumn",cssClass:"is-spacer",name:"",field:"",width:g-4-l})}return a&&this.settings.spacerColumn&&this.isInitialRender&&(this.widthPercent?this.table.css("width","100%"):isNaN(this.totalWidths[r])||this.table.css("width",this.totalWidths[r]),this.isInitialRender=!1),this.widthPercent||void 0!==l?' style="width: '+(this.widthPercent?s+"%":l+"px")+'"':""},calculateRowspan:function(e,t,i){var s=0,n=null;if(!i.rowspan)return null;for(var a=0;a<this.settings.dataset.length;a++)e===this.settings.dataset[a][i.field]&&(s++,null===n&&(n=a));return t===n?' rowspan ="'+s+'"':""},calculateTotals:function(){return this.settings.totals=Ds.aggregate(this.settings.dataset,this.settings.columns),this.settings.totals},setUnit:function(e){return e+(/(px|%)/i.test(""+e)?"":"px")},setupTooltips:function(e,t){if(e||t||this.settings.enableTooltips){var i=this,s=void 0,n={th:".datagrid-header th",td:'.datagrid-body tr.datagrid-row td[role="gridcell"]:not(.rowstatus-cell)',rowstatus:'.datagrid-body tr.datagrid-row td[role="gridcell"] .icon-rowstatus'};this.settings.filterable?(n.headerColumn=n.th+" .datagrid-column-wrapper",n.headerFilter=n.th+" .datagrid-filter-wrapper .btn-menu",n.header=n.headerColumn+", "+n.headerFilter):n.header=n.th,n.iconAlert=n.td+" .icon-alert",n.iconSuccess=n.td+" .icon-success",n.iconError=n.td+" .icon-error",n.iconInfo=n.td+" .icon-info",n.icons=n.iconAlert+", "+n.iconSuccess+", "+n.iconError+", "+n.iconInfo,e&&this.settings.enableTooltips?n.str=n.header+", "+n.td+", "+n.icons+", "+n.rowstatus:n.str=e?n.header+", "+n.rowstatus:n.header+", "+n.td+", "+n.icons;var a=function(e,t){t=void 0===t?400:t,s=setTimeout(function(){var t=m.hasClass(e,"datagrid-column-wrapper"),s=!!m.hasClass(e.parentNode,"datagrid-filter-wrapper")&&e.parentNode.querySelectorAll(".popupmenu.is-open").length>0,n=$(e).data("gridtooltip")||i.cacheTooltip(e),a=t?e.parentNode:e,r=i.getOuterWidth(a);n&&(n.forced||n.textwidth>r-35)&&!s&&i.showTooltip(n)},t)},r=function(e,t){t=void 0===t?400:t,clearTimeout(s),setTimeout(function(){i.hideTooltip(),m.hasClass(e.parentNode,"datagrid-filter-wrapper")&&i.removeTooltipData(e)},t)};this.element.off("mouseenter.gridtooltip",n.str).on("mouseenter.gridtooltip",n.str,function(){a(this)}).off("mouseleave.gridtooltip click.gridtooltip",n.str).on("mouseleave.gridtooltip click.gridtooltip",n.str,function(){r(this)}).off("longpress.gridtooltip",n.str).on("longpress.gridtooltip",n.str,function(){a(this,0)}).off("keydown.gridtooltip",n.str).on("keydown.gridtooltip",n.str,function(e){var t=e.which||e.keyCode||e.charCode||0,s=!1;return e.shiftKey&&112===t?a(this,0):27===t&&(s=i.isGridtooltip(),r(this,0)),s&&e.preventDefault(),!s}),this.toolbar&&this.toolbar.parent().find(".table-errors").length>0&&this.toolbar.parent().find(".table-errors").off("mouseenter.tableerrortooltip",".icon").on("mouseenter.tableerrortooltip",".icon",function(){a(this)}).off("mouseleave.tableerrortooltip click.tableerrortooltip",".icon").on("mouseleave.tableerrortooltip click.tableerrortooltip",".icon",function(){r(this)}).off("longpress.tableerrortooltip",".icon").on("longpress.tableerrortooltip",".icon",function(){a(this,0)})}},getOuterWidth:function(e){var t=getComputedStyle(e),i=e.offsetWidth;return i+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10)},closest:function(e,t){return e&&(t(e)?e:this.closest(e.parentNode,t))},headerNodes:function(){return this.headerContainer?this.headerContainer.find("tr:not(.datagrid-header-groups) th"):$()},updateRow:function(e,t){var i=this.settings,s=t;s||(s=i.treeGrid?i.treeDepth[e].node:this.getDataset()[e]);for(var n=0;n<this.settings.columns.length;n++){var a=this.settings.columns[n];a.hidden||this.updateCellNode(e,n,this.fieldValue(s,a.field),!0)}},updateColumns:function(e,t){void 0===t&&(t=null),this.settings.columns=e,t&&(this.settings.columnGroups=t),this.rerender(),this.element.trigger("columnchange",[{type:"updatecolumns",columns:this.settings.columns}]),this.saveUserSettings()},saveUserSettings:function(){this.element.trigger("settingschanged",[{rowHeight:this.settings.rowHeight,columns:this.settings.columns,sortOrder:this.sortColumn,pagesize:this.settings.pagesize,showPageSizeSelector:this.settings.showPageSizeSelector,activePage:this.pagerAPI?this.pagerAPI.activePage:1,filter:this.filterConditions()}]);var e=this.settings.saveUserSettings;!$.isEmptyObject(e)&&this.canUseLocalStorage()&&(e.columns&&(localStorage[this.uniqueId("usersettings-columns")]=this.copyThenStringify(this.settings.columns)),e.rowHeight&&(localStorage[this.uniqueId("usersettings-row-height")]=this.settings.rowHeight),e.sortOrder&&(localStorage[this.uniqueId("usersettings-sort-order")]=JSON.stringify(this.sortColumn)),e.pagesize&&(localStorage[this.uniqueId("usersettings-pagesize")]=this.settings.pagesize),e.showPageSizeSelector&&(localStorage[this.uniqueId("usersettings-show-pagesize-selector")]=this.settings.showPageSizeSelector),e.activePage&&this.pagerAPI&&(localStorage[this.uniqueId("usersettings-active-page")]=this.pagerAPI.activePage),e.filter&&(localStorage[this.uniqueId("usersettings-filter")]=JSON.stringify(this.filterConditions())))},canUseLocalStorage:function(){try{if(localStorage.getItem)return!0}catch(e){return!1}return!1},columnsFromString:function(e,t){if(!e)return[];var i=JSON.parse(e);if(!i)return[];for(var s=0;s<i.length;s++){var n=void 0,a=this.columnById(i[s].id),r=a.width;a&&(n=i[s].hidden,$.extend(i[s],a[0]),void 0!==n?i[s].hidden=n:delete i[s].hidden,t&&(i[s].width=r))}return i},restoreColumns:function(e){if(this.settings.saveColumns&&this.canUseLocalStorage())if(e)this.updateColumns(e);else{var t=localStorage[this.uniqueId("columns")];!e&&t&&(this.originalColumns=this.columnsFromString(this.copyThenStringify(this.settings.columns)),this.settings.columns=this.columnsFromString(t))}},restoreUserSettings:function(e){var t=this.settings.saveUserSettings;if(e||!$.isEmptyObject(t)&&this.canUseLocalStorage())if(e){if(e.columns&&this.updateColumns(e.columns),e.rowHeight&&this.rowHeight(e.rowHeight),e.sortOrder&&this.setSortColumn(e.sortOrder.sortId,e.sortOrder.sortAsc),e.pagesize&&(this.settings.pagesize=parseInt(e.pagesize,10),this.pagerAPI.settings.pagesize=parseInt(e.pagesize,10),e.activePage||this.pagerAPI.setActivePage(1,!0)),e.showPageSizeSelector&&(this.settings.showPageSizeSelector=e.showPageSizeSelector,this.pagerAPI.showPageSizeSelector(e.showPageSizeSelector)),e.filter&&this.applyFilter(e.filter,"restore"),e.activePage){var i=parseInt(e.activePage,10);this.pagerAPI.setActivePage(i,!0),this.restoreActivePage=!0}}else{if(t.columns){var s=localStorage[this.uniqueId("usersettings-columns")];s&&(this.settings.columns=this.columnsFromString(s))}if(t.rowHeight){var n=localStorage[this.uniqueId("usersettings-row-height")];n&&(this.settings.rowHeight=n)}if(t.sortOrder){var a=localStorage[this.uniqueId("usersettings-sort-order")];a&&(this.sortColumn=JSON.parse(a),this.restoreSortOrder=!0)}if(t.pagesize){var r=localStorage[this.uniqueId("usersettings-pagesize")];r&&(this.settings.pagesize=parseInt(r,10))}if(t.showPageSizeSelector){var o=localStorage[this.uniqueId("usersettings-show-pagesize-selector")];(o="true"===o.toString().toLowerCase())&&(this.settings.showPageSizeSelector=o)}if(t.activePage){var l=localStorage[this.uniqueId("usersettings-active-page")];l&&(this.savedActivePage=parseInt(l,10),this.restoreActivePage=!0)}if(t.filter){var d=localStorage[this.uniqueId("usersettings-filter")];d&&(this.savedFilter=JSON.parse(d),this.restoreFilter=!0)}}},copyThenStringify:function(e){if(!e)return JSON.stringify(e);var t=e.map(function(e){var t=m.extend({},e);return t.editorOptions&&delete t.editorOptions,t});return JSON.stringify(t)},resetColumns:function(){if(this.canUseLocalStorage()&&localStorage.removeItem(this.uniqueId("columns")),this.originalColumns){var e=this.columnsFromString(this.copyThenStringify(this.originalColumns),!0),t=this.settings.columnGroups&&this.originalColGroups?this.originalColGroups:null;this.updateColumns(e,t)}this.clearFilter()},hideColumn:function(e){var t=this.columnIdxById(e);if(-1!==t){if(this.settings.columns[t].hidden=!0,this.headerNodes().eq(t).addClass("is-hidden"),this.tableBody.find("> tr > td:nth-child("+(t+1)+")").addClass("is-hidden"),this.headerColGroup.find("col").eq(t).addClass("is-hidden"),this.updateColumnGroup(),this.bodyColGroup&&this.bodyColGroup.find("col").eq(t).addClass("is-hidden"),this.hasColSpans){var i=this.headerContainer.find("th").eq(t).attr("colspan");if(i&&i>0){i-=1;for(var s=0;s<i;s++)t+=i,this.tableBody.find("> tr > td:nth-child("+(t+1)+")").addClass("is-hidden")}}(this.settings.rowTemplate||this.settings.expandableRow)&&this.syncExpandableRowColspan(),this.element.trigger("columnchange",[{type:"hidecolumn",index:t,columns:this.settings.columns}]),this.saveUserSettings()}},syncExpandableRowColspan:function(){var e=this.visibleColumns().length;this.tableBody.find(".datagrid-expandable-row > td").attr("colspan",e)},showColumn:function(e){var t=this.columnIdxById(e);if(-1!==t){if(this.settings.columns[t].hidden=!1,this.headerNodes().eq(t).removeClass("is-hidden"),this.tableBody.find("> tr > td:nth-child("+(t+1)+")").removeClass("is-hidden"),this.headerColGroup.find("col").eq(t).removeClass("is-hidden"),this.bodyColGroup&&this.bodyColGroup.find("col").eq(t).removeClass("is-hidden"),this.updateColumnGroup(),this.hasColSpans){var i=this.headerContainer.find("th").eq(t).attr("colspan");if(i&&i>0){i-=1;for(var s=0;s<i;s++)t+=i,this.tableBody.find("> tr > td:nth-child("+(t+1)+")").removeClass("is-hidden")}}(this.settings.rowTemplate||this.settings.expandableRow)&&this.syncExpandableRowColspan(),this.element.trigger("columnchange",[{type:"showcolumn",index:t,columns:this.settings.columns}]),this.saveUserSettings()}},exportToCsv:function(e,t,i){ks.exportToCsv(e,t,i,this)},exportToExcel:function(e,t,i){ks.exportToExcel(e,t,i,this)},copyToDataSet:function(e,t,i,s){ks.copyToDataSet(e,t,i,s,this)},personalizeColumns:function(){var e=this,t=this,i='<div class="listview-search alternate-bg"><label class="audible" for="gridfilter">Search</label><input class="searchfield" placeholder="'+k.translate("SearchColumnName")+'" name="searchfield" id="gridfilter"></div>';i+='<div class="listview alternate-bg" id="search-listview"><ul></ul></div>',$("body").modal({title:k.translate("PersonalizeColumns"),content:i,cssClass:"full-width datagrid-columns-dialog",buttons:[{text:k.translate("Close"),click:function(e,t){t.close(),$("body").off("open.datagrid")}}]}).on("beforeopen.datagrid",function(){t.isColumnsChanged=!1}).on("open.datagrid",function(i,s){s.element.find(".searchfield").searchfield({clearable:!0}),s.element.find(".listview").listview({source:e.settings.columns,template:'\n          <ul>\n          {{#dataset}}\n            {{#name}}\n            <li>\n              <a href="#" target="_self" tabindex="-1">\n                <label class="inline">\n                  <input tabindex="-1" type="checkbox" class="checkbox" {{^hideable}}disabled{{/hideable}} {{^hidden}}checked{{/hidden}} data-column-id="{{id}}"/>\n                  <span class="label-text">{{name}}</span>\n                </label>\n              </a>\n            </li>\n            {{/name}}\n          {{/dataset}}\n          </ul>',searchable:!0,selectOnFocus:!1,listFilterSettings:{filterMode:"contains",searchableTextCallback:function(e){return e.name}}}).on("selected",function(e,i){var s=i.elem.find(".checkbox"),n=s.attr("data-column-id"),a=s.prop("checked");i.elem.removeClass("is-selected hide-selected-color"),s.is(":disabled")||(t.isColumnsChanged=!0,a?(t.hideColumn(n),s.prop("checked",!1)):(t.showColumn(n),s.prop("checked",!0)))}),s.element.on("close.datagrid",function(){t.isColumnsChanged=!1}),s.element.on("keydown.datagrid",function(e){27===e.keyCode&&(s.close(),$("body").off("open.datagrid"))})})},setColumnWidth:function(e,t){var i=parseFloat(t),s=this.columnById(e)[0],n=-1;i&&("string"==typeof e&&this.headerNodes().each(function(t){$(this).attr("data-column-id")===e&&(n=t)}),"number"!=typeof t&&(t=i/100*this.element.width()),Math.abs(t-s.width)<2||("number"==typeof s.colspan&&(t/=s.colspan),s&&(s.width=t),this.element.trigger("columnchange",[{type:"resizecolumn",index:n,columns:this.settings.columns}]),this.saveUserSettings(),this.headerWidths[n].width=t))},isEllipsisActiveHeader:function(e){return(void 0===(e=e||{}).sortable||e.sortable)&&"ellipsis"===e.textOverflow},activeEllipsisHeaderAll:function(){for(var e=0,t=this.settings.columns.length;e<t;e++){var i=this.settings.columns[e].id,s=this.columnById(i)[0];if(this.isEllipsisActiveHeader(s)){var n=this.headerContainer[0].querySelector('th[data-column-id="'+i+'"]');this.activeEllipsisHeader(n)}}},activeEllipsisHeader:function(e){if(e){var t=e.querySelector(".datagrid-column-wrapper .datagrid-header-text"),i=e.scrollWidth<t.scrollWidth+65;e.classList[i?"add":"remove"]("is-ellipsis-active")}},resizeColumnWidth:function(e,t,i){var s=e.index();this.headerColGroup.find("col").eq(s)[0].style.width=t+"px",this.settings.dataset.length>0&&(this.bodyColGroup.find("col").eq(s)[0].style.width=t+"px"),this.tableWidth&&i&&(this.headerTable.css("width",parseInt(this.tableWidth,10)+i),this.table.css("width",parseInt(this.tableWidth,10)+i),this.headerWidths[s].widthPercent=!1)},createResizeHandle:function(){var e=this;if(!this.resizeHandle){this.resizeHandle=$('<div class="resize-handle" aria-hidden="true"></div>'),this.settings.columnGroups&&(this.resizeHandle[0].style.height="80px"),this.settings.filterable&&(this.resizeHandle[0].style.height="62px"),this.headerContainerCenter.find("table").before(this.resizeHandle);var t=void 0,i=void 0,s=void 0,n=void 0,a=void 0;this.resizeHandle.drag({axis:"x",containment:this.element}).on("dragstart.datagrid",function(){e.currentHeader&&(e.dragging=!0,t=e.currentHeader.attr("data-column-id"),a=e.columnById(t)[0],i=e.currentHeader.position().left+(e.table.scrollLeft()-10),e.tableWidth=e.table[0].offsetWidth,n=e.currentHeader[0].offsetWidth,e.isEllipsisActiveHeader(a)&&e.currentHeader[0].classList.add("is-ellipsis-active"))}).on("drag.datagrid",function(t,r){if(e.currentHeader&&a){var o=r.left-i-1,l=a.minWidth||12,d=a.maxWidth||1e3;o<l||o>d?e.resizeHandle.css("cursor","inherit"):(o=Math.round(o),s=r.left,e.resizeColumnWidth(e.currentHeader,o,o-n))}}).on("dragend.datagrid",function(){var t=s-i-1;e.dragging=!1,e.setColumnWidth(e.currentHeader.attr("data-column-id"),t),e.isEllipsisActiveHeader(a)&&e.activeEllipsisHeader(e.currentHeader[0])})}},displayCounts:function(e){var t=this.tableBody.find("tr:visible").length,i=0,s="",a=function(e){return k.formatNumber(e,{style:"integer"})};!(this.settings.paging&&!this.settings.source)&&e||(this.recordCount=this.settings.dataset.length,t=this.settings.dataset.length),this.settings.groupable&&(i=t,t=this.originalDataset.length,s=(s="({0} "+k.translate(1===i?"Group":"Groups")+")").replace("{0}",a(i))),this.contextualToolbar&&this.contextualToolbar.length&&this.contextualToolbar.find(".selection-count").text(this._selectedRows.length+" "+k.translate("Selected")),e&&-1!==e&&(t=e),void 0===e&&this.settings.source&&(t=this.lastCount||0);var r=void 0;if(r=this.settings.showFilterTotal&&this.filteredCount>0?(r=(r="("+k.translate(1===t?"ResultOf":"ResultsOf")+")").replace("{0}",a(t-this.filteredCount))).replace("{1}",a(t)):(r="({0} "+k.translate(1===t?"Result":"Results")+")").replace("{0}",a(t)),this.settings.resultsText)if("function"==typeof this.settings.resultsText)if(this.grandTotal)r=this.settings.resultsText(this,this.grandTotal,t);else{var o=0===this.filteredCount?0:t-this.filteredCount;r=this.settings.resultsText(this,t,o)}else r=this.settings.resultsText;this.toolbar&&(n.html(this.toolbar.find(".datagrid-result-count"),r,"<span>"),n.html(this.toolbar.find(".datagrid-group-count"),s,"<span>"),this.toolbar[0].setAttribute("aria-label",this.toolbar.find(".title").text()),this.toolbar.find(".datagrid-row-count").text(t)),n.html(this.element.closest(".modal").find(".datagrid-result-count"),r,"<span>"),this.lastCount=t,this.checkEmptyMessage()},setEmptyMessage:function(e){this.emptyMessage?(this.emptyMessage.settings=e,this.emptyMessage.updated()):(this.emptyMessageContainer=$("<div>"),this.bodyContainer.before(this.emptyMessageContainer),this.emptyMessage=this.emptyMessageContainer.emptymessage(e).data("emptymessage"),this.checkEmptyMessage())},checkEmptyMessage:function(){this.emptyMessage&&this.emptyMessageContainer&&(this.filteredCount===this.recordCount||0===this.recordCount?(this.emptyMessageContainer.show(),this.element.addClass("is-empty")):(this.emptyMessageContainer.hide(),this.element.removeClass("is-empty")))},triggerRowEvent:function(e,t,i){var s=$(t.target).closest("td").index(),n=$(t.target).closest("tr"),a=this.settings.treeGrid?this.actualRowIndex(n):this.dataRowIndex(n),r=!0;$(t.target).is("a")&&(i=!1),i&&(t.stopPropagation(),t.preventDefault());var o=this.settings.dataset[a];return this.settings.groupable&&(n.is(".datagrid-rowgroup-header, .datagrid-rowgroup-footer")?r=!1:(a=this.actualPagingRowIndex(this.actualRowIndex(n)),(o=this.settings.dataset[this.groupArray[a].group])&&o.values&&(o=o.values[this.groupArray[a].node]))),r&&this.element.trigger(e,[{row:a,cell:s,item:o,originalEvent:t}]),!1},handleScrollX:function(){var e=this.bodyWrapperCenter[0].scrollLeft;e!==this.scrollLeft&&this.headerContainerCenter&&(this.scrollLeft=e,this.headerContainerCenter[0].scrollLeft=this.scrollLeft)},handleScrollY:function(e){var t=e.currentTarget.scrollTop;t!==this.scrollTop&&this.bodyWrapperCenter&&(this.bodyWrapperLeft||this.bodyWrapperRight)&&(this.scrollTop=t,this.bodyWrapperLeft&&(this.bodyWrapperLeft[0].scrollTop=this.scrollTop),this.bodyWrapperRight&&(this.bodyWrapperRight[0].scrollTop=this.scrollTop),this.bodyWrapperCenter[0].scrollTop=this.scrollTop)},rerender:function(){this.clearHeaderCache(),this.renderRows(),this.renderHeader()},handleEvents:function(){var e=this,t=this,i="multiple"===this.settings.selectable,s="mixed"===this.settings.selectable;if(!t.settings.cellNavigation&&t.settings.rowNavigation&&t.bodyContainer.on("focus.datagrid","tbody > tr",function(){$(this).addClass("is-active-row")}).on("blur.datagrid","tbody > tr",function(){$("tbody > tr",t.table).removeClass("is-active-row")}),this.settings.paging&&(this.element.on("afterpaging.datagrid",function(e,i){t.pagerAPI.hidePagerBar(i)?t.element.removeClass("paginated"):t.element.addClass("paginated"),t.recordCount=i.total,t.displayCounts(i.total),t.syncSelectedUI(),t.filterExpr&&t.filterExpr[0]&&"all"===t.filterExpr[0].column&&t.highlightSearchRows(t.filterExpr[0].value)}),this.tableBody.on("page.datagrid",function(i,s){"filtered"===s.type&&e.settings.source||(t.saveUserSettings(),t.render(null,s))}).on("pagesizechange.datagrid",function(e,i){t.render(null,i)})),t.settings.showHoverState&&t.bodyContainer.off("mouseenter.datagrid, mouseleave.datagrid").on("mouseenter.datagrid","tbody > tr",function(){t.rowNodes($(this)).addClass("is-hover-row")}).on("mouseleave.datagrid","tbody > tr",function(){t.rowNodes($(this)).removeClass("is-hover-row")}),t.bodyContainer.find(".datagrid-body").on("scroll.table",function(e){t.handleScrollY(e)}),(this.hasLeftPane||this.hasRightPane)&&t.bodyContainer.find(".datagrid-body").on("wheel.table",function(e){0!==e.originalEvent.deltaY&&(e.currentTarget.scrollTop+=e.originalEvent.deltaY,e.preventDefault(),t.handleScrollY(e))}),t.bodyContainer.find(".datagrid-body.scroll-x").on("scroll.tablex",function(e){t.handleScrollX(e)}),this.settings.virtualized){var n=0,a=0;t.bodyWrapperCenter.on("scroll.vtable",r(function(){var e=this.scrollTop,i=e>t.virtualRange.bottom-t.virtualRange.bodyHeight-25,s=e<t.virtualRange.top+25;e!==n&&(s||i)&&(n=this.scrollTop,t.renderRows())},0)),$("body").on("resize.vtable",function(){this.offsetHeight!==a&&(a=this.scrollTop,t.renderRows())})}this.headerContainer.off("click.datagrid-header").on("click.datagrid-header",".datagrid-header th.is-sortable, .datagrid-header th.btn-filter",function(e){$(e.target).parent().is(".datagrid-filter-wrapper")||$(e.target).parent().is(".lookup-wrapper")||t.setSortColumn($(this).attr("data-column-id"))}),this.element.off("click.datagrid").on("click.datagrid","tbody .datagrid-row a",function(e){var t=e.currentTarget.getAttribute("href");t&&"#"!==t||e.preventDefault()}),t.settings.editable&&this.element.off("paste.datagrid").on("paste.datagrid",function(e){var i=void 0;i=e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData?e.originalEvent.clipboardData.getData("text/plain"):!(!window.clipboardData||!window.clipboardData.getData)&&window.clipboardData.getData("Text");var s=/\n/.exec(i),n=/\r/.exec(i),a=/\r\n/.exec(i);if((!t.activeCell||!t.activeCell.node.hasClass("is-readonly"))&&(i&&n||s||a)){var r=s?i.split("\n"):i.split("\r");a&&(r=i.split("\r\n")),r.pop();var o=parseInt($(e.target)[0].parentElement.parentElement.parentElement.getAttribute("data-index"),10),l=parseInt($(e.target)[0].parentElement.parentElement.getAttribute("aria-colindex"),10)-1;t.editor&&t.editor.input&&t.commitCellEdit(),t.copyToDataSet(r,o,l,t.settings.dataset)}}),this.element.off("click.datagrid").on("click.datagrid","tbody td",function(e){var n=null,a=null,r=$(e.target);if(!$(e.currentTarget).parent().hasClass(".datagrid-row-detail")){if(r.parents("td").length>1&&(e.preventDefault(),e.stopPropagation()),t.triggerRowEvent("click",e,!0),t.setActiveCell(r.closest("td")),r.is(".datagrid-expand-btn"))return n=$(this).closest("tr"),a=t.actualRowIndex(n),t.toggleRowDetail(a),t.toggleGroupChildren(n),t.toggleChildren(e,a),!1;var o=r.is(".datagrid-selection-checkbox")||1===r.find(".datagrid-selection-checkbox").length,l=!!t.settings.clickToSelect||o;r.is(".datagrid-drilldown")&&(l=!1),s&&((l=o)||(e.shiftKey&&t.activatedRow().length&&(t.selectRowsBetweenIndexes([t.activatedRow()[0].row,r.closest("tr").index()]),e.preventDefault()),t.toggleRowActivation(r.closest("tr")))),l&&i&&e.shiftKey?(t.selectRowsBetweenIndexes([t.lastSelectedRow,r.closest("tr").index()]),e.preventDefault()):l&&t.toggleRowSelection(r.closest("tr"));var d=t.makeCellEditable(t.activeCell.rowIndex,t.activeCell.cell,e),c=$(this).closest("td"),h=c.attr("aria-colindex")-1,u=t.columnSettings(h);if(u.click&&"function"==typeof u.click&&r.is("button, input[checkbox], a")||r.parent().is("button")){var p=$(this).closest("tr"),g=t.actualRowIndex(p);a=t.dataRowIndex(p);var f=t.settings.treeGrid?t.settings.treeDepth[g].node:t.settings.dataset[a];if(c.hasClass("is-focusable")&&!r.is(t.buttonSelector)&&!r.parent("button").is(t.buttonSelector))return;t.settings.groupable&&(p.is(".datagrid-rowgroup-header, .datagrid-rowgroup-footer")||(g=t.actualPagingRowIndex(t.actualRowIndex(p)),(f=t.settings.dataset[t.groupArray[g].group])&&f.values&&(f=f.values[t.groupArray[g].node]))),(!c.hasClass("is-cell-readonly")&&r.is("button, input[checkbox], a")||r.parent().is("button"))&&u.click(e,[{row:g,cell:t.activeCell.cell,item:f,originalEvent:e}])}if(u.menuId){t.closePrevPopupmenu();var m=$(this).find("button");m.popupmenu({attachToBody:!0,autoFocus:!1,mouseFocus:!0,menuId:u.menuId,trigger:"immediate",offset:{y:5}}).off("close.gridpopupbtn").on("close.gridpopupbtn",function(){var e=$(this);e.data("popupmenu")&&!e.data("tooltip")&&e.data("popupmenu").destroy()}),u.selected&&m.off("selected.gridpopupbtn").on("selected.gridpopupbtn",u.selected)}d&&setTimeout(function(){$("textarea, input",c).length&&!$(".dropdown,[type=file],[type=image],[type=button],[type=submit],[type=reset],[type=checkbox],[type=radio]",c).length&&(t.quickEditMode=!0)},0)}}),"last"!==this.stretchColumn&&$(window).on("orientationchange.datagrid",function(){e.rerender()}),this.element.off("dblclick.datagrid").on("dblclick.datagrid","tbody tr",function(e){t.triggerRowEvent("dblclick",e,!0)}),this.element.off("contextmenu.datagrid").on("contextmenu.datagrid","tbody tr",function(e){var i=function(){return t.settings.menuId&&$("#"+t.settings.menuId).length>0};return t.triggerRowEvent("contextmenu",e,!!t.settings.menuId),!t.isSubscribedTo(e,"contextmenu")&&!i()||(e.preventDefault(),t.closePrevPopupmenu(),!i()||($(e.currentTarget).popupmenu({menuId:t.settings.menuId,eventObj:e,beforeOpen:t.settings.menuBeforeOpen,attachToBody:!0,trigger:"immediate"}).off("selected.gridpopuptr").on("selected.gridpopuptr",function(e,i){t.settings.menuSelected&&t.settings.menuSelected(e,i)}).off("close.gridpopuptr").on("close.gridpopuptr",function(){var e=$(this);e.data("popupmenu")&&e.data("popupmenu").destroy()}),!1))}),this.headerRow.off("mousemove.datagrid").on("mousemove.datagrid","th",function(e){if(!t.dragging&&(t.currentHeader=$(e.target).closest("th"),t.currentHeader.hasClass("is-resizable"))){var i=t.currentHeader.closest(".header-detail"),s=i.length?parseInt(i.css("margin-left"),10):0,n=parseInt(t.currentHeader.position().left,10)-(s||0)+t.element.scrollLeft(),a=n+t.currentHeader.outerWidth(),r=e.pageX-n>a-e.pageX,o=0;o=r?a-6:n-6,0!==t.currentHeader.index()||r||(o="-999"),r||(t.currentHeader=t.currentHeader.prevAll(":visible").not(".is-hidden").first()),t.currentHeader.hasClass("is-resizable")&&(t.createResizeHandle(),t.resizeHandle[0].style.left=o+"px",t.resizeHandle[0].style.cursor="")}}).off("contextmenu.datagrid").on("contextmenu.datagrid","th",function(e){return!t.settings.headerMenuId||(e.preventDefault(),t.closePrevPopupmenu(),$(e.currentTarget).popupmenu({menuId:t.settings.headerMenuId,eventObj:e,attachToBody:!0,beforeOpen:t.settings.headerMenuBeforeOpen,trigger:"immediate"}).off("selected.gridpopupth").on("selected.gridpopupth",function(e,i){t.settings.headerMenuSelected(e,i)}).off("close.gridpopupth").on("close.gridpopupth",function(){var e=$(this);e.data("popupmenu")&&e.data("popupmenu").destroy()}),!1)}),this.headerContainer.off("click.datagrid-header-select").on("click.datagrid-header-select","th .datagrid-checkbox",function(){var e=$(this);e.hasClass("is-checked")?(e.removeClass("is-checked").attr("aria-checked","false"),t.unSelectAllRows()):(e.addClass("is-checked").attr("aria-checked","true"),t.selectAllRows())}),this.element.off("focusout.datagrid").on("focusout.datagrid","tbody td input, tbody td textarea, tbody div.dropdown",function(e){var i=e.target;$(i).is("input.lookup, input.timepicker, input.datepicker, input.spinbox, input.colorpicker")?setTimeout(function(){var e=$("*:focus");if(!$(".lookup-modal.is-visible, #timepicker-popup, #monthview-popup, #colorpicker-menu").length&&t.editor){if(e.is(".spinbox, .trigger, .code-block-actions")||!$(i).is(":visible"))return;if(e&&t.editor.className&&e.closest(t.editor.className).length>0)return;t.commitCellEdit()}},150):$("#dropdown-list, .autocomplete.popupmenu.is-open, #timepicker-popup, .is-editing .code-block").is(":visible")||t.editor&&t.editor.input&&t.commitCellEdit()})},closePrevPopupmenu:function(){[].slice.call(this.element[0].querySelectorAll(".is-open:not(.popupmenu)")).forEach(function(e){var t=$(e);t.data("popupmenu")&&t.trigger("close")})},isSubscribedTo:function(e,t){var i=$._data(this.element[0]).events;for(var s in i)if(s===t&&(1!==i[s].length||"datagrid"!==i[s][0].namespace))return!0;return!1},refreshSelectedRowHeight:function(){var e=this.element.parent().find(".toolbar:not(.contextual-toolbar)"),t=e.find('[data-option="row-short"]'),i=e.find('[data-option="row-medium"]'),s=e.find('[data-option="row-normal"]');"short"===this.settings.rowHeight&&(t.parent().addClass("is-checked"),i.parent().removeClass("is-checked"),s.parent().removeClass("is-checked")),"medium"===this.settings.rowHeight&&(t.parent().removeClass("is-checked"),i.parent().addClass("is-checked"),s.parent().removeClass("is-checked")),"normal"===this.settings.rowHeight&&(t.parent().removeClass("is-checked"),i.parent().removeClass("is-checked"),s.parent().addClass("is-checked")),$(".drag-target-arrows",this.element).css("height",this.getTargetHeight()+"px")},appendToolbar:function(){var e=null,t="",i=null,s=this;if(this.settings.toolbar){if(1===this.element.parent().find(".toolbar:not(.contextual-toolbar)").length)e=this.element.parent().find(".toolbar:not(.contextual-toolbar)"),this.refreshSelectedRowHeight();else{e=$('<div class="toolbar" role="toolbar"></div>'),this.removeToolbarOnDestroy=!0,this.settings.toolbar.title&&(t=$('<div class="title">'+this.settings.toolbar.title+"  </div>")),t||(t=e.find(".title")),e.append(t),this.settings.toolbar.results&&t.append('<span class="datagrid-result-count"></span>');var n=$('<div class="buttonset"></div>').appendTo(e);if(this.settings.toolbar.keywordFilter){var a=$('<label class="audible" for="gridfilter">'+k.translate("Keyword")+"</label>"),r=$('<input class="searchfield" name="searchfield" placeholder="'+k.translate("Keyword")+'" id="gridfilter">');n.append(a),this.settings.toolbar.collapsibleFilter||r.attr("data-options",'{ "collapsible": false }'),n.append(r)}this.settings.toolbar.dateFilter&&n.append('<button class="btn" type="button">'+$.createIcon({icon:"calendar"})+"<span>"+k.translate("Date")+"</span></button>"),this.settings.toolbar.actions&&((i=$('<div class="more"></div>').insertAfter(n)).append('<button class="btn-actions" title="More" type="button">'+$.createIcon({icon:"more"})+'<span class="audible">Grid Features</span></button>'),e.addClass("has-more-button"));var o=$('<ul class="popupmenu"></ul>');this.settings.toolbar.personalize&&o.append('<li><a href="#" data-option="personalize-columns">'+k.translate("PersonalizeColumns")+"</a></li>"),this.settings.toolbar.resetLayout&&o.append('<li><a href="#" data-option="reset-layout">'+k.translate("ResetDefault")+"</a></li>"),this.settings.toolbar.exportToExcel&&o.append('<li><a href="#" data-option="export-to-excel">'+k.translate("ExportToExcel")+"</a></li>"),this.settings.toolbar.advancedFilter&&o.append('<li><a href="#">'+k.translate("AdvancedFilter")+"</a></li>"),this.settings.toolbar.views&&o.append('<li><a href="#">'+k.translate("SaveCurrentView")+'</a></li> <li class="separator"></li> <li class="heading">'+k.translate("SavedViews")+'</li><li><a href="#">View One</a></li>'),this.settings.toolbar.rowHeight&&o.append('<li class="separator single-selectable-section"></li><li class="heading">'+k.translate("RowHeight")+'</li><li class="is-selectable'+("short"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-short">'+k.translate("Short")+'</a></li><li class="is-selectable'+("medium"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-medium">'+k.translate("Medium")+'</a></li><li class="is-selectable'+("normal"===this.settings.rowHeight?" is-checked":"")+'"><a data-option="row-normal">'+k.translate("Normal")+"</a></li>"),this.settings.toolbar.filterRow&&o.append('<li class="separator"></li><li class="heading">'+k.translate("Filter")+'</li><li class="'+(this.settings.filterable?"is-checked ":"")+'is-toggleable"><a data-option="show-filter-row">'+k.translate("ShowFilterRow")+'</a></li><li class="is-indented"><a data-option="run-filter">'+k.translate("RunFilter")+'</a></li><li class="is-indented"><a data-option="clear-filter">'+k.translate("ClearFilter")+"</a></li>"),this.settings.toolbar.actions&&i.append(o),this.element.prev().is(".contextual-toolbar")?this.element.prev().before(e):this.element.before(e)}if(e.find(".btn-actions").popupmenu().on("selected",function(e,t){var i=t.attr("data-option");"row-short"!==i&&"row-medium"!==i&&"row-normal"!==i||s.rowHeight(i.substr(4)),"personalize-columns"===i&&s.personalizeColumns(),"reset-layout"===i&&s.resetColumns(),"export-to-excel"===i&&s.exportToCsv(),"show-filter-row"===i&&s.toggleFilterRow(),"run-filter"===i&&s.applyFilter(null,"menu"),"clear-filter"===i&&s.clearFilter()}),this.settings.initializeToolbar&&!e.data("toolbar")){var l=$.fn.parseOptions(e);this.settings.toolbar.fullWidth&&(l.rightAligned=!0),e.toolbar(l)}if(this.settings.toolbar&&this.settings.toolbar.keywordFilter){var d=e.find(".searchfield"),c=d.parent().find(".close.icon");d.off("keypress.datagrid").on("keypress.datagrid",function(e){13!==e.keyCode&&"change"!==e.type||(e.preventDefault(),s.keywordSearch(d.val()))}),c.off("click.datagrid").on("click.datagrid",function(){s.keywordSearch(d.val())})}if(this.settings.toolbar&&this.settings.toolbar.contextualToolbar){this.element.before('\n        <div class="contextual-toolbar datagrid-contextual-toolbar toolbar is-hidden">\n          <div class="title selection-count">1 Selected</div>\n        </div>'),this.contextualToolbar=this.element.prev(".contextual-toolbar")}this.toolbar=e,this.element.addClass("has-toolbar")}},rowHeight:function(e){return e&&(this.settings.rowHeight=e),this.element.add(this.table).add(this.tableLeft).add(this.tableRight).removeClass("short-rowheight medium-rowheight normal-rowheight").addClass(this.settings.rowHeight+"-rowheight"),this.virtualRange&&this.virtualRange.rowHeight&&(this.virtualRange.rowHeight="normal"===e?40:"medium"===e?30:25),this.saveUserSettings(),this.refreshSelectedRowHeight(),this.settings.rowHeight},keywordSearch:function(e){this.bodyContainer.find('tr[role="row"]').removeClass("is-filtered").show(),this.filterExpr=[],this.bodyContainer.find(".datagrid-expandable-row").each(function(){var e=$(this);e.prev().find(".datagrid-expand-btn").removeClass("is-expanded"),e.prev().find(".plus-minus").removeClass("active"),e.removeClass("is-expanded").css("display",""),e.find(".datagrid-row-detail").css("height","")}),this.bodyContainer.find(".search-mode").each(function(){var e=$(this),t=e.text();e.text(t.replace("<i>","").replace("</i>",""))}),e=(e||"").toLowerCase(),this.filterExpr.push({column:"all",operator:"contains",value:e,keywordSearch:!0}),this.filterKeywordSearch(),this.renderRows(),this.setSearchActivePage({trigger:"searched"}),this.settings.paging||this.highlightSearchRows(e)},setSearchActivePage:function(e){if(this.pagerAPI){var t=this;e||(e={}),this.filterExpr&&1===this.filterExpr.length?""!==this.filterExpr[0].value?e.activePage=this.pagerAPI.filteredActivePage||1:""===this.filterExpr[0].value&&this.pagerAPI.filteredActivePage&&(e=i(e)):this.restoreActivePage||(e=i(e),this.restoreActivePage=!1),e.activePage=this.activePage,this.renderPager(e)}function i(e){return e.activePage=1,t.grandTotal&&(e.grandTotal=t.grandTotal),e}},filterKeywordSearch:function(){var e=this,t=void 0,i=void 0,s=void 0,n=void 0,a=e.filterExpr,r=function(t,i){var s=!1,n=function(s){var n=e.columnById(s)[0],r=e.fieldValue(t,n.field),o=e.settings.columns.indexOf(n);return e.formatValue(n.formatter,i,o,r,n,t,e).toLowerCase().replace(/(<([^>]+)>)|(amp;)|(&lt;([^>]+)&gt;)/gi,"").indexOf(a.value)>-1};return"all"===a.column?e.headerContainer.find("th:visible").each(function(){var e=$(this).attr("data-column-id");if(s=n(e))return!1}):a.columnId&&(s=n(a.columnId)),s};if(a&&1===a.length)if(a=a[0],e.settings.treeGrid)for(s=0,n=(t=e.settings.treeDepth).length;s<n;s++)i=""!==a.value&&!r(t[s].node,s),t[s].node.isFiltered=i;else for(s=0,n=(t=e.settings.dataset).length;s<n;s++)i=""!==a.value&&!r(t[s],s),t[s].isFiltered=i},highlightSearchRows:function(e){var t=this,i=this;if(e&&""!==e){i.tableBody.find("tr").toArray().forEach(function(a){var r=i.rowNodes(a.getAttribute("aria-rowindex")-1),o=function(a){var r=!1;return a.toArray().forEach(function(a){[].slice.call(a.querySelectorAll("td")).forEach(function(a){var o=a.innerText.toLowerCase(),l=!!i.settings.searchExpandableRow||!n.hasClass(t,"datagrid-expandable-row");o.indexOf(e)>-1&&l&&(r=!0,[].slice.call(a.querySelectorAll("*")).forEach(function(t){if(s.unescapeHTML(t.innerHTML)===t.textContent){var i=t.textContent,a=new RegExp("("+w.escapeRegExp(e)+")","gi");n.addClass(t,"search-mode"),n.html(t,i.replace(a,"<i>$1</i>"))}}))})}),r}(r);o||r.find(".datagrid-row-detail").length?i.settings.searchExpandableRow&&o&&r.is(".datagrid-expandable-row")&&""!==e&&(r.prev().show(),r.prev().find(".datagrid-expand-btn").addClass("is-expanded"),r.prev().find(".plus-minus").addClass("active"),r.addClass("is-expanded").css("display","table-row"),r.find(".datagrid-row-detail").css("height","auto")):r.addClass("is-filtered").hide()})}},getDataset:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset;return e.groupable&&(t=this.originalDataset),t},selectAllRows:function(){for(var e=[],t=this.getDataset(),i=0,s=t.length;i<s;i++){var n=this.settings.groupable?i:this.pagingRowIndex(i);(this.filterRowRendered||this.filterExpr&&this.filterExpr[0]&&this.filterExpr[0].keywordSearch)&&t[i].isFiltered||e.push(n)}this.dontSyncUi=!0,this.selectRows(e,!0,!0),this.dontSyncUi=!1,this.syncSelectedUI(),this.element.triggerHandler("selected",[this._selectedRows,"selectall"])},deSelectAllRows:function(){this.unSelectAllRows()},unSelectAllRows:function(){if(this._selectedRows&&0!==this._selectedRows.length){this.dontSyncUi=!0;for(var e=this._selectedRows.length-1;e>=0;e--){var t=this.settings.groupable?this._selectedRows[e].idx:this.pagingRowIndex(this._selectedRows[e].idx);this.unselectRow(t,!0,!0)}this.dontSyncUi=!1,this.syncSelectedUI(),this.element.triggerHandler("selected",[this._selectedRows,"deselectall"])}},isRowSelected:function(e){return!!e&&!0===e._selected},selectNode:function(e,t,i,s){var n=null,a="is-selected"+("mixed"===this.settings.selectable?" hide-selected-color":"");(i&&!this.isRowSelected(i)||s)&&(n=e.find(".datagrid-selection-checkbox").closest("td"),e.addClass(a).attr("aria-selected","true"),n.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked").attr("aria-checked","true").attr("aria-selected","true").attr("aria-label","Selected"),i&&(i._selected=!0))},selectRow:function(e,t,i){var s=null,n=void 0,a=this,r=this.settings;if(void 0!==e&&-1!==e&&r.selectable&&!this.isRowDisabled(e)&&(s=this.settings.groupable?this.rowNodesByDataIndex(e):this.rowNodes(e),n=this.dataRowIndex(s),isNaN(n)&&(n=e),s&&(s.length||!r.source))){if("function"==typeof r.onBeforeSelect&&!i)if(!1===r.onBeforeSelect({node:s,idx:n}))return;if("single"===r.selectable){var o=-1;this._selectedRows.length>0?o=this._selectedRows[0].pagingIdx:s[0]&&s[0].classList.contains("is-selected")&&(o=n),-1!==o&&this.unselectRow(o,!0,!0)}if(!s.hasClass("is-selected")){var l=void 0;if(r.treeGrid){if(s.is(".datagrid-tree-parent")&&"multiple"===r.selectable)s.add(s.nextUntil('[aria-level="1"]')).each(function(e){var t=$(this),i=t.attr("aria-rowindex")-1,s=a.actualPagingRowIndex(i),n=r.treeDepth[s].node;(r.selectChildren||!r.selectChildren&&0===e)&&a.selectNode(t,i,n)});else if("siblings"===r.selectable){this.unSelectAllRows();var d=s.attr("aria-level"),c=s.nextUntil('[aria-level!="'+d+'"]'),h=s.prevUntil('[aria-level!="'+d+'"]');"1"===d&&(c=s.parent().find('[aria-level="1"]'),h=null),s.add(c).add(h).each(function(e){var t=$(this),i=t.attr("aria-rowindex")-1,s=a.actualPagingRowIndex(i),n=r.treeDepth[s].node;(r.selectChildren||!r.selectChildren&&0===e)&&a.selectNode(t,i,n)})}else l=r.treeDepth[a.pagerAPI&&r.source?s.index():e].node,a.selectNode(s,e,l);a.setNodeStatus(s)}else{if(l=r.dataset[n],r.groupable){var u=a.actualPagingRowIndex(a.actualRowIndex(s));if(isNaN(u))return;var p=a.groupArray[u];l=a.settings.dataset[p.group].values[p.node],this._selectedRows.push({idx:l.idx,data:l,elem:s,group:r.dataset[a.groupArray[u].group]})}a.selectNode(s,n,l),a.lastSelectedRow=e}if(!r.groupable){var g=a.actualPagingRowIndex(e);-1===g&&(g=e),this._selectedRows.push({idx:g,data:l,elem:a.visualRowNode(g),page:this.pagerAPI?this.pagerAPI.activePage:1,pagingIdx:e,pagesize:this.settings.pagesize})}}t||a.syncSelectedUI(),i||this.element.triggerHandler("selected",[this._selectedRows,"select"])}},selectRowsBetweenIndexes:function(e){e.sort(function(e,t){return e-t});for(var t=e[0];t<=e[1];t++)this.selectRow(t);this.displayCounts()},syncHeaderCheckbox:function(e){if(0!==this.headerNodes().length){var t=this.headerNodes().find(".datagrid-checkbox"),i=e.length,s=this._selectedRows.length,n=t.data("selected");s!==i&&s>0&&"partial"===n||s===i&&"all"===n&&0!==s||0===s&&"none"===n||(s>0&&t.data("selected","partial").addClass("is-checked is-partial"),s===i&&t.data("selected","all").addClass("is-checked").removeClass("is-partial"),0===s&&t.data("selected","none").removeClass("is-checked is-partial"))}},syncSelectedRows:function(){for(var e=null,t=0;t<this._selectedRows.length;t++){if(this.pagerAPI&&this._selectedRows[t].page===this.pagerAPI.activePage){e=this._selectedRows[t].idx;var i=this.visualRowNode(e);i[0]&&(this._selectedRows[t].elem=i,this.selectNode(i,e,this.settings.dataset[e],!0))}e=this._selectedRows[t].pagingIdx,this._selectedRows[t].pagesize!==this.settings.pagesize&&this.settings.dataset[e]&&(this.selectNode(this.visualRowNode(e),e,this.settings.dataset[e],!0),this._selectedRows[t].pagesize=this.settings.pagesize,this._selectedRows[t].idx=e,this._selectedRows[t].page=this.pagerAPI.activePage),this._selectedRows[t].pagesize===this.settings.pagesize||this.settings.dataset[e]||(this._selectedRows[t].idx=e%this.settings.pagesize,this._selectedRows[t].page=Math.round(e/this.settings.pagesize)+1,this._selectedRows[t].pagesize=this.settings.pagesize)}},calculatePagerInfo:function(e,t,i){for(var s=this.settings,n=t||s.treeGrid?s.treeDepth:s.dataset,a={idx:e,page:1,pagesize:i="number"==typeof i&&i>0?i:s.pagesize,numOfPages:Math.ceil(n.length/i)},r=0;r<a.numOfPages;r++){if(e>=(a.page-1)*a.pagesize&&e<a.page*a.pagesize){a.pagingIdx=e-a.pagesize*r;break}a.page++}return a},syncSelectedRowsIdx:function(){if(0!==this._selectedRows.length&&0!==this.settings.dataset.length){this._selectedRows=[];for(var e=0;e<this.settings.dataset.length;e++)if(this.settings.dataset[e]._selected){var t=this.calculatePagerInfo(e);this._selectedRows.push({idx:e,data:this.settings.dataset[e],elem:this.dataRowNode(e),page:t.page,pagingIdx:e,pagesize:this.settings.pagesize})}}},syncSelectedUI:function(){var e=this.getDataset(),t=e;if(this.filterRowRendered){t=[];for(var i=0,s=e.length;i<s;i++)e[i].isFiltered||t.push(i)}this.syncHeaderCheckbox(t),1!==this.contextualToolbar.length||this.dontSyncUi||(0===this._selectedRows.length&&this.contextualToolbar.animateClosed(),this._selectedRows.length>0&&0===this.contextualToolbar.height()&&this.contextualToolbar.css("display","block").one("animateopencomplete.datagrid",function(){$(this).triggerHandler("recalculate-buttons")}).animateOpen())},activateRow:function(e){this.activatedRow()[0].row!==e&&this.toggleRowActivation(e)},deactivateRow:function(){var e=this.activatedRow()[0].row;e>=0&&this.toggleRowActivation(e)},activatedRow:function(){var e=[{row:-1,item:void 0,elem:void 0}];if(this.tableBody){var t=this.settings,i=t.treeGrid?t.treeDepth:t.dataset,s=this.tableBody.find("tr.is-rowactivated");if(s.length){var n=this.dataRowIndex(s),a=t.indeterminate?n:this.actualRowIndex(s);e=[{row:a,item:i[a],elem:s}]}else{e=null;for(var r=0;r<i.length;r++)if(i[r]._rowactivated){e=[{row:r,item:i[r],elem:void 0}];break}null===e&&(e=[{row:-1,item:void 0,elem:s}])}}return e},toggleRowActivation:function(e){var t=this.settings,i=t.treeGrid?t.treeDepth:t.dataset,s=void 0,n=void 0,a=void 0;if("number"==typeof e){if(s=this.tableBody[0].querySelector('tr[aria-rowindex="'+(e+1)+'"]'),a=e,this.pagerAPI&&t.source&&t.indeterminate){var r=e+(this.pagerAPI.activePage-1)*t.pagesize;s=this.tableBody[0].querySelector('tr[aria-rowindex="'+(r+1)+'"]')}}else s=(n=e instanceof jQuery?e:$(e))[0],a=t.treeGrid||t.groupable?this.actualRowIndex(n):this.dataRowIndex(n);t.indeterminate&&!s&&(s=(n=this.actualRowNode(a))[0]),!!i[a]&&i[a]._rowactivated?this.deactivateRowNode(a,i):(this.deactivateAllRowNodes(i),this.activateAllRowNodes(a,i))},activateAllRowNodes:function(e,t){var i=this;if(!("number"!=typeof e||e<0)){var s=this.settings;void 0===t&&(t=s.treeGrid?s.treeDepth:s.dataset);var n=[{row:e,item:t[e]}];t[e]&&$.when(this.element.triggerHandler("beforerowactivated",n)).done(function(s){var a;"string"==typeof(a=s)&&"false"===a.toLowerCase()||"boolean"==typeof a&&!1===a||"number"==typeof a&&0===a||(i.rowNodes(e).toArray().forEach(function(e){e.classList.add("is-rowactivated")}),t[e]._rowactivated=!0,n=[{row:e,item:t[e]}],i.element.triggerHandler("rowactivated",n))})}},deactivateRowNode:function(e,t){if(!("number"!=typeof e||e<0)){var i=this.settings;if(void 0===t&&(t=i.treeGrid?i.treeDepth:i.dataset),t[e]&&!i.disableRowDeactivation)this.rowNodes(e).toArray().forEach(function(e){e.classList.remove("is-rowactivated")}),delete t[e]._rowactivated,this.element.triggerHandler("rowdeactivated",[{row:e,item:t[e]}])}},deactivateAllRowNodes:function(e){var t=this.settings,i=null;void 0===e&&(e=t.treeGrid?t.treeDepth:t.dataset);var s=[].slice.call(this.bodyContainer[0].querySelectorAll("tr.is-rowactivated"));if(s.length>0){s.forEach(function(e){e.classList.remove("is-rowactivated")});var n=t.treeGrid||t.groupable?this.actualRowIndex($(s)):this.dataRowIndex($(s));i={row:n,item:e[n]},e[n]&&delete e[n]._rowactivated}else for(var a=0;a<e.length;a++){var r=e[a];if(r._rowactivated){delete r._rowactivated,i={row:a,item:r};break}}null!==i&&this.element.triggerHandler("rowdeactivated",[i])},toggleRowSelection:function(e){var t="number"==typeof e?this.tableBody.find('tr[aria-rowindex="'+(e+1)+'"]'):e,i="single"===this.settings.selectable,s="number"==typeof e?e:this.actualRowIndex(t);if(this.settings.groupable&&(s=this.dataRowIndex(t)),!(!1===this.settings.selectable||this.editor&&t.hasClass("is-selected")))return i&&t.hasClass("is-selected")?(this.unselectRow(s),this.displayCounts(),this._selectedRows):(t.hasClass("is-selected")?this.unselectRow(s):this.selectRow(s),this.displayCounts(),this._selectedRows)},unselectRow:function(e,t,i){var s=this,n=s.settings,a=this.settings.groupable?this.rowNodesByDataIndex(e):this.rowNodes(e);if(a&&void 0!==e){var r=function(e,t){var i=function(e,i){delete e._selected,void 0===i&&(i=t);for(var n=0;n<s._selectedRows.length;n++)if(s._selectedRows[n].idx===i){s._selectedRows.splice(n,1);break}};if(s.cellNode(e,s.columnIdxById("selectionCheckbox")),e.removeClass("is-selected hide-selected-color").removeAttr("aria-selected"),-1!==s.columnIdxById("selectionCheckbox")&&s.cellNode(e,s.columnIdxById("selectionCheckbox")).find(".datagrid-cell-wrapper .datagrid-checkbox").removeClass("is-checked no-animate").attr("aria-checked","false").removeAttr("aria-selected").removeAttr("aria-label"),n.treeGrid)for(var a=0;a<n.treeDepth.length;a++)s.isRowSelected(n.treeDepth[a].node)&&(void 0!==t?t===n.treeDepth[a].idx-1&&i(n.treeDepth[a].node):i(n.treeDepth[a].node));else{var r=e.length?s.dataRowIndex(e):t,o=void 0;void 0!==r&&r>-1&&(o=n.dataset[r]),n.groupable&&(o=s.originalDataset[r]),void 0!==o&&(n.paging&&n.source?i(o,r):i(o))}};if(n.treeGrid){if(a.is(".datagrid-tree-parent")&&"multiple"===n.selectable)a.add(a.nextUntil('[aria-level="1"]')).each(function(e){var t=$(this),i=t.attr("aria-rowindex")-1,a=s.actualPagingRowIndex(i);(n.selectChildren||!n.selectChildren&&0===e)&&r(t,a)});else if("siblings"===n.selectable)a.parent().find(".is-selected").each(function(e){var t=$(this),i=t.attr("aria-rowindex")-1,a=s.actualPagingRowIndex(i);(n.selectChildren||!n.selectChildren&&0===e)&&r(t,a)});else{var o=s.actualPagingRowIndex(e);r(a,o)}s.setNodeStatus(a)}else r(a,e);t||s.syncSelectedUI(),i||s.element.triggerHandler("selected",[s._selectedRows,"deselect"])}},setNodeStatus:function(e){var t=this,i="multiple"===t.settings.selectable,s=t.settings,n=t.cellNode(e,t.columnIdxById("selectionCheckbox")),a=void 0;if(!i)return n.find(".datagrid-cell-wrapper .datagrid-checkbox").removeClass("is-checked is-partial").attr("aria-checked","false"),void(e.is(".is-selected")&&n.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked").attr("aria-checked","true"));var r=function(e,i){e.each(function(){var e=$(this),s=t.cellNode(e,t.columnIdxById("selectionCheckbox")),n=t.getSelectedStatus(e,i);s.find(".datagrid-cell-wrapper .datagrid-checkbox").removeClass("is-checked is-partial").attr("aria-checked","false"),"mixed"===n?s.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked is-partial").attr("aria-checked","mixed"):n&&s.find(".datagrid-cell-wrapper .datagrid-checkbox").addClass("is-checked").attr("aria-checked","true")})};a=e.add(e.nextUntil('[aria-level="1"]')).filter(".datagrid-tree-parent"),s.selectChildren&&r(a),a=e,+e.attr("aria-level")>1&&(a=a.add(e.prevUntil('[aria-level="1"]')).add(e.prevAll('[aria-level="1"]:first'))),a=a.filter(".datagrid-tree-parent"),s.selectChildren&&r(a)},getSelectedStatus:function(e){var t=0,i=0,s=0;return e.add(e.nextUntil('[aria-level="1"]')).each(function(){t++,$(this).is(".is-selected")?i++:s++}),t===i||t!==s&&"mixed"},selectedRows:function(){return this._selectedRows},selectRows:function(e,t,i){var s=-1,n=this.settings,a="single"===n.selectable,r="multiple"===n.selectable||"mixed"===n.selectable,o="siblings"===n.selectable,l=this.getDataset();if("number"==typeof e&&(e=[e]),!e||0===e.length)return this._selectedRows;if(a&&(this._selectedRows.length&&this.unselectRow(this._selectedRows[0].idx,!0,!0),s="[object Array]"===Object.prototype.toString.call(e)?e[0]:e.index(),this.selectRow(s,!0,!0)),r||o)if("[object Array]"===Object.prototype.toString.call(e)){for(var d=0;d<e.length;d++)this.selectRow(e[d],!0,!0);if(0===e.length)for(var c=0,h=l.length;c<h;c++)this.unselectRow(c,!0,!0)}else this.selectRow(e.index(),!0,!0);return this.displayCounts(),t||this.syncSelectedUI(),i||this.element.triggerHandler("selected",[this._selectedRows,"select"]),this._selectedRows},findRowsByValue:function(e,t){for(var i=this.settings,s=this.getDataset(),n=-1,a=[],r=0;r<s.length;r++)if(i.groupable)for(var o=0;o<s[r].values.length;o++)n++,s[r].values[o][e]===t&&a.push(n);else(i.treeGrid?s[r].node:s[r])[e]===t&&a.push(r);return a},rowStatus:function(e,t,i){var s=this.getDataset();if(!t)return delete s[e].rowStatus,void this.updateRow(e);if(!/dirty/.test(t)&&s[e]){s[e].rowStatus={};var n=s[e].rowStatus;n.icon=t,t=(t=t.charAt(0).toUpperCase()+t.slice(1)).replace("-progress","Progress"),n.text=k.translate(t),i=i?i.charAt(0).toUpperCase()+i.slice(1):n.text,n.tooltip=i,this.updateRow(e),this.setupTooltips(!0)}},columnById:function(e){return $.grep(this.settings.columns,function(t){return t.id===e})},columnIdxById:function(e){for(var t=this.settings.columns,i=-1,s=0;s<t.length;s++)if(t[s].id===e){i=s;break}return i},handleKeys:function(){var e=this,t=this,i="multiple"===t.settings.selectable,s=$("th .datagrid-checkbox",t.headerRow);t.headerContainer.on("keydown.datagrid","th",function(e){var s=e.which||e.keyCode||e.charCode||0,n=$(this),a=t.columnIdxById(n.attr("data-column-id")),r=t.visibleColumns().length-1,o=void 0;$(e.target).closest(".popupmenu").length>0||(13!==s&&32!==s||((i&&0===a?$(".datagrid-checkbox",n):n).trigger("click.datagrid").focus(),32===s&&e.preventDefault()),-1!==[35,36,37,39].indexOf(s)&&(o=a,o=/35|36/i.test(s)||(e.ctrlKey||e.metaKey)&&/37|39/i.test(s)?k.isRTL()?36===s||(e.ctrlKey||e.metaKey)&&37===s?r:0:35===s||(e.ctrlKey||e.metaKey)&&39===s?r:0:k.isRTL()?39===s?a>0?a-1:a:a<r?a+1:r:37===s?a>0?a-1:a:a<r?a+1:r,t.activeCell.cell=o,n.removeAttr("tabindex").removeClass("is-active"),$("th:not(.is-hidden)",this.headerContainer).eq(o).attr("tabindex","0").addClass("is-active").focus(),e.preventDefault(),t.syncBodyScroll(n)),40===s&&(n.removeAttr("tabindex"),t.activeCell.node=t.cellNode(0,t.settings.groupable?0:t.activeCell.cell).attr("tabindex","0").focus(),e.preventDefault()))}),t.bodyContainer.on("keydown.datagrid","td, input",function(i){var s=!1;if(113!==(i.which||i.keyCode||i.charCode||0)||e.inlineMode||(t.settings.actionableMode=!t.settings.actionableMode,s=!0),s)return i.preventDefault(),i.stopPropagation(),s}),t.bodyContainer.on("keydown.datagrid","td",function(e){var n=e.which||e.keyCode||e.charCode||0,a=!1,r=$(e.target),o=k.isRTL(),l=t.activeCell.node,d=$(this).parent(),c=d.prevAll(":not(.is-hidden, .datagrid-expandable-row)").first(),h=d.nextAll(":not(.is-hidden, .datagrid-expandable-row)").first(),u=t.activeCell.row,p=t.activeCell.cell,g=t.columnSettings(p),f=d.is(".datagrid-rowgroup-header, .datagrid-rowgroup-footer"),m=t.settings.dataset[t.dataRowIndex(l)],v=t.tableBody.find("tr:visible"),b=function(e){var i=v.filter('[aria-rowindex="'+(e+1)+'"]');return i.is(".datagrid-rowgroup-header")?i.index():t.dataRowIndex(i)};l.length||(t.activeCell.node=t.cellNode(u,p),l=t.activeCell.node);var y=function(e,i,s){if(f)return function(e,i,s){var n=t.activeCell.groupNode||l,a=e+(s?-1:1);return a=a>i?s?n.prevAll(":visible").last():n.nextAll(":visible").last():s?n.prevAll(":visible").first():n.nextAll(":visible").first()}(e,i,s);var n=e+(s?-1:1);if(n>i)return i;for(;t.settings.columns[n]&&t.settings.columns[n].hidden;)n=s?n-1:n+1;return n},w=!!$(".datagrid-selection-checkbox",l).length,x=v.last(),C=t.settings.columns.length-1;if(t.settings.onKeyDown){var T=function(t){t||(e.stopPropagation(),e.preventDefault())},S={activeCell:t.activeCell,row:u,cell:p};if(!1===t.settings.onKeyDown(e,S,T)||!T)return e.stopPropagation(),void e.preventDefault()}if(-1!==[9,37,38,39,40].indexOf(n)){if(r.closest(".code-block").length&&(9!==n||!e.shiftKey||0!==t.getFocusables(l).index))return;if(9!==n){if(r.is(".code-block-actions"))return;if(r.closest(".popupmenu.is-open").closest(".popupmenu-wrapper").prev().is(".code-block-actions"))return}}if(-1!==[9,37,39].indexOf(n)){if(9===n&&!t.settings.actionableMode)return;9!==n&&e.altKey?(p=37===n&&!o||39===n&&o?0:C,t.setActiveCell(u,p)):t.quickEditMode&&9!==n||(9===n&&e.shiftKey&&r.is(".code-block-actions")?t.focusNextPrev("prev",l):p=!o&&(37===n||9===n&&e.shiftKey)||o&&(39===n||9===n)?y(p,C,!0):y(p,C),p instanceof jQuery?t.setActiveCell(p):t.setActiveCell(u,p),t.settings.actionableMode&&(t.makeCellEditable(t.activeCell.rowIndex,p,e),t.containsTextField(l)&&t.containsTriggerField(l)&&(t.quickEditMode=!0)),t.quickEditMode=!1,a=!0)}if(38===n&&!t.quickEditMode)if(e.altKey||e.metaKey){var A=b(0);t.setActiveCell(A,p),a=!0}else{if(0===u&&!c.is(".datagrid-rowgroup-header"))return l.removeAttr("tabindex"),void t.headerContainer.find("th").eq(p).attr("tabindex","0").focus();t.setActiveCell(c,p),a=!0}if(40!==n||t.quickEditMode||(e.altKey||e.metaKey?(t.setActiveCell(x,p),a=!0):(t.setActiveCell(h,p),a=!0)),32===n&&e.ctrlKey&&l){var D="";(u=l.closest("tr")).children().each(function(){var e=$(this);D+=e.text()+" "}),$("body").toast({title:"",audibleOnly:!0,message:D}),a=!0}if(36===n&&(t.setActiveCell(u,0),a=!0),35===n&&(t.setActiveCell(u,C),a=!0),34===n&&(t.setActiveCell(x,p),a=!0),33===n&&(t.setActiveCell(b(0),p),a=!0),32===n&&(!t.settings.editable||w)){if(u=l.closest("tr"),1===r.closest(".datagrid-row-detail").length)return;e.preventDefault();var I=r.find(".datagrid-expand-btn, .datagrid-drilldown");if(I&&I.length)return I.trigger("click.datagrid"),void e.preventDefault();i&&e.shiftKey?t.selectRowsBetweenIndexes([t.lastSelectedRow,u.index()]):t.toggleRowSelection(u)}if(t.settings.editable&&32===n&&(t.editor||t.makeCellEditable(t.activeCell.rowIndex,p,e)),13===n&&g.click&&"function"==typeof g.click&&(l.hasClass("is-cell-readonly")||g.click(e,[{row:u,cell:p,item:m,originalEvent:e}])),t.settings.editable&&13===n){if(r.is("textarea")&&e.shiftKey)return;if(r.is(".btn-menu")||r.closest(".popupmenu.is-open").length)return;t.editor?(t.quickEditMode=!1,t.commitCellEdit(),t.setNextActiveCell(e)):(t.makeCellEditable(t.activeCell.rowIndex,p,e),t.containsTextField(l)&&t.containsTriggerField(l)&&(t.quickEditMode=!0)),a=!0}if(-1!==[9,13,32,35,36,37,38,39,40,113].indexOf(n)||e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||!t.settings.editable||t.editor||t.makeCellEditable(t.activeCell.rowIndex,p,e),i&&!t.editor&&(e.ctrlKey||e.metaKey)&&65===n&&(s.addClass("is-checked").removeClass("is-partial").attr("aria-checked","true"),t.selectAllRows(),a=!0),a)return e.preventDefault(),e.stopPropagation(),!1})},getFocusables:function(e){var t=$(":focusable",e);return{elements:t,index:t.index($(":focus"))}},focusNextPrev:function(e,t){if(t&&"string"==typeof e){e=e.toLowerCase();var i=this.getFocusables(t),s=i.elements,n=s.length,a=i.index;/\b(next|prev)\b/g.test(e)&&(a="next"===e?a+1>=n?0:a+1:a-1<0?n:a-1,s.eq(a).focus())}},syncBodyScroll:function(e){var t=e.closest(".datagrid-header");if(t.length>0){var i=t.scrollLeft();e.is(":last-child")&&0===i||this.bodyWrapperCenter.scrollLeft(t.scrollLeft())}else(t=e.closest(".datagrid-body.left, .datagrid-body.right")).length>0&&this.bodyWrapperCenter.scrollTop(t.scrollTop())},containsTextField:function(e){var t=["image","button","submit","reset","checkbox","radio"],i="textarea, input",s=t.length,n=void 0;for(i+=s?":not(":"",n=0;n<s;n++)i+="[type="+t[n]+"],";return i=s?i.slice(0,-1)+")":"",!!$(i,e).length},containsTriggerField:function(e){return!$(".dropdown, .datepicker, .lookup",e).length},isRowDisabled:function(e){if(this.settings.isRowDisabled&&"function"==typeof this.settings.isRowDisabled&&"true"===this.rowNodes(e).attr("aria-disabled"))return!0;return!1},isCellEditable:function(e,t){if(!this.settings.editable)return!1;var i=this.columnSettings(t);if(i.readonly)return!1;if(this.isRowDisabled(e))return!1;var s=this.activeCell.node.find(".datagrid-cell-wrapper"),n=s.text()?s.text():this.fieldValue(this.settings.dataset[e],i.field);if(i.isEditable){var a=this.settings.dataset[e];if(this.settings.treeDepth&&this.settings.treeDepth[e]&&(a=this.settings.treeDepth[e].node),!i.isEditable(e,t,n,i,a,this,"is-editable"))return!1}return!!i.editor},makeCellEditable:function(e,t,i){if(!this.activeCell.node.closest("tr").hasClass("datagrid-summary-row")){var n=this.activeCell.node.find(".datagrid-cell-wrapper"),a=n.parent("td"),r=$(".datagrid-tree-node",n).length>0,o=$(".datagrid-expand-btn",n).length>0;if(a.hasClass("is-editing")||a.hasClass("is-editing-inline"))return!1;this.editor&&this.editor.input&&this.commitCellEdit();var l=this.columnSettings(t);if(!l.editor)return 32!==i.keyCode||$(i.currentTarget).find(".datagrid-selection-checkbox").length||this.toggleRowSelection(this.activeCell.node.closest("tr")),!1;var d=this.actualRowNode(e),c=this.settings.treeGrid?this.actualPagingRowIndex(this.actualRowIndex(d)):this.dataRowIndex(d),h=this.rowData(this.dataRowIndex(d)),u=a.outerWidth(),p=$(".is-editor",a).length>0,g=$(".is-placeholder",n).length>0,f=n.text()?n.text():this.fieldValue(h,l.field);if((p||g)&&(f=this.fieldValue(h,l.field)),!this.isCellEditable(c,t))return!1;if((o||r)&&(o&&(f=$("> span",n).text()),"string"==typeof f&&(f=f.replace(/^\s/,""))),l.inlineEditor?a.addClass("is-editing-inline"):(p&&n.css({position:"static",height:n.outerHeight()}),a.addClass("is-editing").css({"max-width":u,"min-width":u,width:u}),n.empty()),f=s.sanitizeConsoleMethods(f),this.element.triggerHandler("beforeentereditmode",[{row:c,cell:t,item:h,target:n,value:f,column:l,editor:this.editor}]),this.editor=new l.editor(c,t,f,n,l,i,this,h),this.editor.row=c,this.editor.cell=t,this.settings.onEditCell&&this.settings.onEditCell(this.editor),this.editor.useValue&&(f=this.fieldValue(h,l.field)),this.editor.val(f),this.settings.showDirty){var m=f;""===m&&/checkbox|favorite/i.test(this.editor.name)&&(m=!1);var v={originalVal:m,isDirty:!1};this.addToDirtyArray(c,t,v)}return this.editor.focus(),this.element.triggerHandler("entereditmode",[{row:c,cell:t,item:h,target:n,value:f,column:l,editor:this.editor}]),!0}},rowData:function(e){return this.settings.groupable?this.originalDataset[e]:this.settings.treeGrid?this.settings.treeDepth[e].node:this.settings.dataset[e]},commitCellEdit:function(e){if(this.editor){var t=this.editor.input,i=void 0,n=void 0,a="editor"===this.editor.name,r="fileupload"===this.editor.name,o=!t.is(".timepicker, .datepicker, .lookup, .spinbox, .colorpicker");"function"==typeof this.editor.val&&(i=this.editor.val()),a?n=this.editor.td:r?("clear"===this.editor.status?i="":"init"!==this.editor.status&&"cancel"!==this.editor.status||(i=this.editor.originalValue),n=this.tableBody.find("#"+t.attr("id")).closest("td"),i=s.escapeHTML(i)):(n=t.closest("td"),i=s.escapeHTML(i));var l=void 0,d=void 0;null!==this.settings.source&&o?(l=this.activeCell.rowIndex,d=this.activeCell.dataRow):(l=this.actualRowIndex(n.parent()),d=this.dataRowIndex(n.parent()));var c=n.attr("aria-colindex")-1,h=this.columnSettings(c),u=this.settings.treeGrid?this.settings.treeDepth[d].node:this.getDataset()[d],p=this.fieldValue(u,h.field);if(h.beforeCommitCellEdit&&!e)if(!1===h.beforeCommitCellEdit({cell:c,row:d,item:u,editor:this.editor,api:this}))return;if(this.editor){p=s.sanitizeConsoleMethods(p),i=s.sanitizeConsoleMethods(i);var g=n.hasClass("is-editing-inline");n.removeClass("is-editing is-editing-inline"),this.editor.destroy(),this.editor=null,this.updateCellNode(this.settings.groupable?d:l,c,i,!1,g);var f=this.fieldValue(u,h.field);this.element.triggerHandler("exiteditmode",[{row:l,cell:c,item:u,target:n,value:f,oldValue:p,column:h,editor:this.editor}])}}},validateCell:function(e,t){var i,s=this,n=this,a=this.columnSettings(t),r=a.validate,o=void 0;if(r){var l=void 0,d=[],c=a.validate.split(" "),h=$.fn.validation,u=this.fieldValue(this.settings.dataset[e],a.field),p=[],g="",f=void 0;for(f=0;f<c.length;f++){var m=h.rules[c[f]],v={row:e,cell:t,item:this.settings.dataset[e],column:a,grid:n};l=$.Deferred(),m.async?m.check(u,$("<input>").val(u),v,b,l):b(m.check(u,$("<input>").val(u),v),!0,c[f],l),d.push(l)}(i=$).when.apply(i,d).then(function(){var i=$.fn.validation.ValidationTypes;for(var r in i)if(g="",o=i[r],p[o.type]&&(g=p[o.type]),""!==g){n.showCellError(e,t,g,o.type);var l=s.dataRowNode(e);n.element.trigger("cell"+o.type,{row:e,cell:t,message:g,target:s.cellNode(l,t),value:u,column:a})}else n.clearCellError(e,t,o.type)})}function b(e,t,i,s){var n=h.rules[i];o=$.fn.validation.ValidationTypes[n.type]||$.fn.validation.ValidationTypes.error,g="",p[o.type]&&(g=p[o.type]),!e&&t&&(g?(g=(/^\u2022/.test(g)?"":"• ")+g,g+="<br/>• "+n.message):g=n.message,p[o.type]=g),s.resolve()}},showCellError:function(e,t,i,s){var n=this.dataRowNode(e),a=this.cellNode(n,t);if(this.clearNonVisibleCellErrors(e,t,s),!a.length)return this.nonVisibleCellErrors.push({row:e,cell:t,message:i,type:s}),void this.showNonVisibleCellErrors();a.addClass(s).attr("data-"+s+"message",i);var r=a.find(".icon-"+s);if(!r.length){a.find(".datagrid-cell-wrapper").append($($.createIcon({classes:["icon-"+s],icon:s})));var o={forced:!0,placement:"bottom",content:i,isError:"error"===s||"dirtyerror"===s,wrapper:r=a.find(".icon-"+s)};this.cacheTooltip(r,o),this.setupTooltips(!1,!0)}},showNonVisibleCellErrors:function(){var e=this;if(this.toolbar||(this.settings.toolbar={title:" "},this.appendToolbar()),0===this.nonVisibleCellErrors.length)this.toolbar&&1===this.toolbar.parent().find(".table-errors").length&&this.toolbar.parent().find(".table-errors").remove();else{var t=function(t){var i=$.fn.validation.ValidationTypes[t].type,s=$.grep(e.nonVisibleCellErrors,function(e){return e.type===i});e.showNonVisibleCellErrorType(s,i)};for(var i in $.fn.validation.ValidationTypes)t(i)}},showNonVisibleCellErrorType:function(e,t){var i=void 0,s=void 0,n=void 0,a=void 0,r=[],o=$.fn.validation.ValidationTypes[t]||$.fn.validation.ValidationTypes.error;if(1===this.toolbar.parent().find(".table-errors").length&&(s=this.toolbar.parent().find(".table-errors")),0!==e.length){for(a=0;a<e.length;a++){var l=Math.floor((e[a].row+this.settings.pagesize)/this.settings.pagesize);-1===$.inArray(l,r)&&r.push(l)}for(a=0;a<r.length;a++)i=(i?i+"<br>":"")+k.translate(o.pagingMessageID)+" "+r[a];0===this.toolbar.parent().find(".table-errors").length&&(s=$('<div class="table-errors"></div>')),(n=s.find(".icon-"+t)).length||(s.append($($.createIcon({classes:["icon-"+t],icon:t}))),n=s.find(".icon-"+t)),this.element.hasClass("has-toolbar")&&this.toolbar.children(".title").append(s),this.cacheTooltip(n,{forced:!0,placement:"bottom",content:i,isError:"error"===t||"dirtyerror"===t,wrapper:n}),this.setupTooltips(!1,!0)}else s&&s.length&&(n=s.find(".icon-"+o.type),this.hideTooltip(),s.find(".icon-"+o.type).remove())},clearAllCellError:function(e,t){var i=$.fn.validation.ValidationTypes;for(var s in i){var n=i[s];this.clearCellError(e,t,n.type)}},clearCellError:function(e,t,i){this.clearNonVisibleCellErrors(e,t,i);var s=this.dataRowNode(e),n=this.cellNode(s,t);n.length&&this.clearNodeErrors(n,i)},clearNonVisibleCellErrors:function(e,t,i){if(this.nonVisibleCellErrors.length){if(this.toolbar&&this.toolbar.parent()&&this.toolbar.parent().find(".table-errors").length>0){var s=this.toolbar.parent().find(".table-errors").find(".icon-"+i);if(s.length)$.grep(this.nonVisibleCellErrors,function(e){return e.type===i?e:""}).length||s.remove()}this.nonVisibleCellErrors=$.grep(this.nonVisibleCellErrors,function(s){return s.row!==e||s.cell!==t||s.type!==i?s:""}),this.nonVisibleCellErrors.length||this.showNonVisibleCellErrors()}},clearRowError:function(e){this.dataRowNode(e).removeClass("error alert rowstatus-row-error rowstatus-row-alert rowstatus-row-info rowstatus-row-in-progress rowstatus-row-success"),this.rowStatus(e,"","");for(var t=0;t<this.settings.columns.length;t++)this.clearAllCellError(e,t)},clearAllErrors:function(){for(var e=0,t=0;t<this.settings.dataset.length;t++){this.settings.dataset[t].rowStatus&&(delete this.settings.dataset[t].rowStatus,e++);for(var i=0;i<this.settings.columns.length;i++)this.clearAllCellError(t,i)}e>0&&this.render()},clearNodeErrors:function(e,t){(e=e instanceof jQuery?e[0]:e).classList.remove(t),e.removeAttribute("data-"+t+"message");var i=e.querySelector(".icon-"+t);i&&(i.parentNode.removeChild(i),this.hideTooltip())},resetRowStatus:function(){for(var e=this.settings.dataset.filter(function(e){return e.rowStatus}),t=0;t<e.length;t++)delete e[t].rowStatus;e.length>0&&this.render(),this.clearDirty()},clearDirtyClass:function(e){(e=e instanceof jQuery?e[0]:e)&&[].slice.call(e.querySelectorAll(".is-dirty-cell")).forEach(function(e){e.classList.remove("is-dirty-cell")})},clearDirty:function(){this.settings.showDirty&&(this.clearDirtyClass(this.element),this.dirtyArray=void 0)},clearDirtyRow:function(e){if(this.settings.showDirty&&"number"==typeof e){var t=this.rowNodes(e);this.clearDirtyClass(t),this.dirtyArray&&(this.dirtyArray[e]=void 0)}},clearDirtyCell:function(e,t){this.settings.showDirty&&this.dirtyArray&&"number"==typeof e&&"number"==typeof t&&(void 0!==this.dirtyArray[e]&&(this.cellNode(e,t).removeClass("is-dirty-cell"),this.dirtyArray[e][t]=void 0))},dirtyCells:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset,i=[];if(e.showDirty&&this.dirtyArray&&this.dirtyArray.length)for(var s=0,n=t.length;s<n;s++){var a=this.dirtyArray[s];if(void 0!==a)for(var r=0,o=a.length;r<o;r++){var l=a[r];void 0!==l&&l.isDirty&&i.push(e.treeGrid?t[s].node:t[s])}}return i},dirtyRows:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset,i=[];if(e.showDirty&&this.dirtyArray&&this.dirtyArray.length)for(var s=0,n=t.length;s<n;s++){var a=this.dirtyArray[s];if(void 0!==a)for(var r=0,o=a.length;r<o;r++){var l=a[r];if(void 0!==l&&l.isDirty){i.push(e.treeGrid?t[s].node:t[s]);break}}}return i},getModifiedRows:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset,i=[];if(this.dirtyArray&&this.dirtyArray.length)for(var s=0;s<this.dirtyArray.length;s++)if(void 0!==this.dirtyArray[s]){for(var n={data:e.treeGrid?t[s].node:t[s],row:s,type:"dirty",cells:[]},a=0;a<this.dirtyArray[s].length;a++)void 0!==this.dirtyArray[s][a]&&n.cells.push(this.dirtyArray[s][a]);i.push(n)}for(var r=0;r<t.length;r++){var o=t[r];void 0===o.rowStatus||"error"!==o.rowStatus.icon&&"in-progress"!==o.rowStatus.icon||i.push({data:o,row:r,type:o.rowStatus.icon,cells:[]})}return i},showRowError:function(e,t,i){var s=i||"error";this.dataRowNode(e).addClass(i),this.rowStatus(e,s,t)},validateRow:function(e){if(e)for(var t=0;t<this.settings.columns.length;t++)this.validateCell(e,t)},validateAll:function(){for(var e=0;e<this.settings.dataset.length;e++)for(var t=0;t<this.settings.columns.length;t++)this.validateCell(e,t)},columnSettings:function(e){return this.settings.columns[e]||{}},coerceValue:function(e,t,i,s,n){var a=void 0;return i.serialize?a=i.serialize(e,t,i,s,n,this.settings.dataset[s]):(i.sourceFormat?a=e instanceof Date?k.parseDate(e,i.sourceFormat):k.formatDate(e,{pattern:i.sourceFormat}):"number"==typeof t&&e&&(a=k.parseNumber(e)),a)},updateCell:function(e,t,i){var s=this.columnSettings(t);void 0===i&&(i=this.fieldValue(this.settings.dataset[e],s.field)),this.updateCellNode(e,t,i,!0)},updateCellNode:function(e,t,i,n,a){var r=void 0,o=this.settings.groupable?this.rowNodesByDataIndex(e):this.rowNodes(e),l=o.find("td").eq(t),d=this.settings.columns[t]||{},c="",h=d.formatter?d.formatter:this.defaultFormatter,u=$(".editor",l).length>0,p=this.settings.treeGrid,g=this.dataRowIndex(o);(null==g||isNaN(g))&&(g=e);var f=this.rowData(g);0===o.length&&this.settings.paging&&(l=(o=this.visualRowNode(e)).find("td").eq(t));var m=this.fieldValue(f,d.field);if(n?r=i:void 0===(r=this.coerceValue(i,m,d,e,t))&&(r=i),o.length&&f&&!f.rowStatus){var v=o.find("svg.icon-rowstatus");v.length&&v.remove()}if(this.removeTooltipData(l),0===t&&f&&f.rowStatus){var b=l.find("svg.icon-rowstatus");if(o&&l[0]){for(var y=0;y<o.length;y++)o[y].classList.add("rowstatus-row-"+f.rowStatus.icon);if(l[0].classList.add("rowstatus-cell"),!b.length){var w="success"===f.rowStatus.icon?"#icon-check":"#icon-exclamation";l.prepend('<svg class="icon icon-rowstatus" focusable="false" aria-hidden="true" role="presentation"><use xlink:href="'+w+'"></use></svg>')}}if(f.rowStatus.tooltip){b=l.find("svg.icon-rowstatus");var x=f.rowStatus.icon;this.cacheTooltip(b,{forced:!0,placement:"right",content:f.rowStatus.tooltip,isError:"error"===x||"dirtyerror"===x,wrapper:l})}}if(r=s.unescapeHTML(r),d.field&&r!==m)if(d.field.indexOf(".")>-1){var C=f,k=d.field.split(".").length;d.field.split(".").forEach(function(e,t){t===k-1?C[e]=r:C=C[e]})}else f[d.field]=r;var T=s.escapeHTML(r),S=u?r:T;(c=this.formatValue(h,e,t,S,d,f),d.contentVisible)&&(d.contentVisible(e,t,T,d,f)||(c=""));if(a||l.find(".datagrid-cell-wrapper").html(c),n||(this.validateCell(g,t),this.isDirtyCellUndefined(e,t)||(this.dirtyArray[e][t].value=i,this.dirtyArray[e][t].coercedVal=r,this.dirtyArray[e][t].escapedCoercedVal=s.escapeHTML(r),this.dirtyArray[e][t].cellNodeText=l.text(),this.dirtyArray[e][t].cell=t,this.dirtyArray[e][t].column=this.settings.columns[t],this.setDirtyCell(e,t))),this.settings.stretchColumnOnChange&&d&&!d.width){var A=this.calculateTextWidth(d);d.minWidth&&A<d.minWidth&&(A=d.minWidth),d.minWidth&&A>d.maxWidth&&(A=d.maxWidth);var D=A-this.headerWidths[t].width;D>0&&""!==this.headerWidths[t].width&&(this.resizeColumnWidth(l,A,D),this.headerWidths[t].width=A)}if(m=s.sanitizeConsoleMethods(m),r=s.sanitizeConsoleMethods(r),(r=s.escapeHTML(r))!==m&&!n){var I={row:null!==this.settings.source?g:e,relativeRow:e,cell:t,target:l,value:r,oldValue:m,column:d};I.rowData=p&&this.settings.treeDepth[e]?this.settings.treeDepth[e].node:f,this.element.trigger("cellchange",I),this.wasJustUpdated=!0}},isCellDirty:function(e,t){return!this.isDirtyCellUndefined(e,t)&&this.dirtyArray[e][t].isDirty},addToDirtyArray:function(e,t,i){void 0===this.dirtyArray&&(this.dirtyArray=[]),void 0===this.dirtyArray[e]?(this.dirtyArray[e]=[],this.dirtyArray[e][t]=i):void 0===this.dirtyArray[e][t]&&(this.dirtyArray[e][t]=i)},setDirtyCell:function(e,t,i){var s=this.cellNode(e,t);i&&this.addToDirtyArray(e,t,i);var n=this.dirtyArray[e][t];n.originalVal===n.value||n.originalVal===n.coercedVal||n.originalVal===n.escapedCoercedVal||n.originalVal===n.cellNodeText?(this.dirtyArray[e][t].isDirty=!1,this.setDirtyIndicator(e,t,!1)):(this.dirtyArray[e][t].isDirty=!0,s[0].classList.add("is-dirty-cell"),this.setDirtyIndicator(e,t,!0))},setDirtyIndicator:function(e,t,i,s){var n=this.cellNode(e,t);s&&this.addToDirtyArray(e,t,s),e<0||t<0||(i?n[0].classList.add("is-dirty-cell"):n[0].classList.remove("is-dirty-cell"))},isDirtyCellUndefined:function(e,t){return!(this.settings.showDirty&&"number"==typeof e&&"number"==typeof t&&e>-1&&t>-1&&void 0!==this.dirtyArray&&void 0!==this.dirtyArray[e]&&void 0!==this.dirtyArray[e][t])},visualRowIndex:function(e){var t="tr:visible:not(.is-hidden, .datagrid-expandable-row)",i=this.tableBody.find(t).index(e);return-1===i&&this.tableBodyLeft&&(i=this.tableBodyLeft.find(t).index(e)),-1===i&&this.tableBodyRight&&(i=this.tableBodyRight.find(t).index(e)),i},visualRowNode:function(e){var t=e;return this.settings.paging&&this.settings.source&&(t+=(this.pagerAPI.activePage-1)*this.settings.pagesize),this.isRowVisible(e)?this.tableBody.find('tr[aria-rowindex="'+(t+1)+'"]'):$([])},actualRowNode:function(e){return this.tableBody.find('tr[aria-rowindex="'+(e+1)+'"]')},rowNodes:function(e){e instanceof jQuery&&(e=e.attr("aria-rowindex")-1);var t=this.tableBodyLeft?this.tableBodyLeft.find('tr[aria-rowindex="'+(e+1)+'"]'):$(),i=this.tableBody.find('tr[aria-rowindex="'+(e+1)+'"]'),s=this.tableBodyRight?this.tableBodyRight.find('tr[aria-rowindex="'+(e+1)+'"]'):$();return $(i).add(t).add(s)},rowNodesByDataIndex:function(e){e instanceof jQuery&&(e=e.attr("data-index"));var t=this.tableBodyLeft?this.tableBodyLeft.find('tr[data-index="'+e+'"]'):$(),i=this.tableBody.find('tr[data-index="'+e+'"]'),s=this.tableBodyRight?this.tableBodyRight.find('tr[data-index="'+e+'"]'):$();return $(i).add(t).add(s)},cellNode:function(e,t){var i=this.settings.groupable?this.rowNodesByDataIndex(e).find("td"):this.rowNodes(e).find("td");return i.eq(t>=i.length?i.length-1:t)},actualRowIndex:function(e){return e.attr("aria-rowindex")-1},pagingRowIndex:function(e){var t=e;return this.settings.paging&&this.settings.source&&!this.settings.indeterminate&&(t+=(this.pagerAPI.activePage-1)*this.settings.pagesize),t},actualPagingRowIndex:function(e){var t=e;return this.settings.paging&&this.settings.source&&!this.settings.indeterminate&&(t-=(this.pagerAPI.activePage-1)*this.settings.pagesize),t},dataRowNode:function(e){return this.tableBody.find('tr[data-index="'+e+'"]')},dataRowIndex:function(e){return parseInt(e.attr("data-index"),10)},setActiveCell:function(e,t){var i=this.activeCell,s=e,n=void 0,a=void 0,r=void 0,o=e instanceof jQuery&&e.is(".datagrid-rowgroup-header, .datagrid-rowgroup-footer");if(!(e instanceof jQuery&&0===e.length||("number"==typeof e&&(n=e,s=this.tableBody.find("tr:visible").eq(e),a=this.actualRowIndex(s),r=this.dataRowIndex(s)),e instanceof jQuery&&e.is("td")&&((o=e.parent().is(".datagrid-rowgroup-header, .datagrid-rowgroup-footer"))&&(s=e.parent()),t=e.attr("aria-colindex")-1,n=this.visualRowIndex(e.parent()),a=this.actualRowIndex(e.parent()),r=this.dataRowIndex(e.parent()),s=e.parent()),e instanceof jQuery&&e.is("tr")&&(n=this.visualRowIndex(e),a=this.actualRowIndex(e),r=this.dataRowIndex(e),s=e),n<0||t<0))){i.node&&1===i.node.length&&this.activeCell.node.removeAttr("tabindex").removeClass("is-active"),i.cell===t&&i.row===e||this.hideTooltip(),this.activeCell.node=this.cellNode(o||s?s:a>-1?a:n,t).attr("tabindex","0"),this.activeCell.node&&1===i.node.length?(this.activeCell.row=n,this.activeCell.cell=t,a=this.actualRowIndex(this.activeCell.node.parent()),r=this.dataRowIndex(this.activeCell.node.parent())):this.activeCell=i,$("input, button:not(.btn-secondary, .row-btn, .datagrid-expand-btn, .datagrid-drilldown, .btn-icon)",this.activeCell.node).length||(this.activeCell.node.focus(),o&&(this.activeCell.groupNode=this.activeCell.node)),this.activeCell.node.hasClass("is-focusable")&&this.activeCell.node.find("button").focus(),void 0!==r&&(this.activeCell.dataRow=r),void 0!==a&&(this.activeCell.rowIndex=a);var l=+s.find("td[colspan]").attr("colspan");if(o&&this.activeCell.node&&i.node&&!(e instanceof jQuery&&e.is("td"))&&(t<l?(s.find("td[colspan]").attr("tabindex","0").focus(),this.activeCell.groupNode=s.find("td[colspan]")):t>=l?(s.find("td").eq(t-l+1).attr("tabindex","0").focus(),this.activeCell.groupNode=s.find("td").eq(t-l+1)):(s.find("td").eq(t).attr("tabindex","0").focus(),this.activeCell.groupNode=s.find("td").eq(t))),o&&e instanceof jQuery&&e.is("td")&&(this.activeCell.cell=l-1+t,e.is("[colspan]")&&(this.activeCell.cell=t)),this.settings.cellNavigation){var d=this.headerNodes(),c=0;this.hasColSpans&&(c=0,d.eq(t).prevAll("[colspan]").each(function(e,t){var i=$(t).attr("colspan")-1;c+=i}),t-=c),d.removeClass("is-active"),d.eq(t).addClass("is-active")}this.activeCell.isFocused=!0;var h=this.settings.columns[t];h&&h.expandOnActivate&&this.activeCell&&this.activeCell.node&&this.activeCell.node.addClass("is-active"),this.syncBodyScroll(this.activeCell.node),this.element.trigger("activecellchange",[{node:this.activeCell.node,row:this.activeCell.row,cell:this.activeCell.cell}])}},setNextActiveCell:function(e){var t=this;if("keydown"===e.type)if(this.settings.actionableMode){var i=13===e.keyCode?40:e.keyCode;if(32===i)return;setTimeout(function(){var e=$.Event("keydown.datagrid");e.keyCode=i,t.activeCell.node.trigger(e)},0)}else this.setActiveCell(this.activeCell.row,this.activeCell.cell)},addChildren:function(e,t){if(!(!t||t&&!t.length||e<0)){var i=this.settings.treeDepth[e].node;i.children=i.children||[];for(var s=0,n=(t=JSON.parse(JSON.stringify(t))).length;s<n;s++)i.children.push(t[s]);this.updateDataset(this.settings.dataset)}},setExpandedInDataset:function(e,t){this.settings.treeDepth[e].node.expanded=t},toggleChildren:function(e,t){if(!this.settings.groupable){var i=this,s=this.rowNodes(t),n=s.find(".datagrid-expand-btn"),a=parseInt(s.attr("aria-level"),10),r=n.hasClass("is-expanded"),o=[{grid:i,row:t,item:s}];if(i.settings.treeDepth&&i.settings.treeDepth[t]&&(o[0].rowData=i.settings.treeDepth[t].node),s.hasClass("datagrid-tree-parent")&&($(e.target).is(n)||!i.settings.editable&&!i.settings.selectable)){$.when(i.element.triggerHandler(r?"collapserow":"expandrow",o)).done(function(){!function(){s=i.rowNodes(t),n=s.find(".datagrid-expand-btn");var e=s.nextUntil('[aria-level="'+a+'"]'),l=i.settings.treeGrid&&i.settings.source&&i.settings.paging?i.dataRowIndex(s):t;r?(s.attr("aria-expanded",!1),n.removeClass("is-expanded").find(".plus-minus").removeClass("active")):(s.attr("aria-expanded",!0),n.addClass("is-expanded").find(".plus-minus").addClass("active")),i.setExpandedInDataset(l,!r);!function e(t,s,n){var r=t.nextUntil('[aria-level="'+a+'"]');n?r.each(function(){var e=$(this);parseInt(e.attr("aria-level"),10)>s&&e.addClass("is-hidden")}):r.each(function(){var t=$(this),n=parseInt(t.attr("aria-level"),10);if(n===s+1){if(!t.hasClass("is-filtered")&&(t.removeClass("is-hidden"),i.settings.frozenColumns)){var a=t.attr("aria-rowindex");i.tableBody.find('[aria-rowindex="'+a+'"]').removeClass("is-hidden")}if(t.is(".datagrid-tree-parent")){var r=t.find(".datagrid-expand-btn.is-expanded").length>0;r&&e(t,n,!r)}}})}(s,a,r),i.setAlternateRowShading(),o.children=e}()})}}},toggleRowDetail:function(e){var t=this,i=t.rowNodes(e);!i.length&&t.settings.paging&&(t.settings.rowTemplate||t.settings.expandableRow)&&(e+=(t.pagerAPI.activePage-1)*t.settings.pagesize,i=t.dataRowNode(e));var s=i.next(),n=i.find(".datagrid-expand-btn"),a=s.find(".datagrid-row-detail"),r=t.settings.dataset[t.dataRowIndex(i)];if(!i.hasClass("datagrid-tree-parent")){if(t.settings.allowOneExpandedRow&&null===t.settings.groupable){var o=t.tableBody.find("tr.is-expanded"),l=o.prev().find(".datagrid-expand-btn"),d=o.prev(),c=t.actualRowNode(d),h=t.dataRowIndex(d);if(o.length&&s.index()!==o.index()){var u=o.find(".datagrid-row-detail");o.add(l).removeClass("is-expanded"),d.removeClass("is-rowactivated"),d.find(".plus-minus").removeClass("active"),u.animateClosed().on("animateclosedcomplete",function(){o.removeClass("is-expanded"),t.element.triggerHandler("collapserow",[{grid:t,row:c,detail:u,item:t.settings.dataset[h]}])});var p=o.prev().find(".btn-primary");p.length&&p.attr("class",p.attr("class").replace("btn-primary","btn-secondary"))}var g=!s.hasClass("is-expanded"),f=s.prev().find(g?".btn-secondary":".btn-primary");if(f.length>0&&d&&f){var m=f.attr("class")||"";f.attr("class",m.replace(g?"btn-secondary":"btn-primary",g?"btn-primary":"btn-secondary"))}}if(s.hasClass("is-expanded"))a.one("animateclosedcomplete",function(){s.removeClass("is-expanded")}).animateClosed(),n.removeClass("is-expanded").find(".plus-minus").removeClass("active"),t.settings.allowOneExpandedRow&&i.removeClass("is-rowactivated"),t.element.triggerHandler("collapserow",[{grid:t,row:e,detail:a,item:r}]);else{s.addClass("is-expanded"),n.addClass("is-expanded").find(".plus-minus").addClass("active"),s.find(".constrained-width").css("max-width",this.element.outerWidth());var v=[{grid:t,row:e,detail:a,item:r}];if(t.element.triggerHandler("expandrow",v),t.settings.allowOneExpandedRow&&i.addClass("is-rowactivated"),t.settings.onExpandRow){t.settings.onExpandRow(v[0],function(e){e&&a.find(".datagrid-row-detail-padding").empty().append(e),a.animateOpen()})}else a.animateOpen()}}},toggleGroupChildren:function(e){if(this.settings.groupable){var t=e.index(),i=$(),s=$(),n=$();this.hasLeftPane&&(i=this.tableLeft.find("tr").eq(t).nextUntil(".datagrid-rowgroup-header")),s=this.table.find("tr").eq(t).nextUntil(".datagrid-rowgroup-header"),this.hasRightPane&&(n=this.tableRight.find("tr").eq(t).nextUntil(".datagrid-rowgroup-header"));var a=e.find(".datagrid-expand-btn");e.hasClass("is-expanded")?(a.removeClass("is-expanded").find(".plus-minus").removeClass("active"),i.hide(),i.addClass("is-hidden"),s.hide(),s.addClass("is-hidden"),n.hide(),n.addClass("is-hidden"),this.element.triggerHandler("collapserow",[{grid:this,row:e.index(),detail:s,item:{}}]),e.removeClass("is-expanded")):(a.addClass("is-expanded").find(".plus-minus").addClass("active"),i.show(),i.removeClass("is-hidden"),s.show(),s.removeClass("is-hidden"),n.show(),n.removeClass("is-hidden"),this.element.triggerHandler("expandrow",[{grid:this,row:e.index(),detail:s,item:{}}]),e.addClass("is-expanded"))}},setSortColumn:function(e,t){var i=!0;if(void 0!==t?(this.sortColumn.sortAsc===t&&this.sortColumn.sortId===e&&(i=!1),this.sortColumn.sortAsc=t):(this.sortColumn.sortId===e?this.sortColumn.sortAsc=!this.sortColumn.sortAsc:this.sortColumn.sortAsc=!0,t=this.sortColumn.sortAsc),this.sortColumn.sortId=e,this.sortColumn.sortField=this.columnById(e)[0]?this.columnById(e)[0].field:e,this.sortColumn.sortAsc=t,this.setSortIndicator(e,t),i&&this.sortDataset(),!this.settings.focusAfterSort&&this.activeCell&&this.activeCell.isFocused&&(this.activeCell.isFocused=!1),i){var s=this.activeCell.isFocused;this.settings.source||(this.setTreeDepth(),this.setRowGrouping(),this.setTreeRootNodes(),this.renderRows(),this.syncSelectedUI()),s&&1===this.activeCell.node.length&&this.setActiveCell(this.activeCell.row,this.activeCell.cell),this.settings.source&&this.triggerSource({type:"sorted"})}this.tableBody.removeClass("is-loading"),this.saveUserSettings(),this.validateAll(),this.element.trigger("sorted",[this.sortColumn])},sortDataset:function(){if(this.settings.disableClientSort)this.restoreSortOrder=!0;else{this.settings.groupable&&this.originalDataset&&(this.settings.dataset=this.originalDataset);var e=this.sortFunction(this.sortColumn.sortId,this.sortColumn.sortAsc);this.saveDirtyRows(),this.settings.dataset.sort(e),this.setTreeDepth(),this.restoreDirtyRows(),this.settings.selectable&&this.syncDatasetWithSelectedRows()}},saveDirtyRows:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset;if(e.showDirty&&!this.settings.source&&this.dirtyArray&&this.dirtyArray.length)for(var i=0,s=t.length;i<s;i++){if(void 0!==this.dirtyArray[i])(e.treeGrid?t[i].node:t[i]).tempNodeIndex=i}},restoreDirtyRows:function(){var e=this.settings,t=e.treeGrid?e.treeDepth:e.dataset;if(e.showDirty&&this.dirtyArray&&this.dirtyArray.length){for(var i=[],s=0,n=t.length;s<n;s++){var a=e.treeGrid?t[s].node:t[s];void 0!==a.tempNodeIndex&&(i.push({newIdx:s,oldIdx:a.tempNodeIndex}),delete a.tempNodeIndex)}for(var r=[],o=0,l=i.length;o<l;o++)r[i[o].newIdx]=this.dirtyArray[i[o].oldIdx];this.dirtyArray=r}},syncDatasetWithSelectedRows:function(){var e=this;this._selectedRows=[];for(var t,i=this.settings,s=i.treeGrid?i.treeDepth:i.dataset,n=-1,a=function(a,r){if(i.groupable)for(var o=0;o<Object.keys(s[a]).length;o++)n++,r=Object.keys(s[a]).map(function(e){return s[a][e]}),e.isRowSelected(r)&&e._selectedRows.push({idx:n,data:r,elem:e.dataRowNode(n),group:s[a],page:e.pagerAPI?e.pagerAPI.activePage:1,pagingIdx:n,pagesize:e.settings.pagesize});else r=i.treeGrid?s[a].node:s[a],e.isRowSelected(r)&&e._selectedRows.push({idx:a,data:r,elem:e.visualRowNode(a),pagesize:e.settings.pagesize,page:e.pagerAPI?e.pagerAPI.activePage:1,pagingIdx:n});t=r},r=0;r<s.length;r++)a(r,t)},setSortIndicator:function(e,t){this.headerRow&&(this.headerContainer.find(".is-sorted-asc, .is-sorted-desc").removeClass("is-sorted-asc is-sorted-desc").attr("aria-sort","none"),this.headerContainer.find('[data-column-id="'+e+'"]').addClass(t?"is-sorted-asc":"is-sorted-desc").attr("aria-sort",t?"ascending":"descending"))},sortFunction:function(e,t){var i=this.columnById(e),s=0===i.length?null:i[0],n=null===s?e:s.field,a=this,r=function(e){return"string"==typeof(t=null==(t=a.fieldValue(e,n))?"":t)&&(t=t.toUpperCase(),$.isNumeric(t)&&(t=parseFloat(t))),t;var t};return s&&s.sortFunction&&(r=function(e){return s.sortFunction(a.fieldValue(e,n))}),t=t?1:-1,function(e,i){return e=r(e),i=r(i),(void 0===e?"undefined":u(e))!==(void 0===i?"undefined":u(i))&&(e=e.toString().toLowerCase(),i=i.toString().toLowerCase()),t*((e>i)-(i>e))}},isEquivalent:function(e,t){function i(e,t){return JSON.stringify(e)===JSON.stringify($.extend(!0,{},e,t))}return i(e,t)&&i(t,e)},defaultFormatter:function(e,t,i){return null==i||""===i?"":i.toString()},handlePaging:function(){this.settings.paging&&(this.element.addClass("paginated"),this.tableBody.pager({componentAPI:this,dataset:this.settings.dataset,hideOnOnePage:this.settings.hidePagerOnOnePage,source:this.settings.source,pagesize:this.settings.pagesize,indeterminate:this.settings.indeterminate,rowTemplate:this.settings.rowTemplate,pagesizes:this.settings.pagesizes,pageSizeSelectorText:this.settings.groupable?"GroupsPerPage":"RecordsPerPage",showPageSizeSelector:this.settings.showPageSizeSelector,activePage:this.restoreActivePage?parseInt(this.savedActivePage,10):1}),this.restoreActivePage&&(this.savedActivePage=null,this.restoreActivePage=!1))},renderPager:function(e,t,i){this.pagerAPI&&(this.settings.source||(this.pagerAPI.settings.dataset=this.settings.dataset,e.isFilteredClientside=!0),this.pagerAPI.updatePagingInfo(e,t),t||this.triggerSource(e,i),this.syncSelectedUI())},getPageableElements:function(){var e=this.element.children().not(".datagrid-expandable-row");return e.is("table")&&(e=e.find("tr")),e},appendTooltip:function(e){var t=this,i=new RegExp("\\bgrid-tooltip\\b","g");"string"==typeof e?i.test(e)||(e+=" grid-tooltip"):e="grid-tooltip";var s=this.uniqueId("tooltip");if(this.tooltip=document.getElementById(s),!this.tooltip){var n='<div id="'+s+'" class="tooltip '+e+' is-hidden">\n          <div class="arrow"></div>\n          <div class="tooltip-content"></div>\n        </div>';document.body.insertAdjacentHTML("beforeend",n),this.tooltip=document.getElementById(s),this.isTouch&&(this.tooltip.style.pointerEvents="auto",$(this.tooltip).on("touchend.gridtooltip",function(){t.hideTooltip()}))}},cacheTooltip:function(e,t){if(void 0===t){var i=e.querySelector(".is-editor.content-tooltip"),n=e.querySelector("a[title]"),a=m.hasClass(e,"rowstatus-cell"),r="svg"===e.tagName.toLowerCase(),o="th"===e.tagName.toLowerCase(),d=m.hasClass(e,"datagrid-column-wrapper"),c=m.hasClass(e.parentNode,"datagrid-filter-wrapper"),h=e.getAttribute("aria-colindex")-1,u=this.columnSettings(h),p=void 0;if(t={content:"",wrapper:e.querySelector(".datagrid-cell-wrapper")},(o||d||c)&&(t.wrapper=e,t.distance=c?15:null,t.placement=d?"top":"bottom"),a||r){var g=this.closest(e,function(e){return m.hasClass(e,"datagrid-row")}),f=g?g.classList:[];t.isError=f.contains("rowstatus-row-error"),t.placement="right",r&&(t.wrapper=this.closest(e,function(e){return"td"===e.tagName.toLowerCase()}))}if(i){var v=!(!u.editorOptions||!u.editorOptions.width)&&this.setUnit(u.editorOptions.width);i.style.width=v||e.offsetWidth+"px";var b=t.wrapper.innerHTML;""!==s.stripHTML(b)&&(t.content=b,t.extraClassList=["popover","alternate","content-tooltip"])}else if(n)t.content=n.getAttribute("title"),n.removeAttribute("title");else if(p=e.getAttribute("title"))t.content=p,e.removeAttribute("title");else if(o&&!c){var y=e.querySelector(".datagrid-header-text");t.content=y?s.stripHTML(y.textContent):""}else if(c){if(!(e.parentNode.querySelectorAll('.dropdown.is-disabled, input[type="text"][disabled], .btn-filter[disabled]').length>0)){var x=e.parentNode.querySelector(".is-checked");t.content=x?s.stripHTML(x.textContent):""}}else t.content=s.stripHTML(t.wrapper.textContent);var C=t.wrapper.querySelector("select");if(C&&C.selectedIndex&&C.options[C.selectedIndex]&&C.options[C.selectedIndex].innerHTML&&(t.content=l.features.touch?"":C.options[C.selectedIndex].innerHTML.trim()),o&&(t.content=t.content.trim()),""!==t.content){var k=m.hasClass(d?e.parentNode:e,"text-ellipsis"),T=[].slice.call(e.querySelectorAll(".icon")),S=k?8:0;if(T.forEach(function(e){S+=e.getBBox().width+8}),k&&d){var A=e.querySelector(".datagrid-header-text");t.textwidth=A.scrollWidth+(C?0:S)}else t.textwidth=w.textWidth(t.content)+(C?0:S);o&&(t.textwidth=w.textWidth(t.content)),t.content=i?t.content:"<p>"+t.content+"</p>",(p||c)&&(t.forced=!0)}if("function"==typeof u.tooltip){var D=this.closest(e,function(e){return m.hasClass(e,"datagrid-row")}).getAttribute("data-index"),I=this.settings.dataset[D],E=this.fieldValue(this.settings.dataset[D],u.field);t.content=u.tooltip(D,h,E,u,I,this),t.textwidth=w.textWidth(t.content)+20}}return(e=e instanceof jQuery?e:$(e)).data("gridtooltip",t),t},showTooltip:function(e){var t=this;if(this.tooltip){var i=$(this.tooltip),s=this.tooltip.querySelector(".tooltip-content");if(s){s.innerHTML=e.content,this.tooltip.classList.remove("is-hidden","top","right","bottom","left"),this.tooltip.style.display="",this.tooltip.classList.add(e.placement||"top"),e.isError&&this.tooltip.classList.add("is-error"),e.extraClassList&&e.extraClassList.map(function(e){return t.tooltip.classList.add(e)});var n="number"==typeof e.distance?e.distance:10,a={x:0,y:n,container:this.element.closest(".page-container.scrollable")||$("body"),containerOffsetX:e.wrapper.offsetLeft,containerOffsetY:e.wrapper.offsetTop,parent:$(e.wrapper),placement:e.placement||"top",strategies:["flip","nudge"]};"left"!==a.placement&&"right"!==a.placement||(a.x=n,a.y=0),i.data("place")||i.place(a),i.data("place").place(a),i.data("gridtooltip",!0),i.one("afterplace.gridtooltip",function(e,i){t.handleAfterPlaceTooltip(e,i)}).on("click.gridtooltip",function(){t.hideTooltip()}),$("body, .scrollable").off("scroll.gridtooltip").on("scroll.gridtooltip",function(){t.hideTooltip()})}}},handleAfterPlaceTooltip:function(e,t){var i=$("#tooltip");i[0]&&(i.data("place").setArrowPosition(e,t,i),i.triggerHandler("tooltipafterplace",[t]))},hideTooltip:function(){var e=this;this.tooltip&&(this.removeTooltipData(this.tooltip),this.tooltip.classList.add("is-hidden"),this.tooltip.classList.remove("is-error","popover","alternate","content-tooltip"),this.tooltip.style.left="-999px"),$("body, .scrollable").off("scroll.gridtooltip",function(){e.hideTooltip()})},isGridtooltip:function(){var e=!1;this.tooltip&&((this.tooltip instanceof jQuery?this.tooltip:$(this.tooltip)).data("gridtooltip")&&(e=!0));return e},removeTooltipData:function(e){(e=e instanceof jQuery?e:$(e)).data("gridtooltip")&&$.removeData(e[0],"gridtooltip")},removeTooltip:function(){var e=this;if(this.tooltip){var t=$(this.tooltip),i={th:".datagrid-header th",td:'.datagrid-body tr.datagrid-row td[role="gridcell"]:not(.rowstatus-cell)',rowstatus:'.datagrid-body tr.datagrid-row td[role="gridcell"] .icon-rowstatus'};i.str=i.th+", "+i.td+", "+i.rowstatus,$("body, .scrollable").off("scroll.gridtooltip"),t.off("touchend.gridtooltip"),this.element.off("mouseenter.gridtooltip mouseleave.gridtooltip click.gridtooltip longpress.gridtooltip keydown.gridtooltip",i.str),this.toolbar&&this.toolbar.parent().find(".table-errors").length>0&&this.toolbar.parent().find(".table-errors").off("mouseenter.tableerrortooltip",".icon").off("mouseleave.tableerrortooltip click.tableerrortooltip",".icon").off("longpress.tableerrortooltip",".icon");var s=t.data("place");s&&s.destroy(),[].slice.call(this.element[0].querySelectorAll(i.str)).forEach(function(t){return e.removeTooltipData(t)}),this.tooltip.parentNode&&this.tooltip.parentNode.removeChild(this.tooltip)}this.tooltip=void 0},destroy:function(){this.removeTooltip(),this.element.add(this.element.find("*")).off("selected.gridpopupth close.gridpopupth selected.gridpopuptr close.gridpopuptr selected.gridpopupbtn close.gridpopupbtn"),this.pagerAPI&&(this.pagerAPI.element.off("afterpaging.datagrid"),this.tableBody.off("page.datagrid pagesizechange.datagrid"),this.pagerAPI.destroy()),this.element.off().empty().removeClass("datagrid-container");var e=this.element.prev(".toolbar");if(this.triggerDestroyCell(),this.removeToolbarOnDestroy&&this.settings.toolbar&&this.settings.toolbar.keywordFilter){var t=e.find(".searchfield");t.data("searchfield")&&t.data("searchfield").destroy(),t.removeData("options")}return this.removeToolbarOnDestroy&&(e.data("toolbar")&&e.data("toolbar").destroy(),e.remove()),this.element.next(".pager-toolbar").remove(),$.removeData(this.element[0],"datagrid"),this.element.off(),$(document).off("touchstart.datagrid touchend.datagrid touchcancel.datagrid click.datagrid touchmove.datagrid"),this.bodyContainer.off().remove(),$("body").off("resize.vtable resize.datagrid"),$(window).off("orientationchange.datagrid"),this},updated:function(e){return this.settings=m.mergeSettings(this.element,e,this.settings),e&&e.frozenColumns&&(this.headerRow=void 0,this.element.empty(),this.firstRender()),e&&e.dataset&&(this.settings.dataset=e.dataset),e&&e.columns&&(this.settings.columns=e.columns),this.render(),this}},$.fn.datagrid=function(e){return this.each(function(){var t=$.data(this,"datagrid");t?t.updated(e):t=$.data(this,"datagrid",new Es(this,e))})};var Ls={};function Ps(e,t){if(!(e instanceof HTMLElement))throw new Error("Element used for `FormCompact` component must be an instance of HTMLElement");this.settings=m.mergeSettings(e,t,Ls),this.element=e,this.init()}Ps.prototype={init:function(){this.form=this.element.querySelector("form"),this.inputs=m.getArrayFromList(this.element.querySelectorAll("input")),this.renderProps(),this.handleEvents()},renderProps:function(){var e=this;if(this.inputs&&this.inputs.length){var t=["disabled","readonly"];this.inputs.forEach(function(i){t.forEach(function(t){e.setState(t,i)})})}},handleEvents:function(){var e=this;$(this.form).on("focusin.formcompact","input",function(t){return e.handleFocusIn(t)}).on("focusout.formcompact","input",function(t){return e.handleFocusOut(t)});var t=["disabled","readonly"];this.inputsObserver=new MutationObserver(function(i){i.length&&i.forEach(function(i){"attributes"===i.type&&t.indexOf(i.attributeName)>-1&&e.setState(i.attributeName,i.target)})});var i={attributes:!0};this.inputs.forEach(function(t){e.inputsObserver.observe(t,i)})},handleFocusIn:function(e){n.parents(e.target,".column, .columns",!0).classList.add("is-focused")},handleFocusOut:function(e){n.parents(e.target,".column, .columns",!0).classList.remove("is-focused")},setState:function(e,t){if("string"==typeof e&&t instanceof HTMLElement){if(!(["checkbox","radio"].indexOf(t.type)>-1)){"readonly"===e&&(e="readOnly");var i=!0===t[e]?"add":"remove";t.parentNode.classList[i]("is-"+e.toLowerCase())}}},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown(),this.init()},teardown:function(){this.inputsObserver.disconnect(),delete this.inputsObserver,$(this.form).off(["focusin.formcompact","focusout.formcompact"].join(" ")),delete this.form,delete this.inputs},destroy:function(){this.teardown(),$.removeData(this.element,"formcompact")}},$.fn.formcompact=function(e){return this.each(function(){var t=$.data(this,"formcompact");t?t.updated(e):t=$.data(this,"formcompact",new Ps(this,e))})};var Ms={addScrollClass:!1,demoOptions:!0,tabs:null,toolbarSettings:void 0,useAlternate:!1,useBackButton:!0,useBreadcrumb:!1,useFlexToolbar:!1,usePopupmenu:!1,wizardTicks:null};function Bs(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Ms),this.init()}Bs.prototype={get toolbarAPI(){if(this.toolbarElem)return this.toolbarElem.data("toolbar-flex")||this.toolbarElem.data("toolbar")},get toolbar(){return S("toolbarAPI","toolbar"),this.toolbarAPI},get titleButton(){var e=".title > button";return this.toolbarElem&&this.toolbarElem.is(".flex-toolbar")&&(e=".toolbar-section:first-child > button"),this.element.find(e)},get hasTitleButton(){return this.titleButton.length>0},init:function(){this.setup().build().handleEvents(),this.settings.demoOptions&&this.initPageChanger()},setup:function(){return this.settings.demoOptions=this.element.attr("data-demo-options")?"true"===this.element.attr("data-demo-options"):this.settings.demoOptions,this.settings.useBackButton=this.element.attr("data-use-backbutton")?"true"===this.element.attr("data-use-backbutton"):this.settings.useBackButton,this.settings.useBreadcrumb=this.element.attr("data-use-breadcrumb")?"true"===this.element.attr("data-use-breadcrumb"):this.settings.useBreadcrumb,this.settings.useAlternate=this.element.attr("data-use-alternate")?"true"===this.element.attr("data-use-alternate"):this.settings.useAlternate,this.settings.tabs=$.isArray(this.settings.tabs)?this.settings.tabs:null,this.settings.wizardTicks=$.isArray(this.settings.wizardTicks)?this.settings.wizardTicks:null,this.titleText=this.element.find(".title > h1"),this.levelsDeep=[],this.levelsDeep.push(""+this.titleText.text()),this},build:function(){var e=!1,t=this.element.find(".toolbar, .flex-toolbar");if(!t.length)return this;t.is(".flex-toolbar")&&(e=!0),this.toolbarElem=t;var i=this.settings.toolbarSettings;if(this.toolbarElem[e?"toolbarflex":"toolbar"](i),!this.hasTitleButton&&this.levelsDeep.length>1&&this.buildTitleButton(),this.settings.tabs&&this.settings.tabs.length&&this.buildTabs(),this.settings.wizardTicks&&this.settings.wizardTicks.length&&this.buildWizard(),this.settings.usePopupmenu&&this.buildPopupmenu(),this.settings.addScrollClass){var s=$(this.element),n=$(this.element).next(".scrollable"),a=1===n.length?n:$(window),r=this.settings.scrollThreshold?this.settings.scrollThreshold:15;a.on("scroll.header",function(){this.scrollTop>r?s.addClass("is-scrolled-down"):s.removeClass("is-scrolled-down")}),a.scrollTop()>r&&s.addClass("is-scrolled-down")}return this},buildTitleButton:function(){if(this.levelsDeep.length>1&&!this.hasTitleButton&&!this.titleButton.length){this.toolbarAPI.teardown();var e=$('<button class="btn-icon back-button" type="button">\n        <span class="audible">'+k.translate("Drillup")+'</span>\n        <span class="icon app-header go-back">\n          <span class="one"></span>\n          <span class="two"></span>\n          <span class="three"></span>\n        </span>\n      </button>'),t=this.toolbarElem.find(".title");if(this.settings.useFlexToolbar){var i=t.prev(".toolbar-section");i.length||(i=$('<div class="toolbar-section"></div>').insertBefore(t)),e.prependTo(i)}else e.prependTo(t);this.toolbarAPI.init()}this.toolbarElem.addClass("has-title-button"),this.titleButton.find(".icon.app-header").addClass("go-back");var s=$("#application-menu").data("applicationmenu");s?s.modifyTriggers([this.titleButton],null,!0):$("#application-menu").applicationmenu({triggers:[this.titleButton]}),this.handleTitleButtonEvents()},buildBreadcrumb:function(){var e=this,t="has-breadcrumb";this.settings.useAlternate&&(t="has-alternate-breadcrumb"),this.element.addClass(t),this.breadcrumb=this.element.find(".breadcrumb"),this.breadcrumb.length||(this.breadcrumb=$('<nav class="breadcrumb hidden" role="navigation"></nav>').appendTo(this.element),this.breadcrumb.on("click","a",function(t){e.handleBreadcrumbClick(t)})),this.breadcrumb[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),this.adjustBreadcrumb()},adjustBreadcrumb:function(){var e=this.levelsDeep[this.levelsDeep.length-1];this.breadcrumb.empty();var t=$('<ol aria-label="breadcrumb"></ol>').appendTo(this.breadcrumb);$.each(this.levelsDeep,function(i,s){var n="";e===s&&(n=" current"),t.append($('<li><a href="#" class="hyperlink'+n+'">'+s+"</a></li>"))})},buildTabs:function(){if(this.tabsContainer=this.element.find(".tab-container"),!this.tabsContainer.length){this.tabsContainer=$('<div class="tab-container"></div>').appendTo(this.element);var e=$('<ul class="tab-list" role="tablist"></ul>').appendTo(this.tabsContainer);$('<li class="tab"><a href="#header-tabs-home" role="tab">IDS Enterprise Controls | Patterns</a></li>').appendTo(e),$('<li class="tab"><a href="#header-tabs-level-1" role="tab">Level 1 Detail</a></li>').appendTo(e),$('<li class="tab"><a href="#header-tabs-level-2" role="tab">Level 2 Detail</a></li>').appendTo(e)}this.element.addClass(this.settings.useAlternate?"has-alternate-tabs":"has-tabs"),this.tabsContainer[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),$("#header-tabs-level-1").removeAttr("style"),$("#header-tabs-level-2").removeAttr("style"),this.tabsContainer.tabs({containerElement:"#maincontent"})},buildWizard:function(){if(this.element.addClass("has-wizard"),this.wizard=this.element.find(".wizard"),!this.wizard.length){this.wizard=$('<div class="wizard"></div>').appendTo(this.element);var e=$('<div class="wizard-header"></div>').appendTo(this.wizard),t=$('<div class="bar"></div>').appendTo(e);$('<div class="completed-range"></div>').appendTo(t),$('<a href="#" class="tick current"><span class="label">Context Apps</span></a>').appendTo(t),$('<a href="#" class="tick"><span class="label">Utility Apps</span></a>').appendTo(t),$('<a href="#" class="tick"><span class="label">Inbound Configuration</span></a>').appendTo(t),$('<a href="#" class="tick"><span class="label">OID Mapping</span></a>').appendTo(t)}this.wizard[this.settings.useAlternate?"addClass":"removeClass"]("alternate"),this.wizard.wizard()},buildPopupmenu:function(){this.toolbarAPI.teardown();var e=this.toolbarElem.children(".title");if(this.titlePopup=e.find(".btn-menu"),!this.titlePopup.length){var t=e.find("h1");t.wrap('<button id="header-menu" type="button" class="btn-menu"></button>'),this.titlePopup=t.parent(".btn-menu")}this.titlePopupMenu=this.titlePopup.next(".popupmenu"),this.titlePopupMenu.length||(this.titlePopupMenu=$('<ul class="popupmenu is-selectable"></ul>').insertAfter(this.titlePopup),$('<li class="is-checked"><a href="#">Page One Title</a></li><li><a href="#">Page Two Title</a></li><li><a href="#">Page Three Title</a></li><li class="is-disabled"><a href="#">Page Four Title</a></li><li><a href="#">Page Five Title</a></li>').appendTo(this.titlePopupMenu)),this.titlePopupMenu.addClass("is-selectable");var i=this.titlePopupMenu.children(".is-checked").first().text();i||(i=this.titlePopupMenu.children().first().text()),this.titlePopup.children("h1").text(i),this.titlePopup.button().popupmenu(),this.element.addClass("has-popupmenu-title"),this.toolbarAPI.init()},handleEvents:function(){var e=this;return this.element.on("updated.header",function(t,i){e.updated(i)}).on("reset.header",function(){e.reset()}).on("drilldown.header",function(t,i){e.drilldown(i)}).on("drillup.header",function(t,i){e.drillup(i)}),this.handleTitleButtonEvents(),this.titlePopup&&this.titlePopup.length&&this.titlePopup.on("selected.header",function(e,t){var i=void 0;i=t instanceof $?t.text():$(t.element).text(),$(this).children("h1").text(i)}),this},handleTitleButtonEvents:function(){var e=this;this.titleButton&&this.titleButton.length&&this.titleButton.bindFirst("click.header",function(t){e.levelsDeep.length>1&&(t.stopImmediatePropagation(),e.drillup(),t.returnValue=!1)})},handleBreadcrumbClick:function(e){var t=$(e.target).parent(),i=this.breadcrumb.find("li"),s=i.index(t),n=void 0;if(!t.hasClass("current"))if(0!==s){if(s<i.length-1)for(n=i.length-1-s;n>0;)this.drillup(),n-=1}else this.reset()},initPageChanger:function(){var e=this.element.find(".page-changer"),t=e.next().find("li.personalization-colors");if(t.length>0){var i=H.personalizationColors(),s=t.parent().hasClass("popupmenu")?"":'<li class="heading" role="presentation">Personalization</li>';Object.keys(i).forEach(function(e){return s+='<li class="is-selectable'+("Default"===i[e].name?" is-checked is-default":"")+'"><a href="#" data-rgbcolor="'+i[e].value+'">'+i[e].name+"</a></li>",e}),t.replaceWith(s)}e.on("selected.header",function(t,i){var s=i.attr("data-theme-name"),n=i.attr("data-theme-variant");if(s||n){var a=e.next().find(".is-checked a[data-theme-name]").attr("data-theme-name"),r=e.next().find(".is-checked a[data-theme-variant]").attr("data-theme-variant");a&&r&&j.setTheme(a+"-"+r)}else{var o=i.attr("data-theme");if(o)j.setTheme(o);else if(i.parent().hasClass("is-default"))j.setColorsToDefault();else{var l=i.attr("data-rgbcolor");j.setColors(l)}}});var n=H.currentTheme;if("theme-soho-light"!==n.id){var a=n.id.split("-");this.element.find("[data-theme-name]").parent().removeClass("is-checked"),this.element.find('[data-theme-name="'+a[0]+"-"+a[1]+'"]').parent().addClass("is-checked"),this.element.find("[data-theme-variant]").parent().removeClass("is-checked"),this.element.find('[data-theme-variant="'+a[2]+'"]').parent().addClass("is-checked")}if(j.settings.colors){var r="object"===u(j.settings.colors)?j.settings.colors.header:j.settings.colors;r=r.replace("#",""),this.element.find("[data-rgbcolor]").parent().removeClass("is-checked"),this.element.find('[data-rgbcolor="#'+r+'"]').parent().addClass("is-checked")}},drilldown:function(e){this.element.addClass("is-drilldown"),this.levelsDeep.push(e.toString()),this.titleText.text(this.levelsDeep[this.levelsDeep.length-1]),this.settings.useBackButton&&this.buildTitleButton(),this.settings.useBreadcrumb&&(this.breadcrumb&&this.breadcrumb.length?this.adjustBreadcrumb():(this.buildBreadcrumb(),this.breadcrumb.css({display:"block",height:"auto"}).removeClass("hidden")))},drillup:function(e){var t=void 0;if(this.element.removeClass("is-drilldown"),this.levelsDeep.length>1&&(this.levelsDeep.pop(),t=this.levelsDeep[this.levelsDeep.length-1]),void 0!==e&&(t=e),this.levelsDeep.length>1)return this.settings.useBreadcrumb&&this.adjustBreadcrumb(),void this.titleText.text(t);t=this.levelsDeep[0],this.settings.useBackButton&&this.removeButton(),this.settings.useBreadcrumb&&this.removeBreadcrumb(),this.settings.usePopupmenu&&this.removePopupmenu(),this.titleText.text(t),this.element.trigger("drillTop")},reset:function(){for(;this.levelsDeep.length>1;)this.levelsDeep.pop();return this.titleText.text(this.levelsDeep[0]),this.removeBreadcrumb(),this.removeTabs(),this.removeWizard(),this.removePopupmenu(),this.removeButton(),this.element.trigger("afterreset"),this},removeButton:function(){if(this.hasTitleButton)this.titleButton.find(".icon.app-header").removeClass("go-back");else if(this.titleButton&&this.titleButton.length){this.toolbarAPI.teardown();var e=$("#application-menu").data("applicationmenu");e&&e.modifyTriggers([this.titleButton],!0,!0),this.titleButton.off("click.header").remove(),this.titleButton=$(),this.toolbarAPI.init()}},removeBackButton:function(){this.titleButton.length&&this.element.find(".go-back").removeClass("go-back")},removeBreadcrumb:function(){if(this.breadcrumb&&this.breadcrumb.length){var e=this,t=$.fn.transitionEndName(),i=void 0;e.element.removeClass("has-breadcrumb").removeClass("has-alternate-breadcrumb"),this.breadcrumb.is(":not(:hidden)")?(this.element.one(t+".breadcrumb-header",s),i=setTimeout(s,300)):s()}function s(){i&&(clearTimeout(i),i=null),e.element.off(t+".breadcrumb-header"),e.breadcrumb.off().remove(),e.breadcrumb=$()}},removeTabs:function(){if(this.tabsContainer&&this.tabsContainer.length){var e=this,t=$.fn.transitionEndName(),i=void 0;this.element.removeClass("has-tabs").removeClass("has-alternate-tabs"),this.tabsContainer.is(":not(:hidden)")?(this.element.one(t+".tabs-header",s),i=setTimeout(s,300)):s()}function s(){i&&(clearTimeout(i),i=null),e.element.off(t+".tabs-header"),e.tabsContainer.data("tabs").destroy(),e.tabsContainer.remove(),e.tabsContainer=null,$("#header-tabs-level-1").css("display","none"),$("#header-tabs-level-2").css("display","none")}},removeWizard:function(){if(this.wizard&&this.wizard.length){var e=this,t=$.fn.transitionEndName(),i=void 0;this.element.removeClass("has-wizard"),this.wizard.is(":not(:hidden)")?(this.element.one(t+".wizard-header",s),i=setTimeout(s,300)):s()}function s(){i&&(clearTimeout(i),i=null),e.element.off(t+".wizard-header"),e.wizard.data("wizard").destroy(),e.wizard.remove(),e.wizard=null}},removePopupmenu:function(){this.titlePopup&&this.titlePopup.length&&(this.toolbarAPI.teardown(),this.titlePopup.data("popupmenu").destroy(),this.titlePopup.data("button").destroy(),this.titlePopupMenu.remove(),this.titlePopup.children("h1").detach().insertBefore(this.titlePopup),this.titlePopup.remove(),this.titlePopup=void 0,this.titlePopupMenu=void 0,this.element.removeClass("has-popupmenu-title"),this.toolbarAPI.init())},unbind:function(){return this.titleButton&&this.titleButton.length&&this.titleButton.off("click.header"),this.titlePopup&&this.titlePopup.length&&this.titlePopup.off("updated.header"),this.element.off(["updated.header","reset.header","drilldown.header","drillup.header"].join(" ")),this},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.reset().unbind().init()},destroy:function(){this.unbind(),this.hasTitleButton&&this.toolbarElem.removeClass("has-title-button"),$.removeData(this.element[0],"header")}},$.fn.header=function(e){return this.each(function(){var t=$.data(this,"header");t?t.updated(e):t=$.data(this,"header",new Bs(this,e))})};var Rs="lookup-datagrid",Fs={click:null,field:"id",title:null,buttons:[],options:null,beforeShow:null,modalContent:null,editable:!0,typeahead:!1,autoApply:!0,validator:null,autoWidth:!1,clickArguments:{},delimiter:",",minWidth:400};function Os(e,t){this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Fs),this.init()}Os.prototype={init:function(){this.inlineLabel=this.element.closest("label"),this.inlineLabelText=this.inlineLabel.find(".label-text"),this.isInlineLabel=!!this.inlineLabelText.length,this.build(),this.handleEvents(),this.grid=null,this.selectedRows=null},build:function(){var e=this.element;var t,i=(t="lookup-wrapper",e.is(".input-xs")&&(t+=" xs"),e.is(".input-sm")&&(t+=" sm"),e.is(".input-lg")&&(t+=" lg"),t);if(this.element.is(".has-actions")&&(i+=" has-actions-wrapper"),this.icon=$('<span class="trigger" tabindex="-1"></span>').append($.createIcon("search-list")),this.isInlineLabel)this.inlineLabel.addClass(i);else if(this.container=$('<span class="'+i+'"></span>'),this.element.is(".field-options")){var s=this.element.closest(".field").find(".btn-actions");e.add(s).add(s.next(".popupmenu")).wrapAll(this.container)}else e.wrap(this.container);e.after(this.icon),e.hasClass("hidden")&&this.icon.addClass("hidden"),this.settings.autoWidth&&this.applyAutoWidth(),e.attr("data-mask")&&e.mask(),this.element.is(":disabled")&&this.disable(),this.settings.editable||this.element.attr("readonly","true").addClass("is-not-editable"),this.element.parent(".lookup-wrapper").next().is(".btn-actions")&&(this.element.data("fieldoptions")&&this.element.data("fieldoptions").destroy(),this.element.fieldoptions()),this.addAria(),void 0===e.attr("autocomplete")&&e.attr("autocomplete","off")},addAria:function(){this.label=this.isInlineLabel?this.inlineLabelText:$('label[for="'+this.element.attr("id")+'"]')},handleEvents:function(){var e=this;this.icon.on("click.lookup",function(t){e.openDialog(t)}),this.element.on("keyup.lookup",function(t){$("#autocomplete-list").length>0||40===t.which&&e.openDialog(t)})},openDialog:function(e){var t=this;if(!1!==t.element.triggerHandler("beforeopen")&&!(t.isDisabled()||t.isReadonly()&&!t.element.hasClass("is-not-editable")))if(t.settings.click)t.settings.click(e,this,t.settings.clickArguments);else{if(this.settings.beforeShow){return this.element.triggerHandler("start"),void this.settings.beforeShow(this,function(e){return e&&t.createGrid(e),("boolean"!=typeof e||!1!==e)&&(t.createModal(),t.element.triggerHandler("complete"),t.element.trigger("open",[t.modal,t.grid]),t.settings.validator&&t.settings.validator(t.element,t.modal,t.grid),!0)})}if(this.settings.options){t.createModal(),t.element.trigger("open",[t.modal,t.grid]),t.modal.element.find(".btn-actions").removeClass("is-selected"),t.grid&&t.grid.cellNode(0,0,!0).attr("tabindex","0");var i=t.modal.element.find(".toolbar .more > .btn-actions");i.length&&setTimeout(function(){m.fixSVGIcons(i)},600),t.element.trigger("afteropen",[t.modal,t.grid]),t.settings.validator&&t.settings.validator(t.element,t.modal,t.grid)}}},createModal:function(){var e=this,t='<div id="'+Rs+'"></div>',i=$('label[for="'+e.element.attr("id")+'"]');var s=e.isInlineLabel?e.inlineLabelText:i.length?i.clone().find("span").remove().end().text():e.settings.title?e.settings.title:"",n=this.settings.modalContent;n&&n instanceof jQuery&&(t=n,n.show()),!n||n instanceof jQuery||(t=n);var a=this.settings.buttons;(this.settings.options&&"multiple"===this.settings.options.selectable&&0===a.length||!e.settings.autoApply&&0===a.length)&&(a=[{text:k.translate("Cancel"),click:function(t,i){e.element.focus(),i.close()}},{text:k.translate("Apply"),click:function(t,i){i.close(),e.insertRows(e.grid.selectedRows())},isDefault:!0}]),this.settings.options&&"single"===this.settings.options.selectable&&0===a.length&&e.settings.autoApply&&(a=[{text:k.translate("Cancel"),click:function(t,i){e.element.focus(),i.close()}}]);var r=this.settings.options&&this.settings.options.toolbar&&this.settings.options.toolbar.keywordFilter;$("body").modal({title:s,content:t,buttons:a,cssClass:"lookup-modal"+(r?"":" lookup-no-search")}).off("open.lookup").on("open.lookup",function(){e.createGrid()}).off("close.lookup").on("close.lookup",function(){e.element.focus(),e.element.triggerHandler("close",[e.modal,e.grid])}),e.modal=$("body").data("modal"),this.settings.title||e.modal.element.find(".modal-title").append(' <span class="datagrid-result-count"></span>'),e.modal.element.off("afterclose.lookup").on("afterclose.lookup",function(){e.closeTearDown()}),setTimeout(function(){$(".modal.is-visible .searchfield").on("keypress.lookup",function(e){return 13!==e.keyCode})},300)},closeTearDown:function(){var e=$(".modal.is-visible .searchfield").off("keypress.lookup");e.data()&&e.data("searchfield")&&e.data("searchfield").destroy(),e.data()&&e.data("searchfield")&&(e.data("searchfield").destroy(),e.removeData()),e=null,this.grid&&this.grid.destroy&&(this.grid.deSelectAllRows(),this.grid.clearFilter(),this.grid.destroy(),this.grid=null)},createGrid:function(e){var t=this,i=void 0;e?(i=e,Rs=e.attr("id"),t.settings.options=e.data("datagrid").settings):i=t.modal.element.find("#"+Rs),this.settings.minWidth&&(i=this.applyMinWidth(i)),t.settings.options&&("single"===t.settings.options.selectable&&t.settings.autoApply&&(t.settings.options.cellNavigation=!1,i.find("tr").addClass("is-clickable")),t.settings.options.isList=!0,i.data("datagrid")||i.datagrid(t.settings.options)),t.grid=i.data("datagrid"),!this.settings.title&&t.modal&&t.modal.element.find(".title").not(".selection-count").remove();var s=this.settings.options&&this.settings.options.toolbar&&this.settings.options.toolbar.keywordFilter;!s&&t.modal&&t.modal.element.find(".toolbar").appendTo(t.modal.element.find(".modal-header")),s&&t.grid&&(!t.grid.filterExpr||t.grid.filterExpr&&t.grid.filterExpr[0]&&""!==t.grid.filterExpr[0].value)&&t.grid.keywordSearch(""),i.off("selected.lookup");var n=t.element.val();n&&!this.settings.options.source&&t.selectGridRows(n),this.settings.options.source&&i.off("afterpaging.lookup").on("afterpaging.lookup",function(){var e=t.element.val();e&&t.selectGridRows(e)}),this.settings.options&&i.on("selected.lookup",function(e,i){i&&0!==i.length&&(t.settings.validator&&t.settings.validator(t.element,t.modal,t.grid),"single"===t.settings.options.selectable&&t.settings.autoApply&&(t.modal.close(),t.insertRows()))})},selectGridRows:function(e){var t=e,i=!1;if(e){if(this.grid&&this.settings.options.source)for(var s=0;s<this.grid._selectedRows.length;s++)isNaN(this.grid._selectedRows[s].idx)&&this.grid._selectedRows.splice(s,1);if(t.indexOf(this.settings.delimiter)>1){for(var n=t.split(this.settings.delimiter),a=!1,r=0;r<n.length;r++)if(a=this.selectRowByValue(this.settings.field,n[r]),this.grid&&this.settings.options.source&&!a){for(var o={},l=!1,d=0;d<this.grid._selectedRows.length;d++)this.grid._selectedRows[d].data[this.settings.field].toString()===n[r].toString()&&(l=!0);l||(o[this.settings.field]=n[r],this.grid._selectedRows.push({data:o})),i=!0}i&&this.modal.element.find(".contextual-toolbar .selection-count").text(n.length+" "+k.translate("Selected"))}else this.selectRowByValue(this.settings.field,t)}},selectRowByValue:function(e,t){if(!this.settings.options)return!1;var i=this.settings.options.source?this.grid.settings.dataset:this.settings.options.dataset,s=[];if(!i)return!1;for(var n=0;n<i.length;n++){var a=!1;if("function"==typeof this.settings.match&&this.settings.match(t,i[n],this.element,this.grid)&&(a=!0),"function"!=typeof this.settings.match&&i[n][e].toString()===t.toString()&&(a=!0),a){var r=this.grid.settings.source?this.grid.actualRowIndex(this.grid.tableBody.find("tr").eq(n)):n;s.push(r)}}return!!(this.grid&&s.length>0)&&(this.grid.selectRows(s,!1,!0),!0)},insertRows:function(){var e="";this.selectedRows=this.grid.selectedRows();for(var t=0;t<this.selectedRows.length;t++){var i="";i="function"==typeof this.settings.field?this.settings.field(this.selectedRows[t].data,this.element,this.grid):this.selectedRows[t].data[this.settings.field],e+=(0!==t?this.settings.delimiter:"")+i;var s=this.selectedRows[t].idx;this.settings.options.dataset&&this.settings.options.dataset[s]&&delete this.settings.options.dataset[s]._selected}this.element.val(e).trigger("change",[this.selectedRows]),this.element.trigger("input",[this.selectedRows]),this.applyAutoWidth(),this.element.focus()},enable:function(){this.element.prop("disabled",!1).prop("readonly",!1),this.element.parent().removeClass("is-disabled")},disable:function(){this.element.prop("disabled",!0),this.element.parent().addClass("is-disabled")},readonly:function(){this.element.prop("readonly",!0)},applyAutoWidth:function(){var e=this.element.val(),t=e.length,i=e===e.toUpperCase(),s=!isNaN(e);this.element.attr("size",t+(i&&!s?2:1))},applyMinWidth:function(e){if(null==this.settings.minWidth)return e;if($(window).width()>this.settings.minWidth){var t=this.settings.minWidth+"px";e.css({"min-width":t})}return e},isDisabled:function(){return this.element.prop("disabled")},isReadonly:function(){return this.element.prop("readonly")},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings))},updateDataset:function(e,t){this.settings.options.dataset=e,t&&t.activePage&&(this.settings.options.activePage=t.activePage),t&&t.pagesize&&(this.settings.options.pagesize=t.pagesize),this.grid&&this.grid.updateDataset(e,t)},destroy:function(){$.removeData(this.element[0],"lookup"),$(".modal .searchfield").off("keypress.lookup"),$("body").off("open.lookup close.lookup"),this.modal&&this.modal.element&&(this.modal.element.off("afterclose.lookup"),"function"==typeof this.modal.destroy&&this.modal.destroy()),this.element.off("keyup.lookup"),this.icon.off("click.lookup"),this.icon.remove(),this.element.unwrap()}},$.fn.lookup=function(e){return this.each(function(){var t=$.data(this,"lookup");t?t.updated(e):t=$.data(this,"lookup",new Os(this,e))})};var Ns={tabContainers:[]},zs=["primary","secondary","tertiary"];function Hs(e,t){return this.element=$(e),this.settings=m.mergeSettings(this.element[0],t,Ns),this.tabContainers={},this.init()}Hs.prototype={init:function(){var e=this,t=[];t=this.settings.tabContainers instanceof Array&&this.settings.tabContainers.length?this.settings.tabContainers:this.element.find(".tab-container").filter(function(){return!$(this).parents(".tab-panel-container").length}),$(t).each(function(){e.setupTabsInstance($(this))})},setupTabsInstance:function(e){if(e instanceof $){var t=this,i=!1;if(zs.forEach(function(s){if(!i&&!Object.prototype.hasOwnProperty.call(t.tabContainers,s)){var n=e.data("tabs");n||(e.tabs(),n=e.data("tabs")),n.multitabsID=s,e.attr("data-multitabs",s),t.tabContainers[s]=e,i=!0}}),!i)throw new Error("all tab-container slots in MultiTabs component are taken, so a new tabs container was not invoked and stored")}},add:function(e,t,i,s){return(e=this.checkForValidTabContainer(e)).data("tabs").add(t,i,s)},remove:function(e,t,i){return(e=this.checkForValidTabContainer(e)).data("tabs").remove(t,i)},move:function(e,t,i){if(!e||!t)throw new Error("can't move a tab without both a tabId and a targetTabContainerName");var s=void 0,n=void 0,a=this.getFilterableTabContainers(),r=void 0;if(a.each(function(){var t=$(this).data("tabs"),i=t.getTab(null,e);null!==i&&(r=t.multitabsID,s=i.clone(),n=t.getPanel(e).children())}),!s)throw new Error('No tab markup was found in any Multitabs container for href "'+e+'"');this.remove(r,e),this.add(t,e,{name:s.children("a").text().trim(),content:n,doActivate:i})},getTabContainer:function(e){var t=this,i=void 0;return zs.forEach(function(s){!i&&t.tabContainers[s]&&e===s&&(i=t.tabContainers[s])}),i},getFilterableTabContainers:function(){var e=$();return this.performOnAllContainers(function(t,i){e=e.add(i)}),e},checkForValidTabContainer:function(e){if(!e)throw new Error("Need to have a tabContainer defined to hide a tabs instance");if("string"==typeof e&&(e=this.getTabContainer(e)),!(e instanceof $&&e.length))throw new Error("No matching tabContainer could be found and hidden.");return e},performOnAllContainers:function(e,t){var i=this;Array.isArray(t)||(t=t?[t]:[]),zs.forEach(function(s){var n=i.tabContainers[s],a=[];n&&(a.push(s,n),a=a.concat(t),e.apply(this,a))})},adjustModuleTabContainers:function(){this.performOnAllContainers(function(e,t){var i=t.data("tabs");i.isModuleTabs()&&i.adjustModuleTabs()})},hideTabsInstance:function(e){(e=this.checkForValidTabContainer(e)).parent(".multitabs-section").addClass("hidden"),this.adjustModuleTabContainers()},showTabsInstance:function(e){(e=this.checkForValidTabContainer(e)).parent(".multitabs-section").removeClass("hidden"),this.adjustModuleTabContainers()},destroyTabsInstance:function(e){if(e instanceof $&&e.data("tabs")&&"function"==typeof e.data("tabs").destroy){var t=this,i=!1;if(zs.forEach(function(s){if(!i&&t.tabContainers[s].is(e)){var n=e.data("tabs");delete n.multitabsID,e.removeAttr("data-multitabs"),n.destroy(),delete t.tabContainers[s],i=!0}}),!i)throw new Error("could not destroy a tabContainer because it was not associated with this Multitabs instance")}},isHidden:function(e){return(e=this.checkForValidTabContainer(e)).parent(".multitabs-section").is(".hidden")},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings))},teardown:function(){var e=this;return Object.keys(this.tabContainers).forEach(function(t){e.destroyTabsInstance(t)}),this},destroy:function(){this.teardown(),$.removeData(this.element[0],"multitabs")}},$.fn.multitabs=function(e){return this.each(function(){var t=$.data(this,"multitabs");t?t.updated(e):t=$.data(this,"multitabs",new Hs(this,e))})};var qs={backElement:void 0,edgeBleed:!1,edgeBleedBreakpoint:"phone",listElement:void 0,listCloseElement:void 0,detailElement:void 0},Vs=["accordion","listview"];function Ws(e){if(e instanceof HTMLElement){var t=Object.keys($(e).data()),i=void 0;return t.forEach(function(e){Vs.indexOf(e)>-1&&(i=e)}),i}}function js(e,t){e instanceof HTMLElement&&(this.element=e,this.settings=m.mergeSettings(this.element,t,qs),this.init())}js.prototype={init:function(){var e=this;if(this.setInternalElementReference("listElement",function(t){return(i=e.settings[t])instanceof HTMLElement&&void 0!==Ws(i);var i}),this.setInternalElementReference("detailElement"),this.setInternalElementReference("backElement"),this.setInternalElementReference("listCloseElement"),this.showDetail=!1,this.element.classList.contains("show-detail")&&(this.showDetail=!0),this.listElement){this.listComponentType=Ws(this.listElement);var t=this.getListAPI();t&&(t.isControllingDetails=!0)}if(this.backElement){this.backElement.classList.add("list-detail-back-button");var i=this.backElement.querySelector(".icon");i&&(this.backElementIcon=i),this.listContainsBackElement=this.listElement.contains(this.backElement),this.detailContainsBackElement=this.detailElement.contains(this.backElement)}var s=this.element.querySelectorAll(".list-detail");s&&(this.childrenListDetailElements=s),this.settings.edgeBleed?(this.edgeBleed=!0,this.element.classList.add("bleeding-edge__"+this.settings.edgeBleedBreakpoint)):(this.edgeBleed=!1,this.element.classList.remove("bleeding-edge__phone","bleeding-edge__tablet")),this.setBreakpointChecks(),this.handleEvents()},setBreakpointChecks:function(){this.abovePhoneBreakpoint=a.isAbove("phone-to-tablet"),this.aboveTabletBreakpoint=a.isAbove("desktop")},setInternalElementReference:function(e,t){if("string"==typeof this.settings[e]&&this.settings[e].length){var i=document.querySelector(this.settings[e]);i&&(this.settings[e]=i)}t="function"!=typeof t||t(e),this.settings[e]instanceof HTMLElement&&t&&(this[e]=this.settings[e])},handleEvents:function(){var e=this;$(this.element).on("drilldown.listdetail",function(t,i){t.stopPropagation(),e.drilldown(i,t.target)}).on("drillup.listdetail",function(t){t.stopPropagation(),e.drillup()}),this.backElement&&this.backElement.addEventListener("click",this.handleBackClick.bind(this)),this.listCloseElement&&this.listCloseElement.addEventListener("click",this.handleClose.bind(this)),$("body").off("resize.listdetail").on("resize.listdetail",function(){e.handleResize()})},drilldown:function(e,t){this.showDetail||t&&t.innerHTML!==this.listElement.innerHTML||(this.showDetail=!0,this.element.classList.add("show-detail"),this.addBackElementIconContext(),this.isAboveBreakpoint()||this.getListAPI().disable(),this.detailArea&&$(this.detailElement).triggerHandler("activatescreen",[e]))},drillup:function(){this.showDetail&&(this.removeBackElementIconContext(),this.getListAPI().enable(),this.showDetail=!1,this.element.classList.remove("show-detail"))},addBackElementIconContext:function(){this.showDetail&&this.backElementIcon&&!this.backElementIcon.classList.contains("go-back")&&this.backElementIcon.classList.add("go-back")},removeBackElementIconContext:function(){this.backElementIcon&&this.backElementIcon.classList.contains("go-back")&&this.backElementIcon.classList.remove("go-back")},handleBackClick:function(e){function t(){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()}if(!this.showDetail){if(this.edgeBleed){var i=this.getCurrentSelectedListItem();if(i)return this.drilldown(i),t(),!1}return!0}return this.drillup(),this.childrenListDetailElements&&this.childrenListDetailElements.forEach(function(e){var t=$(e).data("listdetail");t&&"function"==typeof t.drillup&&t.drillup()}),t(),!1},handleClose:function(){if(!this.showDetail){var e=this.getCurrentSelectedListItem();this.drilldown(e)}},handleResize:function(){this.setBreakpointChecks();var e=this.getListAPI();this.isAboveBreakpoint()?this.edgeBleed&&!this.showDetail&&this.listElement.classList.contains("is-disabled")&&e.enable():this.edgeBleed&&this.showDetail&&!this.listElement.classList.contains("is-disabled")&&e.disable(),this.isAboveBreakpoint()?this.removeBackElementIconContext():this.addBackElementIconContext(),a.isAbove("desktop")&&e.enable()},isAboveBreakpoint:function(){var e=this.settings.edgeBleedBreakpoint;return this["above"+w.capitalize(e)+"Breakpoint"]},getListAPI:function(){if(this.listElement)return $(this.listElement).data(this.listComponentType)},getCurrentSelectedListItem:function(){if(!this.listElement)return"";var e=void 0,t=this.getListAPI();switch(this.listComponentType){case"accordion":default:e=t.getSelected()}return e=n.convertToHTMLElement(e)},updated:function(e){e&&(this.settings=m.mergeSettings(this.element[0],e,this.settings)),this.teardown(),this.init()},teardown:function(){if($("body").off("resize.listdetail"),$(this.element).off("drilldown.listdetail drillup.listdetail"),this.backElement&&this.backElement.removeEventListener("click",this.handleBackClick.bind(this)),this.listCloseElement&&this.listCloseElement.removeEventListener("click",this.handleClose.bind(this)),this.listComponentType){var e=this.getListAPI();e&&delete e.isControllingDetails}delete this.listElement,delete this.detailElement,delete this.backElement,delete this.backElementIcon,delete this.edgeBleed,delete this.listContainsBackElement,delete this.detailContainsBackElement,delete this.childrenListDetailElements,delete this.showDetail},destroy:function(){this.teardown(),$.removeData(this.element,"listdetail")}},$.fn.listdetail=function(e){return this.each(function(){var t=$.data(this,"listdetail");t?t.updated(e):(t=$.data(this,"listdetail",new js(this,e))).destroy=function(){this.teardown(),$.removeData(this,"listdetail")}})};var Gs={linearProgression:!1,folderIconOpen:"caret-up",folderIconClosed:"caret-down",stepList:"#step-list",stepLi:".js-step",stepLink:".js-step-link",stepFolder:".js-step-folder",btnPrev:".js-step-link-prev",btnNext:".js-step-link-next",btnSaveClose:".js-btn-save-changes",beforeSelectStep:null};function Us(e,t){this.settings=m.mergeSettings(e,t,Gs),this.element=$(e),this.init(),A("Stepprocess")}Us.prototype={init:function(){this.stepListJq=$(this.settings.stepList),this.initStepprocess(),this.handleKeys(),this.setupEvents(),this.focusFirst()},initStepprocess:function(){for(var e=this.stepListJq.find(this.settings.stepLi),t=0,i=e.length;t<i;t++)this.decorateNode(e[t]);var s=$(this.settings.stepLi+".is-selected").find(this.settings.stepLink);this.selectStep(s)},decorateNode:function(e){var t=$(e),i=t.children(this.settings.stepLink),s=t.children(this.settings.stepFolder),n=i.hasClass("is-disabled"),a=s.hasClass("is-open");if(n&&i.attr("aria-disabled","true"),s.length){if(t.addClass("folder"),s.attr("role","group"),n&&(s.addClass("disabled"),a))for(var r=s.children(),o=0,l=r.length;o<l;o++)$(r[o]).find(this.settings.stepLink).addClass("is-disabled").attr("aria-disabled","true");i.attr("aria-expanded",a)}var d=i.parentsUntil(this.stepListJq,"ul").length-1,c=t.index(),h=t.siblings().addBack().length;i.attr({role:"stepitem",tabindex:"-1","aria-selected":"false","aria-level":d+1,"aria-posinset":c+1,"aria-setsize":h,"aria-disabled":n}).addClass("hide-focus").hideFocus()},focusFirst:function(){this.stepListJq.find(this.settings.stepLi+":first").attr("tabindex","0")},folderClose:function(e){var t=this,i=$(e),s=i.children(this.settings.stepLink),n=i.children(this.settings.stepFolder),a=s.closest(".folder").removeClass("is-open").end().find("svg.icon-tree");this.setIcon(a,this.settings.folderIconClosed),this.isAnimating=!0,n.one("animateclosedcomplete",function(){n.removeClass("is-open"),t.isAnimating=!1}).animateClosed(),s.attr("aria-expanded","false")},folderOpen:function(e){var t=this,i=$(e);if(!this.isOpen(i)){var s=i.children(this.settings.stepLink),n=i.children(this.settings.stepFolder);i.addClass("is-open"),s.attr("aria-expanded","true");var a=s.find("svg.icon-tree");this.setIcon(a,this.settings.folderIconOpen),this.isAnimating=!0,n.one("animateopencomplete",function(){t.isAnimating=!1}).addClass("is-open").css("height",0).animateOpen()}},folderToggle:function(e){var t=e.closest(this.settings.stepLi);if(this.isFolder(t)){var i=t.children(this.settings.stepFolder);this.isOpen(i)?this.folderClose(t):this.folderOpen(t)}},getSelectedStep:function(){return $(this.settings.stepLi+".is-selected",this.stepListJq)},getNextNode:function(e){var t=this.settings,i=e.parent().next().find(t.stepLink+":first");if(e.next().is(t.stepFolder)&&e.next().hasClass("is-open")&&(i=e.next().find(t.stepLink+":first")),i.hasClass("is-disabled")&&(i=this.getNextNode(i)),0===i.length)for(var s=0,n=e;s<2&&!(i=(n=n.parent().closest(".folder")).next().find(t.stepLink+":first")).length;s++);return i},getNextStep:function(e){var t=e.children(this.settings.stepLink),i=e.next(this.settings.stepFolder),s=this.getNextNode(t),n=s.next(this.settings.stepFolder),a=null,r=null;return(a=i.length?(r=i).children().length?r.find(this.settings.stepLink).first():s:n.length&&(r=n).children().length?r.find(this.settings.stepLink).first():s).hasClass("is-disabled")&&(a=this.getNextStep(a.parent())),a},getPreviousNode:function(e){var t=this.settings,i=e.parent().prev().find(t.stepLink+":first"),s=i.closest(t.stepLi);return s.is(".folder.is-open")&&s.find("ul.is-open a").length&&!s.find("ul.is-disabled").length&&(i=s.find("ul.is-open "+t.stepLink+":last")),i.hasClass("is-disabled")&&this.getPreviousNode(i),0===i.length&&(i=e.closest(t.stepFolder).prev(t.stepLink)),i},getPreviousStep:function(e){var t=this.settings,i=e.children(t.stepLink),s=this.getPreviousNode(i),n=s.closest(t.stepLi),a=s;if(this.isFolder(n))if(this.isOpen(n))a=this.getPreviousNode(s);else{var r=n.children(t.stepFolder);r.children().length&&(a=r.find(t.stepLink).last())}return a.hasClass("is-disabled")&&(a=this.getPreviousStep(a.parent())),a},goToNextStep:function(){var e=this,t=this.getSelectedStep(),i=e.getNextStep(t);if(i.length)e.selectStep(i,"next");else if("function"==typeof e.settings.beforeSelectStep){var s=e.settings.beforeSelectStep({isStepping:"next"});s.done&&"function"==typeof s.done?s.done(function(t,i){t&&i&&e.selectStepFinish(i)}):s&&e.selectStepFinish(i)}},goToPreviousStep:function(){var e=this.getSelectedStep(),t=this.getPreviousStep(e);t.length&&this.selectStep(t,"prev")},handleKeys:function(){var e=this,t=this.settings;this.stepListJq.on("focus.stepprocess",t.stepLink,function(){var e=$(this);if(0===parseInt(e.attr("aria-level"),10)&&1===parseInt(e.attr("aria-posinset"),10)&&e.hasClass("is-disabled")){var t=$.Event("keydown.stepprocess");return t.keyCode=40,void e.trigger(t)}}),this.stepListJq.on("keydown.stepprocess",t.stepLink,function(i){var s=i.charCode||i.keyCode,n=$(this),a=void 0,r=void 0;if(!e.isAnimating){if(40===s){var o=e.getNextNode(n);e.setFocus(o)}if(38===s){var l=e.getPreviousNode(n);e.setFocus(l)}if(32===i.keyCode&&n.trigger("click.stepprocess"),37===s)return k.isRTL()?n.next().hasClass("is-open")?(r=n.next().find(t.stepLink+":first"),e.setFocus(r)):e.folderToggle(n):n.next().hasClass("is-open")?e.folderToggle(n):(r=n.closest(".folder").find(t.stepLink+":first"),e.setFocus(r)),i.stopPropagation(),!1;if(39===s)return k.isRTL()?n.next().hasClass("is-open")?e.folderToggle(n):(a=n.closest(".folder").find(t.stepLink+":first"),e.setFocus(a)):n.next().hasClass("is-open")?(a=n.next().find(t.stepLink+":first"),e.setFocus(a)):(e.folderToggle(n),e.setFocus(n)),i.stopPropagation(),!1;36===s&&(a=e.stepListJq.find(t.stepLink+":first:visible"),e.setFocus(a)),35===s&&(a=e.stepListJq.find(t.stepLink+":last:visible"),e.setFocus(a))}}),this.stepListJq.on("keypress.stepprocess",t.stepLink,function(i){var s=i.charCode||i.keyCode,n=$(this);if(s>=37&&s<=40||32===s)return i.stopPropagation(),!1;0!==i.which&&n.closest(t.stepLi).nextAll().find(".js-step-link:visible").each(function(){var t=$(this);if(t.text().substr(0,1).toLowerCase()===String.fromCharCode(i.which).toLowerCase())return e.setFocus(t),!1})})},isFolder:function(e){return $(e).hasClass("folder")},isInFolder:function(e){return $(e).closest(this.settings.stepFolder,this.stepListJq).length},isOpen:function(e){return $(e).hasClass("is-open")},setFocus:function(e){e.focus()},setIcon:function(e,t){var i=t.replace(/icon-|hide-focus|\s?/gi,"");e.changeIcon(i)},selectStep:function(e,t){var i=this;void 0===t&&(t="none");var s=void 0;if("function"==typeof i.settings.beforeSelectStep){var n={stepLink:e,isStepping:t};(s=i.settings.beforeSelectStep(n)).done&&"function"==typeof s.done?s.done(function(s,n){s&&(n&&(e=n),i.selectStepFinish(e,t))}):s&&i.selectStepFinish(e,t)}else i.selectStepFinish(e,t)},selectStepFinish:function(e,t){var i=this,s=$(this.settings.stepLink,this.stepListJq),n=e.closest(this.settings.stepLi);if(this.isFolder(n)||(s.attr({tabindex:"-1","aria-selected":"false"}).parent().removeClass("is-selected"),e.attr({tabindex:"0","aria-selected":"true"}),n.addClass("is-selected")),this.isFolder(n))"none"===t?this.folderToggle(n):this.folderOpen(n);else{var a=n.closest(this.settings.stepFolder,this.stepListJq);a.length&&this.folderOpen(a.closest(this.settings.stepLi)),this.showStepPanel(e.attr("href"))}e.focus(),setTimeout(function(){i.element.triggerHandler("selected",e)},0)},unSelectedNode:function(e){var t=$(this.settings.stepLink,this.stepListJq),i=$(e),s=i.children(this.settings.stepLink);t.attr("tabindex","-1"),s.attr("tabindex","0"),i.removeClass("is-selected"),s.attr("aria-selected","false")},setupEvents:function(){var e=this,t=this,i=this.settings;this.stepListJq.on("updated.stepprocess",function(){e.initStepprocess()}).on("click.stepprocess",i.stepLink+":not(.is-clone)",function(e){if(e.preventDefault(),!i.linearProgression){var s=$(this);s.is(".is-disabled, .is-loading")||(t.selectStep(s),e.stopPropagation())}}),$(i.btnPrev).on("click",function(i){i.preventDefault(),e.goToPreviousStep.call(t)}),$(i.btnNext).on("click",function(i){i.preventDefault(),e.goToNextStep.call(t)}),$(i.contentScroll).scrollaction({scrollActionTarget:".main"}),$(i.stepListScroll).scrollaction({scrollActionTarget:".sidebar"}),$(".js-toggle-sidebar").click(function(t){t.preventDefault(),e.element.toggleClass("tablet-hide-steps").toggleClass("phone-hide-steps")})},showStepPanel:function(e){$(".step-panel-active").removeClass("step-panel-active"),$(e).addClass("step-panel-active"),this.element.addClass("phone-hide-steps")},unbind:function(){return this.stepListJq.off("updated.stepprocess click.stepprocess focus.stepprocess keydown.stepprocess keypress.stepprocess").empty(),this},updated:function(e){return void 0!==e&&(this.settings=m.mergeSettings(this.element,e,Gs)),this.unbind().init()},destroy:function(){this.unbind(),$.removeData(this.element[0],"stepprocess")}},$.fn.stepprocess=function(e){return this.each(function(){var t=$.data(this,"stepprocess");t?t.updated(e):t=$.data(this,"stepprocess",new Us(this,e))})};var _s={locale:"en-US"},Ks=".no-init, [data-init]";function Ys(e,t,i){return $(e)[t](i)}function Xs(e,t){var i=e.find(t).not(Ks);return e.filter(t).length&&(i=i.add(e)),i}var Js=[["zoom",null,function(){$("head").zoom()}],["applicationmenu","#application-menu",function(e,t,i){Xs(e,i).each(function(t,i){$(i).applicationmenu({triggers:e.find(".application-menu-trigger")})})}],["personalize",null,function(){$("html").personalize()}],["hyperlink"],["icon"],["radio",".radio-section input:radio.handle",function(e,t,i){Xs(e,i).change(function(){if(this.checked){var e=$(this).closest(".option"),t=e.siblings(),i='button, select, input[type="text"]';$(i,e).removeAttr("disabled"),$(i,t).attr("disabled","disabled")}})}],["splitter"],["tabs",".tab-container:not(.vertical)"],["verticaltabs",".tab-container.vertical"],["multitabs",".multitabs-container"],["dropdown","select.dropdown:not(.multiselect)"],["dropdown","select.dropdown-xs:not(.multiselect)"],["dropdown","select.dropdown-sm:not(.multiselect)"],["dropdown","select.dropdown-lg:not(.multiselect)"],["modal"],["slider",'input[type="range"], .slider'],["editor"],["tooltip","button[title], span[title], .hyperlink[title], .icon[title], input[title]"],["tree"],["rating"],["listbuilder"],["compositeform",".composite-form"],["progress",".progress-bar"],["mask","input[data-mask], .new-mask"],["autocomplete",".autocomplete:not([data-init])"],["multiselect","select[multiple]:not(.dropdown), .multiselect:not([data-init])"],["button",[".btn",".btn-toggle",".btn-secondary",".btn-primary",".btn-modal-primary",".btn-tertiary",".btn-icon",".btn-actions",".btn-menu",".btn-split",".btn-secondary-border"].join(", ")],["hideFocus","a.hide-focus, a.tick, .checkbox, .radio, .switch"],["circlepager"],["clearable",'[data-clearable="true"]'],["textarea","textarea"],["spinbox"],["arrange"],["swaplist"],["colorpicker"],["datepicker"],["timepicker"],["tag"],["busyindicator",".busy, .busy-xs, .busy-sm"],["header"],["fileupload","input.fileupload:not(.fileupload-background-transparent)"],["fileuploadadvanced",".fileupload-advanced"],["fieldfilter",".field-filter"],["fieldoptions",".field-options"],["about"],["contextualactionpanel",".contextual-action-panel-trigger"],["expandablearea",".expandable-area"],["signin"],["homepage"],["lookup",".lookup:not([data-init])"],["wizard"],["popdown","[data-popdown]"],["stepchart",".step-chart"],["calendar",".calendar"],["monthview",".monthview"],["listview"],["trackdirty",'[data-trackdirty="true"]'],["popupmenu","[data-popupmenu]:not(.btn-actions, .btn-filter, .btn-menu)",function(e,t,i){Xs(e,i).each(function(e,i){var s=$(i),n=$.extend({},m.parseOptions(s)),a=s.attr("data-popupmenu");a&&(n.menuId=a),Ys(s,t,n)})}],["popupmenu",".btn-actions, .btn-filter, .btn-menu",function(e,t,i){Xs(e,i).each(function(e,i){var s=$(i);s.parents(".toolbar, .flex-toolbar").length>0||Ys(s,t)})}],["popover","[data-popover]",function(e,t,i){Xs(e,i).each(function(){var e=m.parseOptions(this),t=$(this),i=t.attr("data-trigger"),s=t.attr("data-title"),n=t.attr("data-placement");$.isEmptyObject(e)?t.popover({content:$("#"+t.attr("data-popover")),popover:!0,trigger:i||"click",title:s||void 0,placement:n||"right",extraClass:e.extraClass||void 0}):t.popover({content:$(e.content),popover:!0,trigger:e.trigger||"click",title:e.title||void 0,placement:e.placement||"right",extraClass:e.extraClass||void 0})})}],["searchfield",".searchfield",function(e,t,i){var s=Xs(e,i),n=s.filter(function(){return $(this).parents(".toolbar").length});(s=s.not(n)).each(function(){Ys(this,"searchfield")})}],["toolbar",".toolbar",function(e,t,i){Xs(e,i).each(function(t,i){var s=$(i);s.parents(".header, .contextual-action-panel .modal-header").length&&!e.is(".toolbar")||Ys(s,"toolbar")})}],["toolbarflex",".flex-toolbar"],["accordion",".accordion",function(e,t,i){Xs(e,i).each(function(e,t){var i=$(t);i.parents(".application-menu").length||Ys(i,"accordion")})}],["formcompact",".form-compact-container",function(e,t,i){Xs(e,i).each(function(e,t){Ys($(t),"formcompact")})}],["listdetail",".list-detail",function(e,t,i){Xs(e,i).each(function(e,t){Ys($(t),"listdetail")})}],["texttranslations",'[data-translate="text"]',function(e,t,i){Xs(e,i).each(function(e,t){var i=$(t);i.text(k.translate(i.text(),!0))})}],["breadcrumblabels",".breadcrumb ol",function(e,t,i){Xs(e,i).attr("aria-label",k.translate("Breadcrumb"))}],["validate","[data-validate]",function(e,t,i){Xs(e,i).closest("form, body").validate()}],["validate",'form[data-validate-on="submit"]']];function Qs(e,t,i,s){($.fn[t]||"texttranslations"===t)&&(void 0===i&&(i="."+t),"function"!=typeof s?Xs(e,i).each(function(){var e=$(this);e.is(Ks)||e.parents(Ks).length||Ys(this,t)}):s(e,t,i))}function Zs(e,t){var i=t;"string"==typeof t&&(i={locale:t}),this.element=$(e),k.currentLocale&&k.currentLocale.name&&!t&&(i={locale:k.currentLocale.name}),this.settings=m.mergeSettings(this.element[0],i,_s),this.init()}Zs.prototype={init:function(){var e=this;return k.set(this.settings.locale).done(function(){e.initAll()}),this},initAll:function(){return this.element.each(function(){for(var e=0;e<Js.length;e++)Qs.apply(void 0,[$(this)].concat(p(Js[e])))}),this.element.triggerHandler("initialized",{locale:k.currentLocale}),$.fn.validate&&this.element.validate(),this}},$.fn.initialize=function(e){return this.each(function(){return new Zs(this,e)})};var en={delay:400,mouseEvents:!1};function tn(e){return this.settings=m.mergeSettings(this.element,e,en),this.init()}tn.prototype={timer:null,init:function(){var e=this,t=this.getInputEventNames(),i=this;$(document).on(t.mousedown+".longpress",function(t){var s=t.target;e.timer=new B({id:"longpress-timer",duration:y.convertDelayToFPS(e.settings.delay),timeoutCallback:function(){i.fire(s,t)}}),F.register(e.timer)}),$(document).on([t.mouseup+".longpress",t.mouseout+".longpress",t.mousemove+".longpress"].join(" "),function(){e.killTimer()})},fire:function(e,t){$(e).trigger("longpress",[t])},killTimer:function(){this.timer&&(this.timer.destroy(!0),this.timer=null)},getInputEventNames:function(){var e=l.features.touch,t=this.settings.mouseEvents,i=e||!t;return{mousedown:i?"touchstart":"mousedown",mouseout:i?"touchcancel":"mouseout",mouseup:i?"touchend":"mouseup",mousemove:i?"touchmove":"mousemove"}},updated:function(e){e&&(this.settings=m.mergeSettings(this.element,e,this.settings)),this.teardown(),this.init()},teardown:function(){var e=this.getInputEventNames();this.killTimer(),$(document).off([e.mousedown+".longpress",e.mouseup+".longpress",e.mouseout+".longpress",e.mousemove+".longpress"].join(" "))}};var sn=new tn,nn=Object.freeze({__proto__:null,Button:re,Hyperlink:le,Icon:ne,ListFilter:Ve,MaskInput:ve,Modal:yi,PopupMenu:ye,Tmpl:We,About:xe,Accordion:Te,ApplicationMenu:Xe,Autocomplete:Ge,Bar:ft,Blockgrid:Qe,Bullet:st,BusyIndicator:et,ColorPicker:At,Column:pt,CompletionChart:at,ContextualActionPanel:Mt,Drag:K,DatePicker:Yt,Dropdown:Nt,EmptyMessage:dt,ExpandableArea:It,Line:ht,ListBuilder:mi,ListView:gi,Message:xi,MultiSelect:ki,Notification:Ti,Pager:ui,Pie:vt,Popdown:Ii,Radar:yt,SearchField:Ke,Slider:Ri,Sparkline:ot,Spinbox:qi,Splitter:Wi,StepChart:Yi,Tabs:Qi,Tag:es,Textarea:is,TimePicker:qt,Toast:jt,Toolbar:ns,ToolbarFlex:cs,Tooltip:Rt,Tree:gs,Treemap:ms,Validator:Ut,Wizard:bs,Zoom:zi,Calendar:kt,CompositeForm:Lt,Datagrid:Es,FormCompact:Ps,Header:Bs,Lookup:Os,MonthView:xt,MultiTabs:Hs}),an=Object.freeze({__proto__:null,ListDetail:js,Stepprocess:Us});return e.DOM=n,e.Editors=Cs,e.Formatters=ws,e.GroupBy=As,e.HideFocus=d,e.Initialize=Zs,e.Locale=k,e.Place=ie,e.RenderLoopItem=B,e.Validation=Vt,e.base=E,e.breakpoints=a,e.components=nn,e.debug=i,e.defer=h,e.env=l,e.excel=ks,e.getColorStyleSheet=function(e){return j.getColorStyleSheet(e)},e.keyboard=N,e.longPress=sn,e.masks=de,e.number=x,e.patterns=an,e.personalization=j,e.renderLoop=F,e.setColors=function(e){return j.setColors(e)},e.setTheme=function(e){return j.setTheme(e)},e.smoothScrollTo=c,e.string=w,e.theme=H,e.uniqueIdCount=g,e.utils=m,e.version="4.21.2",e.xss=s,e}({});
//# sourceMappingURL=sohoxi.min.js.map